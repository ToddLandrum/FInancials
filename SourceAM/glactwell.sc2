*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="glactwell.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 619
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 981

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "coa", ;
		BufferModeOverride = 5, ;
		CursorSource = "coa", ;
		Database = ..\data\appdata.dbc, ;
		Height = 90, ;
		Left = 27, ;
		Name = "Cursor1", ;
		Top = 10, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "coabal", ;
		CursorSource = "coabal", ;
		Database = ..\data\appdata.dbc, ;
		Height = 90, ;
		Left = 333, ;
		Name = "Cursor2", ;
		Top = 126, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "glmaster", ;
		CursorSource = "glmaster", ;
		Database = ..\data\appdata.dbc, ;
		Filter = "", ;
		Height = 90, ;
		Left = 152, ;
		Name = "Cursor3", ;
		Top = 14, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "checks", ;
		CursorSource = "checks", ;
		Database = ..\data\appdata.dbc, ;
		Filter = "", ;
		Height = 90, ;
		Left = 329, ;
		Name = "Cursor4", ;
		Top = 7, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "custownvend", ;
		CursorSource = "custownvend", ;
		Database = ..\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\data\appdata.dbc, ;
		Height = 90, ;
		Left = 18, ;
		Name = "Cursor6", ;
		Top = 138, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "vendor", ;
		CursorSource = "vendor", ;
		Database = ..\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formglactwell AS frmrptcriteria OF "appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shpshapecustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="optSelect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shpshapecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shpshapecustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblToYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblfieldlabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblfieldlabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblToPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFromYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFromPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgSortBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboAccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptcriteriabuttons1.Glmaint" UniqueID="" Timestamp="" />

	Caption = "G/L Activity by Well"
	DataSession = 2
	DoCreate = .T.
	Height = 480
	HelpContextID = 409
	Name = "FormGlactWell"
	Visible = .T.
	Width = 378
	Swrptcriteriabuttons1.chkSendFile.Alignment = 0
	Swrptcriteriabuttons1.chkSendFile.Name = "chkSendFile"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 60
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 18
	Swrptcriteriabuttons1.Top = 414
	Swrptcriteriabuttons1.ZOrderSet = 3

	ADD OBJECT 'cboAccount' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 20, ;
		Left = 98, ;
		Name = "cboAccount", ;
		TabIndex = 17, ;
		Top = 320, ;
		Width = 252, ;
		ZOrderSet = 20
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Lblfieldlabelcustom1' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "To Well ID", ;
		Height = 16, ;
		Left = 29, ;
		Name = "Lblfieldlabelcustom1", ;
		TabIndex = 16, ;
		Top = 248, ;
		Width = 49, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lblfieldlabelcustom2' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "From Well ID", ;
		Height = 16, ;
		Left = 17, ;
		Name = "Lblfieldlabelcustom2", ;
		TabIndex = 15, ;
		Top = 197, ;
		Width = 61, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblFromPeriod' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Fiscal Period:", ;
		Height = 16, ;
		Left = 199, ;
		Name = "lblFromPeriod", ;
		TabIndex = 8, ;
		Top = 100, ;
		Width = 66, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblFromYear' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Fiscal Year:", ;
		Height = 16, ;
		Left = 24, ;
		Name = "lblFromYear", ;
		TabIndex = 7, ;
		Top = 100, ;
		Width = 60, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Print By", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 2, ;
		Top = 17, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Selection Criteria", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 4, ;
		Top = 78, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom3' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Well Range", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 13, ;
		Top = 173, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom4' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Sort By", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 1, ;
		Top = 361, ;
		ZOrderSet = 19
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom5' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Account", ;
		FontBold = .T., ;
		Left = 26, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 20, ;
		Top = 306, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblToPeriod' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "To Fiscal Period:", ;
		Height = 16, ;
		Left = 199, ;
		Name = "lblToPeriod", ;
		TabIndex = 12, ;
		Top = 134, ;
		Visible = .F., ;
		Width = 81, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblToYear' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "To Fiscal Year:", ;
		Height = 16, ;
		Left = 24, ;
		Name = "lblToYear", ;
		TabIndex = 11, ;
		Top = 134, ;
		Visible = .F., ;
		Width = 75, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgSortBy' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		ButtonCount = 2, ;
		Height = 36, ;
		Left = 12, ;
		Name = "opgSortBy", ;
		TabIndex = 17, ;
		Top = 368, ;
		Width = 348, ;
		ZOrderSet = 17, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = " Well", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 99, ;
		Option1.Name = "Option1", ;
		Option1.Top = 13, ;
		Option1.Width = 41, ;
		Option2.Alignment = 0, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = " Account Number", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 199, ;
		Option2.Name = "Option2", ;
		Option2.Top = 13, ;
		Option2.Width = 102
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'optSelect' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		ButtonCount = 3, ;
		Height = 36, ;
		Left = 12, ;
		Name = "optSelect", ;
		TabIndex = 3, ;
		Top = 24, ;
		Width = 348, ;
		ZOrderSet = 0, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Fiscal Period", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 4, ;
		Option1.Name = "Option1", ;
		Option1.Top = 12, ;
		Option1.Width = 79, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Fiscal Year", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 119, ;
		Option2.Name = "Option2", ;
		Option2.Top = 12, ;
		Option2.Width = 73, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "Fiscal Period Range", ;
		Option3.FontSize = 8, ;
		Option3.Height = 16, ;
		Option3.Left = 228, ;
		Option3.Name = "Option3", ;
		Option3.Top = 12, ;
		Option3.Width = 113
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Shpshapecustom1' AS shpshapecustom WITH ;
		Height = 120, ;
		Left = 12, ;
		Name = "Shpshapecustom1", ;
		Top = 180, ;
		Width = 348, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Shpshapecustom2' AS shpshapecustom WITH ;
		Height = 37, ;
		Left = 19, ;
		Name = "Shpshapecustom2", ;
		Top = 313, ;
		Width = 348, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Shpshapecustom3' AS shpshapecustom WITH ;
		Height = 84, ;
		Left = 12, ;
		Name = "Shpshapecustom3", ;
		Top = 84, ;
		Width = 348, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Swrptcriteriabuttons1.Glmaint' AS glmaint WITH ;
		Left = 236, ;
		Name = "Glmaint", ;
		Top = 10
		*< END OBJECT: ClassLib="..\..\custom\swgl.vcx" BaseClass="custom" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 132, ;
		Name = "Swrptlook1", ;
		TabIndex = 14, ;
		Top = 192, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = wells.cwellid, ;
		txtBegID.clistworkarea = wells, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = wells.cwellid, ;
		txtEndID.clistworkarea = wells, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtPeriod' AS swperiod WITH ;
		Left = 311, ;
		Name = "txtPeriod", ;
		TabIndex = 6, ;
		Top = 98, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtPeriod2' AS swperiod WITH ;
		Left = 311, ;
		Name = "txtPeriod2", ;
		TabIndex = 10, ;
		Top = 132, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear' AS swyear WITH ;
		Left = 132, ;
		Name = "txtYear", ;
		TabIndex = 5, ;
		Top = 98, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear2' AS swyear WITH ;
		Left = 132, ;
		Name = "txtYear2", ;
		TabIndex = 9, ;
		Top = 132, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\..\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcYear, lcPeriod, lcWell1, lcWell2, lnSort, lcYear2, lcPeriod2, lcCurFY
		LOCAL lnSelect
		
		lcYear      = THISFORM.txtYear.VALUE
		lcPeriod    = THISFORM.txtPeriod.VALUE
		lcWell1     = THISFORM.swrptlook1.txtBegID.VALUE
		lcWell2     = THISFORM.swrptlook1.txtEndID.VALUE
		lnSort      = THISFORM.opgSortBy.VALUE
		lcYear2     = THISFORM.txtYear2.VALUE
		lcPeriod2   = THISFORM.txtPeriod2.VALUE
		lnSelect    = THISFORM.optSelect.VALUE
		lcAccount   = THISFORM.cboAccount.VALUE
		
		
		*
		*  Set the report title
		*
		DO CASE
		   CASE THISFORM.optSelect.VALUE = 1
		      THISFORM.cTitle1 = 'For Fiscal Period: ' + THISFORM.txtPeriod.VALUE +'/'+ THISFORM.txtYear.VALUE
		   CASE THISFORM.optSelect.VALUE = 2
		      THISFORM.cTitle1 = 'For Fiscal Year: ' + THISFORM.txtYear.VALUE
		   CASE THISFORM.optSelect.VALUE = 3
		      THISFORM.cTitle1 = 'For Period Range: ' + THISFORM.txtPeriod.VALUE +'/'+ THISFORM.txtYear.VALUE + ' - ' + ;
		         THISFORM.txtPeriod2.VALUE +'/'+ THISFORM.txtYear2.VALUE
		   CASE THISFORM.optSelect.VALUE = 4
		      THISFORM.cTitle1 = 'For Production Period: ' + lcYear + '/'+lcPeriod
		ENDCASE
		
		*
		*  Set Selection and Sort Criteria
		*
		THISFORM.cSelectCriteria = 'Wells: ' + THISFORM.swrptlook1.txtBegID.VALUE + ' - ' + THISFORM.swrptlook1.txtEndID.VALUE
		IF lnSort = 1
		   THISFORM.cSortOrder      = 'Well ID, Account Number'
		   thisform.creportname     = 'source\glact2.frx'
		ELSE
		   THISFORM.cSortOrder      = 'Account Number, Well ID'
		   THISFORM.cReportName     = 'source\glact5.frx'
		ENDIF   
		
		THISFORM.cTitle2         = ' '
		
		CREATE CURSOR temprpt ;
		  (cunitno    C(10), ;
		   cwellname  C(30), ;
		   cacctno    C(60), ;
		   cacctdesc  C(30), ;
		   cid        C(10), ;
		   cpayee     C(40), ;
		   cbatch     C(8), ;
		   ddate      D, ;
		   cdesc      C(40), ;
		   namount    N(12,2))
		INDEX ON cunitno+cacctno TAG unit
		INDEX ON cacctno+cunitno TAG acct
		
		DO CASE
		   CASE lnSelect = 1
		      SELECT glmaster.cunitno, ;
		         allunits.cname AS cwellname, ;
		         glmaster.cacctno, ;
		         glmaster.cid, ;
		         glmaster.cbatch, ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, allunits, coa ;
		         WHERE BETWEEN(glmaster.cunitno,lcWell1,lcWell2) ;
		         AND glmaster.cunitno = allunits.cunitno ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND glmaster.cYear+glmaster.cPeriod = lcYear+lcPeriod ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma ;
		         GROUP BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma
		
		   CASE lnSelect = 2
		      SELECT glmaster.cunitno, ;
		         allunits.cname AS cwellname, ;
		         glmaster.cacctno, ;
		         glmaster.cid, ;
		         glmaster.cbatch, ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, allunits, coa ;
		         WHERE BETWEEN(glmaster.cunitno,lcWell1,lcWell2) ;
		         AND glmaster.cunitno = allunits.cunitno ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND glmaster.cYear = lcYear ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma ;
		         GROUP BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma
		
		   CASE lnSelect = 3
		      SELECT glmaster.cunitno, ;
		         allunits.cname AS cwellname, ;
		         glmaster.cacctno, ;
		         glmaster.cid, ;
		         glmaster.cbatch, ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, allunits, coa ;
		         WHERE BETWEEN(glmaster.cunitno,lcWell1,lcWell2) ;
		         AND glmaster.cunitno = allunits.cunitno ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND BETWEEN(glmaster.cYear+glmaster.cPeriod, lcYear+lcPeriod, lcYear2+lcPeriod2) ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma ;
		         GROUP BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma
		   CASE lnSelect = 4
		      SELECT glmaster.cunitno, ;
		         allunits.cname AS cwellname, ;
		         glmaster.cacctno, ;
		         glmaster.cid, ;
		         glmaster.cbatch, ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, allunits, coa ;
		         WHERE BETWEEN(glmaster.cunitno,lcWell1,lcWell2) ;
		         AND glmaster.cunitno = allunits.cunitno ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND glmaster.cProdYr+glmaster.cProdPrd = lcYear+lcPeriod ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma ;
		         GROUP BY glmaster.cunitno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma
		ENDCASE
		
		lnCount = _TALLY
		
		IF lnCount = 0
		   RETURN .F.
		ENDIF
		
		SELECT temprpt
		APPEND FROM DBF('temprptx')
		
		SELECT temprpt
		SCAN FOR NOT EMPTY(cid)
		   SCATTER MEMVAR
		   SELECT vendor
		   SET ORDER TO cvendorid
		   IF SEEK(m.cid)
		      m.cpayee = cvendname
		   ELSE
		      SELECT investor
		      SET ORDER TO cownerid
		      IF SEEK(m.cid)
		         m.cpayee = cownname
		      ELSE
		         m.cpayee = ''
		      ENDIF
		   ENDIF
		   SELECT temprpt
		   REPL cpayee WITH m.cpayee
		ENDSCAN
		
		SELECT temprpt
		IF lnSort = 1
		   SET ORDER TO unit
		ELSE 
		   SET ORDER TO acct
		ENDIF
		
		IF RECC() > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF
		
		
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		thisform.cReportName = 'glact2'
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		
		SELECT wells
		SET ORDER TO cwellid
		GO TOP
		thisform.swrptlook1.txtBegID.value = cwellid
		thisform.swrptlook1.txtBegName.value = cwellname
		GO BOTT
		thisform.swrptlook1.txtEndID.value = cwellid
		thisform.swrptlook1.txtEndName.value = cwellname
		
		this.optSelect.value = 1
		this.opgSortBy.value = 1
		
		
	ENDPROC

	PROCEDURE cboAccount.Init
		sele cacctno, cacctdesc from coa into array lacoa order by cacctno
		lnCount = _tally
		
		if lnCount > 0
		  this.addlistitem('ALL ACCOUNTS',1,1)
		  this.addlistitem('******',1,2)
		  
		  for lnx = 1 to lnCount
		  
		     this.addlistitem(lacoa[lnx,1]+'-'+allt(lacoa[lnx,2]),lnx+1,1)
		     this.addlistitem(lacoa[lnx,1],lnx+1,2)
		  endfor   
		  
		  this.listitemid = 1
		endif  
		
		dodefault()
	ENDPROC

	PROCEDURE opgSortBy.Option1.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromPeriod.caption = 'Fiscal Period:'
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtPeriod.visible = .T.
		
	ENDPROC

	PROCEDURE opgSortBy.Option2.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
	ENDPROC

	PROCEDURE optSelect.Option1.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromPeriod.caption = 'Fiscal Period:'
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtPeriod.visible = .T.
		
	ENDPROC

	PROCEDURE optSelect.Option2.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
		thisform.txtYear.visible = .t.
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
	ENDPROC

	PROCEDURE optSelect.Option3.Click
		thisform.lblFromYear.caption = 'From Fiscal Year:'
		thisform.lblFromPeriod.caption = 'From Fiscal Period:'
		thisform.lblToYear.caption = 'To Fiscal Year:'
		thisform.lblToPeriod.caption = 'To Fiscal Period:'
		thisform.txtPeriod.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtYear2.visible = .T.
		thisform.txtPeriod2.visible = .T.
		thisform.lblToYear.visible = .T.
		thisform.lblToPeriod.visible = .T.
	ENDPROC

	PROCEDURE optSelect.Valid
		DO CASE
		   CASE this.value = 1
		      thisform.lblfromyear.caption = 'Fiscal Year:'
		      thisform.lblfromperiod.caption = 'Fiscal Period:'
		   CASE this.value = 2
		      thisform.lblfromyear.caption = 'Fiscal Year:'
		      thisform.lblfromperiod.caption = 'Fiscal Period:'   
		   CASE this.value = 3
		      thisform.lblfromyear.caption = 'Fiscal Year:'
		      thisform.lblfromperiod.caption = 'Fiscal Period:'   
		   CASE this.value = 4
		      thisform.lblfromyear.caption = 'Prod Year:'
		      thisform.lblfromperiod.caption = 'Prod Period:'   
		ENDCASE      
		      
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtBegId.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cwellid
		   thisform.swrptlook1.txtBegName.value = cwellname
		   thisform.swrptlook1.txtBegId.SetFocus()
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtEndId.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cwellid
		   thisform.swrptlook1.txtEndName.value = cwellname
		   thisform.swrptlook1.txtEndId.SetFocus()
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
	ENDPROC

ENDDEFINE
