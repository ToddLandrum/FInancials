*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="glopenprd.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "sysctl", ;
		CursorSource = "sysctl", ;
		Database = ..\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "glopt", ;
		CursorSource = "glopt", ;
		Database = ..\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formglopenprd AS frmformcustom OF "..\.\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Lbltextcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swperiod1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swyear1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdOpen" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdExit" UniqueID="" Timestamp="" />

	Caption = "Open a Closed Fiscal Accounting Period"
	DoCreate = .T.
	Height = 162
	HelpContextID = 378
	lcloseonescape = .T.
	Name = "FormGlopenprd"
	Width = 435

	ADD OBJECT 'cmdExit' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Exit", ;
		FontSize = 8, ;
		Height = 33, ;
		Left = 223, ;
		Name = "cmdExit", ;
		TabIndex = 8, ;
		Top = 119, ;
		Width = 80
		*< END OBJECT: ClassLib="..\.\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdOpen' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Open Period", ;
		FontSize = 8, ;
		Height = 33, ;
		Left = 131, ;
		Name = "cmdOpen", ;
		TabIndex = 7, ;
		Top = 119, ;
		Width = 80
		*< END OBJECT: ClassLib="..\.\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Lbltextcustom1' AS lbltextcustom WITH ;
		AutoSize = .T., ;
		Caption = "This form is used to open a closed Fiscal Accounting Period.  Once a period has been opened, journal transactions can be entered with a date that falls within this period.", ;
		FontBold = .F., ;
		FontSize = 8, ;
		Height = 44, ;
		Left = 43, ;
		Name = "Lbltextcustom1", ;
		TabIndex = 4, ;
		Top = 21, ;
		Width = 334, ;
		WordWrap = .T.
		*< END OBJECT: ClassLib="..\.\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom2' AS lbltextcustom WITH ;
		AutoSize = .T., ;
		Caption = "Fiscal Year:", ;
		FontSize = 8, ;
		Left = 94, ;
		Name = "Lbltextcustom2", ;
		TabIndex = 5, ;
		Top = 81
		*< END OBJECT: ClassLib="..\.\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom3' AS lbltextcustom WITH ;
		AutoSize = .T., ;
		Caption = "Fiscal Period:", ;
		FontSize = 8, ;
		Left = 235, ;
		Name = "Lbltextcustom3", ;
		TabIndex = 6, ;
		Top = 81
		*< END OBJECT: ClassLib="..\.\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Swperiod1' AS swperiod WITH ;
		FontSize = 8, ;
		ldefvalue = .T., ;
		Left = 319, ;
		lnoinit = .T., ;
		Name = "Swperiod1", ;
		TabIndex = 3, ;
		Top = 79
		*< END OBJECT: ClassLib="..\.\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swyear1' AS swyear WITH ;
		FontSize = 8, ;
		ldefvalue = .T., ;
		Left = 166, ;
		lnoinit = .T., ;
		Name = "Swyear1", ;
		TabIndex = 2, ;
		Top = 79
		*< END OBJECT: ClassLib="..\.\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE Init
		LOCAL m.cYear, m.cPeriod, llFound
		
		DODEFAULT()
		SET DELETED ON
		llFound = .F.
		
		SELECT sysctl
		SET ORDER TO yrprdkey
		GO TOP
		
		SCAN FOR NOT lDisbman
		   llFound = .T.
		   thisform.swYear1.value = cYear
		   thisform.swPeriod1.value = cPeriod
		   EXIT
		ENDSCAN   
		
		IF NOT llFound
		   thisform.oMessage.Display('There are no closed fiscal periods.')
		   RETURN .F.
		ENDIF   
		
		
		
		
	ENDPROC

	PROCEDURE cmdExit.Click
		THISFORM.Release()
		
	ENDPROC

	PROCEDURE cmdOpen.Click
		LOCAL m.cYear, m.cPeriod, llFound, m.clPrd, m.clYear
		
		m.cYear   = THISFORM.swYear1.VALUE
		m.cPeriod = THISFORM.swPeriod1.VALUE
		
		SELECT sysctl
		SET ORDER TO yrprdkey
		IF NOT SEEK(m.cYear+m.cPeriod+'N')
		   thisform.oMessage.Display('Fiscal Period: ' + m.cYear+'/'+m.cPeriod + ' is not closed.')
		ELSE
		   IF thisform.oMessage.Confirm('Are you sure you want to open fiscal period: ' + m.cYear+'/'+m.cPeriod + '?')
		      DELETE NEXT 1
		      TABLEUPDATE(.t.)
		      thisform.oMessage.Display('Fiscal Period: ' + m.cYear+'/'+m.cPeriod + ' is now opened.')
		   ENDIF      
		ENDIF   
	ENDPROC

ENDDEFINE
