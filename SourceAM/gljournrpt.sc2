*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="gljournrpt.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 974
	Left = 3
	Name = "Dataenvironment"
	Top = -2
	Width = 1754

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "coa", ;
		CursorSource = "coa", ;
		Database = ..\amdata\appdata.dbc, ;
		Filter = "NOT DELETED()", ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "vendor", ;
		CursorSource = "vendor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 416, ;
		Name = "Cursor10", ;
		Top = 24, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "glmaster", ;
		CursorSource = "glmaster", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 157, ;
		Name = "Cursor2", ;
		Top = 27, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "glopt", ;
		CursorSource = "glopt", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "custs", ;
		CursorSource = "custs", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 155, ;
		Name = "Cursor4", ;
		Top = 290, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "glbatches", ;
		CursorSource = "glbatches", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 144, ;
		Name = "Cursor5", ;
		Top = 158, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "checks", ;
		CursorSource = "checks", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 288, ;
		Name = "Cursor6", ;
		Top = 150, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "emps", ;
		CursorSource = "emps", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 12, ;
		Name = "Cursor7", ;
		Top = 163, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 287, ;
		Name = "Cursor8", ;
		Top = 283, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "revsrc", ;
		CursorSource = "revsrc", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 415, ;
		Name = "Cursor9", ;
		Top = 162, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formgljournlist AS frmrptcriteria OF "appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="optType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblTo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFrom" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFiscal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="optSelect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Glmaint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboJournal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtddate1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtddate2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkOwnPage" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: cbatch1
		*p: cbatch2
	*</DefinedPropArrayMethod>

	Caption = "Journal Reports"
	cbatch1 = .F.
	cbatch2 = .F.
	DataSession = 2
	DoCreate = .T.
	Height = 474
	HelpContextID = 408
	Name = "FormGljournlist"
	Visible = .T.
	Width = 518
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 142
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 18
	Swrptcriteriabuttons1.Top = 396
	Swrptcriteriabuttons1.ZOrderSet = 0

	ADD OBJECT 'cboJournal' AS cbocomboboxcustom WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 180, ;
		Name = "cboJournal", ;
		RowSourceType = 0, ;
		TabIndex = 5, ;
		Top = 108, ;
		Width = 168
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'chkOwnPage' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Put Each Batch On It's Own Page", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 180, ;
		Name = "chkOwnPage", ;
		TabIndex = 17, ;
		Top = 348, ;
		Value = .F., ;
		Width = 178
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'Glmaint' AS glmaint WITH ;
		Left = 19, ;
		Name = "Glmaint", ;
		Top = 80
		*< END OBJECT: ClassLib="..\custom\swgl.vcx" BaseClass="custom" />

	ADD OBJECT 'lblFiscal' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Fiscal Year/Period", ;
		Height = 16, ;
		Left = 60, ;
		Name = "lblFiscal", ;
		TabIndex = 12, ;
		Top = 153, ;
		Width = 90, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblFrom' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Beginning Batch Number", ;
		Height = 16, ;
		Left = 24, ;
		Name = "lblFrom", ;
		TabIndex = 15, ;
		Top = 228, ;
		Width = 120, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Select By", ;
		Height = 16, ;
		Left = 203, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 3, ;
		Top = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "Date Range:", ;
		Left = 84, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 13, ;
		Top = 188
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom4' AS lbllabelcustom WITH ;
		Caption = "Journal", ;
		Left = 108, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 19, ;
		Top = 110
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom5' AS lbllabelcustom WITH ;
		Caption = "-", ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 283, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 6, ;
		Top = 188, ;
		Width = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom1' AS lbltextcustom WITH ;
		Caption = "/", ;
		FontSize = 10, ;
		Left = 222, ;
		Name = "Lbltextcustom1", ;
		TabIndex = 11, ;
		Top = 152, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblTo' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Ending Batch Number", ;
		Height = 16, ;
		Left = 36, ;
		Name = "lblTo", ;
		TabIndex = 16, ;
		Top = 276, ;
		Width = 105, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblType' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Report Type", ;
		Height = 16, ;
		Left = 13, ;
		Name = "lblType", ;
		TabIndex = 1, ;
		Top = 12, ;
		Width = 61, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'optSelect' AS opgoptiongroupcustom WITH ;
		ButtonCount = 3, ;
		Height = 66, ;
		Left = 254, ;
		Name = "optSelect", ;
		TabIndex = 4, ;
		Top = 13, ;
		Width = 142, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Fiscal Period ", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 82, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Date Range", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "Option2", ;
		Option2.Top = 24, ;
		Option2.Width = 74, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "Batch Number Range", ;
		Option3.FontSize = 8, ;
		Option3.Height = 16, ;
		Option3.Left = 5, ;
		Option3.Name = "Option3", ;
		Option3.Top = 43, ;
		Option3.Width = 120
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'optType' AS opgoptiongroupcustom WITH ;
		ButtonCount = 2, ;
		Height = 48, ;
		Left = 85, ;
		Name = "optType", ;
		TabIndex = 2, ;
		Top = 12, ;
		Value = 1, ;
		Width = 107, ;
		ZOrderSet = 1, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Journal Listing", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 6, ;
		Option1.Name = "optJournal", ;
		Option1.Top = 7, ;
		Option1.Value = 1, ;
		Option1.Width = 87, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Account Listing", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 6, ;
		Option2.Name = "Option2", ;
		Option2.Top = 26, ;
		Option2.Width = 93
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 180, ;
		Name = "Swrptlook1", ;
		TabIndex = 14, ;
		Top = 226, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Left = 87, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton1.Top = 0, ;
		Swlookupbutton1.Visible = .T., ;
		Swlookupbutton2.Left = 87, ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		Swlookupbutton2.Top = 52, ;
		Swlookupbutton2.Visible = .T., ;
		TxtBegID.clistexpression = cbatch, ;
		TxtBegID.clistworkarea = glbatches, ;
		TxtBegID.Enabled = .F., ;
		TxtBegID.Format = "", ;
		TxtBegID.Height = 20, ;
		TxtBegID.InputMask = "XXXXXXXXXX", ;
		TxtBegID.Left = 0, ;
		TxtBegID.Name = "TxtBegID", ;
		TxtBegID.Top = 0, ;
		TxtBegID.Value = , ;
		TxtBegID.Width = 84, ;
		TxtBegName.Name = "TxtBegName", ;
		TxtEndID.clistexpression = cbatch, ;
		TxtEndID.clistworkarea = glbatches, ;
		TxtEndID.Enabled = .F., ;
		TxtEndID.Format = "", ;
		TxtEndID.Height = 20, ;
		TxtEndID.Left = 0, ;
		TxtEndID.Name = "TxtEndID", ;
		TxtEndID.Top = 51, ;
		TxtEndID.Width = 84, ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtcPeriod' AS swperiod WITH ;
		Left = 233, ;
		Name = "txtcPeriod", ;
		TabIndex = 8, ;
		Top = 151, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtcYear' AS swyear WITH ;
		Left = 180, ;
		Name = "txtcYear", ;
		TabIndex = 7, ;
		Top = 151, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtddate1' AS dpk WITH ;
		ControlSource = "", ;
		Enabled = .F., ;
		Height = 20, ;
		Left = 180, ;
		Name = "txtddate1", ;
		TabIndex = 9, ;
		Top = 186, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtddate2' AS dpk WITH ;
		ControlSource = "", ;
		Enabled = .F., ;
		Height = 20, ;
		Left = 296, ;
		Name = "txtddate2", ;
		TabIndex = 10, ;
		Top = 186, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcJourn, lcJournal
		
		IF thisform.optType.value = 1
		   IF thisform.chkOwnPage.Value = .t.
		      thisform.creportname = 'gljourn1p'
		   ELSE 
		      thisform.creportname = 'gljourn1'
		   ENDIF       
		   thisform.csortorder = 'Batch Number'
		ELSE
		   thisform.creportname = 'gljourn2'
		   thisform.csortorder = 'Account Number'
		ENDIF  
		
		DO CASE   
		   CASE thisform.optSelect.value = 1
		      thisform.cTitle1 = 'For Fiscal Period: ' + thisform.txtcYear.value+'/'+thisform.txtcPeriod.value
		      thisform.cselectcriteria = 'Fiscal Period'
		      lcbatch1 = thisform.cbatch1
		      lcbatch2 = thisform.cbatch2
		      lcAcct1  = thisform.swrptlOOK1.txtbEGID.Value
		      lcAcct2  = thisform.swrptlOOK1.txtenDID.value
		   CASE thisform.optSelect.value = 2
		      thisform.cTitle1 = 'For Date Range: ' + DTOC(thisform.txtdDate1.value)+' - '+DTOC(thisform.txtdDate2.value)
		      thisform.cselectcriteria = 'Date Range'
		      lcbatch1 = thisform.cbatch1
		      lcbatch2 = thisform.cbatch2
		      lcAcct1  = thisform.swrptlOOK1.txtbEGID.Value
		      lcAcct2  = thisform.swrptlOOK1.txtenDID.value
		   CASE thisform.optSelect.value = 3
		      thisform.cTitle1 = 'For Batch Range: ' + thisform.swrptlook1.txtBegID.value+'-'+thisform.swrptlook1.txtEndID.value
		      thisform.cselectcriteria = 'Batch Number Range'
		      lcbatch1 = thisform.swrptlook1.txtbegID.Value
		      lcbatch2 = thisform.swrptlook1.txtendID.value
		      lcAcct1  = thisform.swrptlOOK1.txtbEGID.Value
		      lcAcct2  = thisform.swrptlOOK1.txtenDID.value
		ENDCASE
		
		lcJournal = thisform.cboJournal.value
		thisform.ctitle2 = lcJournal
		
		DO CASE
		   CASE lcJournal = 'All Journals'
		      lcJourn = '**'
		   CASE lcJournal = 'General Journal'
		      lcJourn = 'GJ'
		   CASE lcJournal = 'A/R Journal'
		      lcJourn = 'AR'
		   CASE lcJournal = 'A/P Journal'
		      lcJourn = 'AP'
		   CASE lcJournal = 'Cash Journal'
		      lcJourn = 'CS'
		   CASE lcJournal = 'Payroll Journal'
		      lcJourn = 'PR'
		   CASE lcJournal = 'Disbursement Manager'
		      lcJourn = 'DM'   
		ENDCASE
		
		WAIT WIND NOWAIT 'Building Report....Please Wait'
		                      
		thisform.glmaint.printjournal(thisform.optType.value, ;
		                              thisform.optSelect.value, ;
		                              thisform.txtcYear.value, ;
		                              thisform.txtcPeriod.value, ;
		                              thisform.txtdDate1.value, ;
		                              thisform.txtdDate2.value, ;
		                              lcBatch1, ;
		                              lcBatch2, ;
		                              lcAcct1, ;
		                              lcAcct2, ;
		                              lcJourn)
		
		WAIT CLEAR
		SELECT gjtmp
		IF RECC() = 0
		   RETURN .F.
		ELSE
		   RETURN .T.
		ENDIF                                    
	ENDPROC

	PROCEDURE Init
		IF DODEFAULT()
		
		SELECT glmaster
		SET SAFETY OFF
		SET ORDER TO glBatch
		GO TOP
		*!*	DO WHILE EMPTY(glmaster.cbatch) AND RECC() > 0 AND NOT EOF()
		*!*	   SKIP
		*!*	ENDDO   
		
		thisform.txtcYear.value   = GetFiscalYear(DATE())
		thisform.txtcPeriod.value = GetFiscalPeriod(DATE())
		thisform.txtdDate1.value  = DATE() - 30
		thisform.txtdDate2.value  = DATE()
		
		SELECT glbatches
		SET ORDER to cbatch
		GO top
		thisform.swrptlook1.txtbegID.Value = cbatch
		thisform.swrptlook1.txtBegName.Value = cref
		thisform.cbatch1 = cbatch
		GO bott
		thisform.swrptlook1.txtendID.Value = cbatch
		thisform.swrptlook1.txtendname.Value = cref
		thisform.cbatch2 = cbatch
		
		ENDIF
	ENDPROC

	PROCEDURE cboJournal.Init
		this.addlistitem('All Journals',1)
		this.addlistitem('General Journal',2)
		this.addlistitem('A/R Journal',3)
		this.addlistitem('A/P Journal',4)
		this.addlistitem('Cash Journal',5)
		this.addlistitem('Payroll Journal',6)
		this.addlistitem('Disbursement Manager',7)
		
		this.listitemid = 1
		
		DODEFAULT()
	ENDPROC

	PROCEDURE optSelect.Click
		DO CASE
		   CASE THIS.VALUE = 1  &&  Fiscal Period Range
		      THISFORM.txtcYear.ENABLED = .T.
		      THISFORM.txtcPeriod.ENABLED = .T.
		      THISFORM.txtdDate1.ENABLED = .F.
		      THISFORM.txtdDate2.ENABLED = .F.
		      IF thisform.optType.Value = 1
		         thisform.swrptlook1.txtbegID.Enabled = .f.
		         thisform.swrptlook1.txtendid.Enabled = .f. 
		      ENDIF 
		   CASE THIS.VALUE = 2  &&  Date Range
		      THISFORM.txtcYear.ENABLED = .F.
		      THISFORM.txtcPeriod.ENABLED = .F.
		      THISFORM.txtdDate1.ENABLED = .T.
		      THISFORM.txtdDate2.ENABLED = .T.
		      IF thisform.optType.Value = 1
		         thisform.swrptlook1.txtbegID.Enabled = .f.
		         thisform.swrptlook1.txtendid.Enabled = .f. 
		      ENDIF 
		   CASE THIS.VALUE = 3  &&  Batch Number
		      THISFORM.txtcYear.ENABLED = .F.
		      THISFORM.txtcPeriod.ENABLED = .F.
		      THISFORM.txtdDate1.ENABLED = .F.
		      THISFORM.txtdDate2.ENABLED = .F.
		      thisform.swrptlook1.txtbegID.Enabled = .t.
		      thisform.swrptlook1.txtendid.Enabled = .t. 
		ENDCASE
		
	ENDPROC

	PROCEDURE optSelect.Init
		this.value = 1
	ENDPROC

	PROCEDURE optType.Init
		this.value = 1
	ENDPROC

	PROCEDURE optType.InteractiveChange
		IF THIS.VALUE = 1
		   thisform.chkOwnPage.Visible = .t.
		   THISFORM.optSelect.Option3.VISIBLE = .T.
		   THISFORM.lblFrom.CAPTION = 'Beginning Batch Number'
		   THISFORM.lblTo.CAPTION   = 'Ending Batch Number'
		   THISFORM.swrptlook1.txtbegid.clistexpression = 'cbatch '
		   THISFORM.swrptlook1.txtbegid.clistworkarea   = 'glbatches'
		   THISFORM.swrptlook1.txtendid.clistexpression = 'cbatch '
		   THISFORM.swrptlook1.txtendid.clistworkarea   = 'glbatches'
		   THISFORM.swrptlook1.txtBegid.MaxLength   = 8
		   THISFORM.swrptlook1.txtendid.MaxLength   = 8  
		   THISFORM.swrptlook1.txtBegid.InputMask   = 'XXXXXXXX'
		   THISFORM.swrptlook1.txtendid.InputMask   = 'XXXXXXXX'  
		   THISFORM.swrptlook1.txtBegid.set('enabled',.f.)
		   THISFORM.swrptlook1.txtEndid.set('enabled',.f.)
		   SELECT glmaster
		   SET SAFETY OFF
		   SET ORDER TO glBatch
		   GO TOP
		   DO WHILE EMPTY(glmaster.cbatch) AND RECC() > 0 AND NOT EOF()
		      SKIP
		   ENDDO
		   THISFORM.swrptlook1.txtbegid.VALUE = cbatch
		   THISFORM.swrptlook1.txtBegName.VALUE = cref
		   GO BOTTOM
		   THISFORM.swrptlook1.txtendid.VALUE = cbatch
		   THISFORM.swrptlook1.txtEndName.VALUE = cref
		ELSE   
		   thisform.chkOwnPage.Visible = .f.
		   THISFORM.optSelect.Option3.VISIBLE = .F.
		   THISFORM.lblFrom.CAPTION = 'Beginning Account Number'
		   THISFORM.lblTo.CAPTION   = 'Ending Account Number'
		   THISFORM.swrptlook1.txtbegid.clistexpression = 'cacctno'
		   THISFORM.swrptlook1.txtbegid.clistworkarea   = 'coa'
		   THISFORM.swrptlook1.txtendid.clistexpression = 'cacctno'
		   THISFORM.swrptlook1.txtendid.clistworkarea   = 'coa'
		   THISFORM.swrptlook1.txtBegid.set('enabled',.t.)
		   THISFORM.swrptlook1.txtEndid.set('enabled',.t.)
		   THISFORM.swrptlook1.txtBegid.MaxLength   = 6
		   THISFORM.swrptlook1.txtendid.MaxLength   = 6
		   THISFORM.swrptlook1.txtBegid.InputMask   = 'XXXXXX'
		   THISFORM.swrptlook1.txtendid.InputMask   = 'XXXXXX'  
		   SELECT coa
		   SET ORDER TO acctno
		   GO TOP
		   THISFORM.swrptlook1.txtbegid.VALUE = cacctno
		   THISFORM.swrptlook1.txtBegName.VALUE = cacctdesc
		   THISFORM.REFRESH()
		   GO BOTT
		   THISFORM.swrptlook1.txtendid.VALUE = cacctno
		   THISFORM.swrptlook1.txtEndName.VALUE = cacctdesc
		   THISFORM.REFRESH()
		ENDIF
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .T.
		
		IF THISFORM.optType.VALUE = 1  &&  Journal listing, so look up batches
		   SET SAFETY OFF
		   
		   SELECT glbatches
		   lcList = 'cBatch\Batch No.,cRef\Reference,dDate\Date'
		
		   DO FORM ..\CUSTOM\picklist WITH 'glbatches', lcList, THIS.PARENT.TxtBegID.VALUE, 3, .T., .T.
		
		   IF llOK
		      THIS.PARENT.TxtBegID.SET('value',glbatches.cBatch)
		      THIS.PARENT.TxtBegName.SET('value',glbatches.cRef)
		   ENDIF
		ELSE  &&  Account listing, so look up accounts
		   lcList = 'cAcctNo/acctno,cAcctDesc/acctdesc'
		
		   DO FORM ..\CUSTOM\picklist WITH 'Coa', lcList, THIS.PARENT.TxtBegID.VALUE, 2
		
		   IF llOK
		      THIS.PARENT.TxtBegID.SET('value',coa.cacctno)
		      THIS.PARENT.TxtBegName.SET('value',coa.cAcctDesc)
		   ENDIF
		ENDIF
		
		THISFORM.setnextcontrol(THIS.PARENT.TxtBegID)
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .T.
		
		IF THISFORM.optType.VALUE = 1  &&  Journal listing, so look up batches
		   SET SAFETY OFF
		   
		   SELECT glbatches
		
		   lcList = 'cBatch\Batch No.,cRef\Reference,dDate\Date'
		
		   DO FORM ..\CUSTOM\picklist WITH 'glbatches', lcList, THIS.PARENT.TxtEndID.VALUE, 3, .T., .T.
		
		   IF llOK
		      THIS.PARENT.TxtEndID.SET('value',glbatches.cBatch)
		      THIS.PARENT.TxtEndName.SET('value',glbatches.cRef)
		   ENDIF
		ELSE  &&  Account listing, so look up accounts
		   lcList = 'cAcctNo/acctno,cAcctDesc/acctdesc'
		
		   DO FORM ..\CUSTOM\picklist WITH 'Coa', lcList, THIS.PARENT.TxtEndID.VALUE, 2
		
		   IF llOK
		      THIS.PARENT.TxtEndID.SET('value',coa.cacctno)
		      THIS.PARENT.TxtEndName.SET('value',coa.cAcctDesc)
		   ENDIF
		ENDIF
		
		THISFORM.setnextcontrol(THIS.PARENT.TxtEndID)
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtBegID.InteractiveChange
		IF DODEFAULT()
		   IF THISFORM.optType.VALUE = 1  &&  Journal Listing
		      SELECT glbatches
		      LOCATE FOR cBatch = THIS.VALUE
		      IF FOUND()
		         THIS.PARENT.txtBegName.SET('value',glbatches.cRef)
		      ELSE
		         THIS.PARENT.txtBegName.SET('value',glbatches.cRef)
		      ENDIF
		   ELSE
		      SELECT coa
		      LOCATE FOR cacctno = THIS.VALUE
		      IF FOUND()
		         THIS.PARENT.txtBegName.SET('value',coa.cacctdesc)
		      ELSE
		         THIS.PARENT.txtBegName.SET('value','')
		      ENDIF
		   ENDIF
		ENDIF
		
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtBegID.Valid
		DO CASE
		   CASE THISFORM.optType.VALUE = 1
		      SELECT glbatches
		      SET ORDER TO cbatch
		      IF NOT SEEK(LEFT(THIS.VALUE,8))
		         THISFORM.oMessage.Warning("The batch number entered doesn't exist")
		         RETURN 
		      endif
		      IF EMPTY(this.Parent.txtbegname.value)
		         thisform.swrptlook1.txtbegName.set('value',cRef)
		      endif
		   CASE THISFORM.optType.VALUE = 2
		      THIS.VALUE = PADR(ALLTRIM(THIS.VALUE),6,'0')
		      SELECT coa
		      SET ORDER TO acctno
		      IF NOT SEEK(THIS.VALUE)
		         thisform.oMessage.Display('%msgBadAcctNo')
		         THISFORM.swrptlook1.txtbegName.VALUE = 'Invalid Account Number'
		         THISFORM.swrptlook1.txtbegName.REFRESH()
		         RETURN 0
		      ELSE
		         THISFORM.swrptlook1.txtbegName.VALUE = cAcctDesc
		         THISFORM.swrptlook1.txtbegName.REFRESH()
		      endif
		ENDCASE
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtEndID.InteractiveChange
		IF DODEFAULT()
		   IF THISFORM.optType.VALUE = 1  &&  Journal Listing
		      SELECT glbatches
		      LOCATE FOR cBatch = THIS.VALUE
		      IF FOUND()
		         THIS.PARENT.txtendName.SET('value',glbatches.cRef)
		      ELSE
		         THIS.PARENT.txtendName.SET('value',glbatches.cRef)
		      ENDIF
		   ELSE
		      SELECT coa
		      LOCATE FOR cacctno = THIS.VALUE
		      IF FOUND()
		         THIS.PARENT.txtendName.SET('value',coa.cacctdesc)
		      ELSE
		         THIS.PARENT.txtendName.SET('value','')
		      ENDIF
		   ENDIF
		ENDIF
		
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtEndID.Valid
		DO CASE
		   CASE THISFORM.optType.VALUE = 1
		      SELECT glbatches
		      SET ORDER TO cbatch
		      IF NOT SEEK(LEFT(THIS.VALUE,8))
		         THISFORM.oMessage.Warning("The batch number entered doesn't exist")
		         RETURN
		      ENDIF
		      IF EMPTY(THIS.PARENT.txtEndName.VALUE)
		         THISFORM.swrptlook1.txtEndName.SET('value',cRef)
		      ENDIF
		   CASE THISFORM.optType.VALUE = 2
		      SELECT coa
		      SET ORDER TO acctno
		      IF NOT SEEK(THIS.VALUE)
		         THISFORM.oMessage.DISPLAY('%msgBadAcctNo')
		         THISFORM.swrptlook1.txtEndName.VALUE = 'Invalid Account Number'
		         THISFORM.swrptlook1.txtEndName.REFRESH()
		         RETURN 0
		      ELSE
		         THISFORM.swrptlook1.txtEndName.VALUE = cAcctDesc
		         THISFORM.swrptlook1.txtEndName.REFRESH()
		      ENDIF
		ENDCASE
		
	ENDPROC

	PROCEDURE txtcPeriod.Valid
		this.value = PADL(ALLTRIM(this.value),2,'0')
		this.refresh()
	ENDPROC

	PROCEDURE txtcPeriod.When
		RETURN thisform.optSelect.value = 1
	ENDPROC

	PROCEDURE txtcYear.When
		RETURN thisform.optSelect.value = 1
	ENDPROC

ENDDEFINE
