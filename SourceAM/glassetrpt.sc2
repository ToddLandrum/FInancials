*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="glassetrpt.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	InitialSelectedAlias = "units"
	Left = -25
	Name = "Dataenvironment"
	Top = 448
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "assets", ;
		CursorSource = "assets", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 38, ;
		Name = "Cursor1", ;
		Order = "", ;
		Top = 11, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formasunitlist AS frmrptcriteria OF "appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="opgSort" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegDesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndDesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSortBy" UniqueID="" Timestamp="" />

	Caption = "Fixed Asset Listing"
	DataSession = 2
	DoCreate = .T.
	Height = 275
	HelpContextID = 586
	Name = "FormAsunitlist"
	Width = 375
	Swrptcriteriabuttons1.chkSendFile.Alignment = 0
	Swrptcriteriabuttons1.chkSendFile.Name = "chkSendFile"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 70
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 8
	Swrptcriteriabuttons1.Top = 216
	Swrptcriteriabuttons1.ZOrderSet = 0

	ADD OBJECT 'lblBegDesc' AS lblfieldlabelcustom WITH ;
		Caption = " ", ;
		Height = 16, ;
		Left = 120, ;
		Name = "lblBegDesc", ;
		TabIndex = 2, ;
		Top = 100, ;
		Width = 5, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblBegID' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Beginning ID:", ;
		Height = 16, ;
		Left = 33, ;
		Name = "lblBegID", ;
		TabIndex = 6, ;
		Top = 89, ;
		Width = 64, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndDesc' AS lblfieldlabelcustom WITH ;
		Caption = " ", ;
		Height = 16, ;
		Left = 119, ;
		Name = "lblEndDesc", ;
		TabIndex = 3, ;
		Top = 161, ;
		Width = 5, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndID' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Ending ID:", ;
		Height = 16, ;
		Left = 48, ;
		Name = "lblEndID", ;
		TabIndex = 5, ;
		Top = 140, ;
		Width = 49, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSortBy' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Sort By:", ;
		Height = 16, ;
		Left = 56, ;
		Name = "lblSortBy", ;
		TabIndex = 7, ;
		Top = 18, ;
		Width = 41, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgSort' AS opgoptiongroupcustom WITH ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 48, ;
		Left = 118, ;
		Name = "opgSort", ;
		TabIndex = 1, ;
		Top = 12, ;
		Width = 84, ;
		ZOrderSet = 1, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Asset No", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "optUnitNum", ;
		Option1.Top = 5, ;
		Option1.Width = 63, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Asset Type", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "optUnitType", ;
		Option2.Top = 29, ;
		Option2.Width = 74
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 125, ;
		Name = "Swrptlook1", ;
		TabIndex = 4, ;
		Top = 86, ;
		ZOrderSet = 4, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = assets.cunitno, ;
		txtBegID.clistworkarea = assets, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = assets.cunitno, ;
		txtEndID.clistworkarea = assets, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />
	
	PROCEDURE builddata
		LOCAL lBegID, lEndID, lSort
		
		lBegID = ALLTRIM(THISFORM.swrptlook1.txtBegID.VALUE)
		lEndID = ALLTRIM(THISFORM.swrptlook1.txtEndID.VALUE)
		lSort = THISFORM.opgSort.VALUE
		
		IF lSort = 1  &&  Sort by Unit Number
		   SELECT cUnitno,  ;
		      cUnitDesc,  ;
		      duadate,  ;
		      nucost,  ;
		      nuadepr,  ;
		      ' ' AS temp ;
		      FROM assets  ;
		      WHERE BETWEEN(assets.cUnitNo,lBegID,lEndID)  ;
		      INTO CURSOR tmpasset  ;
		      ORDER BY cUnitNo
		
		   THISFORM.cselectcriteria = 'Asset ' + lBegID + ' - ' + lEndID
		   THISFORM.csortorder = 'Asset No'
		   THISFORM.ctitle1 = ''
		   THISFORM.ctitle2 = ''
		   THISFORM.creportname = 'falist1'
		
		ELSE  &&  Sort by Unit Type
		   SELECT cUnitno,  ;
		      IIF(nUnitType = 1, 'Autos and Trucks', IIF(nUnitType = 2, 'Building', IIF(nUnitType = 3,  ;
		      'Field Equipment', IIF(nUnitType = 4, 'Heavy Equipment', IIF(nUnitType = 5, 'Office Equipment',  ;
		      IIF(nUnitType = 6, 'Real Estate','Tangible Well Equipment')))))) + '                 ' AS nUnitType,  ;
		      cUnitDesc,  ;
		      duadate,  ;
		      nucost,  ;
		      nuadepr  ;
		      FROM assets  ;
		      WHERE BETWEEN(assets.cUnitNo,lBegID,lEndID)  ;
		      INTO CURSOR tmpasset  ;
		      ORDER BY nUnitType,cUnitNo
		
		   THISFORM.cselectcriteria = 'Asset ' + lBegID + ' - ' + lEndID + ' by Asset Type'
		   THISFORM.csortorder = 'Asset Type, Asset No'
		   THISFORM.ctitle1 = ''
		   THISFORM.ctitle2 = ''
		   THISFORM.creportname = 'falist2'
		
		ENDIF
		
		IF _TALLY = 0
		   RETURN .F.
		ELSE
		   RETURN .T.
		ENDIF
		
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		
		SELE assets
		SET ORDER TO unitno
		
		GO TOP
		THISFORM.swrptlook1.txtBegName.VALUE = assets.cunitdesc
		THISFORM.swrptlook1.txtBegID.VALUE = assets.cunitno
		
		GO BOTTOM
		THISFORM.swrptlook1.txtEndName.VALUE = assets.cunitdesc
		THISFORM.swrptlook1.txtEndID.VALUE = assets.cunitno
		
		THISFORM.opgSort.optUnitNum.VALUE = 1
		
		
		
	ENDPROC

	PROCEDURE opgSort.optUnitNum.GotFocus
		THISFORM.opgSort.VALUE = 1
		
	ENDPROC

	PROCEDURE opgSort.optUnitType.GotFocus
		THISFORM.opgSort.VALUE = 2
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cunitno/Unitno,cunitdesc'
		
		DO FORM ..\CUSTOM\picklist WITH 'Assets', lcList, THISFORM.swrptlook1.txtbegid.VALUE, 2
		
		IF llOK
		   THISFORM.swrptlook1.txtbegid.VALUE = assets.cunitno
		   THISFORM.swrptlook1.txtbegname.VALUE = assets.cunitdesc
		   THISFORM.REFRESH()
		ENDIF
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cunitno/unitno,cunitdesc'
		
		DO FORM ..\custom\picklist WITH 'Assets', lcList, thisform.swrptlook1.txtEndid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtEndid.value = assets.cunitno
		   thisform.swrptlook1.txtEndname.value = assets.cunitdesc
		   thisform.refresh()
		ENDIF   
	ENDPROC

ENDDEFINE
