*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="glactdept.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 619
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 981

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "coa", ;
		BufferModeOverride = 5, ;
		CursorSource = "coa", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 9, ;
		Name = "Cursor1", ;
		Top = 16, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "emps", ;
		CursorSource = "emps", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 258, ;
		Name = "Cursor10", ;
		Top = 263, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "coabal", ;
		CursorSource = "coabal", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 333, ;
		Name = "Cursor2", ;
		Top = 126, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "glmaster", ;
		CursorSource = "glmaster", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Filter = "", ;
		Height = 90, ;
		Left = 178, ;
		Name = "Cursor3", ;
		Top = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "checks", ;
		CursorSource = "checks", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Filter = "", ;
		Height = 90, ;
		Left = 329, ;
		Name = "Cursor4", ;
		Top = 7, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "custownvend", ;
		CursorSource = "custownvend", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 18, ;
		Name = "Cursor6", ;
		Top = 138, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "vendor", ;
		CursorSource = "vendor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "gldept", ;
		CursorSource = "gldept", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 145, ;
		Name = "Cursor8", ;
		Top = 263, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "custs", ;
		CursorSource = "custs", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 382, ;
		Name = "Cursor9", ;
		Top = 258, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formglactdept AS frmrptcriteria OF "appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shpshapecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shpshapecustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Glmaint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblToYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblfieldlabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblfieldlabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblToPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFromYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFromPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="optSelect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSubtotal" UniqueID="" Timestamp="" />

	Caption = "G/L Activity by Department"
	DataSession = 2
	DoCreate = .T.
	Height = 421
	HelpContextID = 411
	Name = "FormGlactDept"
	Visible = .T.
	Width = 375
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 70
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 17
	Swrptcriteriabuttons1.Top = 337

	ADD OBJECT 'chkSubtotal' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Subtotal by Account", ;
		Left = 129, ;
		Name = "chkSubtotal", ;
		TabIndex = 16, ;
		Top = 312
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Glmaint' AS glmaint WITH ;
		Left = 14, ;
		Name = "Glmaint", ;
		Top = 327
		*< END OBJECT: ClassLib="..\custom\swgl.vcx" BaseClass="custom" />

	ADD OBJECT 'Lblfieldlabelcustom1' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "To Dept ID", ;
		Height = 16, ;
		Left = 72, ;
		Name = "Lblfieldlabelcustom1", ;
		TabIndex = 15, ;
		Top = 248, ;
		Width = 51, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lblfieldlabelcustom2' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "From Dept ID", ;
		Height = 16, ;
		Left = 60, ;
		Name = "Lblfieldlabelcustom2", ;
		TabIndex = 14, ;
		Top = 197, ;
		Width = 63, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblFromPeriod' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Fiscal Period:", ;
		Height = 16, ;
		Left = 200, ;
		Name = "lblFromPeriod", ;
		TabIndex = 7, ;
		Top = 100, ;
		Width = 66, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblFromYear' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Fiscal Year:", ;
		Height = 16, ;
		Left = 25, ;
		Name = "lblFromYear", ;
		TabIndex = 6, ;
		Top = 100, ;
		Width = 60, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Print By", ;
		FontBold = .T., ;
		Left = 19, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 1, ;
		Top = 17, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Selection Criteria", ;
		FontBold = .T., ;
		Left = 19, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 3, ;
		Top = 78, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom3' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Department Range", ;
		FontBold = .T., ;
		Left = 19, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 12, ;
		Top = 173
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblToPeriod' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "To Fiscal Period:", ;
		Height = 16, ;
		Left = 200, ;
		Name = "lblToPeriod", ;
		TabIndex = 11, ;
		Top = 134, ;
		Visible = .F., ;
		Width = 81, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblToYear' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "To Fiscal Year:", ;
		Height = 16, ;
		Left = 25, ;
		Name = "lblToYear", ;
		TabIndex = 10, ;
		Top = 134, ;
		Visible = .F., ;
		Width = 75, ;
		ZOrderSet = 21
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'optSelect' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		ButtonCount = 3, ;
		Height = 36, ;
		Left = 13, ;
		Name = "optSelect", ;
		TabIndex = 2, ;
		Top = 24, ;
		Width = 348, ;
		ZOrderSet = 17, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Fiscal Period", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 13, ;
		Option1.Width = 79, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Fiscal Year", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 116, ;
		Option2.Name = "Option2", ;
		Option2.Top = 13, ;
		Option2.Width = 73, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "Fiscal Period Range", ;
		Option3.FontSize = 8, ;
		Option3.Height = 16, ;
		Option3.Left = 226, ;
		Option3.Name = "Option3", ;
		Option3.Top = 13, ;
		Option3.Width = 113
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Shpshapecustom1' AS shpshapecustom WITH ;
		Height = 120, ;
		Left = 13, ;
		Name = "Shpshapecustom1", ;
		Top = 180, ;
		Width = 348, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Shpshapecustom3' AS shpshapecustom WITH ;
		Height = 84, ;
		Left = 13, ;
		Name = "Shpshapecustom3", ;
		Top = 84, ;
		Width = 348, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 133, ;
		Name = "Swrptlook1", ;
		TabIndex = 13, ;
		Top = 192, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = gldept.cdeptno, ;
		txtBegID.clistworkarea = gldept, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = gldept.cdeptno, ;
		txtEndID.clistworkarea = gldept, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtPeriod' AS swperiod WITH ;
		Left = 312, ;
		Name = "txtPeriod", ;
		TabIndex = 5, ;
		Top = 98
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtPeriod2' AS swperiod WITH ;
		Left = 312, ;
		Name = "txtPeriod2", ;
		TabIndex = 9, ;
		Top = 132
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear' AS swyear WITH ;
		Left = 133, ;
		Name = "txtYear", ;
		TabIndex = 4, ;
		Top = 98
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear2' AS swyear WITH ;
		Left = 133, ;
		Name = "txtYear2", ;
		TabIndex = 8, ;
		Top = 132
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcYear, lcPeriod, lcDept1, lcDept2, lnSort, lcYear2, lcPeriod2, lcCurFY
		LOCAL lnSelect
		
		IF THISFORM.chkSubtotal.VALUE = .F.
		   THISFORM.cReportName = 'glact3'
		ELSE
		   THISFORM.cReportName = 'glact4'
		ENDIF
		
		lcYear      = THISFORM.txtYear.VALUE
		lcPeriod    = THISFORM.txtPeriod.VALUE
		lcDept1     = THISFORM.swrptlook1.txtBegID.VALUE
		lcDept2     = THISFORM.swrptlook1.txtEndID.VALUE
		lnSort      = THISFORM.optSelect.VALUE
		lcYear2     = THISFORM.txtYear2.VALUE
		lcPeriod2   = THISFORM.txtPeriod2.VALUE
		lnSelect    = THISFORM.optSelect.VALUE
		
		*
		*  Set the report title
		*
		DO CASE
		   CASE THISFORM.optSelect.VALUE = 1
		      THISFORM.cTitle1 = 'For Fiscal Period: ' + THISFORM.txtPeriod.VALUE +'/'+ THISFORM.txtYear.VALUE
		   CASE THISFORM.optSelect.VALUE = 2
		      THISFORM.cTitle1 = 'For Fiscal Year: ' + THISFORM.txtYear.VALUE
		   CASE THISFORM.optSelect.VALUE = 3
		      THISFORM.cTitle1 = 'For Period Range: ' + THISFORM.txtPeriod.VALUE +'/'+ THISFORM.txtYear.VALUE + ' - ' + ;
		         THISFORM.txtPeriod2.VALUE +'/'+ THISFORM.txtYear2.VALUE
		ENDCASE
		
		   WAIT WIND NOWAIT 'Calculating Account Balances...'
		   THISFORM.glmaint.calcbalance()
		   WAIT CLEAR 
		
		*
		*  Set Selection and Sort Criteria
		*
		THISFORM.cSelectCriteria = 'Departments: ' + alltrim(THISFORM.swrptlook1.txtBegID.VALUE) + ' - ' + THISFORM.swrptlook1.txtEndID.VALUE
		THISFORM.cSortOrder      = 'Dept ID, Account Number'
		THISFORM.cTitle1         = 'by Department'
		THISFORM.cTitle2         = ' '
		
		CREATE CURSOR temprpt ;
		   (cunitno    C(10), ;
		   cdeptno    C(10), ;
		   cdeptdesc  C(30), ;
		   cacctno    C(60), ;
		   cacctdesc  C(30), ;
		   cbatch     C(10), ;
		   cid        C(10), ;
		   cname      C(40), ;
		   ddate      D, ;
		   csource    C(2),  ;
		   cdesc      C(40), ;
		   ndebits    N(12,2), ;
		   ncredits   N(12,2))
		
		INDEX ON cdeptno+cacctno TAG cdeptno
		
		DO CASE
		   CASE lnSelect = 1
		      SELECT glmaster.cunitno, ;
		         glmaster.cdeptno,  ;
		         gldept.cdeptdesc, ;
		         glmaster.cacctno, ;
		         glmaster.cid, ;
		         glmaster.csource,  ;
		         glmaster.cbatch,  ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         glmaster.ndebits, ;
		         glmaster.ncredits  ;
		         FROM glmaster, gldept, coa ;
		         WHERE BETWEEN(glmaster.cdeptno,lcDept1,lcDept2) ;
		         AND glmaster.cdeptno = gldept.cdeptno ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND glmaster.cYear+glmaster.cPeriod = lcYear+lcPeriod ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cdeptno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma ;
		         GROUP BY glmaster.cdeptno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma
		
		   CASE lnSelect = 2
		      SELECT glmaster.cunitno, ;
		         glmaster.cdeptno,  ;
		         gldept.cdeptdesc, ;
		         glmaster.cacctno, ;
		         glmaster.cid, ;
		         glmaster.csource,  ;
		         glmaster.cbatch,  ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         glmaster.ndebits, ;
		         glmaster.ncredits  ;
		         FROM glmaster, gldept, coa ;
		         WHERE BETWEEN(glmaster.cdeptno,lcDept1,lcDept2) ;
		         AND glmaster.cdeptno = gldept.cdeptno ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND glmaster.cYear = lcYear ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cdeptno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma ;
		         GROUP BY glmaster.cdeptno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma
		
		   CASE lnSelect = 3
		      SELECT glmaster.cunitno, ;
		         glmaster.cDeptno, ;
		         gldept.cDeptDesc,  ;
		         glmaster.cacctno, ;
		         glmaster.cid, ;
		         glmaster.csource,  ;
		         glmaster.cbatch,  ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         glmaster.ndebits, ;
		         glmaster.ncredits  ;
		         FROM glmaster, gldept, coa ;
		         WHERE BETWEEN(glmaster.cdeptno,lcDept1,lcDept2) ;
		         AND glmaster.cdeptno = gldept.cDeptNo ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND BETWEEN(glmaster.cYear+glmaster.cPeriod, lcYear+lcPeriod, lcYear2+lcPeriod2) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cdeptno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma ;
		         GROUP BY glmaster.cdeptno, glmaster.cacctno, glmaster.ddate, glmaster.cidglma
		ENDCASE
		
		lnCount = _TALLY
		
		IF lnCount = 0
		   RETURN .F.
		ENDIF
		
		SELECT temprpt
		APPEND FROM DBF('temprptx')
		
		SELECT temprpt
		SCAN FOR NOT EMPTY(cid)
		   SCATTER MEMVAR
		   SELECT vendor
		   SET ORDER TO cvendorid
		   IF SEEK(m.cid)
		      m.cName = cvendname
		   ELSE
		      SELECT investor
		      SET ORDER TO cownerid
		      IF SEEK(m.cid)
		         m.cName = cownname
		      ELSE
		         SELECT custs
		         SET ORDER TO ccustid
		         IF SEEK(m.cid)
		            m.cName = cCustName
		         ELSE
		            SELECT emps
		            SET ORDER TO cEmpID
		            IF SEEK(m.cid)
		               m.cName = ALLTRIM(cFirstName) + ' ' + ALLTRIM(cmidinit) + ' ' + ALLTRIM(cLastName)
		            ELSE
		               m.cName = ''
		            ENDIF
		         ENDIF
		      ENDIF
		   ENDIF
		   SELECT temprpt
		   REPL cName WITH m.cName
		ENDSCAN
		
		SELECT temprpt
		SET ORDER TO cdeptno
		
		IF RECC() > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF
		
		
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		THISFORM.txtYear2.VISIBLE = .F.
		THISFORM.txtPeriod2.VISIBLE = .F.
		THISFORM.lblToYear.VISIBLE = .F.
		THISFORM.lblToPeriod.VISIBLE = .F.
		thisform.chkSubtotal.value = .t.
		
		SELECT gldept
		SET ORDER TO cdeptno
		GO TOP
		THISFORM.swrptlook1.txtBegID.VALUE = cdeptno
		THISFORM.swrptlook1.txtBegName.VALUE = cdeptdesc
		GO BOTT
		THISFORM.swrptlook1.txtEndID.VALUE = cdeptno
		THISFORM.swrptlook1.txtEndName.VALUE = cdeptdesc
		
		THIS.optSelect.VALUE = 1
		
		thisform.txtyear.Value = GetFiscalYear(DATE())
		thisform.txtyear2.Value = GetFiscalYear(DATE())
		
		thisform.txtperiod.Value = GetFiscalPeriod(DATE())
		thisform.txtperiod2.Value = GetFiscalPeriod(DATE())
		
	ENDPROC

	PROCEDURE optSelect.Option1.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromPeriod.caption = 'Fiscal Period:'
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtPeriod.visible = .T.
		
	ENDPROC

	PROCEDURE optSelect.Option2.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
	ENDPROC

	PROCEDURE optSelect.Option3.Click
		thisform.lblFromYear.caption = 'From Fiscal Year:'
		thisform.lblFromPeriod.caption = 'From Fiscal Period:'
		thisform.lblToYear.caption = 'To Fiscal Year:'
		thisform.lblToPeriod.caption = 'To Fiscal Period:'
		thisform.txtPeriod.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtYear2.visible = .T.
		thisform.txtPeriod2.visible = .T.
		thisform.lblToYear.visible = .T.
		thisform.lblToPeriod.visible = .T.
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cdeptno\Dept No.,cdeptdesc\Description'
		DO FORM ..\custom\picklist WITH 'gldept', lcList, thisform.swrptlook1.txtBegId.value, 2, .f., .t.
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cdeptno
		   thisform.swrptlook1.txtBegName.value = cdeptdesc
		   thisform.swrptlook1.txtBegId.SetFocus()
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cdeptno\Dept. No.,cdeptdesc\Description'
		DO FORM ..\custom\picklist WITH 'gldept', lcList, thisform.swrptlook1.txtEndId.value, 2, .f., .t.
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cdeptno
		   thisform.swrptlook1.txtEndName.value = cdeptdesc
		   thisform.swrptlook1.txtEndId.SetFocus()
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
	ENDPROC

ENDDEFINE
