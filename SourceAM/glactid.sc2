*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="glactid.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 619
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 981

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "coa", ;
		BufferModeOverride = 5, ;
		CursorSource = "coa", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 9, ;
		Name = "Cursor1", ;
		Top = 16, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "coabal", ;
		CursorSource = "coabal", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 333, ;
		Name = "Cursor2", ;
		Top = 126, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "glmaster", ;
		CursorSource = "glmaster", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Filter = "", ;
		Height = 90, ;
		Left = 178, ;
		Name = "Cursor3", ;
		Top = 0, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "checks", ;
		CursorSource = "checks", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Filter = "", ;
		Height = 90, ;
		Left = 329, ;
		Name = "Cursor4", ;
		Top = 7, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "custownvend", ;
		CursorSource = "custownvend", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 151, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 18, ;
		Name = "Cursor6", ;
		Top = 138, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "vendor", ;
		CursorSource = "vendor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formglactid AS frmrptcriteria OF "appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="opgSortBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shpshapecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shpshapecustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Glmaint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblfieldlabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblfieldlabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFromYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblFromPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="optSelect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboAccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblToYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblToPeriod" UniqueID="" Timestamp="" />

	Caption = "G/L Activity by ID"
	DataSession = 2
	DoCreate = .T.
	Height = 451
	HelpContextID = 410
	Name = "FormGlactID"
	Visible = .T.
	Width = 381
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 60
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 19
	Swrptcriteriabuttons1.Top = 393
	Swrptcriteriabuttons1.ZOrderSet = 3

	ADD OBJECT 'cboAccount' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 20, ;
		Left = 96, ;
		Name = "cboAccount", ;
		TabIndex = 17, ;
		Top = 311, ;
		Width = 252, ;
		ZOrderSet = 19
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Glmaint' AS glmaint WITH ;
		Left = 14, ;
		Name = "Glmaint", ;
		Top = 408
		*< END OBJECT: ClassLib="..\custom\swgl.vcx" BaseClass="custom" />

	ADD OBJECT 'Lblfieldlabelcustom1' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "To ID", ;
		Height = 16, ;
		Left = 62, ;
		Name = "Lblfieldlabelcustom1", ;
		TabIndex = 16, ;
		Top = 248, ;
		Width = 26, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lblfieldlabelcustom2' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "From ID", ;
		Height = 16, ;
		Left = 50, ;
		Name = "Lblfieldlabelcustom2", ;
		TabIndex = 15, ;
		Top = 197, ;
		Width = 38, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblFromPeriod' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Fiscal Period:", ;
		Height = 16, ;
		Left = 199, ;
		Name = "lblFromPeriod", ;
		TabIndex = 8, ;
		Top = 100, ;
		Width = 66, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblFromYear' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Fiscal Year:", ;
		Height = 16, ;
		Left = 28, ;
		Name = "lblFromYear", ;
		TabIndex = 7, ;
		Top = 100, ;
		Width = 60, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Print By", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 2, ;
		Top = 17, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Selection Criteria", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 4, ;
		Top = 78, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom3' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "ID Range", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 13, ;
		Top = 173, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom4' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Sort By", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 1, ;
		Top = 360, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom5' AS lbllabelcustom WITH ;
		Caption = "Account", ;
		FontBold = .T., ;
		Left = 18, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 20, ;
		Top = 313, ;
		ZOrderSet = 21
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblToPeriod' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "To Fiscal Period:", ;
		Height = 16, ;
		Left = 199, ;
		Name = "lblToPeriod", ;
		TabIndex = 12, ;
		Top = 134, ;
		Visible = .F., ;
		Width = 81, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblToYear' AS lblfieldlabelcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "To Fiscal Year:", ;
		Height = 16, ;
		Left = 13, ;
		Name = "lblToYear", ;
		TabIndex = 11, ;
		Top = 134, ;
		Visible = .F., ;
		Width = 75, ;
		ZOrderSet = 20
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgSortBy' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		ButtonCount = 2, ;
		Height = 36, ;
		Left = 7, ;
		Name = "opgSortBy", ;
		TabIndex = 18, ;
		Top = 347, ;
		Width = 353, ;
		ZOrderSet = 0, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "ID Code", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 75, ;
		Option1.Name = "Option1", ;
		Option1.Top = 13, ;
		Option1.Width = 55, ;
		Option2.Alignment = 0, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = " Account Number", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 175, ;
		Option2.Name = "Option2", ;
		Option2.Top = 13, ;
		Option2.Width = 102
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'optSelect' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		ButtonCount = 4, ;
		Height = 36, ;
		Left = 7, ;
		Name = "optSelect", ;
		TabIndex = 3, ;
		Top = 24, ;
		Width = 353, ;
		ZOrderSet = 16, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Fiscal Period", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 3, ;
		Option1.Name = "Option1", ;
		Option1.Top = 12, ;
		Option1.Width = 79, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Fiscal Year", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 87, ;
		Option2.Name = "Option2", ;
		Option2.Top = 12, ;
		Option2.Width = 73, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "Fiscal Period Range", ;
		Option3.FontSize = 8, ;
		Option3.Height = 16, ;
		Option3.Left = 159, ;
		Option3.Name = "Option3", ;
		Option3.Top = 12, ;
		Option3.Width = 113, ;
		Option4.AutoSize = .T., ;
		Option4.Caption = "Prod Period", ;
		Option4.FontSize = 8, ;
		Option4.Height = 16, ;
		Option4.Left = 274, ;
		Option4.Name = "Option4", ;
		Option4.Top = 12, ;
		Option4.Width = 73
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Shpshapecustom1' AS shpshapecustom WITH ;
		Height = 120, ;
		Left = 7, ;
		Name = "Shpshapecustom1", ;
		Top = 180, ;
		Width = 353, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Shpshapecustom3' AS shpshapecustom WITH ;
		Height = 84, ;
		Left = 7, ;
		Name = "Shpshapecustom3", ;
		Top = 84, ;
		Width = 353, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Height = 93, ;
		Left = 96, ;
		Name = "Swrptlook1", ;
		TabIndex = 14, ;
		Top = 192, ;
		Width = 252, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = custownvend.cid, ;
		txtBegID.clistworkarea = custownvend, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Height = 20, ;
		TxtBegName.Left = 0, ;
		TxtBegName.Name = "TxtBegName", ;
		TxtBegName.Top = 22, ;
		TxtBegName.Width = 246, ;
		txtEndID.clistexpression = custownvend.cid, ;
		txtEndID.clistworkarea = custownvend, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Height = 20, ;
		TxtEndName.Left = 0, ;
		TxtEndName.Name = "TxtEndName", ;
		TxtEndName.Top = 73, ;
		TxtEndName.Width = 246
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtPeriod' AS swperiod WITH ;
		Left = 311, ;
		Name = "txtPeriod", ;
		TabIndex = 6, ;
		Top = 98, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtPeriod2' AS swperiod WITH ;
		Left = 311, ;
		Name = "txtPeriod2", ;
		TabIndex = 10, ;
		Top = 132, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear' AS swyear WITH ;
		Left = 132, ;
		Name = "txtYear", ;
		TabIndex = 5, ;
		Top = 98, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear2' AS swyear WITH ;
		Left = 132, ;
		Name = "txtYear2", ;
		TabIndex = 9, ;
		Top = 132, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcYear, lcPeriod, lcWell1, lcWell2, lnSort, lcYear2, lcPeriod2, lcCurFY
		LOCAL lnSelect
		
		WAIT WIND NOWAIT 'Processing Data, Please Wait...'
		
		lcYear      = THISFORM.txtYear.VALUE
		lcPeriod    = THISFORM.txtPeriod.VALUE
		lcWell1     = THISFORM.swrptlook1.txtBegID.VALUE
		lcWell2     = THISFORM.swrptlook1.txtEndID.VALUE
		lnSort      = THISFORM.opgSortBy.VALUE
		lcYear2     = THISFORM.txtYear2.VALUE
		lcPeriod2   = THISFORM.txtPeriod2.VALUE
		lnSelect    = THISFORM.optSelect.VALUE
		lcAccount   = THISFORM.cboAccount.VALUE
		
		*
		*  Set the report title
		*
		DO CASE
		   CASE THISFORM.optSelect.VALUE = 1
		      THISFORM.cTitle1 = 'For Fiscal Period: ' + THISFORM.txtPeriod.VALUE +'/'+ THISFORM.txtYear.VALUE
		   CASE THISFORM.optSelect.VALUE = 2
		      THISFORM.cTitle1 = 'For Fiscal Year: ' + THISFORM.txtYear.VALUE
		   CASE THISFORM.optSelect.VALUE = 3
		      THISFORM.cTitle1 = 'For Period Range: ' + THISFORM.txtPeriod.VALUE +'/'+ THISFORM.txtYear.VALUE + ' - ' + ;
		         THISFORM.txtPeriod2.VALUE +'/'+ THISFORM.txtYear2.VALUE
		   CASE THISFORM.optSelect.VALUE = 4
		      THISFORM.cTitle1 = 'For Production Period: ' + lcYear + '/'+lcPeriod
		ENDCASE
		
		*
		*  Set Selection and Sort Criteria
		*
		THISFORM.cSelectCriteria = 'IDs: ' + allt(THISFORM.swrptlook1.txtBegID.VALUE) + ' - ' + THISFORM.swrptlook1.txtEndID.VALUE
		IF lnSort = 1
		   THISFORM.cSortOrder      = 'ID, Account Number'
		ELSE
		   THISFORM.cSortOrder      = 'Account Number, ID'
		   THISFORM.cReportName     = 'glact6'
		ENDIF
		
		THISFORM.cTitle2         = ' '
		
		select * from custownvend group by cid into cursor custownvend1
		
		CREATE CURSOR temprpt ;
		   (cid    C(10), ;
		   cname  C(30), ;
		   cacctno    C(60), ;
		   cacctdesc  C(30), ;
		   cunitno        C(10), ;
		   cwellname     C(40), ;
		   ddate      D, ;
		   cdesc      C(40), ;
		   namount    N(12,2))
		INDEX ON cid+cacctno TAG cid
		INDEX ON cacctno+cid TAG acct
		
		DO CASE
		   CASE lnSelect = 1  &&  Fiscal Period
		      SELECT glmaster.cid, ;
		         custownvend1.cname, ;
		         glmaster.cacctno, ;
		         glmaster.cunitno,  ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, coa, custownvend1 ;
		         WHERE BETWEEN(glmaster.cid,lcWell1,lcWell2) ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND glmaster.cid = custownvend1.cid  ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND NOT EMPTY(glmaster.cid)  ;
		         AND glmaster.cYear+glmaster.cPeriod = lcYear+lcPeriod ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma ;
		         GROUP BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma
		
		   CASE lnSelect = 2  &&  Fiscal Year
		      SELECT glmaster.cid, ;
		         custownvend1.cname, ;
		         glmaster.cacctno, ;
		         glmaster.cunitno,  ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, coa, custownvend1 ;
		         WHERE BETWEEN(glmaster.cid,lcWell1,lcWell2) ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND glmaster.cid = custownvend1.cid  ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND NOT EMPTY(glmaster.cid)  ;
		         AND glmaster.cYear = lcYear ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma ;
		         GROUP BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma
		
		   CASE lnSelect = 3  &&  Period Range
		      SELECT glmaster.cid, ;
		         custownvend1.cname, ;
		         glmaster.cacctno, ;
		         glmaster.cunitno,  ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, coa, custownvend1 ;
		         WHERE BETWEEN(glmaster.cid,lcWell1,lcWell2) ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND glmaster.cid = custownvend1.cid  ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND NOT EMPTY(glmaster.cid)  ;
		         AND BETWEEN(glmaster.cYear+glmaster.cPeriod, lcYear+lcPeriod, lcYear2+lcPeriod2) ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma ;
		         GROUP BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma
		
		   CASE lnSelect = 4  &&  Prod Period
		      SELECT glmaster.cid, ;
		         custownvend1.cname, ;
		         glmaster.cacctno, ;
		         glmaster.cunitno,  ;
		         coa.cacctdesc, ;
		         glmaster.ddate, ;
		         glmaster.cdesc, ;
		         SUM(ndebits-nCredits) AS namount ;
		         FROM glmaster, coa, custownvend1 ;
		         WHERE BETWEEN(glmaster.cid,lcWell1,lcWell2) ;
		         AND glmaster.cacctno = coa.cacctno ;
		         AND glmaster.cid = custownvend1.cid  ;
		         AND NOT EMPTY(glmaster.cid)  ;
		         AND NOT EMPTY(glmaster.cacctno) ;
		         AND glmaster.cProdYr+glmaster.cProdPrd = lcYear+lcPeriod ;
		         AND (IIF(lcAccount='******',.T.,glmaster.cacctno=lcAccount)) ;
		         INTO CURSOR temprptx ;
		         ORDER BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma ;
		         GROUP BY glmaster.cid, glmaster.cacctno, glmaster.ddate, cunitno, glmaster.cidglma
		
		ENDCASE
		
		lnCount = _TALLY
		
		IF lnCount = 0
		   RETURN .F.
		ENDIF
		
		SELECT temprpt
		APPEND FROM DBF('temprptx')
		
		SELECT temprpt
		SCAN FOR NOT EMPTY(cunitno)
		   SCATTER MEMVAR
		   SELECT wells
		   SET ORDER TO cwellid
		   IF SEEK(m.cunitno)
		      m.cwellname = cwellname
		   ENDIF
		   SELECT temprpt
		   REPL cwellname WITH m.cwellname
		ENDSCAN
		
		SELECT temprpt
		IF lnSort = 1
		   SET ORDER TO cid
		ELSE
		   SET ORDER TO acct
		ENDIF
		
		WAIT CLEAR
		
		IF RECC() > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF
		
		
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		set deleted on
		
		thisform.cReportName = 'glact7'
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		
		SELECT custownvend
		SET SAFETY OFF
		INDEX ON cid TAG cid
		INDEX ON cname TAG cname
		INDEX ON ctype TAG ctype
		
		SET ORDER TO cid
		GO TOP
		thisform.swrptlook1.txtBegID.value = cid
		thisform.swrptlook1.txtBegName.value = cname
		GO BOTT
		thisform.swrptlook1.txtEndID.value = cid
		thisform.swrptlook1.txtEndName.value = cname
		
		this.optSelect.value = 1
		this.opgSortBy.value = 1
		
		thisform.txtyear.Value = GetFiscalYear(DATE())
		thisform.txtyear2.Value = GetFiscalYear(DATE())
		
		thisform.txtperiod.Value = GetFiscalPeriod(DATE())
		thisform.txtperiod2.Value = GetFiscalPeriod(DATE())
		
		
		
	ENDPROC

	PROCEDURE cboAccount.Init
		sele cacctno, cacctdesc from coa into array lacoa order by cacctno
		lnCount = _tally
		
		if lnCount > 0
		  this.addlistitem('ALL ACCOUNTS',1,1)
		  this.addlistitem('******',1,2)
		  
		  for lnx = 1 to lnCount
		  
		     this.addlistitem(lacoa[lnx,1]+'-'+allt(lacoa[lnx,2]),lnx+1,1)
		     this.addlistitem(lacoa[lnx,1],lnx+1,2)
		  endfor   
		  
		  this.listitemid = 1
		endif  
		
		dodefault()
	ENDPROC

	PROCEDURE opgSortBy.Option1.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromPeriod.caption = 'Fiscal Period:'
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtPeriod.visible = .T.
		
	ENDPROC

	PROCEDURE opgSortBy.Option2.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
	ENDPROC

	PROCEDURE optSelect.Option1.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromPeriod.caption = 'Fiscal Period:'
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtPeriod.visible = .T.
		
	ENDPROC

	PROCEDURE optSelect.Option2.Click
		thisform.lblFromYear.caption = 'Fiscal Year:'
		thisform.lblFromYear.visible = .T.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
		thisform.txtYear2.visible = .F.
		thisform.txtPeriod2.visible = .F.
		thisform.lblToYear.visible = .F.
		thisform.lblToPeriod.visible = .F.
		thisform.lblFromPeriod.visible = .F.
		thisform.txtPeriod.visible = .F.
	ENDPROC

	PROCEDURE optSelect.Option3.Click
		thisform.lblFromYear.caption = 'From Fiscal Year:'
		thisform.lblFromPeriod.caption = 'From Fiscal Period:'
		thisform.lblToYear.caption = 'To Fiscal Year:'
		thisform.lblToPeriod.caption = 'To Fiscal Period:'
		thisform.txtPeriod.visible = .T.
		thisform.lblFromPeriod.visible = .T.
		thisform.txtYear2.visible = .T.
		thisform.txtPeriod2.visible = .T.
		thisform.lblToYear.visible = .T.
		thisform.lblToPeriod.visible = .T.
	ENDPROC

	PROCEDURE optSelect.Valid
		DO CASE
		   CASE this.value = 1
		      thisform.lblfromyear.caption = 'Fiscal Year:'
		      thisform.lblfromperiod.caption = 'Fiscal Period:'
		   CASE this.value = 2
		      thisform.lblfromyear.caption = 'Fiscal Year:'
		      thisform.lblfromperiod.caption = 'Fiscal Period:'   
		   CASE this.value = 3
		      thisform.lblfromyear.caption = 'Fiscal Year:'
		      thisform.lblfromperiod.caption = 'Fiscal Period:'   
		   CASE this.value = 4
		      thisform.lblfromyear.caption = 'Prod Year:'
		      thisform.lblfromperiod.caption = 'Prod Period:'   
		ENDCASE      
		      
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cid\ID,cname\Name,ctype\Type'
		
		SELECT custownvend
		SET SAFETY OFF
		INDEX ON cid TAG cid
		INDEX ON cname TAG cname
		INDEX ON ctype TAG ctype
		
		DO FORM ..\custom\picklist WITH 'custownvend', lcList, thisform.swrptlook1.txtBegId.value, 3,.f.,.t.
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cid
		   thisform.swrptlook1.txtBegName.value = cname
		   thisform.swrptlook1.txtBegId.SetFocus()
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cid\ID,cname\Name,ctype\Type'
		
		SELECT custownvend
		SET SAFETY OFF
		INDEX ON cid TAG cid
		INDEX ON cname TAG cname
		INDEX ON ctype TAG ctype
		
		DO FORM ..\custom\picklist WITH 'custownvend', lcList, thisform.swrptlook1.txtEndId.value, 3,.f.,.t.
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cid
		   thisform.swrptlook1.txtEndName.value = cname
		   thisform.swrptlook1.txtEndId.SetFocus()
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
	ENDPROC

ENDDEFINE
