*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="lmlandinfo.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\source\appdefs.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 346
	Left = 37
	Name = "Dataenvironment"
	Top = 375
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "landowner", ;
		CursorSource = "landowner", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "land", ;
		CursorSource = "land", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "land1", ;
		CursorSource = "land", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 160, ;
		Name = "Cursor4", ;
		Top = 155, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Relation1' AS relation WITH ;
		ChildAlias = "landowner", ;
		ChildOrder = "cleaseid", ;
		Name = "Relation1", ;
		ParentAlias = "land", ;
		RelationalExpr = "cleaseid"
		*< END OBJECT: BaseClass="relation" />

ENDDEFINE

DEFINE CLASS formdmland AS frmdatamanagerformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Pageframe1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Shpshapecustom8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Shpshapecustom7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Shpshapecustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Shpshapecustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Shpshapecustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Shpshapecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtCleaseid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCleaseid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtCleasename" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCleasename" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtCprospect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCprospect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtMlegaldesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblMlegaldesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtCcounty" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtConsolref" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCcounty" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lblfieldlabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtCstate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCstate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtcFormation" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtNgrossacres" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lblfieldlabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblNgrossacres" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtNnetacres" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblNnetacres" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblExpires" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lblfieldlabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtNleaseyears" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblNleaseyears" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtNleasemonths" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblNleasemonths" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblDleasedate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCleasestatus" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.edtMcomments" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblMcomments" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtCrecbook" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCrecbook" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblDrecdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtCrecpage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtcInstrument" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtrrcdistno" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtcrrcleaseno" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtcComingle" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblCrecpage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lbllabelcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.cboLeaseStatus" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lbllabelcustom6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtTownship" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lbllabelcustom7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtAgent" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.chkAmended" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtdleasedate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtdrecdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtdConsolDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtdExpires" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.Cmdcommandbuttoncustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.Cmdcommandbuttoncustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.lstDocuments" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.Cmdcommandbuttoncustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page2.cmdTreeno" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: viewdocument		&& Brings up the viewer for the given document
		*p: cleasename
	*</DefinedPropArrayMethod>

	Caption = "Lease Information"
	cleasename = 
	clistexpression = land.cleaseid
	cworkarea = Land
	DoCreate = .T.
	Height = 507
	HelpContextID = 362
	Name = "FormDmland"
	Width = 652
	cmdatamanager.Name = "cmdatamanager"
	cmdatamanager.TabIndex = 1
	cmlookupmanager.Left = 1
	cmlookupmanager.Name = "cmlookupmanager"
	cmlookupmanager.Top = 29
	Mwresize1.lblHighLight.Name = "lblHighLight"
	Mwresize1.lblShading.Name = "lblShading"
	Mwresize1.Name = "Mwresize1"

	ADD OBJECT 'Pageframe1' AS pageframe WITH ;
		ErasePage = .T., ;
		Height = 492, ;
		Left = 12, ;
		Name = "Pageframe1", ;
		PageCount = 2, ;
		Top = 12, ;
		Width = 636, ;
		Page1.Caption = "Lease Info", ;
		Page1.Name = "Page1", ;
		Page2.Caption = "Documents", ;
		Page2.Name = "Page2"
		*< END OBJECT: BaseClass="pageframe" />

	ADD OBJECT 'Pageframe1.Page1.cboLeaseStatus' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "land.cleasestatus", ;
		Height = 20, ;
		Left = 95, ;
		lrequired = .T., ;
		Margin = 2, ;
		Name = "cboLeaseStatus", ;
		RowSourceType = 0, ;
		TabIndex = 19, ;
		Top = 165, ;
		Width = 155, ;
		ZOrderSet = 49
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page1.chkAmended' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Amended", ;
		ControlSource = "land.lamended", ;
		Left = 281, ;
		Name = "chkAmended", ;
		TabIndex = 21, ;
		Top = 168
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pageframe1.Page1.edtMcomments' AS edteditboxcustom WITH ;
		ControlSource = "land.mcomments", ;
		Height = 50, ;
		Left = 108, ;
		Name = "edtMcomments", ;
		TabIndex = 50, ;
		Top = 394, ;
		Width = 510, ;
		ZOrderSet = 37
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.edtMlegaldesc' AS edteditboxcustom WITH ;
		ControlSource = "land.mlegaldesc", ;
		Height = 50, ;
		Left = 108, ;
		Name = "edtMlegaldesc", ;
		TabIndex = 48, ;
		Top = 329, ;
		Width = 510, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pageframe1.Page1.lblCcounty' AS lblfieldlabelcustom WITH ;
		Caption = "County", ;
		Height = 16, ;
		Left = 25, ;
		Name = "lblCcounty", ;
		TabIndex = 8, ;
		Top = 67, ;
		Width = 36, ;
		ZOrderSet = 19
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblCleaseid' AS lblfieldlabelcustom WITH ;
		Caption = "Lease ID", ;
		Height = 16, ;
		Left = 25, ;
		Name = "lblCleaseid", ;
		TabIndex = 2, ;
		Top = 16, ;
		Width = 44, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblCleasename' AS lblfieldlabelcustom WITH ;
		Caption = "Lease Name", ;
		Height = 16, ;
		Left = 25, ;
		Name = "lblCleasename", ;
		TabIndex = 6, ;
		Top = 41, ;
		Width = 62, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblCleasestatus' AS lblfieldlabelcustom WITH ;
		Caption = "Lease Status", ;
		Height = 16, ;
		Left = 25, ;
		Name = "lblCleasestatus", ;
		TabIndex = 34, ;
		Top = 167, ;
		Width = 66, ;
		ZOrderSet = 36
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblCprospect' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Prospect", ;
		Height = 16, ;
		Left = 191, ;
		Name = "lblCprospect", ;
		TabIndex = 5, ;
		Top = 16, ;
		Width = 45, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblCrecbook' AS lblfieldlabelcustom WITH ;
		Caption = "Book", ;
		Height = 16, ;
		Left = 475, ;
		Name = "lblCrecbook", ;
		TabIndex = 36, ;
		Top = 144, ;
		Width = 26, ;
		ZOrderSet = 40
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblCrecpage' AS lblfieldlabelcustom WITH ;
		Caption = "Page", ;
		Height = 16, ;
		Left = 475, ;
		Name = "lblCrecpage", ;
		TabIndex = 39, ;
		Top = 170, ;
		Width = 26, ;
		ZOrderSet = 44
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblCstate' AS lblfieldlabelcustom WITH ;
		Caption = "State", ;
		Height = 16, ;
		Left = 253, ;
		Name = "lblCstate", ;
		TabIndex = 12, ;
		Top = 67, ;
		Width = 27, ;
		ZOrderSet = 21
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblDleasedate' AS lblfieldlabelcustom WITH ;
		Caption = "Lease Date", ;
		Height = 16, ;
		Left = 431, ;
		Name = "lblDleasedate", ;
		TabIndex = 24, ;
		Top = 16, ;
		Width = 57, ;
		ZOrderSet = 27
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblDrecdate' AS lblfieldlabelcustom WITH ;
		Caption = "Recording Date", ;
		Height = 16, ;
		Left = 425, ;
		Name = "lblDrecdate", ;
		TabIndex = 35, ;
		Top = 118, ;
		Width = 76, ;
		ZOrderSet = 42
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblExpires' AS lblfieldlabelcustom WITH ;
		Caption = "Expires", ;
		Height = 16, ;
		Left = 431, ;
		Name = "lblExpires", ;
		TabIndex = 23, ;
		Top = 85, ;
		Width = 38, ;
		ZOrderSet = 27
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lblfieldlabelcustom1' AS lblfieldlabelcustom WITH ;
		Caption = "Consolidation Reference", ;
		Height = 16, ;
		Left = 29, ;
		Name = "Lblfieldlabelcustom1", ;
		TabIndex = 9, ;
		Top = 239, ;
		Width = 120, ;
		ZOrderSet = 19
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lblfieldlabelcustom2' AS lblfieldlabelcustom WITH ;
		Caption = "Consolidation Recorded", ;
		Height = 16, ;
		Left = 29, ;
		Name = "Lblfieldlabelcustom2", ;
		TabIndex = 20, ;
		Top = 267, ;
		Width = 116, ;
		ZOrderSet = 27
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lblfieldlabelcustom3' AS lblfieldlabelcustom WITH ;
		Caption = "Formation", ;
		Height = 16, ;
		Left = 25, ;
		Name = "Lblfieldlabelcustom3", ;
		TabIndex = 30, ;
		Top = 140, ;
		Width = 49, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "RRC Comingle", ;
		Left = 423, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 54, ;
		Top = 295
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lbllabelcustom3' AS lbllabelcustom WITH ;
		Caption = "Instrument No:", ;
		Left = 430, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 51, ;
		Top = 190
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lbllabelcustom4' AS lbllabelcustom WITH ;
		Caption = "RRC Lease No", ;
		Left = 422, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 52, ;
		Top = 249
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lbllabelcustom5' AS lbllabelcustom WITH ;
		Caption = "RRC District No", ;
		Left = 423, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 53, ;
		Top = 271
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lbllabelcustom6' AS lbllabelcustom WITH ;
		Caption = "Township", ;
		Left = 25, ;
		Name = "Lbllabelcustom6", ;
		TabIndex = 55, ;
		Top = 92
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Lbllabelcustom7' AS lbllabelcustom WITH ;
		Caption = "Agent", ;
		Left = 216, ;
		Name = "Lbllabelcustom7", ;
		TabIndex = 56, ;
		Top = 92
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblMcomments' AS lblfieldlabelcustom WITH ;
		Caption = "Comments", ;
		Height = 16, ;
		Left = 19, ;
		Name = "lblMcomments", ;
		TabIndex = 49, ;
		Top = 394, ;
		Width = 52, ;
		ZOrderSet = 38
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblMlegaldesc' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Legal Description", ;
		Height = 16, ;
		Left = 19, ;
		Name = "lblMlegaldesc", ;
		TabIndex = 47, ;
		Top = 329, ;
		Width = 85, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblNgrossacres' AS lblfieldlabelcustom WITH ;
		Caption = "Gross Acres", ;
		Height = 16, ;
		Left = 23, ;
		Name = "lblNgrossacres", ;
		TabIndex = 31, ;
		Top = 116, ;
		Width = 65, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblNleasemonths' AS lblfieldlabelcustom WITH ;
		Caption = "Lease Term (Mos)", ;
		Height = 16, ;
		Left = 431, ;
		Name = "lblNleasemonths", ;
		TabIndex = 27, ;
		Top = 62, ;
		Width = 90, ;
		ZOrderSet = 31
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblNleaseyears' AS lblfieldlabelcustom WITH ;
		Caption = "Lease Term (Yrs)", ;
		Height = 16, ;
		Left = 431, ;
		Name = "lblNleaseyears", ;
		TabIndex = 25, ;
		Top = 39, ;
		Width = 88, ;
		ZOrderSet = 29
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblNnetacres' AS lblfieldlabelcustom WITH ;
		Caption = "Net Acres", ;
		Height = 16, ;
		Left = 213, ;
		Name = "lblNnetacres", ;
		TabIndex = 32, ;
		Top = 116, ;
		Width = 51, ;
		ZOrderSet = 25
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Shpshapecustom1' AS shpshapecustom WITH ;
		Height = 104, ;
		Left = 419, ;
		Name = "Shpshapecustom1", ;
		Top = 4, ;
		Width = 204, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pageframe1.Page1.Shpshapecustom2' AS shpshapecustom WITH ;
		Height = 190, ;
		Left = 12, ;
		Name = "Shpshapecustom2", ;
		Top = 4, ;
		Width = 396, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pageframe1.Page1.Shpshapecustom4' AS shpshapecustom WITH ;
		Height = 134, ;
		Left = 419, ;
		Name = "Shpshapecustom4", ;
		Top = 108, ;
		Width = 204, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pageframe1.Page1.Shpshapecustom5' AS shpshapecustom WITH ;
		Height = 90, ;
		Left = 12, ;
		Name = "Shpshapecustom5", ;
		Top = 212, ;
		Width = 396, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pageframe1.Page1.Shpshapecustom7' AS shpshapecustom WITH ;
		Height = 73, ;
		Left = 12, ;
		Name = "Shpshapecustom7", ;
		Top = 382, ;
		Width = 612, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pageframe1.Page1.Shpshapecustom8' AS shpshapecustom WITH ;
		Height = 73, ;
		Left = 12, ;
		Name = "Shpshapecustom8", ;
		Top = 318, ;
		Width = 612, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pageframe1.Page1.txtAgent' AS txttextboxcustom WITH ;
		ControlSource = "land.cagent", ;
		Height = 20, ;
		Left = 268, ;
		Name = "txtAgent", ;
		TabIndex = 14, ;
		Top = 89, ;
		Width = 120
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtcComingle' AS txttextboxcustom WITH ;
		ControlSource = "land.ccomingle", ;
		Height = 20, ;
		Left = 506, ;
		Margin = 1, ;
		MaxLength = 20, ;
		Name = "txtcComingle", ;
		TabIndex = 46, ;
		Top = 293, ;
		Width = 114, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtCcounty' AS txttextboxcustom WITH ;
		ControlSource = "land.ccounty", ;
		Height = 20, ;
		Left = 95, ;
		Margin = 1, ;
		MaxLength = 20, ;
		Name = "txtCcounty", ;
		TabIndex = 10, ;
		Top = 64, ;
		Width = 148, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtcFormation' AS txttextboxcustom WITH ;
		ControlSource = "land.cformation", ;
		Height = 20, ;
		InputMask = "", ;
		Left = 95, ;
		Margin = 1, ;
		Name = "txtcFormation", ;
		TabIndex = 17, ;
		Top = 139, ;
		Width = 107, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtcInstrument' AS txttextboxcustom WITH ;
		ControlSource = "land.cinstrument", ;
		Height = 20, ;
		Left = 423, ;
		Margin = 1, ;
		MaxLength = 20, ;
		Name = "txtcInstrument", ;
		TabIndex = 41, ;
		Top = 207, ;
		Width = 192, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtCleaseid' AS txttextboxcustom WITH ;
		ControlSource = "land.cleaseid", ;
		Format = "!", ;
		Height = 20, ;
		HelpContextID = 80, ;
		InputMask = "", ;
		Left = 95, ;
		lrequired = .T., ;
		Margin = 1, ;
		MaxLength = 10, ;
		Name = "txtCleaseid", ;
		TabIndex = 3, ;
		Top = 14, ;
		Width = 78, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtCleasename' AS txttextboxcustom WITH ;
		ControlSource = "land.cleasename", ;
		Height = 20, ;
		Left = 95, ;
		lrequired = .T., ;
		Margin = 1, ;
		MaxLength = 40, ;
		Name = "txtCleasename", ;
		TabIndex = 7, ;
		Top = 39, ;
		Width = 294, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtConsolref' AS txttextboxcustom WITH ;
		ControlSource = "land.cconsolref", ;
		Height = 20, ;
		Left = 185, ;
		Margin = 1, ;
		MaxLength = 20, ;
		Name = "txtConsolref", ;
		TabIndex = 42, ;
		Top = 239, ;
		Width = 148, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtCprospect' AS txttextboxcustom WITH ;
		ControlSource = "land.cprospect", ;
		Height = 20, ;
		Left = 243, ;
		Margin = 1, ;
		MaxLength = 40, ;
		Name = "txtCprospect", ;
		TabIndex = 4, ;
		Top = 14, ;
		Width = 146, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtCrecbook' AS txttextboxcustom WITH ;
		ControlSource = "land.crecbook", ;
		Height = 20, ;
		Left = 509, ;
		Margin = 1, ;
		MaxLength = 10, ;
		Name = "txtCrecbook", ;
		TabIndex = 38, ;
		Top = 142, ;
		Width = 78, ;
		ZOrderSet = 39
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtCrecpage' AS txttextboxcustom WITH ;
		ControlSource = "land.crecpage", ;
		Height = 20, ;
		Left = 509, ;
		Margin = 1, ;
		MaxLength = 10, ;
		Name = "txtCrecpage", ;
		TabIndex = 40, ;
		Top = 168, ;
		Width = 78, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtcrrcleaseno' AS txttextboxcustom WITH ;
		ControlSource = "land.crrcleaseno", ;
		Height = 20, ;
		Left = 506, ;
		Margin = 1, ;
		MaxLength = 20, ;
		Name = "txtcrrcleaseno", ;
		TabIndex = 44, ;
		Top = 245, ;
		Width = 114, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtCstate' AS txttextboxcustom WITH ;
		ControlSource = "land.cstate", ;
		Format = "K!", ;
		Height = 20, ;
		InputMask = "AA", ;
		Left = 283, ;
		Margin = 1, ;
		MaxLength = 2, ;
		Name = "txtCstate", ;
		TabIndex = 11, ;
		Top = 64, ;
		Width = 25, ;
		ZOrderSet = 20
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtdConsolDate' AS dpk WITH ;
		ControlSource = "land.dconsoldate", ;
		Height = 20, ;
		Left = 185, ;
		lnocurrentdate = .T., ;
		Name = "txtdConsolDate", ;
		TabIndex = 43, ;
		Top = 265, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtdExpires' AS dpk WITH ;
		ControlSource = "land.dexpires", ;
		Height = 20, ;
		Left = 512, ;
		lnocurrentdate = .T., ;
		Name = "txtdExpires", ;
		TabIndex = 29, ;
		Top = 86, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtdleasedate' AS dpk WITH ;
		ControlSource = "land.dleasedate", ;
		Height = 20, ;
		Left = 512, ;
		lnocurrentdate = .T., ;
		Name = "txtdleasedate", ;
		TabIndex = 22, ;
		Top = 14, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtdrecdate' AS dpk WITH ;
		ControlSource = "land.drecdate", ;
		Height = 20, ;
		Left = 512, ;
		lnocurrentdate = .T., ;
		Name = "txtdrecdate", ;
		TabIndex = 37, ;
		Top = 116, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtNgrossacres' AS txttextboxcustom WITH ;
		ControlSource = "land.ngrossacre", ;
		Height = 20, ;
		InputMask = "9,999,999.9999", ;
		Left = 95, ;
		Margin = 1, ;
		Name = "txtNgrossacres", ;
		TabIndex = 15, ;
		Top = 114, ;
		Width = 107, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtNleasemonths' AS txttextboxcustom WITH ;
		ControlSource = "land.nleasemonths", ;
		Height = 20, ;
		InputMask = "9999", ;
		Left = 542, ;
		Margin = 1, ;
		Name = "txtNleasemonths", ;
		TabIndex = 28, ;
		Top = 60, ;
		Width = 45, ;
		ZOrderSet = 30
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtNleaseyears' AS txttextboxcustom WITH ;
		ControlSource = "land.nleaseyears", ;
		Height = 20, ;
		InputMask = "999", ;
		Left = 542, ;
		Margin = 1, ;
		Name = "txtNleaseyears", ;
		TabIndex = 26, ;
		Top = 37, ;
		Width = 45, ;
		ZOrderSet = 28
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtNnetacres' AS txttextboxcustom WITH ;
		ControlSource = "land.nnetacres", ;
		Height = 20, ;
		InputMask = "9,999,999.9999", ;
		Left = 268, ;
		Margin = 1, ;
		Name = "txtNnetacres", ;
		TabIndex = 16, ;
		Top = 114, ;
		Width = 120, ;
		ZOrderSet = 24
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtrrcdistno' AS txttextboxcustom WITH ;
		ControlSource = "land.crrcdistno", ;
		Height = 20, ;
		Left = 506, ;
		Margin = 1, ;
		MaxLength = 20, ;
		Name = "txtrrcdistno", ;
		TabIndex = 45, ;
		Top = 269, ;
		Width = 114, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtTownship' AS txttextboxcustom WITH ;
		ControlSource = "land.ctownship", ;
		Left = 95, ;
		Name = "txtTownship", ;
		TabIndex = 13, ;
		Top = 89
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page2.Cmdcommandbuttoncustom1' AS cmdcommandbuttoncustom WITH ;
		Caption = "Remove Doc", ;
		Height = 36, ;
		Left = 539, ;
		Name = "Cmdcommandbuttoncustom1", ;
		Top = 181, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pageframe1.Page2.Cmdcommandbuttoncustom2' AS cmdcommandbuttoncustom WITH ;
		Caption = "Link Doc", ;
		Height = 36, ;
		Left = 539, ;
		Name = "Cmdcommandbuttoncustom2", ;
		Top = 79, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pageframe1.Page2.Cmdcommandbuttoncustom3' AS cmdcommandbuttoncustom WITH ;
		Caption = "View Doc", ;
		Height = 36, ;
		Left = 539, ;
		Name = "Cmdcommandbuttoncustom3", ;
		Top = 127, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pageframe1.Page2.cmdTreeno' AS cmdcommandbuttoncustom WITH ;
		Caption = "Treeno", ;
		Height = 36, ;
		Left = 539, ;
		Name = "cmdTreeno", ;
		Top = 236, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pageframe1.Page2.lstDocuments' AS lstlistboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 400, ;
		Left = 23, ;
		Name = "lstDocuments", ;
		Top = 40, ;
		Width = 500
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="listbox" />
	
	PROCEDURE Init
		IF DODEFAULT()
		   * If we're in demo mode, tell the user that this is an optional module
		   IF m.goapp.ldemo
		      thisform.omessage.warning('The Land Management module is an optional module that can be purchased separately.' + ;
		                                ' It is included in the demo for evaluation purposes.')
		   ENDIF
		   
		   liDataSession = SET('datasession')
		   SET DATASESSION TO 1
		   IF USED('land')
		      USE IN land
		   ENDIF
		   SET DATASESSION TO (liDataSession)
		   
		   IF m.goapp.lDocuments
		      thisform.pageframe1.PageCount = 2
		   ELSE
		      thisform.pageframe1.PageCount = 1
		      thisform.pageframe1.Tabs = .f.
		   ENDIF    
		ENDIF 
	ENDPROC

	PROCEDURE list
		LPARAMETERS cworkarea
		LOCAL lcList, lnRecNo
		LOCAL llReturn, loError
		PRIV llOK
		
		lnrecno = 1
		
		TRY
		    llOK   = .F.
		    lcList = 'cleaseid\Lease ID,cleasename\Lease Name,cprospect\Prospect'
		
		    IF THIS.flushcontrolbuffer() AND THIS.beforenav('Land')
		        SELECT land
		        lnRecNo = RECNO()
		
		        DO FORM ..\CUSTOM\picklist WITH 'Land', lcList, 'cleaseid', 3, .F., .T.
		        IF NOT llOK
		            SELECT land
		            GOTO lnRecNo
		        ENDIF
		    ENDIF
		
		
		CATCH TO loError
		    llReturn = .F.
		    DO errorlog WITH 'List', loError.LINENO, 'Land Info', loError.ERRORNO, loError.MESSAGE, '', loError
		    MESSAGEBOX('Unable to process the list at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		          'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		ENDTRY
		
		THISFORM.REFRESH()
		
	ENDPROC

	PROCEDURE viewdocument		&& Brings up the viewer for the given document
		LOCAL lnReturn, llReturn, lcOutputFile
		LOCAL liKey, lcPath
		
		IF m.goApp.lDocuments
		   liKey = INT(VAL(thisform.pageframe1.page2.lstDocuments.Value))
		ENDIF 
		
		swselect('documents')
		SET ORDER TO iDocPK
		IF SEEK(liKey)
		   lcOutputFile = cPath
		
		   llReturn = .T.
		
		   IF NOT FILE(lcOutputFile)
		      llReturn = .F.
		   ENDIF
		
		   TRY
		      IF llReturn
		         DECLARE INTEGER ShellExecute IN "Shell32.dll" ;
		            INTEGER HWND, ;
		            STRING lpVerb, ;
		            STRING lpFile, ;
		            STRING lpParameters, ;
		            STRING lpDirectory, ;
		            LONG nShowCmd
		
		         lnReturn = ShellExecute(0, "Open", lcOutputFile, "", "", 1)
		      ENDIF
		
		      THIS.nReturnValue = lnReturn
		
		      IF lnReturn > 32
		         llReturn = .T.
		      ELSE
		         llReturn = .F.
		      ENDIF
		   CATCH TO loError
		   ENDTRY
		
		   RETURN (llReturn)
		
		ENDIF
	ENDPROC

	PROCEDURE cmdatamanager.afternav
		LPARAMETERS cWorkarea
		
		IF m.goApp.lDocuments
		   thisform.pageframe1.page2.lstDocuments.Requery()
		ENDIF    
	ENDPROC

	PROCEDURE cmdatamanager.afternew
		LPARAMETERS cworkarea
		
		IF m.cworkarea = 'Land'
		   REPL cLeaseStatus WITH 'Active'
		   THISFORM.setnextcontrol(THISFORM.pageframe1.page1.txtcleaseid)
		ENDIF
		
	ENDPROC

	PROCEDURE cmdatamanager.beforedelete
		LPARAMETERS cWorkarea
		
		SELECT landowner
		LOCATE FOR cLeaseID == land.cLeaseID
		IF FOUND()
		   THISFORM.oMessage.Warning('This lease has one or more lease obligations set up for it.  It cannot be deleted.')
		   RETURN .F.
		ENDIF
		
		RETURN(DODEFAULT(cWorkarea))
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.cboLeaseStatus.Init
		IF DODEFAULT()
		   THIS.ADDLISTITEM('Active',1,1)
		   THIS.ADDLISTITEM('Active',1,2)
		   THIS.ADDLISTITEM('Pending',2,1)
		   THIS.ADDLISTITEM('Pending',2,2)
		   THIS.ADDLISTITEM('Dedicated',3,1)
		   THIS.ADDLISTITEM('PD',3,2)
		   THIS.ADDLISTITEM('Expired',4,1)
		   THIS.ADDLISTITEM('Expired',4,2)
		   THIS.ADDLISTITEM('HBP',5,1)
		   THIS.ADDLISTITEM('HBP',5,2)
		   THIS.ADDLISTITEM('Paid-Up',6,1)
		   THIS.ADDLISTITEM('Paid-Up',6,2)
		   THIS.ADDLISTITEM('Sold',7,1)
		   THIS.ADDLISTITEM('Sold',7,2)
		   THIS.ADDLISTITEM('Mandatory Pool',8,1)
		   THIS.ADDLISTITEM('MP',8,2)
		   THIS.ADDLISTITEM('ROW',9,1)
		   THIS.ADDLISTITEM('ROW',9,2)
		   THIS.ADDLISTITEM('Location Agree',10,1)
		   THIS.ADDLISTITEM('LA',10,2)
		   THIS.ADDLISTITEM('Plugged',11,1)
		   THIS.ADDLISTITEM('PL',11,2)
		   THIS.ADDLISTITEM('Tank Battery',12,1)
		   THIS.ADDLISTITEM('TB',12,2)
		   THIS.ADDLISTITEM('Inactive',13,1)
		   THIS.ADDLISTITEM('IN',13,2)
		   THIS.AddListItem('Temporary Access',14,1)
		   THIS.ADDLISTITEM('TA',14,2)
		   this.AddListItem('Tank Battery, Etc.',15,1)
		   this.AddListItem('TBE',15,2)
		   this.addlistitem('Meter Site',16,1)
		   this.AddListItem('MS',16,2)
		ENDIF
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.txtCleaseid.Valid
		LOCAL lcLeaseID
		
		IF NOT THIS.lChanged OR EMPTY(THIS.VALUE)
		   RETURN
		ENDIF
		
		lcLeaseID = THIS.VALUE
		
		IF lcLeaseID = land.cLeaseID
		   RETURN
		ENDIF
		
		SET DELETED OFF
		SELECT land1
		SET ORDER TO cLeaseID
		IF SEEK(lcLeaseID)
		   IF NOT DELETED()
		      IF THISFORM.oMessage.CONFIRM('This lease already exists in the Land file.  Would you like to view that record?')
		         THISFORM.cmdatamanager.revertall()
		         SELECT land
		         SET ORDER TO cLeaseID
		         SEEK(lcLeaseID)
		         THISFORM.REFRESH()
		      ELSE
		         SET DELETED ON
		         THIS.VALUE = ''
		         RETURN 0
		      ENDIF
		   ELSE
		      THISFORM.cmdatamanager.revertall()
		      SELECT land
		      SET ORDER TO cLeaseID
		      SEEK(lcLeaseID)
		      RECALL
		      SCATTER MEMVAR BLANK
		      GATHER MEMVAR
		      THISFORM.cmdatamanager.REPLACE('Land','cLeaseID',lcLeaseID)
		      THISFORM.REFRESH()
		   ENDIF
		ELSE
		   * If the lease id is the same as a wellid, pull in the name of the well
		   SELE wells
		   LOCATE FOR cwellid = lcLeaseID
		   IF FOUND()
		      THISFORM.cmdatamanager.REPLACE('Land','Cleasename',wells.cwellname)
		      THISFORM.pageframe1.page1.txtcleasename.REFRESH()
		   ENDIF
		ENDIF
		SELECT land
		SET DELETED ON
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.txtCleasename.GotFocus
		THISFORM.cleasename = THIS.VALUE
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.txtCleasename.LostFocus
		IF m.goapp.lQBVersion
		   IF THIS.VALUE <> THISFORM.cleasename AND NOT EMPTY(land.clistid)
		      IF NOT THISFORM.omessage.CONFIRM('Changing the lease name of a lease that has been synchronized ' + ;
		            'will create a new class in QuickBooks instead of changing the original name. Is this ok?')
		         THIS.SET('value',THISFORM.cleasename)
		      ENDIF
		   ENDIF
		ENDIF
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.txtdExpires.Valid
		IF NOT EMPTY(THIS.VALUE) AND NOT EMPTY(THIS.PARENT.txtdleasedate.VALUE)  ;  &&  Not allowed if earlier than the lease date
		   AND THIS.VALUE < THIS.PARENT.txtdleasedate.VALUE
		   THISFORM.oMessage.Warning('You cannot choose an expiration date that is prior to the Lease Date.  Please select a different date.')
		   THIS.SET('value',{})
		   RETURN .F.
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Pageframe1.Page2.Activate
		IF m.goApp.lCloudDocs
		   this.cmdTreeno.Visible = .t.
		ELSE
		   this.cmdTreeno.Visible = .f.
		ENDIF
		
		RETURN DODEFAULT()   
	ENDPROC

	PROCEDURE Pageframe1.Page2.Cmdcommandbuttoncustom1.Click
		likey = INT(VAL(this.parent.lstDocuments.Value))
		
		swselect('documents')
		SET ORDER to iDocPK
		IF SEEK(likey)
		   DELETE NEXT 1
		   this.Parent.lstDocuments.Requery()
		   thisform.setchanged(.t.,'Documents')
		   m.gostatemanager.refreshall('Form')
		ENDIF 
	ENDPROC

	PROCEDURE Pageframe1.Page2.Cmdcommandbuttoncustom1.Init
		IF DODEFAULT()
		IF FILE('datafiles\treeno.txt')
		   this.Visible = .f.
		ELSE
		   this.Visible = .t.
		ENDIF 
		ENDIF 
	ENDPROC

	PROCEDURE Pageframe1.Page2.Cmdcommandbuttoncustom2.Click
		LOCAL lnx
		llReturn = THISFORM.ofilEDIALOG.openfile()
		IF THISFORM.ofilEDIALOG.nfiles > 0
		   FOR lnx = 1 TO THISFORM.ofilEDIALOG.nfiles
		      m.cfk      = land.cleaseid
		      m.cDocLink = 'LI'
		      m.cpath    = UPPER(THISFORM.ofilEDIALOG.aFiles[lnx])
		      swSELECT('documents')
		      LOCATE FOR cfk == m.cfk AND ALLTRIM(cpath) == ALLTRIM(m.cpath)
		      IF NOT FOUND()
		         INSERT INTO documents FROM MEMVAR
		      ENDIF
		   ENDFOR
		   THIS.PARENT.lstDocuments.REQUERY()
		   thisform.setchanged(.t.,'Documents')
		   m.gostatemanager.refreshall('Form')
		ENDIF
	ENDPROC

	PROCEDURE Pageframe1.Page2.Cmdcommandbuttoncustom2.Init
		IF DODEFAULT()
		IF FILE('datafiles\treeno.txt')
		   this.Visible = .f.
		ELSE
		   this.Visible = .t.
		ENDIF 
		ENDIF 
	ENDPROC

	PROCEDURE Pageframe1.Page2.Cmdcommandbuttoncustom3.Click
		thisform.viewdocument()
	ENDPROC

	PROCEDURE Pageframe1.Page2.Cmdcommandbuttoncustom3.Init
		IF DODEFAULT()
		IF FILE('datafiles\treeno.txt')
		   this.Visible = .f.
		ELSE
		   this.Visible = .t.
		ENDIF 
		ENDIF 
	ENDPROC

	PROCEDURE Pageframe1.Page2.cmdTreeno.Click
		LOCAL loTS
		
		loTS = m.goApp.oTreeno
		
		IF loTS.Login()
		   * Get the cabinet ID, needed for the other calls
		   lnCabinetID = loTS.GetCabinetID("Leases") && ex. "Leases", "Wells"
		
		   IF m.lnCabinetID = -1
		      MESSAGEBOX('Error Accessing Treeno:' + CHR(10) + loTS.cErrorMsg,48,'Treeno Problem')
		      RETURN
		   ENDIF
		
		   * Check to see if the folder already exists
		   * Not a great example because if you did a search for a company named "Test"
		   * a company like "Test Company" would match. The assumption is this
		   * field contains a unique value. If that ends up being a bad assumption
		   * you could iterate over the loTS.oMatches and do a more exact match.
		   *lnMatches = loTS.SearchCabinet(lnCabinetID, "company_name", "Test Company") && ex. lease_number or well_id
		   lnMatches = loTS.SearchCabinet(lnCabinetID, "lease_number", land.cleaseid) && ex. lease_number or well_id
		
		   IF lnMatches = -1
		      MESSAGEBOX('Error Accessing Treeno:' + CHR(10) + loTS.cErrorMsg,48,'Treeno Problem')
		      RETURN
		   ENDIF
		
		   * If the folder doesn't exist, create it
		   IF lnMatches = 0
		      * Folder Not found
		      IF MESSAGEBOX('The folder for lease: ' + land.cleaseid + ' does not exist in Treeno. Do you want to create it?',36,'Access Treeno') = 6
		         CREATE CURSOR curfolder (abstracted L, lease_number C(40), lessor_name C(30), lease_date D(30), well_numbers C(40), county C(20), township c(20), acres N(12,4), nec_owns_deep L)
		         SWSELECT('leasewell')
		         SELECT cWellID FROM leasewell WHERE  cLeaseid == land.cleaseid INTO CURSOR templease ORDER BY cWellID
		         INSERT INTO curfolder (abstracted, lease_number, lessor_name, lease_date, well_numbers, county, township, acres, nec_owns_deep) ;
		            VALUES (.F., land.cLeaseID, land.cleasename, land.dleasedate, templease.cwellid, land.ccounty, land.ctownship, land.nGrossAcre, .F.)
		
		         llCreated = loTS.CreateFolder(thisform.DataSessionId, m.lnCabinetID, "curFolder")
		
		         IF !m.llCreated
		            MESSAGEBOX('Error Accessing Treeno:' + CHR(10) + loTS.cErrorMsg,48,'Treeno Problem')
		         ENDIF
		      ELSE
		         RETURN
		      ENDIF
		   ENDIF
		
		   swselect('options')
		   GO TOP 
		   lcUser = ALLTRIM(cTreenoUser)
		   lcPassword = ALLTRIM(cmEncrypt(options.cTreenoPwd,'5h3rWar3A1Z2'))
		   * Now open the website up to this folder
		   loTS.LaunchWebsite(lcUser, lcPassword, "Leases", "lease_number", land.cleaseid)
		ELSE
		   MESSAGEBOX('Unable to login to Treeno. Check your user name and password in the Cloud Doc Mgmt preferences and try again.',16,'Treeno Login Problem')   
		ENDIF
		
	ENDPROC

	PROCEDURE Pageframe1.Page2.lstDocuments.DblClick
		thisform.viewdocument()
	ENDPROC

	PROCEDURE Pageframe1.Page2.lstDocuments.Init
		IF DODEFAULT()
		IF FILE('datafiles\treeno.txt')
		   this.Visible = .f.
		ELSE
		   this.Visible = .t.
		ENDIF 
		ENDIF 
	ENDPROC

	PROCEDURE Pageframe1.Page2.lstDocuments.Requery
		
		this.Clear()
		lnx = 1
		swselect('documents')
		SCAN FOR cDocLink = 'LI' AND cFK == land.cleaseid
		   SCATTER memvar
		   this.AddListItem(JUSTFNAME(documents.cpath),lnx,1)
		   this.AddListItem(TRANSFORM(documents.idocpk),lnx,2)
		   lnx = lnx + 1
		ENDSCAN
		
	ENDPROC

ENDDEFINE
