*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="araged.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor12" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 507
	InitialSelectedAlias = "custs"
	Left = 240
	Name = "Dataenvironment"
	Top = 51
	Width = 640

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "custs", ;
		BufferModeOverride = 5, ;
		CursorSource = "custs", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Name = "Cursor1", ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor10", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "gasinv", ;
		CursorSource = "gasinv", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor11", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "glmaster", ;
		CursorSource = "glmaster", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 339, ;
		Name = "Cursor12", ;
		Top = 12, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "invhdr", ;
		BufferModeOverride = 5, ;
		CursorSource = "invhdr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Name = "Cursor2", ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "custown", ;
		CursorSource = "custown", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 209, ;
		Name = "Cursor3", ;
		Top = 3, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "aropt", ;
		CursorSource = "aropt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 104, ;
		Name = "Cursor4", ;
		Top = 1, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "arpmtdet", ;
		CursorSource = "arpmtdet", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "arpmthdr", ;
		CursorSource = "arpmthdr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor6", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "arpmtdet1", ;
		CursorSource = "arpmtdet", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor7", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "arpmthdr1", ;
		CursorSource = "arpmthdr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 403, ;
		Name = "Cursor8", ;
		Top = 139, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "gasown", ;
		CursorSource = "gasown", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor9", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formaragedlist AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shape3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgOrderBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgReportType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lblfieldlabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblThroughdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblReportType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblOrderBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboRcvAccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblRcvAccount" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkShowPmt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkIncludeAll" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtThroughDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkCustomers" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkJIB" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkHouseGas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkNetOwners" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: ctype
		*p: lhousegas
	*</DefinedPropArrayMethod>

	Caption = "Aged Receivables Reports"
	ctype = .F.
	DataSession = 2
	DoCreate = .T.
	Height = 529
	HelpContextID = 576
	Name = "FormAragedlist"
	Width = 516
	Swrptcriteriabuttons1.CHKEXPORT.Alignment = 0
	Swrptcriteriabuttons1.CHKEXPORT.Name = "CHKEXPORT"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 140
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 23
	Swrptcriteriabuttons1.Top = 443
	Swrptcriteriabuttons1.ZOrderSet = 11

	ADD OBJECT 'cboRcvAccount' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 20, ;
		Left = 180, ;
		Name = "cboRcvAccount", ;
		TabIndex = 11, ;
		Top = 189, ;
		Width = 228, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'chkCustomers' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Customers", ;
		Left = 180, ;
		Name = "chkCustomers", ;
		TabIndex = 19, ;
		Top = 366, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkHouseGas' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "House Gas Owners", ;
		Left = 289, ;
		Name = "chkHouseGas", ;
		TabIndex = 22, ;
		Top = 402, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkIncludeAll' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Include All Receivables", ;
		Left = 285, ;
		Name = "chkIncludeAll", ;
		TabIndex = 4, ;
		Top = 53, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkJIB' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "JIB Owners", ;
		Left = 180, ;
		Name = "chkJIB", ;
		TabIndex = 21, ;
		Top = 402, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkNetOwners' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Net Owners", ;
		Left = 289, ;
		Name = "chkNetOwners", ;
		TabIndex = 20, ;
		Top = 368, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkSelected' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Choose Selected Customers", ;
		Left = 183, ;
		Name = "chkSelected", ;
		TabIndex = 13, ;
		Top = 234, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkShowPmt' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Show Payment Detail", ;
		Left = 180, ;
		Name = "chkShowPmt", ;
		TabIndex = 10, ;
		Top = 163, ;
		Value = .F., ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'lblBegID' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Beginning Customer:", ;
		Height = 16, ;
		Left = 67, ;
		Name = "lblBegID", ;
		TabIndex = 15, ;
		Top = 263, ;
		Width = 101, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndID' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Ending Customer:", ;
		Height = 16, ;
		Left = 82, ;
		Name = "lblEndID", ;
		TabIndex = 17, ;
		Top = 314, ;
		Width = 86, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lblfieldlabelcustom1' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Show Aging For:", ;
		Height = 16, ;
		Left = 84, ;
		Name = "Lblfieldlabelcustom1", ;
		TabIndex = 18, ;
		Top = 366, ;
		Width = 84, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblOrderBy' AS lbltextcustom WITH ;
		Caption = "Sort By:", ;
		Left = 127, ;
		Name = "lblOrderBy", ;
		TabIndex = 7, ;
		Top = 90, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblRcvAccount' AS lbllabelcustom WITH ;
		Caption = "Receivable Acct:", ;
		Left = 84, ;
		Name = "lblRcvAccount", ;
		TabIndex = 12, ;
		Top = 191, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblReportType' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Report Type:", ;
		Height = 16, ;
		Left = 104, ;
		Name = "lblReportType", ;
		TabIndex = 2, ;
		Top = 17, ;
		Width = 64, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Caption = "All Owners Selected", ;
		ForeColor = 0,0,255, ;
		Left = 201, ;
		Name = "lblSelected", ;
		TabIndex = 16, ;
		Top = 292, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom1' AS lbltextcustom WITH ;
		Caption = "Base Report On:", ;
		Left = 86, ;
		Name = "Lbltextcustom1", ;
		TabIndex = 9, ;
		Top = 128, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblThroughdate' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Through Date:", ;
		Height = 16, ;
		Left = 98, ;
		Name = "lblThroughdate", ;
		TabIndex = 5, ;
		Top = 54, ;
		Width = 70, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgDate' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		ButtonCount = 3, ;
		Height = 17, ;
		Left = 174, ;
		Name = "opgDate", ;
		TabIndex = 8, ;
		Top = 126, ;
		Value = 1, ;
		Width = 259, ;
		ZOrderSet = 13, ;
		Option1.Caption = "Due Date", ;
		Option1.FontSize = 8, ;
		Option1.Height = 17, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 2, ;
		Option1.Value = 1, ;
		Option1.Width = 61, ;
		Option2.Caption = "Invoice Date", ;
		Option2.FontSize = 8, ;
		Option2.Height = 17, ;
		Option2.Left = 80, ;
		Option2.Name = "Option2", ;
		Option2.Top = 2, ;
		Option2.Value = 0, ;
		Option2.Width = 79, ;
		Option3.Caption = "Post Date", ;
		Option3.FontSize = 8, ;
		Option3.Height = 17, ;
		Option3.Left = 171, ;
		Option3.Name = "Option3", ;
		Option3.Top = 2, ;
		Option3.Width = 61
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'opgOrderBy' AS opgoptiongroupcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 26, ;
		Left = 174, ;
		Name = "opgOrderBy", ;
		TabIndex = 6, ;
		Top = 85, ;
		Value = 1, ;
		Width = 188, ;
		ZOrderSet = 3, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Owner ID", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Value = 1, ;
		Option1.Width = 64, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Owner Name", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 101, ;
		Option2.Name = "Option2", ;
		Option2.Top = 5, ;
		Option2.Width = 82
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'opgReportType' AS opgoptiongroupcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 26, ;
		Left = 175, ;
		Name = "opgReportType", ;
		TabIndex = 1, ;
		Top = 12, ;
		Width = 133, ;
		ZOrderSet = 4, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Detail", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "optDetail", ;
		Option1.Top = 5, ;
		Option1.Width = 44, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Summary", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 65, ;
		Option2.Name = "optSummary", ;
		Option2.Top = 5, ;
		Option2.Width = 63
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Shape1' AS shape WITH ;
		Height = 29, ;
		Left = 72, ;
		Name = "Shape1", ;
		Top = 121, ;
		Width = 351, ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape2' AS shape WITH ;
		Height = 29, ;
		Left = 72, ;
		Name = "Shape2", ;
		Top = 84, ;
		Width = 351, ;
		ZOrderSet = 1
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape3' AS shape WITH ;
		Height = 29, ;
		Left = 72, ;
		Name = "Shape3", ;
		Top = 11, ;
		Width = 351, ;
		ZOrderSet = 0
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 180, ;
		Name = "Swrptlook1", ;
		TabIndex = 14, ;
		Top = 260, ;
		ZOrderSet = 6, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		TxtBegID.clistexpression = custown.ccustid, ;
		TxtBegID.clistworkarea = custown, ;
		TxtBegID.Name = "TxtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		TxtEndID.clistexpression = custown.ccustid, ;
		TxtEndID.clistworkarea = custown, ;
		TxtEndID.Name = "TxtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtThroughDate' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 181, ;
		Name = "txtThroughDate", ;
		TabIndex = 3, ;
		Top = 52, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcBegID,lcEndID,ldThruDate
		
		lcBegID = THISFORM.swrptlook1.txtBegID.VALUE
		lcEndID = THISFORM.swrptlook1.txtEndID.VALUE
		ldThruDate = THISFORM.txtThroughDate.VALUE
		lnDate = THISFORM.opgDate.VALUE
		llShowAll = THISFORM.chkIncludeAll.VALUE
		tlJIBs = THISFORM.chkJIB.VALUE
		llSelected  = THISFORM.chkselected.VALUE
		
		
		IF NOT llSelected
		   SELECT ccustid AS cid FROM custown ;
		      INTO CURSOR SELECTED ;
		      WHERE BETWEEN(ccustid,lcBegID,lcEndID) ;
		      ORDER BY cid
		ENDIF
		
		IF THISFORM.chkCustomers.VALUE = .F. AND THISFORM.chkHouseGas.VALUE = .F. AND THISFORM.chkJIB.VALUE = .F.  &&  Nothing's marked
		   THISFORM.oMessage.Warning('You must choose to show aging for at least one type of balance.')
		   RETURN .F.
		ENDIF
		
		DO CASE
		   CASE lnDate = 1
		      lcCriteria = 'by Due Date'
		   CASE lnDate = 2
		      lcCriteria = 'by Invoice Date'
		   CASE lnDate = 3
		      lcCriteria = 'by Post Date'
		   OTHERWISE
		      lcCriteria = 'by Due Date'
		ENDCASE
		
		THISFORM.cSelectCriteria = 'Customers:  ' + ALLTRIM(THISFORM.swrptlook1.txtBegID.VALUE) + ' - ' + ALLTRIM(THISFORM.swrptlook1.txtEndID.VALUE) + ' - ' + lcCriteria
		THISFORM.cSortOrder      = 'Customer ID'
		
		IF m.goapp.lAMVersion
		   lcAccount = THISFORM.cboRcvAccount.VALUE
		ELSE
		   lcAccount = '******'
		ENDIF
		
		IF lcAccount = '******'
		   THISFORM.cTitle2 = 'As of ' + DTOC(THISFORM.txtThroughDate.VALUE) + ' - All Accounts'
		ELSE
		   THISFORM.cTitle2 = 'As of ' + DTOC(THISFORM.txtThroughDate.VALUE) + ' -' + THISFORM.cboRcvAccount.DISPLAYVALUE
		ENDIF
		
		WAIT WIND NOWAIT 'Calculating Aging...Please Wait'
		
		IF USED('custbal')
		   USE IN custbal
		ENDIF
		IF USED('custbaltemp')
		   USE IN custbaltemp
		ENDIF
		
		IF THISFORM.opgReportType.VALUE = 1  &&  Detail
		
		   CREATE CURSOR custbaltemp ;
		      (ccustid     C(10), ;
		      cBatch     C(8), ;
		      cCustName   C(40), ;
		      cbAddr1     C(40),  ;
		      cbAddr2     C(40),  ;
		      cbAddr3     C(40),  ;
		      cbCity      C(40),  ;
		      cbState     C(2),  ;
		      cbZip       C(10), ;
		      cinvnum     C(15), ;
		      dInvDate    D, ;
		      cDateCap    C(10), ;
		      dSelDate    D, ;
		      dStmtDate   D,  ;
		      cReference  C(15),  ;
		      ccontact    C(25), ;
		      cphone      C(15), ;
		      asterisk    C(1), ;
		      cartype     C(1), ;
		      nInvBal     N(12,2), ;
		      nInvTot     N(12,2),  ;
		      ninvage     N(6,0))
		   INDEX ON ccustid TAG ccustid
		   INDEX ON cCustName TAG cCustName
		
		   SELECT custbaltemp
		   IF THISFORM.opgOrderBy.VALUE = 2  &&  Owner Name
		      SET ORDER TO cCustName
		   ELSE
		      SET ORDER TO ccustid
		   ENDIF
		
		   THISFORM.cTitle1 = 'Aged Receivables - Detail'
		
		   THIS.cReportName = 'arage2.frx'
		
		   IF THISFORM.chkHouseGas.VALUE
		      IF THISFORM.chkShowPmt.VALUE
		         llReturn = aragedDet(lcBegID,lcEndID,ldThruDate,.T.,lnDate,.T.,lcAccount,llShowAll,.F.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ELSE
		         llReturn = araged(lcBegID,lcEndID,ldThruDate,.T.,lnDate,.T.,lcAccount,llShowAll,.F.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		   ENDIF
		
		   IF THISFORM.chkShowPmt.VALUE
		      IF THISFORM.chkCustomers.VALUE
		         llReturn = aragedDet(lcBegID,lcEndID,ldThruDate,.T.,lnDate,.F.,lcAccount,llShowAll,.F.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		      IF THISFORM.chkJIB.VALUE
		         llReturn = aragedDet(lcBegID,lcEndID,ldThruDate,.T.,lnDate,.F.,lcAccount,llShowAll,.T.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		   ELSE  &&  No payment detail
		      IF THISFORM.chkCustomers.VALUE
		         llReturn = araged(lcBegID,lcEndID,ldThruDate,.T.,lnDate,.F.,lcAccount,llShowAll,.F.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		      IF THISFORM.chkJIB.VALUE
		         llReturn = araged(lcBegID,lcEndID,ldThruDate,.T.,lnDate,.F.,lcAccount,llShowAll,.T.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		   ENDIF
		   SELECT custbaltemp
		   IF RECCOUNT() > 0
		      USE IN custbal
		      USE DBF('custbaltemp') AGAIN IN 0 ALIAS custbal ORDER TAG IIF(THISFORM.opgOrderBy.VALUE = 1,'ccustid','ccustname')
		      SELECT custbal
		      RETURN .T.
		   ELSE
		      RETURN .F.
		   ENDIF
		ELSE
		   CREATE CURSOR custbaltemp ;
		      (ccustid   C(10), ;
		      cCustName  C(40), ;
		      nCurrent   N(12,2), ;
		      nDays1     N(12,2), ;
		      nDays30    N(12,2), ;
		      nDays60    N(12,2), ;
		      nDaysOver90    N(12,2))
		   INDEX ON ccustid TAG ccustid
		   INDEX ON cCustName TAG cCustName
		
		   SELECT custbaltemp
		   IF THISFORM.opgOrderBy.VALUE = 2  &&  Owner Name
		      SET ORDER TO cCustName
		   ELSE
		      SET ORDER TO ccustid
		   ENDIF
		
		   THISFORM.cTitle1 = 'Aged Receivables - Summary'
		   THIS.cReportName = 'arage1.frx'
		   IF THISFORM.chkShowPmt.VALUE
		      IF THISFORM.chkCustomers.VALUE
		         llReturn = aragedDet(lcBegID,lcEndID,ldThruDate,.F.,lnDate,.F.,lcAccount,llShowAll,.F.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		      IF THISFORM.chkJIB.VALUE
		         llReturn = aragedDet(lcBegID,lcEndID,ldThruDate,.F.,lnDate,.F.,lcAccount,llShowAll,.T.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		   ELSE
		      IF THISFORM.chkCustomers.VALUE
		         llReturn = araged(lcBegID,lcEndID,ldThruDate,.F.,lnDate,.F.,lcAccount,llShowAll,.F.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		      IF THISFORM.chkJIB.VALUE
		         llReturn = araged(lcBegID,lcEndID,ldThruDate,.F.,lnDate,.F.,lcAccount,llShowAll,.T.,llSelected)
		         IF llReturn
		            SELECT custbaltemp
		            APPEND FROM DBF('custbal')
		         ENDIF
		      ENDIF
		   ENDIF
		
		   SELECT custbaltemp
		   IF RECCOUNT() > 0
		      USE IN custbal
		      USE DBF('custbaltemp') AGAIN IN 0 ALIAS custbal ORDER TAG IIF(THISFORM.opgOrderBy.VALUE = 1,'ccustid','ccustname')
		      SELECT custbal
		      RETURN .T.
		   ELSE
		      RETURN .F.
		   ENDIF
		ENDIF
		
		
	ENDPROC

	PROCEDURE Init
		PARA tcType
		
		IF TYPE('tcType') <> 'C'  &&  Nothing passed, so set it to blank
		   tcType = ''
		endif
		
		this.cType = tcType  &&  Set it, so it can be used for JIB stuff later
		IF NOT m.goapp.lAMVersion
		   thisform.lblrcvaccount.Visible = .f.
		   thisform.cborcvAccount.Visible = .f.
		   thisform.opgDate.option3.Visible = .f.
		ENDIF 
		
		DODEFAULT()
		
		DO CASE
		   CASE tcType = 'H'
		      thisform.lhousegas = .t.
		      THISFORM.opgReportType.VISIBLE = .F.      
		      THISFORM.lblReportType.VISIBLE = .F.
		      THISFORM.cborcvaccount.VISIBLE = .F.
		      THISFORM.chkshowpmt.VISIBLE    = .T.
		      THISFORM.lblRcvAccount.VISIBLE = .F.
		      THISFORM.opgDate.option3.VISIBLE = .F.
		      THISFORM.chkIncludeAll.VISIBLE = .F.
		      THISFORM.shape3.VISIBLE = .F.
		      THIS.CAPTION = 'House Gas Receivables'
		      thisform.lblBegID.Caption = 'Beginning Owner:'
		      thisform.lblendID.Caption = 'Ending Owner:'
		      thisform.swrptlook1.txtBegID.cListexpression = 'gasown.cOwnerID'
		      thisform.swrptlook1.txtBegID.cListWorkarea = 'gasown'
		      thisform.swrptlook1.txtEndID.cListexpression = 'gasown.cOwnerID'
		      thisform.swrptlook1.txtEndID.cListWorkarea = 'gasown'
		      THIS.HELPCONTEXTID = 166
		      SELECT gasown
		      SET ORDER TO cownerid
		      GO TOP
		      THISFORM.swrptlook1.txtBegID.VALUE = cownerid
		      GO BOTT
		      THISFORM.swrptlook1.txtEndID.VALUE = cownerid
		      SELECT investor
		      SET ORDER TO cownerid
		      IF SEEK(THISFORM.swrptlook1.txtBegID.VALUE)
		         THISFORM.swrptlook1.txtBegName.VALUE = cOwnName
		      ENDIF
		      IF SEEK(THISFORM.swrptlook1.txtEndID.VALUE)
		         THISFORM.swrptlook1.txtEndName.VALUE = cOwnName
		      ENDIF
		      thisform.chkCustomers.set('value',.f.)
		      thisform.chkhouseGas.set('value',.t.)
		      thisform.chkJIB.set('value',.f.)
		      * If we're in demo mode, tell the user that this is an optional module
		      IF m.goapp.ldemo
		         THISFORM.omessage.warning('The House Gas module is an optional module that can be purchased separately.' + ;
		            ' It is included in the demo for evaluation purposes.')
		      ENDIF
		   CASE tcType = 'J'
		      THISFORM.CAPTION = 'Joint Interest Receivables Report'
		      THIS.HELPCONTEXTID = 222
		      THISFORM.opgReportType.VISIBLE = .T.
		      THISFORM.lblReportType.VISIBLE = .T.
		      SELECT custown
		      INDEX ON cCustID TAG cCustID
		      GO TOP
		      THISFORM.swrptlook1.txtBegID.VALUE = cCustID
		      THISFORM.swrptlook1.txtBegName.VALUE = ccustname
		      GO BOTTOM
		      THISFORM.swrptlook1.txtEndID.VALUE = cCustID
		      THISFORM.swrptlook1.txtEndName.VALUE = ccustname
		      thisform.lblBegID.Caption = 'Beginning Owner:'
		      thisform.lblendID.Caption = 'Ending Owner:'
		      THISFORM.opgOrderBy.Option1.CAPTION = 'Owner ID'
		      THISFORM.opgOrderBy.Option2.CAPTION = 'Owner Name'
		      thisform.chkCustomers.set('value',.f.)
		      thisform.chkhouseGas.set('value',.f.)
		      thisform.chkJIB.set('value',.t.)
		
		   OTHERWISE
		      THIS.CAPTION = 'Aged Receivables Report'
		      THIS.HELPCONTEXTID = 383
		      THISFORM.opgReportType.VISIBLE = .T.
		      THISFORM.lblReportType.VISIBLE = .T.
		      SELECT custown
		      INDEX ON cCustID TAG cCustID
		      GO TOP
		      THISFORM.swrptlook1.txtBegID.VALUE = cCustID
		      THISFORM.swrptlook1.txtBegName.VALUE = ccustname
		      GO BOTTOM
		      THISFORM.swrptlook1.txtEndID.VALUE = cCustID
		      THISFORM.swrptlook1.txtEndName.VALUE = ccustname
		      THISFORM.opgOrderBy.Option1.CAPTION = 'Customer ID'
		      THISFORM.opgOrderBy.Option2.CAPTION = 'Customer Name'
		      thisform.chkCustomers.set('value',.t.)
		      thisform.chkhouseGas.set('value',.f.)
		      thisform.chkJIB.set('value',.f.)
		
		ENDCASE
		
		IF NOT USED('glmaster') AND m.goapp.lAMVersion  &&  If it's the AM version and GLMaster isn't used, use it - BH 10/24/07
		   USE glmaster IN 0
		ENDIF
		
		THISFORM.opgReportType.VALUE = 1
		THISFORM.txtThroughDate.VALUE = DATE()
		
		
		
	ENDPROC

	PROCEDURE cboRcvAccount.Init
		IF DODEFAULT()
		   sele cacctno + ' - ' + cacctdesc as cdesc, cacctno from coa where naccttype < 3 ;
		        into cursor tempcoa order by cacctno
		   this.addlistitem('** All Accounts **',1,1)
		   this.addlistitem('******',1,2)     
		   if _Tally > 0
		      lnx = 2
		      sele tempcoa
		      scan
		         scatter memvar
		         this.addlistitem(m.cdesc,lnx,1)
		         this.addlistitem(m.cacctno,lnx,2)
		         lnx = lnx + 1
		      endscan
		      this.listitemid = 1
		   endif
		endif              
	ENDPROC

	PROCEDURE chkCustomers.Click
		IF this.Value AND NOT thisform.chkJIB.Value AND NOT thisform.chkHouseGas.Value
		   THISFORM.opgReportType.VISIBLE = .T.
		   THISFORM.lblReportType.VISIBLE = .T.
		ENDIF 
		
		DODEFAULT()
	ENDPROC

	PROCEDURE chkHouseGas.Click
		IF THIS.VALUE = .T.
		   THISFORM.lhousegas = .T.
		   THISFORM.opgReportType.VISIBLE = .F.
		   THISFORM.opgReportType.set('value',1)
		   THISFORM.lblReportType.VISIBLE = .F.
		   THISFORM.cborcvaccount.VISIBLE = .F.
		*!*	   THISFORM.chkshowpmt.VISIBLE    = .F.
		*!*	   thisform.chkShowPmt.set('value',.f.)
		   THISFORM.lblRcvAccount.VISIBLE = .F.
		   THISFORM.opgDate.option3.VISIBLE = .F.
		   THISFORM.chkIncludeAll.VISIBLE = .F.
		   THISFORM.shape3.VISIBLE = .F.
		   thisform.chkIncludeAll.set('value',.f.)
		   thisform.txtThroughDate.Enabled = .t.
		   IF thisform.opgDate.Value = 3
		      thisform.opgdate.set('value',1)
		   ENDIF 
		ELSE
		   THISFORM.lhousegas = .F.
		   THISFORM.opgReportType.VISIBLE = .T.
		   THISFORM.lblReportType.VISIBLE = .T.
		   THISFORM.cborcvaccount.VISIBLE = .T.
		   THISFORM.chkshowpmt.VISIBLE    = .T.
		   THISFORM.lblRcvAccount.VISIBLE = .T.
		   THISFORM.opgDate.option3.VISIBLE = .T.
		   THISFORM.chkIncludeAll.VISIBLE = .T.
		   THISFORM.shape3.VISIBLE = .T.
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE chkIncludeAll.Click
		IF this.value = .t.
		   thisform.txtThroughDate.set('enabled',.f.)
		ELSE
		   thisform.txtThroughDate.set('enabled',.t.)
		ENDIF
		
		DODEFAULT() 
	ENDPROC

	PROCEDURE chkSelected.Click
		IF this.Value
		   DO FORM commonsource\selected-ids WITH 'CUSTOWN' LINKED 
		   lnCount = RECCOUNT('selected')
		   thisform.lblselected.Caption = TRANSFORM(lnCount) + ' Customers Selected'
		   thisform.lblselected.Visible = .T.
		   thisform.lblbegID.Visible = .F.
		   thisform.lblendID.Visible = .F.
		   thisform.swrptlook1.Visible = .F.
		ELSE
		   thisform.lblselected.Visible = .F.
		   thisform.lblbegID.Visible = .T.
		   thisform.lblendID.Visible = .T.
		   thisform.swrptlook1.Visible = .T.
		ENDIF 
	ENDPROC

	PROCEDURE opgDate.Click
		DODEFAULT()
		
		IF thisform.opgReportType.Value <> 2
		   THISFORM.chkShowPmt.VISIBLE = .T.
		ENDIF
		
	ENDPROC

	PROCEDURE opgReportType.Valid
		IF this.Value = 1 AND thisform.opgDate.Value <> 3
		   thisform.chkShowPmt.Visible = .t.
		ELSE
		   thisform.chkshowPmt.Visible = .f.
		   thisform.chkshowPmt.set('value',.f.)
		endif
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .T.
		lcList = 'ccustid\ID,ccustname\Name,ctype\Type'
		
		SET SAFETY OFF
		
		IF THISFORM.lHousegas
		   SELECT gasown.cOwnerID, cOwnname FROM gasown, investor  ;
		      INTO CURSOR owntemp READWRITE  ;
		      WHERE gasown.cOwnerID == investor.cOwnerID  ;
		      GROUP BY gasown.cOwnerID
		
		   SELECT owntemp
		   INDEX ON cOwnerID TAG cOwnerID
		   INDEX ON cOwnname TAG cOwnname
		
		   lcList = 'cownerid\Owner ID,cownname\Owner Name'
		   DO FORM ..\CUSTOM\picklist WITH 'owntemp', lcList, THISFORM.swrptlook1.txtbegid.VALUE, 2, .T., .T.
		
		   IF llOK
		      THISFORM.swrptlook1.txtbegid.VALUE   = owntemp.cOwnerID
		      THISFORM.swrptlook1.txtBegName.VALUE = owntemp.cOwnname
		      THISFORM.swrptlook1.txtBegName.REFRESH()
		   ENDIF
		ELSE
		   SELECT custown
		   INDEX ON ccustid TAG ccustid
		   INDEX ON ccustname TAG ccustname
		   INDEX ON ctype TAG ctype
		
		   DO FORM ..\CUSTOM\picklist WITH 'Custown', lcList, THISFORM.swrptlook1.txtbegid.VALUE, 3, .F., .T.
		
		   IF llOK
		      THISFORM.swrptlook1.txtbegid.VALUE   = custown.ccustid
		      THISFORM.swrptlook1.txtBegName.VALUE = custown.ccustname
		      THISFORM.swrptlook1.txtBegName.REFRESH()
		   ENDIF
		ENDIF
		
		THISFORM.setnextcontrol(THIS.PARENT.txtbegid)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .T.
		lcList = 'ccustid\ID,ccustname\Name,ctype\Type'
		
		SET SAFETY OFF
		
		IF THISFORM.lHousegas
		   SELECT gasown.cOwnerID, cOwnname FROM gasown, investor  ;
		      INTO CURSOR owntemp READWRITE  ;
		      WHERE gasown.cOwnerID == investor.cOwnerID  ;
		      GROUP BY gasown.cOwnerID
		
		   SELECT owntemp
		   INDEX ON cOwnerID TAG cOwnerID
		   INDEX ON cOwnname TAG cOwnname
		
		   lcList = 'cownerid\Owner ID,cownname\Owner Name'
		   DO FORM ..\CUSTOM\picklist WITH 'owntemp', lcList, THISFORM.swrptlook1.txtEndid.VALUE, 2, .T., .T.
		
		   IF llOK
		      THISFORM.swrptlook1.txtEndid.VALUE   = owntemp.cOwnerID
		      THISFORM.swrptlook1.txtEndName.VALUE = owntemp.cOwnname
		      THISFORM.swrptlook1.txtEndName.REFRESH()
		   ENDIF
		ELSE
		   SELECT custown
		   INDEX ON ccustid TAG ccustid
		   INDEX ON ccustname TAG ccustname
		   INDEX ON ctype TAG ctype
		
		   DO FORM ..\CUSTOM\picklist WITH 'Custown', lcList, THISFORM.swrptlook1.txtendid.VALUE, 3, .F., .T.
		
		   IF llOK
		      THISFORM.swrptlook1.txtendid.VALUE   = custown.ccustid
		      THISFORM.swrptlook1.txtEndName.VALUE = custown.ccustname
		      THISFORM.swrptlook1.txtEndName.REFRESH()
		   ENDIF
		ENDIF
		
		THISFORM.setnextcontrol(THIS.PARENT.txtendid)
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtBegID.InteractiveChange
		IF DODEFAULT()
		*!*	   IF THISFORM.lhousegas
		*!*	      SELECT investor
		*!*	      LOCATE FOR cOwnerID = THIS.VALUE
		*!*	      IF FOUND()
		*!*	         THIS.PARENT.txtBegName.SET('value',investor.cOwnName)
		*!*	      ELSE
		*!*	         THIS.PARENT.txtBegName.SET('value','Unknown Owner')
		*!*	      ENDIF
		*!*	   ELSE
		*!*	      THIS.PARENT.txtBegName.SET('value',custown.cCustName)
		*!*	   ENDIF
		*!*	   THIS.PARENT.txtEndName.SET('value',THIS.PARENT.txtBegName.VALUE)
		ENDIF
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtBegID.Valid
		IF THISform.lHouseGas AND NOT thisform.chkCustomers.Value AND NOT thisform.chkJIB.Value 
		   SELECT gasown
		   SET ORDER TO cownerid
		   IF NOT SEEK(THIS.VALUE) AND NOT EMPTY(THIS.VALUE)
		      THISFORM.oMessage.Warning('The selected owner is not a house gas owner.  Select a valid house gas owner before continuing.')
		      RETURN 0
		   ENDIF
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtEndID.InteractiveChange
		IF DODEFAULT()
		*!*	   IF thisform.lhousegas
		*!*	      SELECT investor
		*!*	      LOCATE FOR cOwnerID = this.Value
		*!*	      IF FOUND()
		*!*	         this.Parent.txtEndName.set('value',investor.cOwnName)
		*!*	      ELSE
		*!*	         this.Parent.txtEndName.set('value','Unknown Owner')
		*!*	      ENDIF 
		*!*	   else    
		*!*	      this.Parent.txtEndName.set('value',custown.cCustName)
		*!*	   endif
		endif
	ENDPROC

	PROCEDURE Swrptlook1.TxtEndID.Valid
		IF THISform.lHouseGas AND NOT thisform.chkCustomers.Value AND NOT thisform.chkJIB.Value 
		   SELECT gasown
		   SET ORDER TO cownerid
		   IF NOT SEEK(THIS.VALUE) AND NOT EMPTY(THIS.VALUE)
		      THISFORM.oMessage.Warning('The selected owner is not a house gas owner.  Select a valid house gas owner before continuing.')
		      RETURN 0
		   ENDIF
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

ENDDEFINE
