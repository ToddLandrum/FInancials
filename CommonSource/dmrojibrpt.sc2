*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrojibrpt.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 721
	Left = 40
	Name = "Dataenvironment"
	Top = 126
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "aropt", ;
		CursorSource = "aropt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "options", ;
		CursorSource = "options", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor10", ;
		Top = 380, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "arpmtdet", ;
		CursorSource = "arpmtdet", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "arpmthdr", ;
		CursorSource = "arpmthdr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "invhdr", ;
		CursorSource = "invhdr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "invdet", ;
		CursorSource = "invdet", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor6", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "expense", ;
		CursorSource = "expense", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor8", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "expcat", ;
		CursorSource = "expcat", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor9", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Relation1' AS relation WITH ;
		ChildAlias = "arpmtdet", ;
		ChildOrder = "cbatch", ;
		Name = "Relation1", ;
		ParentAlias = "arpmthdr", ;
		RelationalExpr = "cbatch"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation2' AS relation WITH ;
		ChildAlias = "invdet", ;
		ChildOrder = "cbatch", ;
		Name = "Relation2", ;
		ParentAlias = "invhdr", ;
		RelationalExpr = "cbatch"
		*< END OBJECT: BaseClass="relation" />

	ADD OBJECT 'Relation3' AS relation WITH ;
		ChildAlias = "expense", ;
		ChildOrder = "ccatcode", ;
		Name = "Relation3", ;
		ParentAlias = "expcat", ;
		RelationalExpr = "ccatcode"
		*< END OBJECT: BaseClass="relation" />

ENDDEFINE

DEFINE CLASS formdmrojibrpt AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chklPayments" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="swdate1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swgroup1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="swdate2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblGroup" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: creport		&& The report type as passed.
	*</DefinedPropArrayMethod>

	Caption = "JIB Invoices and Payments Report"
	DataSession = 2
	DoCreate = .T.
	Height = 391
	HelpContextID = 223
	Name = "FormDmrojibrpt"
	Width = 399
	SWRPTCRITERIABUTTONS1.chkExport.Alignment = 0
	SWRPTCRITERIABUTTONS1.chkExport.Name = "chkExport"
	SWRPTCRITERIABUTTONS1.cmdclose.Name = "cmdclose"
	SWRPTCRITERIABUTTONS1.CMDPREVIEW.Name = "CMDPREVIEW"
	SWRPTCRITERIABUTTONS1.CMDPRINT.Name = "CMDPRINT"
	SWRPTCRITERIABUTTONS1.Left = 70
	SWRPTCRITERIABUTTONS1.Name = "SWRPTCRITERIABUTTONS1"
	SWRPTCRITERIABUTTONS1.TabIndex = 13
	SWRPTCRITERIABUTTONS1.Top = 287

	ADD OBJECT 'chklPayments' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Only Show Payments", ;
		Left = 126, ;
		Name = "chklPayments", ;
		TabIndex = 12, ;
		Top = 262, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkSelected' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Choose Selected Owners", ;
		Left = 118, ;
		Name = "chkSelected", ;
		TabIndex = 8, ;
		Top = 134, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'LblBegID' AS lbllabelcustom WITH ;
		Caption = "First Owner:", ;
		Height = 16, ;
		Left = 40, ;
		Name = "LblBegID", ;
		TabIndex = 10, ;
		Top = 160, ;
		Width = 63, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblEndID' AS lbllabelcustom WITH ;
		Caption = "Last Owner:", ;
		Height = 16, ;
		Left = 40, ;
		Name = "LblEndID", ;
		TabIndex = 11, ;
		Top = 211, ;
		Width = 63, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblGroup' AS lbllabelcustom WITH ;
		Caption = "Group:", ;
		Height = 16, ;
		Left = 68, ;
		Name = "LblGroup", ;
		TabIndex = 6, ;
		Top = 76, ;
		Width = 35, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Date Range", ;
		Left = 45, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 3, ;
		Top = 26
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "-", ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 222, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 5, ;
		Top = 26, ;
		Width = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Caption = "All Owners Selected", ;
		ForeColor = 0,0,255, ;
		Left = 136, ;
		Name = "lblSelected", ;
		TabIndex = 7, ;
		Top = 192, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'swdate1' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 120, ;
		Name = "swdate1", ;
		TabIndex = 1, ;
		Top = 24, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'swdate2' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 237, ;
		Name = "swdate2", ;
		TabIndex = 2, ;
		Top = 24, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swgroup1' AS swgroup WITH ;
		Left = 118, ;
		Name = "Swgroup1", ;
		TabIndex = 4, ;
		Top = 73, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 118, ;
		Name = "Swrptlook1", ;
		TabIndex = 9, ;
		Top = 157, ;
		ZOrderSet = 8, ;
		SWLOOKUPBUTTON1.Name = "SWLOOKUPBUTTON1", ;
		SWLOOKUPBUTTON2.Name = "SWLOOKUPBUTTON2", ;
		TXTBEGID.clistexpression = investor.cOwnerID, ;
		TXTBEGID.clistworkarea = investor, ;
		TXTBEGID.Name = "TXTBEGID", ;
		TXTBEGNAME.Name = "TXTBEGNAME", ;
		TXTENDID.clistexpression = investor.cOwnerID, ;
		TXTENDID.clistworkarea = investor, ;
		TXTENDID.Name = "TXTENDID", ;
		TXTENDNAME.Name = "TXTENDNAME"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />
	
	PROCEDURE builddata
		LOCAL tcOwner1, tcOwner2, tdDate1, tdDate2, tcReport, tlAcctDesc, tlPayments, tlGroup
		
		tcOwner1  = THISFORM.swrptlook1.txtBegID.VALUE
		tcOwner2  = THISFORM.swrptlook1.txtEndID.VALUE
		tdDate1   = THISFORM.swdate1.VALUE
		tdDate2   = THISFORM.swDate2.VALUE
		tcReport  = THISFORM.cReport
		tlAcctDesc = options.lAcctDesc  &&  Whether to match up the description with ccateg or cdescrip in expcat
		tlPayments = THISFORM.chklPayments.VALUE
		tlGroup   = THISFORM.swgroup1.VALUE
		llSelected  = THISFORM.chkselected.VALUE
		
		IF NOT llSelected
		   SELECT cownerid AS cid FROM investor ;
		      INTO CURSOR SELECTED ;
		      WHERE BETWEEN(cownerid,tcOwner1,tcOwner2) ;
		      ORDER BY cid
		ENDIF
		
		THISFORM.cTitle1 = 'JIB Invoices and Payments Report'
		THISFORM.cTitle2 = 'For Date Range: ' + DTOC(tdDate1)+' - '+DTOC(tdDate2)
		THISFORM.cSelectCriteria = 'Owners: ' + ALLTRIM(tcOwner1) + ' - ' + ALLTRIM(tcOwner2)
		THISFORM.cSortOrder = 'Owner ID'
		
		DO CASE
		   CASE tcReport = 'JP'               && JIB Invoices and Payments Report
		      THISFORM.cReportName = 'dmrojibrpt'
		      IF NOT tlPayments  &&  Payments only, so change report title
		         THISFORM.cTitle1 = 'JIB Invoices and Payments Report'
		      ELSE
		         THISFORM.cTitle1 = 'JIB Payments Report'
		      ENDIF
		
		      CREATE CURSOR jibrpt ;
		         (cCustId     C(10), ;
		         cCustName   C(40), ;
		         cInvNum     C(15), ;
		         dTranDate   D, ;
		         nAmount     N(12,2), ;
		         lPayments   L,  ;
		         cProdYear   C(4), ;
		         cProdPrd    C(2), ;
		         cGroup      C(2), ;
		         cDepositId  C(8), ;
		         cRecType    C(1))
		      INDEX ON cCustId+STR(YEAR(dTranDate))+STR(MONTH(dTranDate))+STR(DAY(dTranDate))+cInvNum+cRecType TAG rptorder
		
		      IF NOT tlPayments  &&  Payments only, so skip invoices
		         SELECT invhdr.cInvNum, ;
		            invhdr.cCustId, ;
		            investor.cOwnName AS cCustName, ;
		            invhdr.dInvDate AS dTranDate, ;
		            invhdr.ninvtot AS nAmount, ;
		            invhdr.cProdYear, ;
		            invhdr.cProdPrd, ;
		            invhdr.cGroup, ;
		            'I' AS cRecType ;
		            FROM invhdr, investor ;
		            WHERE 'J' $ invhdr.cinvtype ;
		            AND invhdr.ccustid in (SELECT cid FROM selected) ;
		            AND BETWEEN(invhdr.dInvDate,tdDate1,tdDate2) ;
		            AND invhdr.cCustId = investor.cownerid ;
		            AND invhdr.ninvtot <> 0 ;
		            AND IIF(tlGroup<>'**',cGroup = tlGroup,.T.)  ;
		            INTO CURSOR temp ;
		            ORDER BY invhdr.cCustId, invhdr.dInvDate
		
		         IF _TALLY > 0
		            SELECT jibrpt
		            APPEND FROM DBF('temp')
		         ENDIF
		      ENDIF
		
		      SELECT arpmthdr.dRecDate AS dTranDate, ;
		         arpmthdr.cCustId, ;
		         investor.cOwnName AS cCustName, ;
		         arpmthdr.cReference AS cDepositId, ;
		         arpmtdet.cInvNum, ;
		         arpmtdet.nAmtApp AS nAmount, ;
		         arpmtdet.dInvDate, ;
		         IIF(tlPayments,.T.,.F.) AS lPayments,  ;
		         'P' AS cRecType ;
		         FROM arpmthdr, arpmtdet, investor ;
		         WHERE arpmthdr.ccustid in (SELECT cid FROM selected) ;
		         AND BETWEEN(arpmthdr.dRecDate,tdDate1,tdDate2) ;
		         AND arpmthdr.cCustId = investor.cownerid ;
		         AND arpmthdr.cBatch = arpmtdet.cBatch ;
		         AND arpmtdet.nAmtApp <> 0 ;
		         AND arpmthdr.cPmtType = 'J'  ;
		         AND IIF(tlGroup<>'**',arpmtdet.cGroup = tlGroup,.T.)  ;
		         INTO CURSOR temp ;
		         ORDER BY arpmthdr.cCustId, arpmtdet.dInvDate
		
		      IF _TALLY > 0
		         SELECT jibrpt
		         APPEND FROM DBF('temp')
		      ENDIF
		
		      SELECT jibrpt
		      IF RECC() > 0
		         RETURN .T.
		      ELSE
		         RETURN .F.
		      ENDIF
		
		   CASE tcReport = 'JE'              && JIB Expense Report
		
		      THISFORM.cReportName = 'dmrojibexp'
		      THISFORM.cTitle1 = 'JIB Expenses by Category'
		      CREATE CURSOR jibrpt ;
		         (cCustId     C(10), ;
		         cCustName   C(40), ;
		         cWellId     C(10), ;
		         cWellname   C(30), ;
		         cCateg      C(25), ;
		         cItemID     C(4),  ;
		         nAmount     N(12,2), ;
		         cTaxCode    C(2), ;
		         cTaxdesc    C(25))
		
		      INDEX ON cCustId+cWellId+cTaxCode TAG rptorder
		
		      SELECT invhdr.cCustId, ;
		         investor.cOwnName     AS cCustName, ;
		         SUM(invdet.nextension) AS nAmount, ;
		         invdet.citemdesc  AS cCateg, ;
		         invdet.cUnitNo    AS cWellId, ;
		         invdet.cItemID  ;
		         FROM invhdr, invdet, investor ;
		         WHERE invhdr.cinvtype = 'J'  ;
		         AND invhdr.ccustid in (SELECT cid FROM selected) ;
		         AND BETWEEN(invhdr.dInvDate,tdDate1,tdDate2) ;
		         AND invhdr.cBatch  = invdet.cBatch ;
		         AND invhdr.cCustId = investor.cownerid ;
		         AND invdet.nextension <> 0 ;
		         AND IIF(tlGroup<>'**',invhdr.cGroup = tlGroup,.T.)  ;
		         INTO CURSOR temp ;
		         ORDER BY invhdr.cCustId, invdet.cItemID, invdet.citemdesc, cWellId ;
		         GROUP BY invhdr.cCustId, invdet.cItemID, invdet.citemdesc, cWellId
		
		      IF _TALLY > 0
		         SELECT jibrpt
		         APPEND FROM DBF('temp')
		      ENDIF
		
		      SELECT jibrpt
		      SET ORDER TO 0
		      SCAN
		         IF cCateg = 'Credit Memo'
		            DELETE
		            LOOP
		         ENDIF
		         m.cCateg = cCateg
		         m.cWellId = cWellId
		         m.cCatCode = cItemID
		
		         swselect('expcat')
		         SET ORDER TO cCatCode
		
		         IF SEEK(m.cCatCode)
		            m.cTaxCode = cTaxCode
		         ELSE
		            m.cTaxCode = 'OE'
		         ENDIF
		         IF EMPTY(m.cTaxCode)
		            m.cTaxCode = 'OE'
		         ENDIF
		         DO CASE
		            CASE m.cTaxCode = 'OE'
		               m.cTaxdesc = '** Operating Expenses **'
		            CASE m.cTaxCode = 'IE'
		               m.cTaxdesc = '** Intangible Expenses **'
		            CASE m.cTaxCode = 'TE'
		               m.cTaxdesc = '** Tangible Expenses **'
		            CASE m.cTaxCode = 'TD'
		               m.cTaxdesc = '** Tangible Drilling **'
		            CASE m.cTaxCode = 'ID'
		               m.cTaxdesc = '** Intangible Drilling **'
		            CASE m.cTaxCode = 'TC'
		               m.cTaxdesc = '** Tangible Completion **'
		            CASE m.cTaxCode = 'IC'
		               m.cTaxdesc = '** Intangible Completion **'
		            CASE m.cTaxCode = 'LC'
		               m.cTaxdesc = '** Leasehold Costs **'
		            OTHERWISE
		               m.cTaxdesc = '** Other Expenses **'
		         ENDCASE
		         swselect('wells')
		         SET ORDER TO cWellId
		         IF SEEK(m.cWellId)
		            m.cWellname = cWellname
		         ELSE
		            m.cWellname = 'Unknown'
		         ENDIF
		         SELECT jibrpt
		         REPLACE cTaxCode  WITH m.cTaxCode, ;
		            cWellname WITH m.cWellname, ;
		            cTaxdesc  WITH m.cTaxdesc
		      ENDSCAN
		
		      SELECT jibrpt
		      SET ORDER TO rptorder
		      IF RECC() > 0
		         RETURN .T.
		      ELSE
		         RETURN .F.
		      ENDIF
		
		ENDCASE
		
	ENDPROC

	PROCEDURE Init
		LPARA tcReport
		DODEFAULT()
		IF TYPE('tcReport') <> 'C'
		   tcReport = 'JP'
		ENDIF
		
		THISFORM.cReport = tcReport
		
		DO CASE
		   CASE tcReport = 'JP'
		      THISFORM.CAPTION = 'JIB Invoices and Payments Report'
		   CASE tcReport = 'JE'
		      THISFORM.CAPTION = 'JIB Expenses by Category Report'
		      THISFORM.chklPayments.VALUE = .F.  &&  Uncheck and hide the option to show payments if doing this report...looks goofy to leave it on there
		      THISFORM.chklPayments.VISIBLE = .F.
		   OTHERWISE
		      THISFORM.CAPTION = 'JIB Invoices and Payments Report'
		      THISFORM.cReport = 'JP'
		ENDCASE
		
		swselect('investor')
		SET ORDER TO cOwnerID
		GO TOP
		
		THISFORM.swrptlook1.txtBegName.VALUE = cSortField
		THISFORM.swrptlook1.txtBegID.VALUE = cOwnerID
		GO BOTTOM
		
		THISFORM.swrptlook1.txtEndName.VALUE = cSortField
		THISFORM.swrptlook1.txtEndID.VALUE = cOwnerID
		
		swselect('invhdr')
		SET ORDER TO dinvdate
		GO TOP
		THISFORM.swdate1.VALUE = dinvdate
		GO BOTT
		THISFORM.swdate2.VALUE = dinvdate
		IF THISFORM.swdate1.VALUE = {}
		   THISFORM.swdate1.VALUE = DATE()-30
		ENDIF
		IF THISFORM.swdate2.VALUE = {}
		   THISFORM.swdate2.VALUE = DATE()
		ENDIF
		
	ENDPROC

	PROCEDURE chkSelected.Click
		IF this.Value
		   DO FORM commonsource\selected-ids WITH 'OWNER' LINKED 
		   lnCount = RECCOUNT('selected')
		   thisform.lblselected.Caption = TRANSFORM(lnCount) + ' Owners Selected'
		   thisform.lblselected.Visible = .T.
		   thisform.lblbegID.Visible = .F.
		   thisform.lblendID.Visible = .F.
		   thisform.swrptlook1.Visible = .F.
		ELSE
		   thisform.lblselected.Visible = .F.
		   thisform.lblbegID.Visible = .T.
		   thisform.lblendID.Visible = .T.
		   thisform.swrptlook1.Visible = .T.
		ENDIF 
	ENDPROC

	PROCEDURE Swrptlook1.SWLOOKUPBUTTON1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,csortfield'
		
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtbegid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cOwnerID
		   thisform.swrptlook1.txtBegName.value = cSortField
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(this.parent.txtBegID)
	ENDPROC

	PROCEDURE Swrptlook1.SWLOOKUPBUTTON2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,csortfield'
		
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtendid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cOwnerID
		   thisform.swrptlook1.txtEndName.value = cSortField
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(this.parent.txtEndID)
	ENDPROC

ENDDEFINE
