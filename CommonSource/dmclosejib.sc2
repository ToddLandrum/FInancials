*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmclosejib.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor28" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 860
	Left = -1
	Name = "Dataenvironment"
	Top = -5
	Width = 1016

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "aropt", ;
		CursorSource = "aropt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "invdet", ;
		BufferModeOverride = 5, ;
		CursorSource = "invdet", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor10", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor11", ;
		Order = "cownerid", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "options", ;
		CursorSource = "options", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor12", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor13' AS cursor WITH ;
		Alias = "terms", ;
		CursorSource = "terms", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor13", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor14' AS cursor WITH ;
		Alias = "taxcodes", ;
		CursorSource = "taxcodes", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor14", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor15' AS cursor WITH ;
		Alias = "vendor", ;
		CursorSource = "vendor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor15", ;
		Order = "cvendorid", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor16' AS cursor WITH ;
		Alias = "wellinv", ;
		CursorSource = "wellinv", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor16", ;
		Top = 620, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor17' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor17", ;
		Top = 620, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor18' AS cursor WITH ;
		Alias = "wellhist", ;
		BufferModeOverride = 5, ;
		CursorSource = "wellhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor18", ;
		Top = 620, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor19' AS cursor WITH ;
		Alias = "disbhist", ;
		BufferModeOverride = 5, ;
		CursorSource = "disbhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor19", ;
		Top = 738, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "arpmthdr", ;
		CursorSource = "arpmthdr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 167, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor20' AS cursor WITH ;
		Alias = "coabal", ;
		BufferModeOverride = 5, ;
		CursorSource = "coabal", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 736, ;
		Name = "Cursor20", ;
		Top = 322, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor21' AS cursor WITH ;
		Alias = "apopt", ;
		CursorSource = "apopt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 423, ;
		Name = "Cursor21", ;
		Top = 299, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor22' AS cursor WITH ;
		Alias = "checks", ;
		BufferModeOverride = 5, ;
		CursorSource = "checks", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 405, ;
		Name = "Cursor22", ;
		Top = 20, ;
		Width = 97
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor23' AS cursor WITH ;
		Alias = "susaudit", ;
		BufferModeOverride = 5, ;
		CursorSource = "susaudit", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 416, ;
		Name = "Cursor23", ;
		Top = 450, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor24' AS cursor WITH ;
		Alias = "prepayh", ;
		BufferModeOverride = 5, ;
		CursorSource = "prepayh", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 762, ;
		Name = "Cursor24", ;
		Top = 20, ;
		Width = 124
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor25' AS cursor WITH ;
		Alias = "revsrc", ;
		CursorSource = "revsrc", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 595, ;
		Name = "Cursor25", ;
		Top = 190, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor26' AS cursor WITH ;
		Alias = "roundtmp", ;
		BufferModeOverride = 5, ;
		CursorSource = "roundtmp", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 570, ;
		Name = "Cursor26", ;
		Top = 380, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor27' AS cursor WITH ;
		Alias = "prepayd", ;
		BufferModeOverride = 5, ;
		CursorSource = "prepayd", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 762, ;
		Name = "Cursor27", ;
		Top = 138, ;
		Width = 124
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor28' AS cursor WITH ;
		Alias = "plugwellbal", ;
		BufferModeOverride = 5, ;
		CursorSource = "plugwellbal", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 850, ;
		Name = "Cursor28", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "expense", ;
		BufferModeOverride = 5, ;
		CursorSource = "expense", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "expcat", ;
		CursorSource = "expcat", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "glmaster", ;
		BufferModeOverride = 5, ;
		CursorSource = "glmaster", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 158, ;
		Name = "Cursor5", ;
		Order = "glbatch", ;
		Top = 227, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "glopt", ;
		CursorSource = "glopt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor6", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "coa", ;
		CursorSource = "coa", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Order = "acctno", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "sysctl", ;
		BufferModeOverride = 5, ;
		CursorSource = "sysctl", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 436, ;
		Name = "Cursor8", ;
		Top = 147, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "invhdr", ;
		BufferModeOverride = 5, ;
		CursorSource = "invhdr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor9", ;
		Order = "cbatch", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formdmclosejib AS frmformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shpshapecustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shpshapecustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblInvDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swyear1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdProcess" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swgroup1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Glmaint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNjibinv" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblNjibinv" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblRunNo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="nrunno" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPostDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblPostDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdInvDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkCompanyShare" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkadvposting" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shpshapecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdExpDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chklBackup" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom5" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: backup		&& Performs a data backup.
		*m: backupnew
		*m: process		&& Performs the JIB close processing
		*m: qbsync		&& Checks to see if files need to be sync'd with QB
		*p: lcloserun
		*p: oprogress
	*</DefinedPropArrayMethod>

	BindControls = .T.
	BufferMode = 2
	Caption = "Close A JIB Run"
	DataSession = 2
	DoCreate = .T.
	Height = 431
	HelpContextID = 115
	Name = "FormDmclosejib"
	oprogress = .NULL.
	oregistry = .NULL.
	Visible = .T.
	Width = 482
	Mwresize1.lblHighLight.Name = "lblHighLight"
	Mwresize1.lblShading.Name = "lblShading"
	Mwresize1.Name = "Mwresize1"

	ADD OBJECT 'chkadvposting' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Advanced Posting", ;
		Left = 312, ;
		Name = "chkadvposting", ;
		TabIndex = 5, ;
		Top = 24, ;
		Value = .F., ;
		ZOrderSet = 20
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkCompanyShare' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Company Share Only", ;
		Left = 312, ;
		Name = "chkCompanyShare", ;
		TabIndex = 6, ;
		Top = 48, ;
		Value = .F., ;
		Visible = .F., ;
		ZOrderSet = 19
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chklBackup' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Backup data files before processing", ;
		Left = 166, ;
		Name = "chklBackup", ;
		TabIndex = 19, ;
		Top = 316, ;
		Value = .T., ;
		ZOrderSet = 25
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'cmdCancel' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Cancel", ;
		Height = 54, ;
		Left = 248, ;
		Name = "cmdCancel", ;
		TabIndex = 21, ;
		Top = 366, ;
		Width = 90, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdProcess' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Process", ;
		Height = 54, ;
		Left = 144, ;
		Name = "cmdProcess", ;
		TabIndex = 20, ;
		Top = 366, ;
		Width = 90, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Glmaint' AS glmaint WITH ;
		Left = 24, ;
		Name = "Glmaint", ;
		Top = 326
		*< END OBJECT: ClassLib="..\custom\swgl.vcx" BaseClass="custom" />

	ADD OBJECT 'lblInvDate' AS lbllabelcustom WITH ;
		Alignment = 1, ;
		AutoSize = .F., ;
		Caption = "Invoice/Posting Date:", ;
		Height = 16, ;
		Left = 55, ;
		Name = "lblInvDate", ;
		TabIndex = 9, ;
		Top = 112, ;
		Width = 143, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Posting Date", ;
		FontBold = .T., ;
		Left = 31, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 12, ;
		Top = 71, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Alignment = 1, ;
		AutoSize = .T., ;
		Caption = "Expenses", ;
		Height = 16, ;
		Left = 133, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 17, ;
		Top = 179, ;
		Width = 50, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom3' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Accounting Date To Use For Processing:", ;
		FontBold = .T., ;
		Left = 31, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 11, ;
		Top = 151, ;
		ZOrderSet = 24
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom4' AS lbllabelcustom WITH ;
		Caption = " Well Group:", ;
		Left = 90, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 13, ;
		Top = 225, ;
		Width = 61, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom5' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Processing Options", ;
		FontBold = .T., ;
		Left = 32, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 23, ;
		Top = 249, ;
		ZOrderSet = 26
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblNjibinv' AS lblfieldlabelcustom WITH ;
		Caption = "Next JIB Invoice Number", ;
		Height = 16, ;
		Left = 38, ;
		Name = "lblNjibinv", ;
		TabIndex = 16, ;
		Top = 286, ;
		Width = 118, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblPeriod' AS lbllabelcustom WITH ;
		Caption = "Run Year", ;
		Left = 150, ;
		Name = "lblPeriod", ;
		TabIndex = 2, ;
		Top = 20, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblPostDate' AS lbllabelcustom WITH ;
		Alignment = 1, ;
		AutoSize = .F., ;
		Caption = "Posting Date:", ;
		Height = 16, ;
		Left = 55, ;
		Name = "lblPostDate", ;
		TabIndex = 8, ;
		Top = 88, ;
		Visible = .F., ;
		Width = 143, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblRunNo' AS lbllabelcustom WITH ;
		Caption = "Run No:", ;
		Left = 158, ;
		Name = "lblRunNo", ;
		TabIndex = 4, ;
		Top = 49, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'nrunno' AS txttextboxcustom WITH ;
		Alignment = 3, ;
		Height = 20, ;
		Left = 203, ;
		Name = "nrunno", ;
		ReadOnly = .T., ;
		TabIndex = 3, ;
		Top = 47, ;
		Value = 0, ;
		Width = 36, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Shpshapecustom1' AS shpshapecustom WITH ;
		Height = 62, ;
		Left = 19, ;
		Name = "Shpshapecustom1", ;
		Top = 156, ;
		Width = 444, ;
		ZOrderSet = 21
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Shpshapecustom2' AS shpshapecustom WITH ;
		Height = 93, ;
		Left = 20, ;
		Name = "Shpshapecustom2", ;
		Top = 255, ;
		Width = 444, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Shpshapecustom3' AS shpshapecustom WITH ;
		Height = 62, ;
		Left = 19, ;
		Name = "Shpshapecustom3", ;
		Top = 76, ;
		Width = 444, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Swgroup1' AS swgroup WITH ;
		Height = 20, ;
		Left = 156, ;
		lexcludeall = .T., ;
		Name = "Swgroup1", ;
		TabIndex = 15, ;
		Top = 223, ;
		Width = 252, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Swyear1' AS swyear WITH ;
		Left = 203, ;
		Name = "Swyear1", ;
		TabIndex = 1, ;
		Top = 18, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtdExpDate' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 202, ;
		Name = "txtdExpDate", ;
		TabIndex = 14, ;
		Top = 177, ;
		Visible = .T., ;
		Width = 75, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtdInvDate' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		lcheckdate = .T., ;
		Left = 203, ;
		lmorethan90 = .T., ;
		Name = "txtdInvDate", ;
		TabIndex = 10, ;
		Top = 110, ;
		Width = 75, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNjibinv' AS txttextboxcustom WITH ;
		ControlSource = "aropt.njibinv", ;
		Height = 20, ;
		InputMask = "999999999999", ;
		Left = 166, ;
		Name = "txtNjibinv", ;
		TabIndex = 18, ;
		Top = 284, ;
		Width = 110, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtPostDate' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		lcheckdate = .T., ;
		Left = 203, ;
		Name = "txtPostDate", ;
		TabIndex = 7, ;
		Top = 85, ;
		Visible = .F., ;
		Width = 75, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />
	
	PROCEDURE Activate
		IF DODEFAULT()
		   SWSELECT('aropt')
		   GO top
		   lnjibinv = njibinv
		   thisform.txtnjibinv.Value = lnjibinv
		   thisform.txtnjibinv.Refresh()
		endif
	ENDPROC

	PROCEDURE backup		&& Performs a data backup.
		LOCAL lcDataPath, lcFileName, lcFolderName, lcBackupPath, lnDataSession
		
		tcYear    = THISFORM.swyear1.VALUE
		tcRunNo   = PADL(ALLT(STR(THISFORM.nRunNo.value)),3,'0')
		
		IF TYPE('m.goApp') = 'O'
		   lcDataPath = ALLT(m.goApp.cDataFilePath)
		   IF NOT ':' $ lcDataPath AND NOT '\\' $ lcDataPath and left(lcDataPath,1) <> '\'
		      lcSavePath = ALLT(CURDIR())
		      lcDataPath = sys(5) + curdir() + lcDataPath
		   ENDIF   
		   lcBackupPath = lcDataPath
		   lcFolderName = lcDataPath
		   lcDataPath = '"'+lcDataPath + '*.*' +'"'
		ELSE
		   lcBackupPath = ALLTRIM(GETDIR())
		   lcDataPath   = lcBackupPath + '*.*'    
		ENDIF
		
		IF NOT '\' $ lcDataPath
		   lcDataPath = 'Data\*.*'
		ENDIF
		
		* Create the backup folders if needed
		IF NOT DIRECTORY(lcbackuppath+'Backups')
		   MD (lcBackupPath+'Backups')
		ENDIF 
		lcBackupPath = lcBackupPath + 'Backups\'
		lcFolder = 'BKJ' + tcYear+tcRunNo 
		IF NOT DIRECTORY(lcBackupPath+lcFolder)
		   MD (lcBackupPath+lcFolder)
		ENDIF    
		lcBackupPath = lcBackupPath + lcFolder
		lcFileName = JUSTPATH(lcDataPath)
		lcFileName   = ALLTRIM(SUBSTR(lcFileName, RAT('\', lcFileName) + 1))  + ;
		                  '_' + ALLT(STR(YEAR(DATE()))) + '_' + ;
		                  PADL(ALLT(STR(MONTH(DATE()))), 2, '0') + '_' ;
		                  + PADL(ALLT(STR(DAY(DATE()))), 2, '0')+ '_'+STRTRAN(TIME(),':','_')+ '.zip'
		lcBackupPath = ADDBS(lcBackupPath)
		
		lnDatasession = SET('datasession')
		* Create the backup
		lnError = swbackup('B', lcFolderName, ALLTRIM(lcFileName), lcBackupPath)
		SET DATASESSION TO (lnDataSession)
		
		DO CASE 
		   CASE lnError = 0 
		      WAIT WIND NOWAIT 'Backup Completed'
		   CASE lnError = 4
		      thisform.oMessage.Display('Backup Encountered Errors. Unable to create backup file.')
		   CASE lnError = 6
		      thisform.oMessage.Display('Backup Encountered Errors. Unable to compress file.')   
		   OTHERWISE 
		      thisform.oMessage.Display('Backup encountered an unknown error. Unable to complete backup.')   
		ENDCASE
		
		
	ENDPROC

	PROCEDURE backupnew
	ENDPROC

	PROCEDURE Error
		LPARAMETERS nerror,cmethod,nline
		
		if nerror <> 1540
		   dodefault(nerror,cmethod,nline)
		endif   
	ENDPROC

	PROCEDURE Init
		* Check for JIB owners in the DOI
		* If none are found, tell about it.
		SELE * FROM wellinv WHERE lJIB = .T. INTO CURSOR temp
		IF _tally = 0
		   *  Even if there's no JIB owners for this group, there could still be JIB-only expcat records.
		   *  Check for them, and let them continue if it finds them.
		   SELECT * FROM expense WHERE cYear <> 'FIXD' AND nrunnojib = 0 AND ccatcode IN  ;
		      (SELECT ccatcode FROM expcat WHERE lJIBOnly)  ;
		      INTO CURSOR JIBOnlyTemp
		   IF _TALLY = 0
		      THISFORM.omessage.severe('There are no JIB owners defined in the division of interests. ' + ;
		         'Owners must be marked with the "JIB Int" check box in order to ' + ;
		         'be invoiced for expenses.')
		      RETURN .F.
		   ENDIF
		ELSE
		   DODEFAULT()
		   IF NOT m.goapp.lAMVersion
		      THISFORM.chkadvposting.VISIBLE = .F.
		   ENDIF
		   THISFORM.txtPostDate.VALUE = DATE()
		   THISFORM.txtPostDate.REFRESH()
		   THISFORM.txtdInvDate.VALUE = DATE()
		   THISFORM.txtdInvDate.REFRESH()
		   THISFORM.txtdexpdate.VALUE = DATE()
		   THISFORM.txtdexpdate.REFRESH()
		
		   THISFORM.swgroup1.LISTITEMID = 1
		   SELECT aropt
		   IF RECC() = 0
		      m.njibinv = 1
		      STORE '' TO m.ccashacct, m.caracct, m.cdiscacct, m.ctaxacct, m.cintacct, m.ccogsacct, ;
		         m.minvmsg, m.cinvnum
		      STORE .F. TO m.lzerobal, m.lnegbal, m.lanyact, m.lminbalck, m.linvdayck
		      m.ninvtype = 2
		      m.ninvday = 1
		      m.nminbal = 0
		      INSERT INTO aropt FROM MEMVAR
		   ENDIF
		   THISFORM.oregistry = findglobalobject('cmregistry')
		   *
		   *  Check to see if we're closing by period or run no
		   *
		   SELE options
		   GO TOP
		   lcYear = STR(YEAR(DATE()),4)
		
		   THIS.nrunno.VISIBLE = .T.
		   THIS.lblrunno.VISIBLE = .T.
		   THIS.lblperiod.CAPTION = 'Run Year:'
		   THIS.CAPTION = 'Close a JIB Run'
		   THIS.nrunno.VALUE = getrunno(lcYear,.T.,'J')
		ENDIF
		
		_VFP.AUTOYIELD = .F.
		
	ENDPROC

	PROCEDURE process		&& Performs the JIB close processing
		LOCAL tcYear, tdInvDate, oJIB, tcOwner1, tcOwner2, tcGroup, llInUse, lcFile
		
		llInUse    = .F.
		tcYear     = THISFORM.swyear1.VALUE
		tdInvDate  = THISFORM.txtdInvDate.VALUE
		tcGroup = LEFT(THISFORM.swgroup1.VALUE,2)
		
		* Check to see if there are any jib owners in this group
		* If not, tell about it.
		SELE wellinv.*, wells.cgroup  FROM wellinv, wells INTO CURSOR temp WHERE wellinv.cwellid == wells.cwellid AND wells.cgroup = tcGroup AND wellinv.lJIB = .T.
		IF RECC() = 0
		   *  Even if there's no JIB owners for this group, there could still be JIB-only expcat records.
		   *  Check for them, and let them continue if it finds them.
		   SELECT * FROM expense WHERE cYear <> 'FIXD' AND nrunnojib = 0 AND ccatcode IN  ;
		      (SELECT ccatcode FROM expcat WHERE lJIBOnly)  ;
		      AND expense.cWellID in(SELECT cwellid FROM wells WHERE cGroup = tcGroup)  ;
		      INTO CURSOR JIBOnlyTemp
		   IF _TALLY = 0
		      THISFORM.omessage.severe('There are no JIB owners defined in the division of interests for this well group. ' + ;
		         'Owners must be marked with the "JIB Int" check box in order to ' + ;
		         'be invoiced.')
		      RETURN
		   ENDIF
		ENDIF
		
		* Check to see if this is the QB version, if so, make sure QB is active
		IF m.goapp.lQBVersion
		   m.goapp.oQB.nDatasession = THISFORM.DATASESSIONID
		   IF NOT m.goapp.oQB.lqbactive
		      THIS.omessage.severe('The QuickBooks link is not active. The JIB run cannot be closed at this time.')
		      RETURN
		   ENDIF
		ENDIF
		
		* Check DOI to see if all used classes total 100%
		IF NOT swdoicheck(tcGroup,.F.,THISFORM.txtdexpDate.VALUE)
		    RETURN
		ENDIF
		
		* Set posting date if we're doing advanced posting
		IF NOT THISFORM.chkadvposting.VALUE
		   tdPostDate = THISFORM.txtdInvDate.VALUE
		ELSE
		   tdPostDate = THISFORM.txtPostDate.VALUE
		ENDIF
		
		*  Make sure the period or year isn't closed
		IF NOT THISFORM.glmaint.CheckPeriod(tdPostDate)
		   THISFORM.omessage.warning('Unable to process the JIB closing. Either the fiscal year or period represented by this date has been closed.')
		   RETURN .F.
		ENDIF
		
		IF THISFORM.chkadvposting.VALUE = .T. AND YEAR(tdInvDate) <> YEAR(tdPostDate)  &&  Don't allow posting/invoice dates in different years.  Can cause problems with 1099 numbers - BH 12/09/2008
		   THISFORM.omessage.warning('You cannot have a posting date in a different year than the invoice date.  Please correct before proceeding.')
		   RETURN
		ENDIF
		
		llInUse = isfilelocked()
		
		IF llInUse
		   IF NOT THIS.omessage.CONFIRM('There are other users logged in at this time. Do you want to continue?')
		      RETURN
		   ENDIF
		ENDIF
		
		*
		*  If we're not closing by run no, make the run no be
		*  the same as the period.
		*
		tnRunNo   = THISFORM.nRunNo.VALUE
		
		IF NOT THISFORM.omessage.CONFIRM('Please confirm the request to close JIB Run ' + tcYear+'/'+ALLT(STR(tnRunNo)))
		   RETURN
		ENDIF
		
		SWSELECT('arpmthdr')
		LOCATE FOR dRecDate = tdInvDate AND cPmtType = 'J'  &&  Find any JIB payments received on this date, and warn them that they won't be included on the statements - BH 07/15/08
		IF FOUND()
		   IF NOT THISFORM.omessage.CONFIRM('There have been JIB payments received using the same date as the JIB invoice date.  These payments will not be included when this run is processed, and will not affect the JIB balances.  Would you like to continue?')
		      RETURN
		   ENDIF
		ENDIF
		
		IF THISFORM.chklBackup.VALUE = .T.
		   THISFORM.backup()
		ENDIF
		
		* Turn FoxAudit auditing off for the close
		IF TYPE('oFoxAudit_APPDATA') = 'O'
		   oFoxAudit_APPDATA.lLogUpdates = .F.
		ENDIF
		
		IF NOT USED('aropt')
		   USE aropt IN 0
		ENDIF
		SELECT aropt
		REPL njibinv WITH THISFORM.txtnjibinv.VALUE
		
		IF NOT USED('investor')
		   USE investor IN 0
		ENDIF
		SELECT investor
		SET ORDER TO cOwnerID
		GO TOP
		tcOwner1  = cOwnerID
		GO BOTT
		tcOwner2  = cOwnerID
		
		*
		*  Call jibproc to create the (jibowner) and (jibwell) cursors
		*
		oJIB = CREATEOBJECT('jibproc',tcOwner1, tcOwner2, ;
		   '01', ;
		   tcYear, ;
		   tcGroup, 'O', tdInvDate, .F., tnRunNo)
		
		oJIB.dExpDate  = THIS.txtdExpDate.VALUE
		oJIB.dPostDate = tdPostDate
		oJIB.CompanyPost = THISFORM.chkCompanyShare.VALUE
		
		oJIB.MAIN(.T.)
		RELE oJIB
		
		THISFORM.nRunNo.VALUE = getrunno(THISFORM.swyear1.VALUE,.T.,'J')
		THISFORM.nRunNo.REFRESH()
		
		THISFORM.SAVE()
		
		* Turn FoxAudit auditing on after the close
		  IF TYPE('oFoxAudit_APPDATA') = 'O'
		     oFoxAudit_APPDATA.lLogUpdates = m.goapp.lAuditTrail
		  ENDIF
		
		
	ENDPROC

	PROCEDURE qbsync		&& Checks to see if files need to be sync'd with QB
		*
		*  Check the files that have a tie-in listid to QuickBooks
		*
		
		*  Wells 
		SELE wells
		SCAN FOR EMPTY(cListID)
		   RETURN .T.
		ENDSCAN
		
		* Owners
		SELE investor
		SCAN FOR EMPTY(cListID)
		   RETURN .T.
		ENDSCAN
		
		* Expense Categories
		SELE expcat
		SCAN FOR EMPTY(cListID)
		   RETURN .T.
		ENDSCAN
		
		* Terms
		SELE terms
		SCAN FOR EMPTY(cListID)
		   RETURN .T.
		ENDSCAN
		
		* Vendors
		SELE vendor
		SCAN FOR EMPTY(cListID)
		   RETURN .T.
		ENDSCAN
		
		* Everythings synchronized
		RETURN .F.
	ENDPROC

	PROCEDURE Unload
		_VFP.AutoYield = .T.
		
		DODEFAULT()
	ENDPROC

	PROCEDURE chkadvposting.Click
		if this.value
		   thisform.lblInvDate.Top = 114
		   thisform.txtdinvDate.Top = 112
		   thisform.lblpostdate.visible = .t.
		   thisform.txtPostDate.visible = .t.
		   thisform.txtdinvDate.lcheckdate = .f.
		   thisform.chkcompanyshare.visible = .t.
		   thisform.lblInvDate.caption = 'Invoice Date:'
		else
		   thisform.lblInvDate.Top = 101
		   thisform.txtdinvDate.Top = 99
		   thisform.lblpostdate.visible = .f.
		   thisform.txtPostDate.visible = .f.
		   thisform.chkcompanyshare.visible = .f.
		   thisform.txtdinvDate.lcheckdate = .t.
		   thisform.lblInvDate.caption = 'Invoice/Posting Date:'
		endif   
	ENDPROC

	PROCEDURE chkCompanyShare.Click
		thisform.txtdinvDate.lcheckdate = this.value
		
	ENDPROC

	PROCEDURE cmdCancel.Click
		thisform.release()
	ENDPROC

	PROCEDURE cmdProcess.Click
		thisform.process()
	ENDPROC

	PROCEDURE nrunno.When
		RETURN .F.
	ENDPROC

	PROCEDURE Swyear1.Valid
		IF between(this.value,'1970','2099')
		   if len(allt(this.value)) = 4
		      thisform.nrunno.value = getrunno(this.value,.t.,'J')
		   else
		      wait wind nowait 'Invalid Year Entered...'
		      return 0
		   endif
		else
		   wait wind nowait 'Invalid Year Entered...'
		   return 0
		ENDIF
		   
	ENDPROC

	PROCEDURE txtdExpDate.dropdown
		DODEFAULT()
		thisform.setnextcontrol(this)
		
	ENDPROC

	PROCEDURE txtdInvDate.LostFocus
		IF DODEFAULT()
		   thisform.txtdexpDate.Value = this.Value
		   thisform.txtdExpDate.Refresh()
		ENDIF 
	ENDPROC

	PROCEDURE txtdInvDate.Refresh
		this.cvaluesource = 'this.value'
		DODEFAULT()
	ENDPROC

	PROCEDURE txtPostDate.Refresh
		this.cvaluesource = 'this.value'
		DODEFAULT()
	ENDPROC

ENDDEFINE
