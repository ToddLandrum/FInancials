*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrojibdist.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor11" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 423
	Left = -4
	Name = "Dataenvironment"
	Top = 57
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "groups", ;
		CursorSource = "groups", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "wellinv", ;
		CursorSource = "wellinv", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor10", ;
		Top = 380, ;
		Width = 101
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "disbhist", ;
		CursorSource = "disbhist", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor11", ;
		Top = 380, ;
		Width = 101
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "expense", ;
		CursorSource = "expense", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "income", ;
		CursorSource = "income", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "expcat", ;
		CursorSource = "expcat", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 136, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "taxcodes", ;
		CursorSource = "taxcodes", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 291, ;
		Name = "Cursor6", ;
		Top = 136, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "sysctl", ;
		CursorSource = "sysctl", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "wellhist", ;
		CursorSource = "wellhist", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor8", ;
		Top = 260, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor9", ;
		Top = 260, ;
		Width = 101
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Relation1' AS relation WITH ;
		ChildAlias = "wellhist", ;
		ChildOrder = "cwellid", ;
		Name = "Relation1", ;
		ParentAlias = "wells", ;
		RelationalExpr = "cwellid"
		*< END OBJECT: BaseClass="relation" />

ENDDEFINE

DEFINE CLASS formdmrojibdist AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="lblBegPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swperiod1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swyear1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swperiod2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblLastWell" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblFirstWell" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swyear2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chklDetail" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblClass" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboClass" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgType" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: lexcludeall
		*p: nsaveddatasess		&& The original datasetssion id
	*</DefinedPropArrayMethod>

	Caption = "Owner JIB Summary"
	DataSession = 2
	DoCreate = .T.
	Height = 352
	Name = "FormDMroJIBDist"
	Width = 375
	Swrptcriteriabuttons1.chkSendFile.Alignment = 0
	Swrptcriteriabuttons1.chkSendFile.Name = "chkSendFile"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 57
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 17
	Swrptcriteriabuttons1.Top = 276
	Swrptcriteriabuttons1.ZOrderSet = 0

	ADD OBJECT 'cboClass' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 20, ;
		Left = 92, ;
		Name = "cboClass", ;
		TabIndex = 19, ;
		Top = 243, ;
		Visible = .F., ;
		Width = 216
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'chklDetail' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Show Detail", ;
		Left = 149, ;
		Name = "chklDetail", ;
		TabIndex = 15, ;
		Top = 216, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'lblBegPeriod' AS lbllabelcustom WITH ;
		Caption = "Beginning Period:", ;
		Height = 16, ;
		Left = 175, ;
		Name = "lblBegPeriod", ;
		TabIndex = 7, ;
		Top = 59, ;
		Width = 85, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblBegYear' AS lbllabelcustom WITH ;
		Alignment = 1, ;
		Caption = "Beginning Year:", ;
		Height = 16, ;
		Left = 17, ;
		Name = "lblBegYear", ;
		TabIndex = 6, ;
		Top = 59, ;
		Width = 79, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblClass' AS lbltextcustom WITH ;
		Caption = "Class:", ;
		Left = 51, ;
		Name = "lblClass", ;
		TabIndex = 18, ;
		Top = 245, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndPeriod' AS lbllabelcustom WITH ;
		Caption = "Ending Period:", ;
		Height = 16, ;
		Left = 190, ;
		Name = "lblEndPeriod", ;
		TabIndex = 11, ;
		Top = 86, ;
		Width = 70, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndYear' AS lbllabelcustom WITH ;
		Caption = "Ending Year:", ;
		Height = 16, ;
		Left = 32, ;
		Name = "lblEndYear", ;
		TabIndex = 10, ;
		Top = 86, ;
		Width = 64, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblFirstWell' AS lbllabelcustom WITH ;
		Caption = "First Owner:", ;
		Height = 16, ;
		Left = 38, ;
		Name = "LblFirstWell", ;
		TabIndex = 13, ;
		Top = 117, ;
		Width = 63, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Report Criteria:", ;
		Left = 22, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 3, ;
		Top = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblLastWell' AS lbllabelcustom WITH ;
		Caption = "Last Owner:", ;
		Height = 16, ;
		Left = 38, ;
		Name = "LblLastWell", ;
		TabIndex = 14, ;
		Top = 168, ;
		Width = 63, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgPeriod' AS opgoptiongroupcustom WITH ;
		AutoSize = .T., ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 48, ;
		Left = 106, ;
		Name = "opgPeriod", ;
		TabIndex = 1, ;
		Top = 2, ;
		Width = 92, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Period Range", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 82, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Year", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "Option2", ;
		Option2.Top = 27, ;
		Option2.Width = 42
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'opgType' AS opgoptiongroupcustom WITH ;
		AutoSize = .T., ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 48, ;
		Left = 228, ;
		Name = "opgType", ;
		TabIndex = 2, ;
		Top = 2, ;
		Width = 110, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Production Year", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 96, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Accounting Year", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "Option2", ;
		Option2.Top = 27, ;
		Option2.Width = 100
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Swperiod1' AS swperiod WITH ;
		Left = 267, ;
		MaxLength = 2, ;
		Name = "Swperiod1", ;
		TabIndex = 5, ;
		Top = 57, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swperiod2' AS swperiod WITH ;
		Left = 267, ;
		MaxLength = 2, ;
		Name = "Swperiod2", ;
		TabIndex = 9, ;
		Top = 84, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 105, ;
		Name = "Swrptlook1", ;
		TabIndex = 12, ;
		Top = 112, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = investor.cownerid, ;
		txtBegID.clistworkarea = investor, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = investor.cownerid, ;
		txtEndID.clistworkarea = Investor, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'Swyear1' AS swyear WITH ;
		InputMask = "9999", ;
		Left = 105, ;
		MaxLength = 4, ;
		Name = "Swyear1", ;
		TabIndex = 4, ;
		Top = 57, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swyear2' AS swyear WITH ;
		InputMask = "9999", ;
		Left = 105, ;
		MaxLength = 4, ;
		Name = "Swyear2", ;
		TabIndex = 8, ;
		Top = 84, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcGroup, lcBegID, lcEndID, lcBegYear, lcEndYear, lcBegPeriod, lcEndPeriod, lncriteria
		LOCAL lcWhere, lcWhere2, lcWhere3, lcWhere4, lcOwnName
		
		IF USED('classtmp')
		   USE IN classtmp
		ENDIF
		
		IF USED('classtemp')
		   USE IN classtemp
		ENDIF
		
		IF USED('exptmp')
		   USE IN exptmp
		ENDIF
		
		IF USED('oetmp')
		   USE IN OEtmp
		ENDIF
		
		IF USED('ictmp')
		   USE IN ICtmp
		ENDIF
		
		IF USED('tctmp')
		   USE IN TCtmp
		ENDIF
		
		IF USED('lctmp')
		   USE IN LCtmp
		ENDIF
		
		IF USED('mitmp')
		   USE IN MItmp
		ENDIF
		
		IF USED('taxtmp')
		   USE IN taxtmp
		ENDIF
		
		IF USED('inctmp')
		   USE IN inctmp
		ENDIF
		
		SELE wells
		SET ORDER TO cwellid
		GO TOP
		lcbegwell = cwellid
		GO BOTT
		lcendwell = cwellid
		
		lcBegID     = THISFORM.Swrptlook1.txtBegID.VALUE
		lcEndID     = THISFORM.Swrptlook1.txtEndID.VALUE
		lcBegYear   = THISFORM.swYear1.VALUE
		lcEndYear   = THISFORM.swYear2.VALUE
		lcBegPeriod = THISFORM.swPeriod1.VALUE
		lcEndPeriod = THISFORM.swPeriod2.VALUE
		lncriteria  = THISFORM.opgperiod.VALUE
		lnType      = THISFORM.opgType.VALUE
		
		CREATE CURSOR classtmp  ;
		   (cownerid    c(10), ;
		   cownname    c(40), ;
		   cwellid     c(10),     ;
		   cwellname   c(40),    ;
		   cgroup      c(2),     ;
		   cdesc1      c(30), ;
		   ncode1      N(12,2),  ;
		   cdesc2      c(30), ;
		   ncode2      N(12,2),  ;
		   cdesc3      c(30), ;
		   ncode3      N(12,2),  ;
		   cdesc4      c(30), ;
		   ncode4      N(12,2),  ;
		   cdesc5      c(30), ;
		   ncode5      N(12,2),  ;
		   cdesc6      c(30), ;
		   ncode6      N(12,2))
		INDEX ON cownerid+cwellid TAG owner
		
		THISFORM.cTitle1 = 'Owner JIB Summary'
		
		IF lncriteria = 1
		   IF lnType = 1
		      THISFORM.cTitle2 = 'For Production Period Range: ' + lcBegYear+'/'+lcBegPeriod + ' - ' + lcEndYear+'/'+lcEndPeriod
		   ELSE
		      THISFORM.cTitle2 = 'For Accounting Period Range: ' + lcBegYear+'/'+lcBegPeriod + ' - ' + lcEndYear+'/'+lcEndPeriod
		   ENDIF
		ELSE
		   IF lnType = 1
		      THISFORM.cTitle2 = 'For Production Year: ' + lcBegYear
		   ELSE
		      THISFORM.cTitle2 = 'For Accounting Year: ' + lcBegYear
		   ENDIF
		ENDIF
		
		THISFORM.cSortOrder = 'Well ID'
		
		IF lncriteria = 1  &&  Period Range
		   IF lnType = 1
		      lcWhere2 = 'between(expense.cyear+expense.cPeriod,lcBegYear+lcBegPeriod,lcEndYear+lcEndPeriod)'
		      lcWhere3 = 'between(disbhist.hyear+disbhist.hPeriod,lcBegYear+lcBegPeriod,lcEndYear+lcEndPeriod)'
		      lcWhere4 = 'between(wellhist.hyear+wellhist.hPeriod,lcBegYear+lcBegPeriod,lcEndYear+lcEndPeriod)'
		   ELSE
		      lcWhere2 = 'between(expense.cAcctYear+Expense.cAcctPrd,lcBegYear+lcBegPeriod,lcEndYear+lcEndPeriod)'
		      lcWhere3 = 'between(year(disbhist.hdate),val(lcBegYear),val(lcEndYear)) and between(month(disbhist.hdate),val(lcBegPeriod),Val(lcEndPeriod))'
		      lcWhere4 = 'between(year(wellhist.hdate),val(lcBegYear),val(lcEndYear)) and between(month(wellhist.hdate),val(lcBegPeriod),Val(lcEndPeriod))'
		   ENDIF
		ELSE  &&  Year
		   IF lnType = 1
		      lcWhere2 = 'expense.cYear = lcBegYear'
		      lcWhere3 = 'disbhist.hYear = lcBegYear'
		      lcWhere4 = 'wellhist.hYear = lcBegYear'
		      lcBegPeriod = '01'
		      lcEndPeriod = '12'
		   ELSE
		      lcWhere2 = 'expense.cAcctYear = lcBegYear'
		      lcWhere3 = 'year(disbhist.hdate) = val(lcBegYear)'
		      lcWhere4 = 'year(wellhist.hdate) = val(lcBegYear)'
		      lcBegPeriod = '01'
		      lcEndPeriod = '12'
		   ENDIF
		ENDIF
		
		SELECT wells.cwellid,  ;
		   cwellname  ;
		   FROM wells  ;
		   INTO CURSOR welltmp  ;
		   WHERE BETWEEN(wells.cwellid,lcbegwell,lcendwell)
		
		WAIT WIND NOWAIT 'Building Report....Please Wait'
		
		CREATE CURSOR exptemp ;
		   (cownerid   c(10), ;
		   cownname   c(40), ;
		   cwellid    c(10), ;
		   cwellname  c(30), ;
		   cperiod    c(2), ;
		   cyear      c(4), ;
		   dexpdate   d, ;
		   crefid     c(20), ;
		   cpayee     c(40), ;
		   ccateg     c(20), ;
		   ccatcode   c(4), ;
		   ctaxcode   c(2), ;
		   cexpclass  c(1), ;
		   ctaxdesc   c(30), ;
		   namount    N(12,2))
		INDEX ON cownerid+cwellid+ctaxcode+cyear+cperiod+cpayee+ccateg TAG myindex
		
		IF THISFORM.chklDetail.VALUE  &&  If a detail report is requested
		   SELECT expense.namount,  ;  &&  Expense Info
		   expense.cwellid,  ;
		      wells.cwellname,  ;
		      expense.cperiod,  ;
		      expense.cyear,  ;
		      expense.dexpdate,  ;
		      expense.crefid,  ;
		      expense.cpayee,  ;
		      expense.ccateg,  ;
		      expense.ccatcode,  ;
		      expense.cRunYearJIB,  ;
		      expense.nRunNoJIB,  ;
		      expcat.ctaxcode,  ;
		      expcat.cexpclass,  ;
		      taxcodes.cDesc AS ctaxdesc  ;
		      FROM expense, expcat, taxcodes, wells  ;
		      INTO CURSOR exptmp  ;
		      WHERE expense.cwellid = wells.cwellid  ;
		      AND BETWEEN(expense.cwellid,lcbegwell,lcendwell)  ;
		      AND expense.ccatcode <> 'MKTG' ;
		      AND expense.ccatcode = expcat.ccatcode  ;
		      AND &lcWhere2  ;
		      AND taxcodes.ctaxcode = expcat.ctaxcode
		
		   IF USED('exptmp1')
		      USE IN exptmp1
		   ENDIF
		   USE DBF('exptmp') AGAIN IN 0 ALIAS exptmp1
		
		   SELE exptmp1
		   IF THISFORM.cboclass.VALUE <> '**'
		      DELE FOR ctaxcode <> THISFORM.cboclass.VALUE
		   ENDIF
		
		
		
		   SELE investor
		   SCAN FOR BETWEEN(cownerid,lcBegID,lcEndID)
		      SELE exptmp1
		      SCAN
		         SCATTER MEMVAR
		         SELE disbhist
		         lDelete = .T.
		         LOCATE FOR cownerid==investor.cownerid AND cwellid = exptmp1.cwellid AND &lcWhere3 AND ctypeinv = 'W' AND cRunYear = m.cRunYearJIB AND nRunNo = m.nRunNoJIB AND cRecType = 'J'
		
		         IF FOUND()
		            lDelete = .F.
		            SCATTER MEMVAR
		            DO CASE
		               CASE m.cexpclass = '0'
		                  m.namount = ROUND(m.namount * (m.nworkint/100),2)
		               CASE m.cexpclass = '1'
		                  m.namount = ROUND(m.namount * (m.nintclass1/100),2)
		               CASE m.cexpclass = '2'
		                  m.namount = ROUND(m.namount * (m.nintclass2/100),2)
		               CASE m.cexpclass = '3'
		                  m.namount = ROUND(m.namount * (m.nintclass3/100),2)
		               CASE m.cexpclass = '4'
		                  m.namount = ROUND(m.namount * (m.nintclass4/100),2)
		               CASE m.cexpclass = '5'
		                  m.namount = ROUND(m.namount * (m.nintclass5/100),2)
		               CASE m.cexpclass = 'A'
		                  m.namount = ROUND(m.namount * (m.nacpint/100),2)
		               CASE m.cexpclass = 'B'
		                  m.namount = ROUND(m.namount * (m.nbcpint/100),2)
		            ENDCASE
		
		            m.cownname = investor.cownname
		            m.cownerid = investor.cownerid
		
		            INSERT INTO exptemp FROM MEMVAR
		         ENDIF
		      ENDSCAN
		   ENDSCAN
		ELSE  &&  No detail
		
		   THISFORM.cReportName = 'dmrojibdist1.frx'
		   SELE investor
		   SCAN FOR BETWEEN(cownerid,lcBegID,lcEndID)
		      m.cownerid = cownerid
		      m.cownname = cownname
		      SELE welltmp
		      SCAN
		         SELECT SUM(expense.namount) AS namount,  ;  &&  Expense Info
		         expense.cwellid, ;
		            wells.cwellname, ;
		            expense.ccatcode,  ;
		            expcat.ctaxcode,  ;
		            expcat.cexpclass,  ;
		            taxcodes.cDesc AS ctaxdesc  ;
		            FROM expense, expcat, taxcodes, wells  ;
		            INTO CURSOR exptmp  ;
		            WHERE expense.cwellid = welltmp.cwellid  ;
		            AND expense.cwellid = wells.cwellid ;
		            AND expense.ccatcode <> 'MKTG' ;
		            AND expense.ccatcode = expcat.ccatcode  ;
		            AND expcat.ctaxcode = taxcodes.ctaxcode  ;
		            AND &lcWhere2  ;
		            AND taxcodes.ctaxcode = expcat.ctaxcode ;
		            ORDER BY expense.cwellid, expcat.ctaxcode, expcat.cexpclass ;
		            GROUP BY expense.cwellid, expcat.ctaxcode, expcat.cexpclass
		
		         SELE exptmp
		         SCAN FOR cwellid == welltmp.cwellid
		            SCATTER MEMVAR
		            SELE wellinv
		            lDelete = .T.
		            lnAmount = 0
		            SCAN FOR cownerid = m.cownerid AND cwellid = welltmp.cwellid AND ctypeinv='W'
		               lDelete = .F.
		               SCATTER MEMVAR
		               DO CASE
		                  CASE m.cexpclass = '0'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nworkint/100),2)
		                  CASE m.cexpclass = '1'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nintclass1/100),2)
		                  CASE m.cexpclass = '2'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nintclass2/100),2)
		                  CASE m.cexpclass = '3'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nintclass3/100),2)
		                  CASE m.cexpclass = '4'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nintclass4/100),2)
		                  CASE m.cexpclass = '5'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nintclass5/100),2)
		                  CASE m.cexpclass = 'A'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nbcpint/100),2)
		                  CASE m.cexpclass = 'B'
		                     m.namount = lnAmount + ROUND(m.namount * (m.nacpint/100),2)
		               ENDCASE
		            ENDSCAN
		
		            INSERT INTO exptemp FROM MEMVAR
		
		         ENDSCAN
		
		         lncode = 1
		         SELE taxcodes
		         SCAN
		            SCATTER MEMVAR
		            lccode = 'm.ncode' + ALLT(STR(lncode))
		            lcdesc = 'm.cdesc' + ALLT(STR(lncode))
		
		            DO CASE
		               CASE lncode = 1
		                  m.cdesc1 = m.cDesc
		               CASE lncode = 2
		                  m.cdesc2 = m.cDesc
		               CASE lncode = 3
		                  m.cdesc3 = m.cDesc
		               CASE lncode = 4
		                  m.cdesc4 = m.cDesc
		               CASE lncode = 5
		                  m.cdesc5 = m.cDesc
		               CASE lncode = 6
		                  m.cdesc6 = m.cDesc
		            ENDCASE
		
		            SELE exptemp
		            SUM namount  TO &lccode FOR ctaxcode = m.ctaxcode AND cwellid == welltmp.cwellid AND exptemp.cownerid==investor.cownerid
		            lncode = lncode + 1
		
		         ENDSCAN
		
		         INSERT INTO classtmp FROM MEMVAR
		         STORE 0 TO m.ncode1, m.ncode2, m.ncode3, m.ncode4, m.ncode5, m.ncode6
		
		      ENDSCAN
		   ENDSCAN
		ENDIF
		
		WAIT CLEAR
		
		IF THISFORM.chklDetail.VALUE
		   THISFORM.cReportName = 'dmrojibdist3'
		   THISFORM.cSortOrder = 'Tax Code, Well ID'
		   SELECT exptemp
		   COUNT FOR NOT DELETED() TO lnCount
		   IF lnCount > 0
		      RETURN .T.
		   ELSE
		      RETURN .F.
		   ENDIF
		ELSE
		   SELECT classtmp
		   COUNT FOR NOT DELETED() TO lnCount
		   IF lnCount > 0
		      RETURN .T.
		   ELSE
		      RETURN .F.
		   ENDIF
		ENDIF
		
	ENDPROC

	PROCEDURE Init
		IF DODEFAULT()
		   SET DELETED ON
		   SELECT investor
		   SET ORDER TO cownerid
		
		   GO TOP
		   THISFORM.swrptlook1.txtBegName.VALUE = csortfield
		   THISFORM.swrptlook1.txtBegID.VALUE = cownerid
		
		   GO BOTTOM
		   THISFORM.swrptlook1.txtEndName.VALUE = csortfield
		   THISFORM.swrptlook1.txtEndID.VALUE = cownerid
		
		   THISFORM.opgPeriod.value = 1
		
		      
		   THISFORM.swYear1.VALUE = allt(str(year(date())-1))
		   THISFORM.swPeriod1.VALUE = '01'
		   THISFORM.swYear2.VALUE = allt(str(year(date())-1))
		   THISFORM.swPeriod2.VALUE = '12'
		ENDIF
		
		
	ENDPROC

	PROCEDURE cboClass.Init
		
		this.addlistitem['** - All Classes',1,1]
		THIS.Addlistitem['**',1,2]
		
		sele ctaxcode, cdesc from taxcodes into cursor tempcodes order by ctaxcode
		
		lnx = 2
		sele tempcodes
		scan
		   scatter memvar
		   this.addlistitem(m.cdesc,lnx,1)
		   this.addlistitem(m.ctaxcode,lnx,2)
		   lnx = lnx + 1
		endscan
		   
		this.listitemid = 1
		
		dodefault()
	ENDPROC

	PROCEDURE chklDetail.Click
		IF THIS.VALUE
		   thisform.lblClass.visible = .t.
		   thisform.cboClass.visible = .t.
		ELSE
		   thisform.lblClass.visible = .f.
		   thisform.cboClass.visible = .f.
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE opgPeriod.Init
		IF DODEFAULT()
		   THIS.VALUE = 1
		ENDIF
		
	ENDPROC

	PROCEDURE opgPeriod.Option1.Click
		THISFORM.swperiod1.SET('visible',.T.)
		THISFORM.swyear2.SET('visible',.T.)
		THISFORM.swperiod2.SET('visible',.T.)
		THISFORM.lblBegyear.CAPTION = 'Beginning Year:'
		THISFORM.lblBegPeriod.VISIBLE = .T.
		THISFORM.lblEndYear.VISIBLE = .T.
		THISFORM.lblEndPeriod.VISIBLE = .T.
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE opgPeriod.Option2.Click
		THISFORM.swperiod1.SET('visible',.F.)
		THISFORM.swyear2.SET('visible',.F.)
		THISFORM.swperiod2.SET('visible',.F.)
		THISFORM.lblBegyear.CAPTION = 'Year:'
		THISFORM.lblBegPeriod.VISIBLE = .F.
		THISFORM.lblEndYear.VISIBLE = .F.
		THISFORM.lblEndPeriod.VISIBLE = .F.
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE opgType.Init
		IF DODEFAULT()
		   THIS.VALUE = 1
		ENDIF
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,csortfield'
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtBegId.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cownerid
		   thisform.swrptlook1.txtBegName.value = csortfield
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,csortfield'
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtEndId.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cownerid
		   thisform.swrptlook1.txtEndName.value = csortfield
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

ENDDEFINE
