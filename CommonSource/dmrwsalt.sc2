*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrwsalt.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 158
	Left = 10
	Name = "Dataenvironment"
	Top = 451
	Width = 523

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "groups", ;
		CursorSource = "groups", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 108, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "vendor", ;
		CursorSource = "vendor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 206, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "wellhist", ;
		CursorSource = "wellhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 304, ;
		Name = "Cursor4", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "expense", ;
		CursorSource = "expense", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 401, ;
		Name = "Cursor5", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formdmrwsalt AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="OpgReportCriteria" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblProdYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblGroup" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPeriod2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="swgroup1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgReportOn" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />

	Caption = "Salt Water Reports"
	DataSession = 2
	DoCreate = .T.
	Height = 542
	HelpContextID = 207
	Name = "FormDmrwsalt"
	Width = 515
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.CMDPREVIEW.Name = "CMDPREVIEW"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 140
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 20
	Swrptcriteriabuttons1.Top = 468

	ADD OBJECT 'chkSelected' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Choose Selected Wells", ;
		Left = 181, ;
		Name = "chkSelected", ;
		TabIndex = 13, ;
		Top = 250, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'lblBegID' AS lbllabelcustom WITH ;
		Alignment = 1, ;
		AutoSize = .T., ;
		Caption = "First Well:", ;
		Height = 16, ;
		Left = 121, ;
		Name = "lblBegID", ;
		TabIndex = 15, ;
		Top = 279, ;
		Width = 49
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndID' AS lbllabelcustom WITH ;
		Alignment = 1, ;
		AutoSize = .T., ;
		Caption = "Last Well:", ;
		Height = 16, ;
		Left = 121, ;
		Name = "lblEndID", ;
		TabIndex = 16, ;
		Top = 330, ;
		Width = 49
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblGroup' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Group:", ;
		Height = 16, ;
		Left = 135, ;
		Name = "LblGroup", ;
		TabIndex = 19, ;
		Top = 387, ;
		Width = 35
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Sort By:", ;
		Height = 16, ;
		Left = 129, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 2, ;
		Top = 48, ;
		Width = 41
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "Period:", ;
		Left = 228, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 8, ;
		Top = 179
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom3' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Ending Year:", ;
		Height = 16, ;
		Left = 106, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 11, ;
		Top = 210, ;
		Width = 64
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom4' AS lbllabelcustom WITH ;
		Caption = "Period:", ;
		Left = 228, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 12, ;
		Top = 210
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom5' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Base Report On:", ;
		Height = 16, ;
		Left = 88, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 4, ;
		Top = 122, ;
		Width = 82
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblProdYear' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Beginning Year:", ;
		Height = 16, ;
		Left = 91, ;
		Name = "LblProdYear", ;
		TabIndex = 7, ;
		Top = 179, ;
		Width = 79
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Caption = "All IDs Selected", ;
		ForeColor = 0,0,255, ;
		Left = 180, ;
		Name = "lblSelected", ;
		TabIndex = 18, ;
		Top = 315, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'OpgReportCriteria' AS opgoptiongroupcustom WITH ;
		BorderStyle = 0, ;
		ButtonCount = 3, ;
		Height = 68, ;
		Left = 174, ;
		Name = "OpgReportCriteria", ;
		TabIndex = 1, ;
		Top = 42, ;
		Value = 1, ;
		Width = 96, ;
		Option1.Caption = " Well ID", ;
		Option1.FontSize = 8, ;
		Option1.Height = 17, ;
		Option1.Left = 5, ;
		Option1.Name = "cWellID", ;
		Option1.Top = 5, ;
		Option1.Value = 1, ;
		Option1.Width = 127, ;
		Option2.Caption = " Well Name", ;
		Option2.FontSize = 8, ;
		Option2.Height = 17, ;
		Option2.Left = 5, ;
		Option2.Name = "WellName", ;
		Option2.Top = 25, ;
		Option2.Width = 115, ;
		Option3.Caption = "Vendor ID", ;
		Option3.FontSize = 8, ;
		Option3.Height = 17, ;
		Option3.Left = 5, ;
		Option3.Name = "VendorID", ;
		Option3.Top = 45, ;
		Option3.Width = 103
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'opgReportOn' AS opgoptiongroupcustom WITH ;
		AutoSize = .T., ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 46, ;
		Left = 174, ;
		Name = "opgReportOn", ;
		TabIndex = 3, ;
		Top = 116, ;
		Value = 1, ;
		Width = 110, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Production Year", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "cWellID", ;
		Option1.Top = 5, ;
		Option1.Value = 1, ;
		Option1.Width = 96, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Accounting Year", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "WellName", ;
		Option2.Top = 25, ;
		Option2.Width = 100
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'swgroup1' AS swgroup WITH ;
		Left = 178, ;
		Name = "swgroup1", ;
		TabIndex = 17, ;
		Top = 385
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 180, ;
		Name = "Swrptlook1", ;
		TabIndex = 14, ;
		Top = 276, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = wells.cwellid, ;
		txtBegID.clistworkarea = wells, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = wells.cwellid, ;
		txtEndID.clistworkarea = wells, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtPeriod1' AS swperiod WITH ;
		Height = 20, ;
		Left = 266, ;
		Name = "txtPeriod1", ;
		TabIndex = 6, ;
		Top = 177, ;
		Width = 24
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtPeriod2' AS swperiod WITH ;
		Height = 20, ;
		Left = 266, ;
		Name = "txtPeriod2", ;
		TabIndex = 10, ;
		Top = 208, ;
		Width = 24
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear1' AS txttextboxcustom WITH ;
		Alignment = 2, ;
		DateFormat = 0, ;
		Format = "K", ;
		Height = 20, ;
		InputMask = "9999", ;
		Left = 178, ;
		Margin = 1, ;
		Name = "txtYear1", ;
		StrictDateEntry = 1, ;
		TabIndex = 5, ;
		Top = 177, ;
		Value = transform(year(date())), ;
		Width = 40
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear2' AS txttextboxcustom WITH ;
		Alignment = 2, ;
		DateFormat = 0, ;
		Format = "K", ;
		Height = 20, ;
		InputMask = "9999", ;
		Left = 178, ;
		Margin = 1, ;
		Name = "txtYear2", ;
		StrictDateEntry = 1, ;
		TabIndex = 9, ;
		Top = 208, ;
		Value = transform(year(date())), ;
		Width = 40
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcWhere, lcWhereExp, lnReportOn
		
		lnReportOn = thisform.opgReportOn.Value
		
		IF lnReportOn = 1
		   lcWhere = 'BETWEEN(wellhist.hyear+wellhist.hperiod,THISFORM.txtYear1.value+thisform.txtPeriod1.value,thisform.txtYear2.value+thisform.txtPeriod2.value)'
		   lcWhereExp = 'BETWEEN(expense.cyear+expense.cperiod,THISFORM.txtYear1.value+thisform.txtPeriod1.value,thisform.txtYear2.value+thisform.txtPeriod2.value)'
		   thisform.ctitle2 = 'Production Period: ' + thisform.txtperiod1.value+'/'+thisform.txtyear1.value + ' - ' + ;
		       thisform.txtperiod2.value+'/'+thisform.txtyear2.value
		ELSE
		   lcWhere = "BETWEEN(ALLTRIM(STR(YEAR(wellhist.hDate)))+PADL(ALLTRIM(STR(MONTH(wellhist.hDate))),2,'0'),THISFORM.txtYear1.value+thisform.txtPeriod1.value,thisform.txtYear2.value+thisform.txtPeriod2.value)"
		   lcWhereExp = "BETWEEN(ALLTRIM(STR(YEAR(expense.dExpDate)))+PADL(ALLTRIM(STR(MONTH(expense.dExpDate))),2,'0'),THISFORM.txtYear1.value+thisform.txtPeriod1.value,thisform.txtYear2.value+thisform.txtPeriod2.value)"
		   thisform.ctitle2 = 'Accounting Period: ' + thisform.txtperiod1.value+'/'+thisform.txtyear1.value + ' - ' + ;
		       thisform.txtperiod2.value+'/'+thisform.txtyear2.value
		ENDIF 
		
		thisform.ctitle1 = 'Salt Water Report'
		
		DO case
		   CASE thisform.opgReportCriteria.Value = 2
		      thisform.csortorder = 'Well Name'
		   CASE thisform.opgReportCriteria.Value = 3
		      thisform.csortorder = 'Vendor ID'
		   OTHERWISE
		      thisform.csortorder = 'Well ID'
		ENDCASE 
		
		thisform.creportname = 'commonsource\dmrwsalt1'                                   
		thisform.cselectcriteria = 'Well ID: ' + ALLTRIM(thisform.swrptlook1.txtBegID.value) + ' - ' + ALLTRIM(thisform.swrptlook1.txtEndID.value)    
		
		IF THISFORM.swgroup1.value = '**'
		   thisform.cSelectCriteria = thisform.cSelectcriteria + ' in All Groups'
		ENDIF 
		                                   
		IF USED('salttmp')
		   USE IN 'salttmp'
		ENDIF   
		
		tcWellID1 = thisform.swrptlook1.txtbegID.Value
		tcWellID2 = thisform.swrptlook1.txtendID.Value 
		
		llSelected = thisform.chkselected.Value 
		
		IF NOT llSelected
		   SELECT cwellid as cid FROM wells WHERE BETWEEN(cwellid,tcWellID1,tcWellID2) INTO CURSOR selected ORDER BY cid
		ELSE
		   SELECT selected
		   GO top
		   tcWellID1 = cid
		   GO bott
		   tcWellID2 = cid 
		ENDIF 
		                                   
		***********************************************************
		*  If sorting by well ID and no group is specified
		***********************************************************
		
		IF THISFORM.opgReportCriteria.cWellID.value = 1  ;  
		   AND THISFORM.swgroup1.value = '** - All Groups'
		   
		   SELECT wells.cwellname,  ;
		          wellhist.cWellID,  ;
		          IIF(lnReportOn = 1,wellhist.hyear, ALLTRIM(STR(YEAR(wellhist.hDate)))) AS cyear,  ;
		          IIF(lnReportOn = 1,wellhist.hperiod, PADL(ALLTRIM(STR(MONTH(wellhist.hDate))),2,'0')) AS cperiod,  ;
		          wellhist.ntotsalt  ;
		   FROM wells, wellhist  ;
		   INTO CURSOR salttmp  ;
		   WHERE wells.cWellID = wellhist.cWellID  ;
		     AND wellhist.ntotsalt <> 0 ;
		     AND wells.cwellid in (select cid from selected)  ;
		     AND &lcWhere  ;
		   ORDER BY wells.cWellID
		ENDIF 
		
		***********************************************************
		*  If sorting by well ID and a group is specified
		***********************************************************
		
		IF THISFORM.opgReportCriteria.cWellID.value = 1  ;  
		   AND THISFORM.swgroup1.value <> '** - All Groups'
		   
		   SELECT wells.cwellname,  ;
		          groups.cgroup,  ;
		          wellhist.cWellID,  ;
		          IIF(lnReportOn = 1,wellhist.hyear, ALLTRIM(STR(YEAR(wellhist.hDate)))) AS cyear,  ;
		          IIF(lnReportOn = 1,wellhist.hperiod, PADL(ALLTRIM(STR(MONTH(wellhist.hDate))),2,'0')) AS cperiod,  ;
		          wellhist.ntotsalt  ;
		   FROM wells, wellhist, groups  ;
		   INTO CURSOR salttmp  ;
		   WHERE wells.cWellID = wellhist.cWellID  ;
		     AND wellhist.ntotsalt <> 0 ;
		     AND wells.cwellid in (select cid from selected)  ;
		     AND &lcWhere  ;
		     AND wells.cgroup = groups.cgroup  ;
		     AND wells.cgroup = SUBSTR(THISFORM.swgroup1.value,1,2)  ;
		   ORDER BY wells.cWellID
		ENDIF   
		
		***********************************************************
		*  If sorting by Well Name and no group is specified
		***********************************************************   
		
		IF THISFORM.opgReportCriteria.wellname.value = 1  ;  
		   AND THISFORM.swgroup1.value = '** - All Groups'
		   
		   SELECT wells.cwellname,  ;
		          wellhist.cWellID,  ;
		          IIF(lnReportOn = 1,wellhist.hyear, ALLTRIM(STR(YEAR(wellhist.hDate)))) AS cyear,  ;
		          IIF(lnReportOn = 1,wellhist.hperiod, PADL(ALLTRIM(STR(MONTH(wellhist.hDate))),2,'0')) AS cperiod,  ;
		          wellhist.ntotsalt  ;
		   FROM wells, wellhist  ;
		   INTO CURSOR salttmp  ;
		   WHERE wells.cWellID = wellhist.cWellID  ;
		     AND wellhist.ntotsalt <> 0 ;
		     AND wells.cwellid in (select cid from selected)  ;
		     AND &lcWhere  ;
		   ORDER BY wells.cwellname    
		ENDIF 
		
		***********************************************************
		*  If sorting by Well Name and a group is specified
		***********************************************************
		
		IF THISFORM.opgReportCriteria.wellname.value = 1  ;  
		   AND THISFORM.swgroup1.value <> '** - All Groups'
		   
		   SELECT wells.cwellname,  ;
		          groups.cgroup,  ;
		          wellhist.cWellID,  ;
		          IIF(lnReportOn = 1,wellhist.hyear, ALLTRIM(STR(YEAR(wellhist.hDate)))) AS cyear,  ;
		          IIF(lnReportOn = 1,wellhist.hperiod, PADL(ALLTRIM(STR(MONTH(wellhist.hDate))),2,'0')) AS cperiod,  ;
		          wellhist.ntotsalt  ;
		   FROM wells, wellhist, groups  ;
		   INTO CURSOR salttmp  ;
		   WHERE wells.cWellID = wellhist.cWellID  ;
		     AND wellhist.ntotsalt <> 0 ;
		     AND wells.cwellid in (select cid from selected)  ;
		     AND &lcWhere  ;
		     AND wells.cgroup = groups.cgroup  ;
		     AND wells.cgroup = SUBSTR(THISFORM.swgroup1.value,1,2)  ;
		   ORDER BY wells.cwellname
		ENDIF
		
		***********************************************************
		*  If sorting by Vendor ID and no group is specified
		***********************************************************   
		
		IF THISFORM.opgReportCriteria.vendorid.value = 1  ;  
		   AND THISFORM.swgroup1.value = '** - All Groups'
		   
		   SELECT wells.cwellname,  ;
		          expense.cWellID,  ;
		          IIF(lnReportOn = 1,expense.cYear, ALLTRIM(STR(YEAR(expense.dExpDate)))) AS cyear,  ;
		          IIF(lnReportOn = 1,expense.cperiod, PADL(ALLTRIM(STR(MONTH(expense.dExpDate))),2,'0')) AS cperiod,  ;
		          vendor.cvendname,  ;
		          vendor.cvendorid,  ;
		          expense.nsaltwater  ;
		   FROM wells, expense, vendor  ;
		   INTO CURSOR salttmp  ;
		   WHERE wells.cWellID = expense.cWellID  ;
		     AND BETWEEN(vendor.cvendorid, thisform.swrptlook1.txtBegID.value, thisform.swrptlook1.txtEndID.value)  ;
		     AND &lcWhereExp  ;
		     AND vendor.cvendorid = expense.cvendorid  ;
		     AND expense.nsaltwater > 0  ;
		     AND expense.nRunNoRev <> 0  ;  &&  Make it only pick up entries that have been closed, so this report will match the ones that are coming from wellhist - BH 07/15/2008
		   ORDER BY vendor.cvendorid, wells.cWellID
		
		   thisform.creportname = 'commonsource\dmrwsalt2'    
		ENDIF 
		
		***********************************************************
		*  If sorting by Vendor ID and a group is specified
		***********************************************************
		
		IF THISFORM.opgReportCriteria.vendorid.value = 1  ;  
		   AND THISFORM.swgroup1.value <> '** - All Groups'
		   
		   SELECT wells.cwellname,  ;
		          expense.cWellID,  ;
		          IIF(lnReportOn = 1,expense.cYear, ALLTRIM(STR(YEAR(expense.dExpDate)))) AS cyear,  ;
		          IIF(lnReportOn = 1,expense.cperiod, PADL(ALLTRIM(STR(MONTH(expense.dExpDate))),2,'0')) AS cperiod,  ;
		          vendor.cvendname,  ;
		          vendor.cvendorid,  ;
		          expense.nsaltwater,  ;
		          wells.cgroup,  ;
		          groups.cdesc  ;
		   FROM wells, expense, vendor, groups  ;
		   INTO CURSOR salttmp  ;
		   WHERE wells.cWellID = expense.cWellID  ;
		     AND BETWEEN(vendor.cvendorid, thisform.swrptlook1.txtBegID.value, thisform.swrptlook1.txtEndID.value)  ;
			 AND &lcWhereExp  ;
		     AND vendor.cvendorid = expense.cvendorid  ;
		     AND wells.cgroup = groups.cgroup  ;
		     AND groups.cgroup = SUBSTR(thisform.swgroup1.value,1,2)  ;
		     AND expense.nsaltwater > 0  ;
		     AND expense.nRunNoRev <> 0  ;  &&  Make it only pick up entries that have been closed, so this report will match the ones that are coming from wellhist - BH 07/15/2008
		   ORDER BY vendor.cvendorid, wells.cWellID
		   
		   thisform.creportname = 'commonsource\dmrwsalt2'    
		ENDIF 
		      
		SELECT salttmp
		IF RECC() > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF         
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		
		SELECT wells
		SET ORDER TO cWellID
		GO TOP
		
		THISFORM.swrptlook1.txtBegName.VALUE = cwellname
		THISFORM.swrptlook1.txtBegID.VALUE = cWellID
		GO BOTTOM
		
		THISFORM.swrptlook1.txtEndName.VALUE = cwellname
		THISFORM.swrptlook1.txtEndID.VALUE = cWellID
		
		
		
	ENDPROC

	PROCEDURE chkSelected.Click
		IF this.Value
		   DO FORM commonsource\selected-ids WITH 'WELL' LINKED 
		   lnCount = RECCOUNT('selected')
		   thisform.lblselected.Caption = TRANSFORM(lnCount) + ' Wells Selected'
		   thisform.lblselected.Visible = .T.
		   thisform.lblbegID.Visible = .F.
		   thisform.lblendID.Visible = .F.
		   thisform.swrptlook1.Visible = .F.
		ELSE
		   thisform.lblselected.Visible = .F.
		   thisform.lblbegID.Visible = .T.
		   thisform.lblendID.Visible = .T.
		   thisform.swrptlook1.Visible = .T.
		ENDIF 
	ENDPROC

	PROCEDURE OpgReportCriteria.cWellID.Click
		select wells
		set order to cWellID
		go top
		
		thisform.swrptlook1.txtBegName.value = cwellname
		thisform.swrptlook1.txtBegID.value = cWellID
		go bottom
		
		thisform.swrptlook1.txtEndName.value = cwellname
		thisform.swrptlook1.txtEndID.value = cWellID
		
		thisform.lblBegID.caption = 'First Well ID:'
		thisform.lblEndID.caption = 'Last Well ID:'
		
		thisform.swrptlook1.txtBegID.cListExpression = 'wells.cWellID'
		thisform.swrptlook1.txtBegID.cListWorkarea = 'wells'
		thisform.swrptlook1.txtEndID.cListExpression = 'wells.cWellID'
		thisform.swrptlook1.txtEndID.cListWorkarea = 'wells'
		
		thisform.chkselected.Visible = .t.
	ENDPROC

	PROCEDURE OpgReportCriteria.cWellID.GotFocus
		THISFORM.opgReportCriteria.VALUE = 1
		THIS.CLICK()
		
	ENDPROC

	PROCEDURE OpgReportCriteria.VendorID.Click
		SELECT vendor
		SET ORDER TO cvendorid
		GO TOP
		
		THISFORM.swrptlook1.txtBegName.VALUE = cvendname
		THISFORM.swrptlook1.txtBegID.VALUE = cvendorid
		GO BOTTOM
		
		THISFORM.swrptlook1.txtEndName.VALUE = cvendname
		THISFORM.swrptlook1.txtEndID.VALUE = cvendorid
		
		THISFORM.lblBegID.CAPTION = 'First Vendor ID:'
		THISFORM.lblEndID.CAPTION = 'Last Vendor ID:'
		
		THISFORM.swrptlook1.txtBegID.cListExpression = 'vendor.cVendorid'
		THISFORM.swrptlook1.txtBegID.cListWorkarea = 'vendor'
		THISFORM.swrptlook1.txtEndID.cListExpression = 'vendor.cVendorID'
		THISFORM.swrptlook1.txtEndID.cListWorkarea = 'vendor'
		
		thisform.chkSelected.Value = .f.
		THISFORM.chkselected.VISIBLE = .F.
		THISFORM.lblselected.VISIBLE = .F.
		THISFORM.lblBegID.VISIBLE = .T.
		THISFORM.lblEndID.VISIBLE = .T.
		THISFORM.swrptlook1.VISIBLE = .T.
		
	ENDPROC

	PROCEDURE OpgReportCriteria.VendorID.GotFocus
		THISFORM.opgReportCriteria.VALUE = 3
		THIS.CLICK()
		
	ENDPROC

	PROCEDURE OpgReportCriteria.WellName.Click
		select wells
		set order to cwellid
		
		go top
		thisform.swrptlook1.txtBegID.value = cWellID
		thisform.swrptlook1.txtBegName.value = cwellname
		
		go bottom
		thisform.swrptlook1.txtEndName.value = cwellname
		thisform.swrptlook1.txtEndID.value = cWellID
		
		thisform.swrptlook1.txtBegID.cListExpression = 'wells.cWellID'
		thisform.swrptlook1.txtBegID.cListWorkarea = 'wells'
		thisform.swrptlook1.txtEndID.cListExpression = 'wells.cWellID'
		thisform.swrptlook1.txtEndID.cListWorkarea = 'wells'
		
		thisform.chkselected.Visible = .t.
	ENDPROC

	PROCEDURE OpgReportCriteria.WellName.GotFocus
		THISFORM.opgReportCriteria.VALUE = 2
		THIS.CLICK()
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		
		IF THISFORM.opgReportCriteria.VALUE = 1 OR THISFORM.opgReportCriteria.VALUE = 2
		   lcList = 'cwellid,cwellname,cgroup,cwellstat'
		   DO FORM ..\CUSTOM\picklist WITH 'Wells', lcList, THISFORM.swrptlook1.txtbegid.VALUE, 4
		
		   IF llOK
		      THISFORM.swrptlook1.txtbegid.VALUE = cwellid
		      THISFORM.swrptlook1.txtBegName.VALUE = cwellname
		      THISFORM.swrptlook1.txtbegid.REFRESH()
		      THISFORM.swrptlook1.txtBegName.REFRESH()
		   ENDIF
		ELSE
		   lcList = 'cvendorid,cvendname'
		   DO FORM ..\CUSTOM\picklist WITH 'Vendor', lcList, THISFORM.swrptlook1.txtbegid.VALUE, 2
		
		   IF llOK
		      THISFORM.swrptlook1.txtbegid.VALUE = cvendorid
		      THISFORM.swrptlook1.txtBegName.VALUE = cvendname
		      THISFORM.swrptlook1.txtbegid.REFRESH()
		      THISFORM.swrptlook1.txtBegName.REFRESH()
		   ENDIF
		ENDIF
		
		THISFORM.setnextcontrol(THISFORM.swrptlook1.txtbegid)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		IF THISFORM.opgReportCriteria.VALUE = 1 OR THISFORM.opgReportCriteria.VALUE = 2
		   lcList = 'cwellid,cwellname,cgroup,cwellstat'
		   DO FORM ..\CUSTOM\picklist WITH 'Wells', lcList, THISFORM.swrptlook1.txtEndid.VALUE, 4
		
		   IF llOK
		      THISFORM.swrptlook1.txtEndid.VALUE = cwellid
		      THISFORM.swrptlook1.txtEndName.VALUE = cwellname
		      THISFORM.swrptlook1.txtEndid.REFRESH()
		      THISFORM.swrptlook1.txtEndName.REFRESH()
		   ENDIF
		ELSE
		   lcList = 'cvendorid,cvendname'
		   DO FORM ..\CUSTOM\picklist WITH 'Vendor', lcList, THISFORM.swrptlook1.txtEndid.VALUE, 2
		
		   IF llOK
		      THISFORM.swrptlook1.txtEndid.VALUE = cvendorid
		      THISFORM.swrptlook1.txtEndName.VALUE = cvendname
		      THISFORM.swrptlook1.txtEndid.REFRESH()
		      THISFORM.swrptlook1.txtEndName.REFRESH()
		   ENDIF
		ENDIF
		
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

	PROCEDURE txtYear1.Init
		DODEFAULT()
		this.value = STR(YEAR(DATE()),4)
		
	ENDPROC

	PROCEDURE txtYear1.Valid
		IF NOT BETWEEN(this.value,'1900','2099')
		   WAIT WINDOW 'Invalid date entered, please re-enter...'
		   RETURN 0
		ENDIF   
		 
	ENDPROC

	PROCEDURE txtYear2.Init
		DODEFAULT()
		THIS.VALUE = STR(YEAR(DATE()),4)
		
	ENDPROC

	PROCEDURE txtYear2.Valid
		IF NOT BETWEEN(this.value,'1900','2099')
		   WAIT WINDOW 'Invalid date entered, please re-enter...'
		   RETURN 0
		ENDIF   
		 
	ENDPROC

ENDDEFINE
