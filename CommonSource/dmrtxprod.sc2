*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrtxprod.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 346
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "txrrcdata", ;
		CursorSource = "txrrcdata", ;
		Database = ..\datafiles\redhawkdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 104
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\redhawkdata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "land", ;
		CursorSource = "land", ;
		Database = ..\datafiles\redhawkdata\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "fields", ;
		CursorSource = "fields", ;
		Database = ..\datafiles\redhawkdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "options", ;
		CursorSource = "options", ;
		Database = ..\datafiles\redhawkdata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formdmrtxprod AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="txtPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chklCorrected" UniqueID="" Timestamp="" />

	Caption = "Print Texas PR Report"
	DoCreate = .T.
	Height = 335
	HelpContextID = 621
	Name = "FormDmrtxprod"
	Width = 361
	SWRPTCRITERIABUTTONS1.chkExport.Alignment = 0
	SWRPTCRITERIABUTTONS1.chkExport.Name = "chkExport"
	SWRPTCRITERIABUTTONS1.cmdclose.Name = "cmdclose"
	SWRPTCRITERIABUTTONS1.CMDPREVIEW.Name = "CMDPREVIEW"
	SWRPTCRITERIABUTTONS1.CMDPRINT.Name = "CMDPRINT"
	SWRPTCRITERIABUTTONS1.Left = 63
	SWRPTCRITERIABUTTONS1.Name = "SWRPTCRITERIABUTTONS1"
	SWRPTCRITERIABUTTONS1.TabIndex = 11
	SWRPTCRITERIABUTTONS1.Top = 269

	ADD OBJECT 'chklCorrected' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Corrected Report", ;
		Left = 130, ;
		Name = "chklCorrected", ;
		TabIndex = 10, ;
		Top = 219, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Lbltextcustom1' AS lbltextcustom WITH ;
		AutoSize = .T., ;
		Caption = "/", ;
		FontSize = 10, ;
		Left = 150, ;
		Name = "Lbltextcustom1", ;
		TabIndex = 3, ;
		Top = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom2' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Year/Period", ;
		Left = 40, ;
		Name = "Lbltextcustom2", ;
		TabIndex = 4, ;
		Top = 44
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom3' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "First Field", ;
		Left = 51, ;
		Name = "Lbltextcustom3", ;
		TabIndex = 6, ;
		Top = 101
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom4' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Last Field", ;
		Left = 51, ;
		Name = "Lbltextcustom4", ;
		TabIndex = 7, ;
		Top = 152
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 110, ;
		Name = "Swrptlook1", ;
		TabIndex = 5, ;
		Top = 97, ;
		ZOrderSet = 5, ;
		SWLOOKUPBUTTON1.Name = "SWLOOKUPBUTTON1", ;
		SWLOOKUPBUTTON2.Name = "SWLOOKUPBUTTON2", ;
		TXTBEGID.clistexpression = fields.cfieldid, ;
		TXTBEGID.clistworkarea = fields, ;
		TXTBEGID.Name = "TXTBEGID", ;
		TXTBEGNAME.Name = "TXTBEGNAME", ;
		TXTENDID.clistexpression = fields.cfieldid, ;
		TXTENDID.clistworkarea = fields, ;
		TXTENDID.InputMask = "", ;
		TXTENDID.Name = "TXTENDID", ;
		TXTENDNAME.Name = "TXTENDNAME"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtPeriod' AS swperiod WITH ;
		Enabled = .T., ;
		ldefvalue = .T., ;
		Left = 158, ;
		lenabled = .T., ;
		Name = "txtPeriod", ;
		TabIndex = 2, ;
		Top = 42
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtYear' AS swyear WITH ;
		Enabled = .T., ;
		ldefvalue = .T., ;
		Left = 110, ;
		lenabled = .T., ;
		Name = "txtYear", ;
		TabIndex = 1, ;
		Top = 42
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		lcYear   = THISFORM.txtyear.VALUE
		lcPeriod = THISFORM.txtperiod.VALUE
		lcField1 = THISFORM.swrptlook1.txtbegid.VALUE
		lcField2 = THISFORM.swrptlook1.txtendid.VALUE
		llCorrected = THISFORM.chklCorrected.VALUE
		
		SET EXACT ON
		
		DIME lamonth[12]
		lamonth[1] = 'January'
		lamonth[2] = 'February'
		lamonth[3] = 'March'
		lamonth[4] = 'April'
		lamonth[5] = 'May'
		lamonth[6] = 'June'
		lamonth[7] = 'July'
		lamonth[8] = 'August'
		lamonth[9] = 'September'
		lamonth[10] = 'October'
		lamonth[11] = 'November'
		lamonth[12] = 'December'
		
		**  Do the processing to break the selected records into the correct format  **
		CREATE CURSOR txtemp  ;
		   (cp5operno    c(6),  ;
		   crrcdistno    c(4),  ;
		   lCorrected    L,  ;
		   cyear         c(4),  ;
		   cperiod       c(2),  ;
		   cFieldId1     c(10), cFieldName1   c(30), cLeaseID1     c(10), cLeaseName1   c(30),  ;
		   cRRCLeaseNo1  c(20), cComingle1    c(20), nBegVol1      N(4,0), nEndVol1      N(4,0),  ;
		   nOilProd1     N(4,0), nGasProd1     N(4,0), nDispVolume1  N(4,0), cOilDispCode1 c(1),  ;
		   cGasDispCode1 c(1), cFieldId2     c(10), cFieldName2   c(30), cLeaseID2     c(10),  ;
		   cLeaseName2   c(30), cRRCLeaseNo2  c(20), cComingle2    c(20), nBegVol2      N(4,0),  ;
		   nEndVol2      N(4,0), nOilProd2     N(4,0), nGasProd2     N(4,0),  ;
		   nDispVolume2  N(4,0), cOilDispCode2 c(1), cGasDispCode2 c(1), cFieldId3     c(10),  ;
		   cFieldName3   c(30), cLeaseID3     c(10), cLeaseName3   c(30), cRRCLeaseNo3  c(20),  ;
		   cComingle3    c(20), nBegVol3      N(4,0), nEndVol3      N(4,0), nOilProd3     N(4,0),  ;
		   nGasProd3     N(4,0), nDispVolume3  N(4,0), cOilDispCode3 c(1), cGasDispCode3 c(1),  ;
		   cFieldId4     c(10), cFieldName4   c(30), cLeaseID4     c(10), cLeaseName4   c(30),  ;
		   cRRCLeaseNo4  c(20), cComingle4    c(20), nBegVol4      N(4,0), nEndVol4      N(4,0),  ;
		   nOilProd4     N(4,0), nGasProd4     N(4,0), nDispVolume4  N(4,0), cOilDispCode4 c(1),  ;
		   cGasDispCode4 c(1), cFieldId5     c(10), cFieldName5   c(30), cLeaseID5     c(10),  ;
		   cLeaseName5   c(30), cRRCLeaseNo5  c(20), cComingle5    c(20), nBegVol5      N(4,0),  ;
		   nEndVol5      N(4,0), nOilProd5     N(4,0), nGasProd5     N(4,0), nDispVolume5  N(4,0),  ;
		   cOilDispCode5 c(1), cGasDispCode5 c(1), cFieldId6     c(10), cFieldName6   c(30),  ;
		   cLeaseID6     c(10), cLeaseName6   c(30), cRRCLeaseNo6  c(20), cComingle6    c(20),  ;
		   nBegVol6      N(4,0), nEndVol6      N(4,0), nOilProd6     N(4,0), nGasProd6     N(4,0),  ;
		   nDispVolume6  N(4,0), cOilDispCode6 c(1), cGasDispCode6 c(1), cFieldId7     c(10),  ;
		   cFieldName7   c(30), cLeaseID7     c(10), cLeaseName7   c(30), cRRCLeaseNo7  c(20),  ;
		   cComingle7    c(20), nBegVol7      N(4,0), nEndVol7      N(4,0), nOilProd7     N(4,0),  ;
		   nGasProd7     N(4,0), nDispVolume7  N(4,0), cOilDispCode7 c(1), cGasDispCode7 c(1),  ;
		   cFieldId8     c(10), cFieldName8   c(30), cLeaseID8     c(10), cLeaseName8   c(30),  ;
		   cRRCLeaseNo8  c(20), cComingle8    c(20), nBegVol8      N(4,0), nEndVol8      N(4,0),  ;
		   nOilProd8     N(4,0), nGasProd8     N(4,0), nDispVolume8  N(4,0), cOilDispCode8 c(1),  ;
		   cGasDispCode8 c(1), cFieldId9     c(10), cFieldName9   c(30), cLeaseID9     c(10),  ;
		   cLeaseName9   c(30), cRRCLeaseNo9  c(20), cComingle9    c(20), nBegVol9      N(4,0),  ;
		   nEndVol9      N(4,0), nOilProd9     N(4,0), nGasProd9     N(4,0), nDispVolume9  N(4,0),  ;
		   cOilDispCode9 c(1), cGasDispCode9 c(1), cwelltype1 c(1), cwelltype2 c(1), cwelltype3 c(1), ;
		   cwelltype4 c(1), cwelltype5 c(1), cwelltype6 c(1), cwelltype7 c(1), cwelltype8 c(1), cwelltype9 c(1))
		
		SELE *, llCorrected AS lCorrected, lamonth[val(cperiod)] AS CMONTH FROM txrrcdata ;
		   WHERE cyear = lcYear AND cperiod = lcPeriod AND BETWEEN(cfieldid,lcField1,lcField2) ;
		   INTO CURSOR temptxrpt  ;
		   ORDER BY crrcdistno,cfieldname,cleaseid
		
		llData = .F.
		
		lnCount = 1  &&  Counter for determining what position to put the data in
		lcOldDistNo = '*'  &&  Stores the previous district number
		llNeedInsert = .F.
		
		SELECT temptxrpt
		SCAN
		   SCATTER MEMVAR
		
		   IF m.crrcdistno <> lcOldDistNo  &&  Changing district #s, so re-set the remaining memvars
		      IF lcOldDistNo <> '*'
		         lcDistSave = m.crrcdistno
		         m.crrcdistno = lcOldDistNo
		         INSERT INTO txtemp FROM MEMVAR
		         m.crrcdistno = lcDistSave
		         llData = .T.
		      ENDIF
		
		      FOR lnX = 1 TO 9
		         lcX = ALLT(STR(lnX))
		         STORE '' TO m.cfieldid&lcX,m.cfieldname&lcX,m.cleaseid&lcX,m.cLeaseName&lcX,m.cRRCLeaseNo&lcX,  ;
		            m.cComingle&lcX,m.cOilDispCode&lcX,m.cGasDispCode&lcX,m.cwelltype&lcX
		
		         STORE 0 TO m.nBegVol&lcX,m.nEndVol&lcX,m.nOilProd&lcX,m.nGasProd&lcX
		
		         lnCount = 1  &&  Reset the counter
		      ENDFOR
		   ENDIF
		
		   lcCount = ALLT(STR(lnCount))
		
		   m.cfieldid&lcCount = m.cfieldid
		   m.cfieldname&lcCount = m.cfieldname
		   m.cleaseid&lcCount = m.cleaseid
		   m.cLeaseName&lcCount = m.cLeaseName
		   m.cRRCLeaseNo&lcCount = m.cRRCLeaseNo
		   m.cComingle&lcCount = m.cComingle
		   m.nBegVol&lcCount = m.nBegVol
		   m.nEndVol&lcCount = m.nEndVol
		   m.nOilProd&lcCount = m.nOilProd
		   m.nGasProd&lcCount = m.nGasProd
		   m.nDispVolume&lcCount = m.nDispVolume
		   m.cOilDispCode&lcCount = m.cOilDispCode
		   m.cGasDispCode&lcCount = m.cGasDispCode
		   m.nBegVol&lcCount = ROUND(VAL(ALLT(STR(m.nBegVol))),0)
		   m.cwelltype&lcCount = m.cwelltype
		   llNeedInsert = .T.
		
		   lcOldDistNo = m.crrcdistno  &&  Store what the previous district was, so we know if it changes on the next record
		
		   IF lnCount = 9  &&  Last item to fit on the page, so re-set the counter to 1
		      INSERT INTO txtemp FROM MEMVAR
		      llNeedInsert = .F.
		      FOR lnX = 1 TO 9
		         lcX = ALLT(STR(lnX))
		         STORE '' TO m.cfieldid&lcX,m.cfieldname&lcX,m.cleaseid&lcX,m.cLeaseName&lcX,m.cRRCLeaseNo&lcX,  ;
		            m.cComingle&lcX,m.cOilDispCode&lcX,m.cGasDispCode&lcX,m.cwelltype&lcX
		
		         STORE 0 TO m.nBegVol&lcX,m.nEndVol&lcX,m.nOilProd&lcX,m.nGasProd&lcX
		
		         lnCount = 1  &&  Reset the counter
		      ENDFOR
		   ELSE
		      lnCount = lnCount + 1
		   ENDIF
		ENDSCAN
		
		* Insert if there's less than nine
		IF llNeedInsert
		   INSERT INTO txtemp FROM MEMVAR
		ENDIF
		
		GetStateFormats('TX')
		
		SELECT txtemp
		THISFORM.creportname = m.goapp.cRptsFolder+'StateReports\texaspr.frx'
		
		IF _TALLY > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF
		
		
	ENDPROC

	PROCEDURE Init
		IF DODEFAULT()
		   SELE FIELDS
		   SET ORDER TO cfieldid
		   GO TOP
		   THISFORM.swrptlook1.txtbegid.VALUE = cfieldid
		   THISFORM.swrptlook1.txtbegname.VALUE = cfieldname
		   GO BOTT
		   THISFORM.swrptlook1.txtendid.VALUE = cfieldid
		   THISFORM.swrptlook1.txtendname.VALUE = cfieldname
		
		   SELE txrrcdata
		   SET ORDER TO cperiod
		   GO BOTT
		   THISFORM.txtyear.VALUE = cyear
		   THISFORM.txtperiod.VALUE = cperiod
		
		   IF LEN(ALLTRIM(m.goapp.ccompanyname)) < 3
		      m.goapp.ccompanyname = 'Sherwood Energy'
		      m.goapp.caddress1    = '4182 Clemmons Rd #285'
		      m.goapp.ccity        = 'Clemmons'
		      m.goapp.cstate       = 'NC'
		      m.goapp.czip         = '27012'
		      m.goapp.ccontact     = 'Phil Sherwood'
		   ENDIF
		
		ENDIF
		
	ENDPROC

	PROCEDURE Swrptlook1.SWLOOKUPBUTTON1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cfieldid,cfieldname'
		DO FORM ..\custom\picklist WITH 'Fields', lcList, thisform.swrptlook1.txtbegid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cfieldid
		   thisform.swrptlook1.txtBegName.value = cfieldname
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.SWLOOKUPBUTTON2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cfieldid,cfieldname'
		DO FORM ..\custom\picklist WITH 'Fields', lcList, thisform.swrptlook1.txtendid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cfieldid
		   thisform.swrptlook1.txtEndName.value = cfieldname
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

ENDDEFINE
