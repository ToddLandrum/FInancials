*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmsuspreason.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	InitialSelectedAlias = "revcat"
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "suspreasons", ;
		CursorSource = "suspreasons", ;
		Database = ..\..\database\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS dmsuspreason AS frmdatamanagerformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Lbltextcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtReasonDesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtReasonCode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkLnounclaimed" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkLwaitdivord" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: checkcodeuse
		*m: refacctno
	*</DefinedPropArrayMethod>

	Caption = "Suspense Reason Codes"
	clistexpression = suspreasons.creason
	cnavworkarea = suspreasons
	cworkarea = suspreasons
	DoCreate = .T.
	Height = 192
	HelpContextID = 363
	Name = "DMSUSPREASON"
	Width = 594
	_memberdata = <VFPData>
		<memberdata name="checkcodeuse" display="CheckCodeUse"/>
		</VFPData>
	cmdatamanager.Name = "cmdatamanager"
	cmdatamanager.TabIndex = 2
	cmlookupmanager.Name = "cmlookupmanager"
	Mwresize1.lblHighLight.Name = "lblHighLight"
	Mwresize1.lblShading.Name = "lblShading"
	Mwresize1.Left = 456
	Mwresize1.Name = "Mwresize1"
	Mwresize1.TabIndex = 1
	Mwresize1.Top = 228

	ADD OBJECT 'chkLnounclaimed' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Exempt from Unclaimed", ;
		ControlSource = "suspreasons.lnounclaimed", ;
		Height = 16, ;
		Left = 99, ;
		Name = "chkLnounclaimed", ;
		TabIndex = 7, ;
		Top = 144, ;
		Visible = .F., ;
		Width = 130
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkLwaitdivord' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Waiting on Division Order", ;
		ControlSource = "suspreasons.lwaitdivord", ;
		Height = 16, ;
		Left = 336, ;
		Name = "chkLwaitdivord", ;
		TabIndex = 8, ;
		Top = 144, ;
		Visible = .F., ;
		Width = 139
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Lbltextcustom1' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Suspense Code", ;
		FontBold = .F., ;
		Left = 21, ;
		Name = "Lbltextcustom1", ;
		TabIndex = 4, ;
		Top = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom2' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Reason Description", ;
		FontBold = .F., ;
		Left = 21, ;
		Name = "Lbltextcustom2", ;
		TabIndex = 6, ;
		Top = 93
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'txtReasonCode' AS txttextboxcustom WITH ;
		ControlSource = "suspreasons.creason", ;
		Format = "K!", ;
		Height = 20, ;
		InputMask = "XXX", ;
		Left = 147, ;
		lrequired = .T., ;
		MaxLength = 3, ;
		Name = "txtReasonCode", ;
		TabIndex = 3, ;
		Top = 41, ;
		Width = 45
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtReasonDesc' AS txttextboxcustom WITH ;
		ControlSource = "suspreasons.description", ;
		Height = 20, ;
		Left = 147, ;
		lrequired = .T., ;
		MaxLength = 40, ;
		Name = "txtReasonDesc", ;
		TabIndex = 5, ;
		Top = 91, ;
		Width = 321
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE checkcodeuse
		LPARAMETERS tcCode
		
		* Checks to see if the code has been used. This is to keep it from being updated or deleted.
		LOCAL llFound
		llFound = .F.
		
		IF NOT EMPTY(tcCode)
		   swselect('wellinv')
		   LOCATE FOR creason = tcCode
		   IF FOUND()
		      llFound = .T.
		   ENDIF
		
		   swselect('disbhist')
		   LOCATE FOR creason = tcCode
		   IF FOUND()
		      llFound = .T.
		   ENDIF
		
		   swselect('suspense')
		   LOCATE FOR creason = tcCode
		   IF FOUND()
		      llFound = .T.
		   ENDIF
		
		   IF llFound
		      MESSAGEBOX('This suspense code has been used. It cannot be modified or deleted.',16,THISFORM.CAPTION)
		   ENDIF
		ENDIF
		
		swclose('wellinv')
		swclose('disbhist')
		swclose('suspense')
		
		RETURN llFound
		
		
	ENDPROC

	PROCEDURE list
		LPARAMETERS cworkarea
		LOCAL lcList, lnRecNo
		PRIV llOK
		
		SET SAFETY OFF
		
		
		
		llOK = .F.
		lcList = 'creason\Code,Description\Description'
		
		lcCode = suspreasons.creason
		
		IF THIS.flushcontrolbuffer() AND THIS.beforenav('suspreasons')
		   DO FORM ..\CUSTOM\picklist WITH 'suspreasons', lcList, THISFORM.txtreasonCode.VALUE, 2
		ENDIF
		
		IF NOT llOK
		   SELECT suspreasons
		   LOCATE FOR creason = lcCode
		ENDIF
		
		THISFORM.REFRESH()
		
	ENDPROC

	PROCEDURE refacctno
	ENDPROC

	PROCEDURE cmdatamanager.beforedelete
		LPARAMETERS cWorkarea
		
		IF thisform.CheckCodeUse()
		   RETURN .F.
		ELSE
		   RETURN DODEFAULT()
		ENDIF 
	ENDPROC

	PROCEDURE txtReasonCode.Valid
		IF this.lchanged AND thisform.CheckCodeUse(this.value)
		   RETURN 0
		ELSE
		   RETURN DODEFAULT()
		ENDIF 
	ENDPROC

ENDDEFINE
