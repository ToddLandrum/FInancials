*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmdoi.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor28" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor29" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor30" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor31" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor32" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor33" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor34" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor35" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor36" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor37" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor38" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 723
	Left = 37
	Name = "Dataenvironment"
	Top = 7
	Width = 1664

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "wellinv", ;
		CursorSource = "wellinv", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 1092, ;
		Name = "Cursor1", ;
		Top = 144, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "doi_bc", ;
		CursorSource = "doi_bc", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 172, ;
		Name = "Cursor10", ;
		NoDataOnLoad = .T., ;
		Top = 292, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "doi_e1", ;
		CursorSource = "doi_e1", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor11", ;
		NoDataOnLoad = .T., ;
		Top = 282, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "doi_e2", ;
		CursorSource = "doi_e2", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 430, ;
		Name = "Cursor12", ;
		NoDataOnLoad = .T., ;
		Top = 275, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor13' AS cursor WITH ;
		Alias = "doi_e3", ;
		CursorSource = "doi_e3", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 20, ;
		Name = "Cursor13", ;
		NoDataOnLoad = .T., ;
		Top = 437, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor14' AS cursor WITH ;
		Alias = "doi_e4", ;
		CursorSource = "doi_e4", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 153, ;
		Name = "Cursor14", ;
		NoDataOnLoad = .T., ;
		Top = 425, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor15' AS cursor WITH ;
		Alias = "doi_e5", ;
		CursorSource = "doi_e5", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor15", ;
		NoDataOnLoad = .T., ;
		Top = 413, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor16' AS cursor WITH ;
		Alias = "doi_m2", ;
		CursorSource = "doi_m2", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 432, ;
		Name = "Cursor16", ;
		NoDataOnLoad = .T., ;
		Top = 410, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor17' AS cursor WITH ;
		Alias = "doi_gt1", ;
		CursorSource = "doi_gt1", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 687, ;
		Name = "Cursor17", ;
		NoDataOnLoad = .T., ;
		Top = 263, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor18' AS cursor WITH ;
		Alias = "doi_gt2", ;
		CursorSource = "doi_gt2", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 816, ;
		Name = "Cursor18", ;
		NoDataOnLoad = .T., ;
		Top = 263, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor19' AS cursor WITH ;
		Alias = "doi_own", ;
		CursorSource = "doi_own", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 380, ;
		Name = "Cursor19", ;
		NoDataOnLoad = .T., ;
		Top = 9, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 26, ;
		Name = "Cursor2", ;
		Order = "cwellid", ;
		Top = 5, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor20' AS cursor WITH ;
		Alias = "doifile", ;
		BufferModeOverride = 3, ;
		CursorSource = "wellinv", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 1075, ;
		Name = "Cursor20", ;
		Order = "deckorder", ;
		Top = 296, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor21' AS cursor WITH ;
		Alias = "doi_ap", ;
		CursorSource = "doi_ap", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 553, ;
		Name = "Cursor21", ;
		NoDataOnLoad = .T., ;
		Top = 138, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor22' AS cursor WITH ;
		Alias = "doi_gt3", ;
		CursorSource = "doi_gt3", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 827, ;
		Name = "Cursor22", ;
		NoDataOnLoad = .T., ;
		Top = 107, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor23' AS cursor WITH ;
		Alias = "doi_gt4", ;
		CursorSource = "doi_gt4", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 687, ;
		Name = "Cursor23", ;
		NoDataOnLoad = .T., ;
		Top = 138, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor24' AS cursor WITH ;
		Alias = "programs", ;
		CursorSource = "programs", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 561, ;
		Name = "Cursor24", ;
		Top = 537, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor25' AS cursor WITH ;
		Alias = "doi_ot1", ;
		CursorSource = "doi_ot1", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 621, ;
		Name = "Cursor25", ;
		NoDataOnLoad = .T., ;
		Top = 11, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor26' AS cursor WITH ;
		Alias = "doi_ot2", ;
		CursorSource = "doi_ot2", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 565, ;
		Name = "Cursor26", ;
		NoDataOnLoad = .T., ;
		Top = 416, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor27' AS cursor WITH ;
		Alias = "doi_ot3", ;
		CursorSource = "doi_ot3", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 689, ;
		Name = "Cursor27", ;
		NoDataOnLoad = .T., ;
		Top = 385, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor28' AS cursor WITH ;
		Alias = "doi_ot4", ;
		CursorSource = "doi_ot4", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 841, ;
		Name = "Cursor28", ;
		NoDataOnLoad = .T., ;
		Top = 420, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor29' AS cursor WITH ;
		Alias = "doi_pt1", ;
		CursorSource = "doi_pt1", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 6, ;
		Name = "Cursor29", ;
		NoDataOnLoad = .T., ;
		Top = 534, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 132, ;
		Name = "Cursor3", ;
		Top = 6, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor30' AS cursor WITH ;
		Alias = "doi_pt2", ;
		CursorSource = "doi_pt2", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 158, ;
		Name = "Cursor30", ;
		NoDataOnLoad = .T., ;
		Top = 549, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor31' AS cursor WITH ;
		Alias = "doi_pt3", ;
		CursorSource = "doi_pt3", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 284, ;
		Name = "Cursor31", ;
		NoDataOnLoad = .T., ;
		Top = 544, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor32' AS cursor WITH ;
		Alias = "doi_pt4", ;
		CursorSource = "doi_pt4", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 423, ;
		Name = "Cursor32", ;
		NoDataOnLoad = .T., ;
		Top = 542, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor33' AS cursor WITH ;
		Alias = "doi_op", ;
		CursorSource = "doi_op", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 699, ;
		Name = "Cursor33", ;
		NoDataOnLoad = .T., ;
		Top = 542, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor34' AS cursor WITH ;
		Alias = "wellinv1", ;
		BufferModeOverride = 0, ;
		CursorSource = "wellinv", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 556, ;
		Name = "Cursor34", ;
		Top = 258, ;
		Width = 97
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor35' AS cursor WITH ;
		Alias = "suspense", ;
		CursorSource = "suspense", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 506, ;
		Name = "Cursor35", ;
		Top = 654, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor36' AS cursor WITH ;
		Alias = "doi_plg", ;
		CursorSource = "doi_plg", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 55, ;
		Name = "Cursor36", ;
		NoDataOnLoad = .T., ;
		Top = 660, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor37' AS cursor WITH ;
		Alias = "suspreasons", ;
		CursorSource = "suspreasons", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 498, ;
		Name = "Cursor37", ;
		Top = 10, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor38' AS cursor WITH ;
		Alias = "doidecks", ;
		CursorSource = "doidecks", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 1550, ;
		Name = "Cursor38", ;
		Order = "navorder", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "doi_dc", ;
		BufferModeOverride = 5, ;
		CursorSource = "doi_dc", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 30, ;
		Name = "Cursor4", ;
		NoDataOnLoad = .T., ;
		Top = 160, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "doi_gr", ;
		CursorSource = "doi_gr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 271, ;
		Name = "Cursor5", ;
		NoDataOnLoad = .T., ;
		Top = 6, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "doi_m1", ;
		CursorSource = "doi_m1", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 174, ;
		Name = "Cursor6", ;
		NoDataOnLoad = .T., ;
		Top = 147, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "doi_or", ;
		CursorSource = "doi_or", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor7", ;
		NoDataOnLoad = .T., ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "doi_tr", ;
		CursorSource = "doi_tr", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 430, ;
		Name = "Cursor8", ;
		NoDataOnLoad = .T., ;
		Top = 155, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "doi_ac", ;
		CursorSource = "doi_ac", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 27, ;
		Name = "Cursor9", ;
		NoDataOnLoad = .T., ;
		Top = 286, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />
	
	PROCEDURE OpenTables
		IF DODEFAULT()
		   SELECT doidecks
		   SET ORDER to deckorder
		   SET RELATION TO deckorder INTO wellinv
		ENDIF    
	ENDPROC

ENDDEFINE

DEFINE CLASS formdmdoi AS frmdatamanagerformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="pageframe" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Shpshapecustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.chkSpecify" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Shpshapecustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Shpshapecustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtWellid2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtWellName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Shpshapecustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Shpshapecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtcOwnerID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cmdLookWell2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtDadded" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblDadded" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtCadduser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblCadduser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtDchanged" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblDchanged" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtCchguser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblCchguser" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtInterest" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblInterest" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblTypeinv" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblTypeint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtIntclass1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblIntclass1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtIntclass2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblIntclass2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtIntclass3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblIntclass3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtIntclass4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblIntclass4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtIntclass5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblIntclass5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevoil" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblRevoil" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevgas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblRevgas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevtrp" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblRevtrp" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevmisc1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblRevmisc1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevmisc2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblRevmisc2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblDirect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtFlatrate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblFlatrate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtProgcode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.chkLjib" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevtax1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevtax2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.chkLonhold" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtNbcpint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblNbcpint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtNacpint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblNacpint" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.chkLflat" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cboOwnType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cboIntType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cboDirect" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtcOwnerName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cmdLookOwner" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtAPOInt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtcFlatStart" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblFlatStarts" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.opgFlatFreq" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblFlatFreq" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevtax3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevTax12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cmdProgram" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtRevOth" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lblfieldlabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtFlatMCF" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtFlatBBL" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblFlatMCF" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblFlatBBL" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtNtaxpct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.shpPlug" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.txtnPlugPct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.lblPlugMod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cboSuspReason" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.Lbllabelcustom6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page2.cboDeck2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column1.txtOwnerID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column2.txtOwnerName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column3.chkOnHold" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column4.chkJIB" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column5.txtOwnerType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column6.txtIntType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column7.txtDirectPay" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column8.chkFlatRate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column10.txtProgCode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column11.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column11.txtInterest" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Grdgridcustom1.Column9.Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.txtnTotalInt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.cmdChkInterests" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.txtWellid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.txtWellName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.cboInterestClass" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.lblInterestClass" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.Lbllabelcustom6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.cboDeck1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page1.cmdLookWell1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page3.cmdLinkDoc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page3.cmdViewDoc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page3.lstDocuments" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page3.cmdDelDoc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page3.cmdTreeno" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe.Page3.cmdShowPath" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: calcints		&& Calculates the total interest for the given interest class.
		*m: checkdecks
		*m: chkinterest		&& Checks the given interest in the currently displayed well to see what the total interest in the well is.
		*m: createnewdeck
		*m: recalcrev		&& Recalculates the net revenue interests.
		*m: requeryclass
		*m: requerydeck
		*m: selectrec		&& Selects the current record from the view displayed in the grid and displays it on the owner interests page.
		*m: setflat
		*m: setstate
		*m: showflatfields
		*m: temp
		*m: viewdocument
		*m: zerointerests
		*p: lcoldownerid
		*p: lcoldprogcode
		*p: lcoldwellid
		*p: ldummyafternav
		*p: lintwarning		&& Saves the state of the interest over 100% warning.
		*p: lnewrecord
		*p: nownertype
		*p: oldinttype
	*</DefinedPropArrayMethod>

	BufferMode = 2
	Caption = "Division of Interests"
	clistexpression = doidecks.cdeck
	cnavworkarea = doidecks
	cworkarea = wellinv
	DoCreate = .T.
	Height = 592
	HelpContextID = 17
	lcoldownerid = 
	lcoldprogcode = 
	lcoldwellid = 
	ldummyafternav = .F.
	lnewrecord = .F.
	Name = "FormDmdoi"
	nownertype = 1
	oldinttype = 
	Width = 809
	WindowState = 0
	_memberdata = <VFPData>
		<memberdata name="viewdocument" display="ViewDocument"/>
		<memberdata name="showflatfields" display="ShowFlatFields"/>
		<memberdata name="createnewdeck" display="CreateNewDeck"/>
		<memberdata name="requerydeck" display="RequeryDeck"/>
		<memberdata name="checkdecks" display="CheckDecks"/>
		</VFPData>
	cmdatamanager.Name = "cmdatamanager"
	cmdatamanager.TabIndex = 1
	cmdatamanager.ZOrderSet = 0
	cmlookupmanager.Left = 36
	cmlookupmanager.Name = "cmlookupmanager"
	cmlookupmanager.Top = 540
	Mwresize1.lblHighLight.Name = "lblHighLight"
	Mwresize1.lblShading.Name = "lblShading"
	Mwresize1.Name = "Mwresize1"
	Mwresize1.TabIndex = 9

	ADD OBJECT 'pageframe' AS pgfpageframecustom WITH ;
		ActivePage = 1, ;
		ErasePage = .T., ;
		Height = 584, ;
		Left = 4, ;
		Name = "pageframe", ;
		PageCount = 3, ;
		TabIndex = 7, ;
		Top = 4, ;
		Width = 800, ;
		ZOrderSet = 8, ;
		Page1.Caption = "Owner Interests", ;
		Page1.FontBold = .T., ;
		Page1.FontSize = 10, ;
		Page1.ForeColor = 0,0,0, ;
		Page1.Name = "Page2", ;
		Page1.PageOrder = 2, ;
		Page2.Caption = "Interest Views", ;
		Page2.FontBold = .T., ;
		Page2.FontSize = 10, ;
		Page2.ForeColor = 0,0,0, ;
		Page2.Name = "Page1", ;
		Page2.PageOrder = 1, ;
		Page3.Caption = "Documents", ;
		Page3.FontBold = .T., ;
		Page3.Name = "Page3", ;
		Page3.PageOrder = 3
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="pageframe" />

	ADD OBJECT 'pageframe.Page1.cboDeck1' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "doidecks.cdeck", ;
		Height = 20, ;
		Left = 487, ;
		Name = "cboDeck1", ;
		Style = 2, ;
		TabIndex = 5, ;
		Top = 16, ;
		Width = 168
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'pageframe.Page1.cboInterestClass' AS cbocomboboxcustom WITH ;
		FontName = "Courier New", ;
		Height = 20, ;
		Left = 487, ;
		Name = "cboInterestClass", ;
		Top = 61, ;
		Width = 168, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'pageframe.Page1.cmdChkInterests' AS cmdcommandbuttoncustom WITH ;
		Caption = "Check Interests", ;
		Height = 24, ;
		Left = 103, ;
		Name = "cmdChkInterests", ;
		TabIndex = 72, ;
		Top = 525, ;
		Width = 91
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page1.cmdLookWell1' AS cmdcommandbuttoncustom WITH ;
		Caption = " Well ID ", ;
		Height = 22, ;
		Left = 27, ;
		Name = "cmdLookWell1", ;
		TabIndex = 2, ;
		TabStop = .F., ;
		Top = 16, ;
		Width = 48, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1' AS grdgridcustom WITH ;
		ColumnCount = 11, ;
		cworkarea = DOI_DC, ;
		FontName = "Arial", ;
		Height = 421, ;
		lallowautoappend = .F., ;
		lallowdelete = .F., ;
		lallownew = .F., ;
		lcolumnmemory = .F., ;
		Left = 7, ;
		LinkMaster = "", ;
		lrefreshonrowchange = .F., ;
		Name = "Grdgridcustom1", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordSource = "DOI_DC", ;
		RecordSourceType = 1, ;
		RelationalExpr = "", ;
		Top = 97, ;
		Width = 780, ;
		Column1.ControlSource = "doi_dc.cownerid", ;
		Column1.FontName = "Courier New", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 73, ;
		Column10.ColumnOrder = 10, ;
		Column10.ControlSource = "doi_dc.interest", ;
		Column10.FontName = "Courier New", ;
		Column10.FontSize = 8, ;
		Column10.Name = "Column11", ;
		Column10.ReadOnly = .T., ;
		Column10.Width = 88, ;
		Column11.FontName = "Arial", ;
		Column11.Name = "Column9", ;
		Column11.ReadOnly = .T., ;
		Column11.Sparse = .F., ;
		Column2.ControlSource = "doi_dc.cownname", ;
		Column2.FontName = "Courier New", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 293, ;
		Column3.ControlSource = "doi_dc.lonhold", ;
		Column3.FontName = "Courier New", ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Sparse = .F., ;
		Column3.Width = 20, ;
		Column4.ControlSource = "doi_dc.ljib", ;
		Column4.FontName = "Courier New", ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Sparse = .F., ;
		Column4.Width = 20, ;
		Column5.ControlSource = "doi_dc.ctypeinv", ;
		Column5.FontName = "Courier New", ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Width = 20, ;
		Column6.ControlSource = "doi_dc.ctypeint", ;
		Column6.FontName = "Courier New", ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 20, ;
		Column7.ControlSource = "doi_dc.cdirect", ;
		Column7.FontName = "Courier New", ;
		Column7.FontSize = 8, ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .T., ;
		Column7.Width = 20, ;
		Column8.Alignment = 3, ;
		Column8.ControlSource = "doi_dc.lflat", ;
		Column8.FontName = "Courier New", ;
		Column8.Name = "Column8", ;
		Column8.ReadOnly = .T., ;
		Column8.Sparse = .F., ;
		Column8.Width = 20, ;
		Column9.ColumnOrder = 9, ;
		Column9.ControlSource = "doi_dc.cprogcode", ;
		Column9.FontName = "Courier New", ;
		Column9.FontSize = 8, ;
		Column9.Name = "Column10", ;
		Column9.ReadOnly = .T., ;
		Column9.Width = 85
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="grid" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column1.Header1' AS header WITH ;
		Caption = "Owner ID", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column1.txtOwnerID' AS txttextboxcustom WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "doi_dc.cownerid", ;
		FontName = "Courier New", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		lautoremember = .F., ;
		Margin = 0, ;
		Name = "txtOwnerID", ;
		ReadOnly = .T., ;
		ToolTipText = "This is the ID code for the owner."
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column10.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Prog Code", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column10.txtProgCode' AS txtquickfill WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		clistworkarea = Programs, ;
		ControlSource = "doi_dc.cprogcode", ;
		FontName = "Courier New", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "txtProgCode", ;
		ReadOnly = .T.
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column11.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Interest", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column11.txtInterest' AS txttextboxcustom WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "doi_dc.interest", ;
		FontName = "Courier New", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "txtInterest", ;
		ReadOnly = .T.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column2.Header1' AS header WITH ;
		Caption = "Owner Name", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column2.txtOwnerName' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "doi_dc.cownname", ;
		FontName = "Courier New", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "txtOwnerName", ;
		ReadOnly = .T., ;
		TabStop = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column3.chkOnHold' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "", ;
		ControlSource = "doi_dc.lonhold", ;
		FontName = "Courier New", ;
		Left = 6, ;
		Name = "chkOnHold", ;
		ReadOnly = .T., ;
		ToolTipText = "Check this box to put this interest for this owner on hold.", ;
		Top = 25
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "IH", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column4.chkJIB' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "", ;
		ControlSource = "doi_dc.ljib", ;
		FontName = "Courier New", ;
		Left = 9, ;
		Name = "chkJIB", ;
		ReadOnly = .T., ;
		Top = 25
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column4.Header1' AS header WITH ;
		Caption = "JIB", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "OT", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column5.txtOwnerType' AS txttextboxcustom WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "doi_dc.ctypeinv", ;
		FontName = "Courier New", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "txtOwnerType", ;
		ReadOnly = .T.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "IT", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column6.txtIntType' AS txttextboxcustom WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "doi_dc.ctypeint", ;
		FontName = "Courier New", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "txtIntType", ;
		ReadOnly = .T.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "DP", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column7.txtDirectPay' AS txttextboxcustom WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "doi_dc.cdirect", ;
		FontName = "Courier New", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "txtDirectPay", ;
		ReadOnly = .T.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column8.chkFlatRate' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "", ;
		ControlSource = "doi_dc.lflat", ;
		FontName = "Courier New", ;
		Left = 9, ;
		Name = "chkFlatRate", ;
		ReadOnly = .T., ;
		Top = 25
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column8.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "FR", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column9.Command1' AS commandbutton WITH ;
		Caption = "Edit", ;
		Height = 27, ;
		Left = 21, ;
		Name = "Command1", ;
		Top = 29, ;
		Width = 84
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page1.Grdgridcustom1.Column9.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Edit", ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe.Page1.lblInterestClass' AS lbllabelcustom WITH ;
		Caption = "Interest Class", ;
		Left = 416, ;
		Name = "lblInterestClass", ;
		Top = 63, ;
		Width = 68, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page1.Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Total Well Interest", ;
		Left = 496, ;
		Name = "Lbllabelcustom1", ;
		Top = 525
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page1.Lbllabelcustom6' AS lbllabelcustom WITH ;
		Caption = "Deck:", ;
		Left = 448, ;
		Name = "Lbllabelcustom6", ;
		TabIndex = 8, ;
		Top = 19
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page1.txtnTotalInt' AS txttextboxcustom WITH ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 589, ;
		Name = "txtnTotalInt", ;
		Top = 523, ;
		Width = 96
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.txtWellid1' AS txtquickfill WITH ;
		clistexpression = cwellid, ;
		clistworkarea = wells, ;
		ControlSource = "doidecks.cwellid", ;
		cworkarea = , ;
		Format = "!", ;
		Height = 20, ;
		Left = 78, ;
		lrequired = .T., ;
		MaxLength = 10, ;
		Name = "txtWellid1", ;
		ReadOnly = .F., ;
		TabIndex = 3, ;
		Top = 17, ;
		Width = 78, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page1.txtWellName' AS txttextboxcustom WITH ;
		BackColor = 192,192,192, ;
		ControlSource = "wells.cwellname", ;
		Height = 20, ;
		Left = 167, ;
		Name = "txtWellName", ;
		ReadOnly = .T., ;
		TabIndex = 4, ;
		Top = 17, ;
		Width = 254, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.cboDeck2' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "wellinv.cdeck", ;
		Height = 22, ;
		Left = 499, ;
		Name = "cboDeck2", ;
		Style = 2, ;
		TabIndex = 5, ;
		Top = 12, ;
		Width = 125
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'pageframe.Page2.cboDirect' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "wellinv.cdirect", ;
		Height = 20, ;
		Left = 426, ;
		lrequired = .F., ;
		Name = "cboDirect", ;
		TabIndex = 15, ;
		Top = 99, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'pageframe.Page2.cboIntType' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "wellinv.ctypeint", ;
		Height = 20, ;
		Left = 303, ;
		lrequired = .F., ;
		Name = "cboIntType", ;
		TabIndex = 14, ;
		Top = 99, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'pageframe.Page2.cboOwnType' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "wellinv.ctypeinv", ;
		Height = 20, ;
		Left = 85, ;
		lrequired = .F., ;
		Name = "cboOwnType", ;
		TabIndex = 11, ;
		Top = 99, ;
		Width = 126
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'pageframe.Page2.cboSuspReason' AS cbocomboboxcustom WITH ;
		BoundColumn = 1, ;
		ColumnCount = 2, ;
		ControlSource = "wellinv.creason", ;
		Height = 20, ;
		Left = 715, ;
		lrequired = .F., ;
		Name = "cboSuspReason", ;
		TabIndex = 9, ;
		Top = 80, ;
		Visible = .T., ;
		Width = 63
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'pageframe.Page2.chkLflat' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Flat Rate", ;
		ControlSource = "wellinv.lflat", ;
		Height = 16, ;
		Left = 632, ;
		Name = "chkLflat", ;
		TabIndex = 10, ;
		Top = 103, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'pageframe.Page2.chkLjib' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "JIB Int (Billed)", ;
		ControlSource = "wellinv.ljib", ;
		Height = 16, ;
		Left = 632, ;
		Name = "chkLjib", ;
		TabIndex = 7, ;
		Top = 55, ;
		Width = 82
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'pageframe.Page2.chkLonhold' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Int On Hold", ;
		ControlSource = "wellinv.lonhold", ;
		Height = 16, ;
		Left = 632, ;
		Name = "chkLonhold", ;
		TabIndex = 8, ;
		Top = 79, ;
		Width = 70
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'pageframe.Page2.chkSpecify' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 1, ;
		Caption = "Don't Automatically Calculate NRI for Working Interest Owners for This Well", ;
		ControlSource = "wells.lrecalc", ;
		Left = 208, ;
		Name = "chkSpecify", ;
		TabIndex = 1, ;
		Top = 188, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'pageframe.Page2.cmdLookOwner' AS cmdcommandbuttoncustom WITH ;
		Caption = "Owner ID", ;
		Height = 20, ;
		Left = 19, ;
		Name = "cmdLookOwner", ;
		TabIndex = 2, ;
		TabStop = .F., ;
		Top = 61, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page2.cmdLookWell2' AS cmdcommandbuttoncustom WITH ;
		Caption = " Well ID ", ;
		Height = 22, ;
		Left = 24, ;
		Name = "cmdLookWell2", ;
		TabIndex = 2, ;
		TabStop = .F., ;
		Top = 12, ;
		Width = 48, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page2.cmdProgram' AS cmdcommandbuttoncustom WITH ;
		Caption = "Program", ;
		Height = 20, ;
		Left = 467, ;
		Name = "cmdProgram", ;
		TabIndex = 3, ;
		TabStop = .F., ;
		Top = 61, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page2.lblCadduser' AS lbllabelcustom WITH ;
		Caption = "Added By", ;
		Height = 16, ;
		Left = 207, ;
		Name = "lblCadduser", ;
		TabIndex = 16, ;
		Top = 515, ;
		Width = 50, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblCchguser' AS lbllabelcustom WITH ;
		Caption = "Last Changed By:", ;
		Height = 16, ;
		Left = 590, ;
		Name = "lblCchguser", ;
		TabIndex = 24, ;
		Top = 515, ;
		Width = 88, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblDadded' AS lbllabelcustom WITH ;
		Caption = "Date Added", ;
		Height = 16, ;
		Left = 8, ;
		Name = "lblDadded", ;
		TabIndex = 12, ;
		Top = 515, ;
		Width = 59, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblDchanged' AS lbllabelcustom WITH ;
		Caption = "Date Changed:", ;
		Height = 16, ;
		Left = 396, ;
		Name = "lblDchanged", ;
		TabIndex = 19, ;
		Top = 515, ;
		Width = 73, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblDirect' AS lbllabelcustom WITH ;
		Caption = "Direct Paid", ;
		Height = 16, ;
		Left = 370, ;
		Name = "lblDirect", ;
		TabIndex = 22, ;
		Top = 101, ;
		Width = 53
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lblfieldlabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Other Prod Rev", ;
		Height = 16, ;
		Left = 563, ;
		Name = "Lblfieldlabelcustom1", ;
		TabIndex = 39, ;
		Top = 217, ;
		Width = 76
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblFlatBBL' AS lbllabelcustom WITH ;
		Caption = "Rate per BBL", ;
		Left = 563, ;
		Name = "lblFlatBBL", ;
		TabIndex = 86, ;
		Top = 160, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblFlatFreq' AS lbllabelcustom WITH ;
		Caption = "Flat Freq", ;
		Left = 185, ;
		Name = "lblFlatFreq", ;
		TabIndex = 31, ;
		Top = 131, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblFlatMCF' AS lbllabelcustom WITH ;
		Caption = "Rate per MCF", ;
		Left = 292, ;
		Name = "lblFlatMCF", ;
		TabIndex = 85, ;
		Top = 160, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblFlatrate' AS lbllabelcustom WITH ;
		Caption = "Flat Rate", ;
		Height = 16, ;
		Left = 19, ;
		Name = "lblFlatrate", ;
		TabIndex = 45, ;
		Top = 160, ;
		Visible = .F., ;
		Width = 44
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblFlatStarts' AS lbllabelcustom WITH ;
		Caption = "Month Flat Rate Starts", ;
		Left = 19, ;
		Name = "lblFlatStarts", ;
		TabIndex = 30, ;
		Top = 131, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblIntclass1' AS lbllabelcustom WITH ;
		Caption = "Exp Class 1", ;
		Height = 16, ;
		Left = 291, ;
		Name = "lblIntclass1", ;
		TabIndex = 51, ;
		Top = 290, ;
		Width = 59
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblIntclass2' AS lbllabelcustom WITH ;
		Caption = "Exp Class 2", ;
		Height = 16, ;
		Left = 565, ;
		Name = "lblIntclass2", ;
		TabIndex = 52, ;
		Top = 290, ;
		Width = 59
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblIntclass3' AS lbllabelcustom WITH ;
		Caption = "Exp Class 3", ;
		Height = 16, ;
		Left = 19, ;
		Name = "lblIntclass3", ;
		TabIndex = 56, ;
		Top = 315, ;
		Width = 59
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblIntclass4' AS lbllabelcustom WITH ;
		Caption = "Exp Class 4", ;
		Height = 16, ;
		Left = 291, ;
		Name = "lblIntclass4", ;
		TabIndex = 57, ;
		Top = 315, ;
		Width = 59
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblIntclass5' AS lbllabelcustom WITH ;
		Caption = "Exp Class 5", ;
		Height = 16, ;
		Left = 565, ;
		Name = "lblIntclass5", ;
		TabIndex = 58, ;
		Top = 315, ;
		Width = 59
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblInterest' AS lbllabelcustom WITH ;
		Caption = "Working Interest", ;
		Height = 16, ;
		Left = 19, ;
		Name = "lblInterest", ;
		TabIndex = 50, ;
		Top = 290, ;
		Width = 80
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom1' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Revenue", ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 16, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 32, ;
		Top = 200, ;
		Width = 50
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom10' AS lbllabelcustom WITH ;
		Caption = "Tax 4", ;
		Left = 709, ;
		Name = "Lbllabelcustom10", ;
		TabIndex = 84, ;
		Top = 369
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom11' AS lbllabelcustom WITH ;
		Caption = "Oil", ;
		FontBold = .F., ;
		Left = 31, ;
		Name = "Lbllabelcustom11", ;
		TabIndex = 66, ;
		Top = 392
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom12' AS lbllabelcustom WITH ;
		Caption = "Gas", ;
		FontBold = .F., ;
		Left = 31, ;
		Name = "Lbllabelcustom12", ;
		TabIndex = 67, ;
		Top = 413
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom13' AS lbllabelcustom WITH ;
		Caption = "Other", ;
		FontBold = .F., ;
		Left = 31, ;
		Name = "Lbllabelcustom13", ;
		TabIndex = 68, ;
		Top = 434
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom16' AS lbllabelcustom WITH ;
		Caption = "State Tax W/H Pct", ;
		Left = 373, ;
		Name = "Lbllabelcustom16", ;
		TabIndex = 87, ;
		Top = 477
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom2' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Taxes", ;
		FontBold = .T., ;
		Left = 16, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 65, ;
		Top = 357
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom3' AS lbllabelcustom WITH ;
		BackStyle = 1, ;
		Caption = "Expenses", ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 16, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 46, ;
		Top = 260, ;
		Width = 56
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom4' AS lbllabelcustom WITH ;
		Caption = "After Payout", ;
		Left = 19, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 62, ;
		Top = 338
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom5' AS lbllabelcustom WITH ;
		Caption = "Reason", ;
		Left = 724, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 91, ;
		Top = 65
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom6' AS lbllabelcustom WITH ;
		Caption = "Deck:", ;
		Left = 463, ;
		Name = "Lbllabelcustom6", ;
		TabIndex = 8, ;
		Top = 15
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom7' AS lbllabelcustom WITH ;
		Caption = "Tax 1", ;
		Left = 127, ;
		Name = "Lbllabelcustom7", ;
		TabIndex = 78, ;
		Top = 369
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom8' AS lbllabelcustom WITH ;
		Caption = "Tax 2", ;
		Left = 308, ;
		Name = "Lbllabelcustom8", ;
		TabIndex = 80, ;
		Top = 369
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.Lbllabelcustom9' AS lbllabelcustom WITH ;
		Caption = "Tax 3", ;
		Left = 493, ;
		Name = "Lbllabelcustom9", ;
		TabIndex = 82, ;
		Top = 369
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblNacpint' AS lbllabelcustom WITH ;
		Caption = "Aft. Casing Point", ;
		Height = 16, ;
		Left = 565, ;
		Name = "lblNacpint", ;
		TabIndex = 63, ;
		Top = 339, ;
		Width = 82
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblNbcpint' AS lbllabelcustom WITH ;
		Caption = "Bef. Casing Point", ;
		Height = 16, ;
		Left = 291, ;
		Name = "lblNbcpint", ;
		TabIndex = 64, ;
		Top = 340, ;
		Width = 84
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblPlugMod' AS lbllabelcustom WITH ;
		Caption = "Plugging Pct", ;
		Left = 114, ;
		Name = "lblPlugMod", ;
		TabIndex = 88, ;
		Top = 477
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblRevgas' AS lbllabelcustom WITH ;
		Caption = "Gas Revenue", ;
		Height = 16, ;
		Left = 292, ;
		Name = "lblRevgas", ;
		TabIndex = 37, ;
		Top = 217, ;
		Width = 68
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblRevmisc1' AS lbllabelcustom WITH ;
		Caption = "Misc Revenue 1", ;
		Height = 16, ;
		Left = 19, ;
		Name = "lblRevmisc1", ;
		TabIndex = 43, ;
		Top = 241, ;
		Width = 79
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblRevmisc2' AS lbllabelcustom WITH ;
		Caption = "Misc Revenue 2", ;
		Height = 16, ;
		Left = 292, ;
		Name = "lblRevmisc2", ;
		TabIndex = 44, ;
		Top = 240, ;
		Width = 79
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblRevoil' AS lbllabelcustom WITH ;
		Caption = "Oil Revenue", ;
		Height = 16, ;
		Left = 19, ;
		Name = "lblRevoil", ;
		TabIndex = 36, ;
		Top = 217, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblRevtrp' AS lbllabelcustom WITH ;
		Caption = "Trans Revenue", ;
		Height = 16, ;
		Left = 563, ;
		Name = "lblRevtrp", ;
		TabIndex = 38, ;
		Top = 240, ;
		Width = 76
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblTypeint' AS lbllabelcustom WITH ;
		Caption = "Interest Type", ;
		Height = 16, ;
		Left = 233, ;
		Name = "lblTypeint", ;
		TabIndex = 20, ;
		Top = 101, ;
		Width = 65
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.lblTypeinv' AS lbllabelcustom WITH ;
		Caption = "Owner Type", ;
		Height = 16, ;
		Left = 16, ;
		Name = "lblTypeinv", ;
		TabIndex = 17, ;
		Top = 101, ;
		Width = 63
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'pageframe.Page2.opgFlatFreq' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		ButtonCount = 4, ;
		ControlSource = "wellinv.nflatfreq", ;
		Enabled = .T., ;
		Height = 24, ;
		Left = 235, ;
		Name = "opgFlatFreq", ;
		TabIndex = 26, ;
		Top = 127, ;
		Visible = .F., ;
		Width = 372, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Monthly", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 3, ;
		Option1.Width = 55, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Quarterly", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 84, ;
		Option2.Name = "Option2", ;
		Option2.Top = 3, ;
		Option2.Width = 63, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "Semi-Annually", ;
		Option3.FontSize = 8, ;
		Option3.Height = 16, ;
		Option3.Left = 171, ;
		Option3.Name = "Option3", ;
		Option3.Top = 3, ;
		Option3.Width = 87, ;
		Option4.AutoSize = .T., ;
		Option4.Caption = "Annually", ;
		Option4.FontSize = 8, ;
		Option4.Height = 16, ;
		Option4.Left = 288, ;
		Option4.Name = "Option4", ;
		Option4.Top = 3, ;
		Option4.Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'pageframe.Page2.shpPlug' AS shpshapecustom WITH ;
		Height = 29, ;
		Left = 104, ;
		Name = "shpPlug", ;
		Top = 470, ;
		Width = 204
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'pageframe.Page2.Shpshapecustom1' AS shpshapecustom WITH ;
		Height = 138, ;
		Left = 7, ;
		Name = "Shpshapecustom1", ;
		Top = 46, ;
		Width = 780
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'pageframe.Page2.Shpshapecustom2' AS shpshapecustom WITH ;
		Height = 60, ;
		Left = 7, ;
		Name = "Shpshapecustom2", ;
		Top = 208, ;
		Width = 780
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'pageframe.Page2.Shpshapecustom3' AS shpshapecustom WITH ;
		Height = 96, ;
		Left = 7, ;
		Name = "Shpshapecustom3", ;
		Top = 364, ;
		Width = 780
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'pageframe.Page2.Shpshapecustom4' AS shpshapecustom WITH ;
		Height = 96, ;
		Left = 7, ;
		Name = "Shpshapecustom4", ;
		Top = 268, ;
		Width = 780
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'pageframe.Page2.Shpshapecustom5' AS shpshapecustom WITH ;
		Height = 29, ;
		Left = 363, ;
		Name = "Shpshapecustom5", ;
		Top = 470, ;
		Width = 204
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'pageframe.Page2.txtAPOInt' AS txttextboxcustom WITH ;
		BackColor = 255,255,255, ;
		ControlSource = "wellinv.napoint", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 104, ;
		Name = "txtAPOInt", ;
		SelectOnEntry = .T., ;
		TabIndex = 59, ;
		Top = 337, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtCadduser' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.cadduser", ;
		Height = 20, ;
		Left = 270, ;
		MaxLength = 10, ;
		Name = "txtCadduser", ;
		ReadOnly = .T., ;
		TabIndex = 18, ;
		Top = 513, ;
		Width = 76, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtCchguser' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.cchguser", ;
		Height = 20, ;
		Left = 688, ;
		MaxLength = 10, ;
		Name = "txtCchguser", ;
		ReadOnly = .T., ;
		TabIndex = 25, ;
		Top = 513, ;
		Width = 95, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtcFlatStart' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.cflatstart", ;
		Enabled = .T., ;
		Height = 20, ;
		InputMask = "99", ;
		Left = 131, ;
		lenabled = .T., ;
		MaxLength = 2, ;
		Name = "txtcFlatStart", ;
		TabIndex = 23, ;
		Top = 129, ;
		Visible = .F., ;
		Width = 27
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtcOwnerID' AS txtquickfill WITH ;
		clistexpression = investor.cownerid, ;
		clistworkarea = investor, ;
		ControlSource = "wellinv.cownerid", ;
		Format = "!", ;
		Height = 20, ;
		Left = 85, ;
		lrequired = .T., ;
		MaxLength = 10, ;
		Name = "txtcOwnerID", ;
		TabIndex = 4, ;
		Top = 61, ;
		Width = 78
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtcOwnerName' AS txttextboxcustom WITH ;
		BackColor = 212,208,200, ;
		Height = 20, ;
		Left = 170, ;
		Name = "txtcOwnerName", ;
		TabIndex = 5, ;
		Top = 61, ;
		Width = 281
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtDadded' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.dadded", ;
		Height = 20, ;
		Left = 80, ;
		Name = "txtDadded", ;
		ReadOnly = .T., ;
		TabIndex = 13, ;
		Top = 513, ;
		Width = 84, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtDchanged' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.dchanged", ;
		Height = 20, ;
		Left = 481, ;
		Name = "txtDchanged", ;
		ReadOnly = .T., ;
		TabIndex = 21, ;
		Top = 513, ;
		Width = 84, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtFlatBBL' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nflatbbl", ;
		Enabled = .T., ;
		Height = 20, ;
		InputMask = "999999.99", ;
		Left = 649, ;
		Name = "txtFlatBBL", ;
		SelectOnEntry = .T., ;
		TabIndex = 29, ;
		Top = 158, ;
		Visible = .F., ;
		Width = 98
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtFlatMCF' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nflatmcf", ;
		Enabled = .T., ;
		Height = 20, ;
		InputMask = "999999.99", ;
		Left = 377, ;
		Name = "txtFlatMCF", ;
		SelectOnEntry = .T., ;
		TabIndex = 28, ;
		Top = 158, ;
		Visible = .F., ;
		Width = 98
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtFlatrate' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nflatrate", ;
		Enabled = .T., ;
		Height = 20, ;
		InputMask = "999999.99", ;
		Left = 104, ;
		Name = "txtFlatrate", ;
		SelectOnEntry = .T., ;
		TabIndex = 27, ;
		Top = 158, ;
		Visible = .F., ;
		Width = 98
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtIntclass1' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nintclass1", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 378, ;
		Name = "txtIntclass1", ;
		SelectOnEntry = .T., ;
		TabIndex = 48, ;
		Top = 288, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtIntclass2' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nintclass2", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 650, ;
		Name = "txtIntclass2", ;
		SelectOnEntry = .T., ;
		TabIndex = 49, ;
		Top = 288, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtIntclass3' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nintclass3", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 104, ;
		Name = "txtIntclass3", ;
		SelectOnEntry = .T., ;
		TabIndex = 53, ;
		Top = 313, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtIntclass4' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nintclass4", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 378, ;
		Name = "txtIntclass4", ;
		SelectOnEntry = .T., ;
		TabIndex = 54, ;
		Top = 313, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtIntclass5' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nintclass5", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 650, ;
		Name = "txtIntclass5", ;
		SelectOnEntry = .T., ;
		TabIndex = 55, ;
		Top = 313, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtInterest' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nworkint", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		lautoremember = .F., ;
		Left = 104, ;
		Name = "txtInterest", ;
		SelectOnEntry = .T., ;
		TabIndex = 47, ;
		Top = 288, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtNacpint' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nacpint", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 650, ;
		Name = "txtNacpint", ;
		SelectOnEntry = .T., ;
		TabIndex = 61, ;
		Top = 337, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtNbcpint' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nbcpint", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 378, ;
		Name = "txtNbcpint", ;
		SelectOnEntry = .T., ;
		TabIndex = 60, ;
		Top = 337, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtnPlugPct' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nplugpct", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 197, ;
		Margin = 1, ;
		Name = "txtnPlugPct", ;
		TabIndex = 89, ;
		Top = 474, ;
		Width = 96
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtNtaxpct' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.ntaxpct", ;
		Height = 20, ;
		InputMask = "99.99", ;
		Left = 481, ;
		Margin = 1, ;
		MaxLength = 4, ;
		Name = "txtNtaxpct", ;
		TabIndex = 90, ;
		Top = 474, ;
		Width = 71
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtProgcode' AS txtquickfill WITH ;
		clistexpression = programs.cprogcode, ;
		clistworkarea = programs, ;
		ControlSource = "wellinv.cprogcode", ;
		Format = "!", ;
		Height = 20, ;
		Left = 531, ;
		MaxLength = 10, ;
		Name = "txtProgcode", ;
		TabIndex = 6, ;
		Top = 61, ;
		Width = 78
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevgas' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevgas", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 378, ;
		Name = "txtRevgas", ;
		SelectOnEntry = .T., ;
		TabIndex = 34, ;
		Top = 215, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevmisc1' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevmisc1", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 104, ;
		Name = "txtRevmisc1", ;
		SelectOnEntry = .T., ;
		TabIndex = 40, ;
		Top = 238, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevmisc2' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevmisc2", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 378, ;
		Name = "txtRevmisc2", ;
		SelectOnEntry = .T., ;
		TabIndex = 41, ;
		Top = 238, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevoil' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevoil", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 104, ;
		MaxLength = 11, ;
		Name = "txtRevoil", ;
		SelectOnEntry = .T., ;
		TabIndex = 33, ;
		Top = 215, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevOth' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevoth", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 650, ;
		Name = "txtRevOth", ;
		SelectOnEntry = .T., ;
		TabIndex = 35, ;
		Top = 215, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevtax1' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax1", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 79, ;
		Name = "txtRevtax1", ;
		SelectOnEntry = .T., ;
		TabIndex = 69, ;
		Top = 388, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax10' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax10", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 661, ;
		Name = "txtRevTax10", ;
		SelectOnEntry = .T., ;
		TabIndex = 72, ;
		Top = 388, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax11' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax11", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 661, ;
		Name = "txtRevTax11", ;
		SelectOnEntry = .T., ;
		TabIndex = 76, ;
		Top = 409, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax12' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax12", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 661, ;
		Name = "txtRevTax12", ;
		SelectOnEntry = .T., ;
		TabIndex = 83, ;
		Top = 430, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevtax2' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax2", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 79, ;
		Name = "txtRevtax2", ;
		SelectOnEntry = .T., ;
		TabIndex = 73, ;
		Top = 409, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevtax3' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax3", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 79, ;
		Name = "txtRevtax3", ;
		SelectOnEntry = .T., ;
		TabIndex = 77, ;
		Top = 430, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax4' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax4", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 260, ;
		Name = "txtRevTax4", ;
		SelectOnEntry = .T., ;
		TabIndex = 70, ;
		Top = 388, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax5' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax5", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 260, ;
		Name = "txtRevTax5", ;
		SelectOnEntry = .T., ;
		TabIndex = 74, ;
		Top = 409, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax6' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax6", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 260, ;
		Name = "txtRevTax6", ;
		SelectOnEntry = .T., ;
		TabIndex = 79, ;
		Top = 430, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax7' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax7", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 445, ;
		Name = "txtRevTax7", ;
		SelectOnEntry = .T., ;
		TabIndex = 71, ;
		Top = 388, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax8' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax8", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 445, ;
		Name = "txtRevTax8", ;
		SelectOnEntry = .T., ;
		TabIndex = 75, ;
		Top = 409, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevTax9' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtax9", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 445, ;
		Name = "txtRevTax9", ;
		SelectOnEntry = .T., ;
		TabIndex = 81, ;
		Top = 430, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtRevtrp' AS txttextboxcustom WITH ;
		ControlSource = "wellinv.nrevtrp", ;
		Height = 20, ;
		InputMask = "999.9999999", ;
		Left = 650, ;
		Name = "txtRevtrp", ;
		SelectOnEntry = .T., ;
		TabIndex = 42, ;
		Top = 238, ;
		Width = 97
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtWellid2' AS txtquickfill WITH ;
		clistexpression = cwellid, ;
		clistworkarea = wells, ;
		ControlSource = "wellinv.cwellid", ;
		cworkarea = , ;
		Format = "!", ;
		Height = 20, ;
		Left = 75, ;
		lrequired = .T., ;
		MaxLength = 10, ;
		Name = "txtWellid2", ;
		ReadOnly = .F., ;
		TabIndex = 3, ;
		Top = 13, ;
		Width = 78, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page2.txtWellName' AS txttextboxcustom WITH ;
		BackColor = 192,192,192, ;
		ControlSource = "wells.cwellname", ;
		Height = 20, ;
		Left = 164, ;
		Name = "txtWellName", ;
		ReadOnly = .T., ;
		TabIndex = 4, ;
		Top = 13, ;
		Width = 254, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'pageframe.Page3.cmdDelDoc' AS cmdcommandbuttoncustom WITH ;
		Caption = "Remove Doc", ;
		Height = 36, ;
		Left = 705, ;
		Name = "cmdDelDoc", ;
		Top = 180, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page3.cmdLinkDoc' AS cmdcommandbuttoncustom WITH ;
		Caption = "Link Doc", ;
		Height = 36, ;
		Left = 705, ;
		Name = "cmdLinkDoc", ;
		Top = 72, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page3.cmdShowPath' AS cmdcommandbuttoncustom WITH ;
		Caption = "Show Paths", ;
		Height = 36, ;
		Left = 705, ;
		Name = "cmdShowPath", ;
		Top = 234, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page3.cmdTreeno' AS cmdcommandbuttoncustom WITH ;
		Caption = "Treeno", ;
		Height = 36, ;
		Left = 705, ;
		Name = "cmdTreeno", ;
		Top = 288, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page3.cmdViewDoc' AS cmdcommandbuttoncustom WITH ;
		Caption = "View Doc", ;
		Height = 36, ;
		Left = 705, ;
		Name = "cmdViewDoc", ;
		Top = 126, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'pageframe.Page3.lstDocuments' AS lstlistboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 420, ;
		Left = 19, ;
		Name = "lstDocuments", ;
		Top = 23, ;
		Width = 672
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="listbox" />
	
	PROCEDURE beforeclose
		LPARAMETERS nclosereason
		
		IF NOT FILE('petrox.dat')  &&  Don't ask if this is Petrox, because they do hundreds of replacements at a time, and we wrote them a utility to combine them later
		   swselect('wellinv1')  &&  Check for a record for this owner in this well with this owner type, and don't let them add a duplicate
		   IF wellinv.lFlat
		      LOCATE FOR cWellID = wellinv.cWellID AND cOwnerID = wellinv.cOwnerID AND cTypeInv = wellinv.cTypeInv AND cidwinv <> wellinv.cidwinv AND lFlat
		   ELSE
		      LOCATE FOR cWellID = wellinv.cWellID AND cOwnerID = wellinv.cOwnerID AND cTypeInv = wellinv.cTypeInv AND cidwinv <> wellinv.cidwinv AND NOT lFlat
		   ENDIF
		   IF FOUND()
		*      THISFORM.oMessage.Warning("This owner already has an interest in this well with this owner type.  Add this entry's percentages to the existing record, instead of creating multiple entries.")
		      thisform.cmdatamanager.revertall()
		*      RETURN .F.
		   ENDIF
		ENDIF
		
		thisform.setnextcontrol(ThisForm.pageframe.Page2.cboOwnType)
		
		dodefault(nCloseReason)
	ENDPROC

	PROCEDURE beforenav
		LPARAMETERS cWorkarea, lForceConfirm
		
		IF LOWER(m.cworkarea) == 'wellinv'
		   swselect('wellinv')
		   IF GETFLDSTATE(0,m.cworkarea) > 1 OR '2' $ GETFLDSTATE(-1,m.cworkarea)
		      IF FILE('changedflds.txt')
		         lcFields = GETFLDSTATE(-1,m.cworkarea)
		         lnfield  = ATC('2',lcfields)
		         IF lnfield > 0
		            MESSAGEBOX('Field: ' + FIELD(lnField) + ' was changed. Value = ' + ;
		                      TRANSFORM(EVALUATE(FIELD(lnfield))) + ' Well/Owner: ' + cwellid+'/'+cownerid+'/'+ctypeinv,0,'Field Changed')
		         ENDIF
		      ENDIF    
		      IF thisform.omessage.confirm('Save changes to this form?')
		         thisform.save()
		      ENDIF
		   ENDIF
		ENDIF 
	ENDPROC

	PROCEDURE calcints		&& Calculates the total interest for the given interest class.
		******************************************************
		*  Checks the interests in the given interest class
		*  and sets a warning property to .T. if they are 
		*  over 100%
		******************************************************
		LOCAL lcWellID, lnTotal, lnRecNo
		
		   
		lnTotal = 0
		
		thisform.pageFrame.page1.cboInterestClass.Refresh()
		thisform.pageframe.page1.txtWellID1.Refresh()
		lcWellID = thisform.pageframe.page1.txtWellID1.value
		
		SELECT (thisform.pageframe.page1.grdgridcustom1.recordsource)
		lnRecNo = RECNO()
		
		SUM(interest) TO lnTotal
		
		IF lnRecNo <= RECC()
		   GOTO (lnRecNo)
		ENDIF  
		      
		THISFORM.pageframe.page1.txtnTotalInt.value = lnTotal
		THISFORM.pageframe.page1.txtnTotalInt.REFRESH()
		
		IF lnTotal > 100 
		   IF NOT thisform.lIntWarning
		      thisform.lIntWarning = .T.
		   ENDIF   
		ELSE
		   thisform.lIntWarning = .F.   
		ENDIF   
		
	ENDPROC

	PROCEDURE checkdecks
		*
		* Adds any missing decks to doidecks
		*
		swselect('wellinv')
		swselect('doidecks')
		SET ORDER to DECKORDER   && CDECK+CWELLID
		
		SELECT cdeck, cwellid FROM wellinv INTO CURSOR temp ;
		   ORDER BY cdeck, cwellid ;
		   GROUP BY cdeck, cwellid
		   
		   
		SELECT temp
		SCAN 
		   SCATTER MEMVAR 
		   
		   SELECT doidecks
		   IF NOT SEEK(m.cdeck+m.cwellid)
		      m.effstartyr = '2010'
		      m.effstartprd = '01'
		      INSERT INTO doidecks FROM MEMVAR 
		   ENDIF 
		ENDSCAN 
		
		TABLEUPDATE(.t.,.t.,'doidecks')
		
		USE IN temp
	ENDPROC

	PROCEDURE chkinterest		&& Checks the given interest in the currently displayed well to see what the total interest in the well is.
		LPARA tcType, tlDialog, tlValidate
		*
		*  Calculates the interest in the given class and
		*  builds a message to show in the lblInterestTotal label
		*
		*  tcType   = the type of interest to check
		*  tlDialog = check all interests and display in a dialog
		*
		
		lnTotal   = 0
		lcMessage = ' '
		
		DO CASE
		   CASE NOT tlDialog
		      RETURN
		      DO CASE
		         CASE tcType = '**'
		            lcMessage = ''
		
		         CASE tcType = 'OR'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cWellID AND INLIST(cTypeInt, 'O', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevoil
		            ENDSCAN
		            lcMessage = 'Oil Revenue = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'GR'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cWellID AND INLIST(cTypeInt, 'G', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevgas
		            ENDSCAN
		            lcMessage = 'Gas Revenue = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'TR'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cWellID AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtrp
		            ENDSCAN
		            lcMessage = 'Transportation Revenue = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'OP'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cWellID AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevoth
		            ENDSCAN
		            lcMessage = 'Other Product Revenue = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'DC'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nworkint
		            ENDSCAN
		            lcMessage = 'Operating Interests = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'M1'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevmisc1
		            ENDSCAN
		            lcMessage = 'Miscellaneous Revenue 1 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'M2'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevmisc2
		            ENDSCAN
		            lcMessage = 'Miscellaneous Revenue 2 = ' + STR(lnTotal, 11, 7)
		         CASE tcType = 'E1'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nintclass1
		            ENDSCAN
		            lcMessage = 'Expense Class 1 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'E2'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nintclass2
		            ENDSCAN
		            lcMessage = 'Expense Class 2 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'E3'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nintclass3
		            ENDSCAN
		            lcMessage = 'Expense Class 3 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'E4'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nintclass4
		            ENDSCAN
		            lcMessage = 'Expense Class 4 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'E5'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nintclass5
		            ENDSCAN
		            lcMessage = 'Expense Class 5 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'BC'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nbcpint
		            ENDSCAN
		            lcMessage = 'Before Casing Point = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'AC'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nacpint
		            ENDSCAN
		            lcMessage = 'After Casing Point = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'AP'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + napoint
		            ENDSCAN
		            lcMessage = 'After Payout = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'OT1'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax1
		            ENDSCAN
		            lcMessage = 'Oil Taxes 1 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'GT1'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax2
		            ENDSCAN
		            lcMessage = 'Gas Taxes 1 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'PT1'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax3
		            ENDSCAN
		            lcMessage = 'Other Taxes 1 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'OT2'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax4
		            ENDSCAN
		            lcMessage = 'Oil Taxes 2 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'GT2'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax5
		            ENDSCAN
		            lcMessage = 'Gas Taxes 2 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'PT2'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax6
		            ENDSCAN
		            lcMessage = 'Other Taxes 2 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'OT3'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax7
		            ENDSCAN
		            lcMessage = 'Oil Taxes 3 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'GT3'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax8
		            ENDSCAN
		            lcMessage = 'Gas Taxes 3 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'PT3'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax9
		            ENDSCAN
		            lcMessage = 'Other Taxes 3 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'OT4'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax10
		            ENDSCAN
		            lcMessage = 'Oil Taxes 4 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'GT4'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax11
		            ENDSCAN
		            lcMessage = 'Gas Taxes 4 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'PT4'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nrevtax12
		            ENDSCAN
		            lcMessage = 'Other Taxes 4 = ' + STR(lnTotal, 11, 7)
		
		         CASE tcType = 'PLG'
		            SELECT doifile
		            SCAN FOR cWellID = doidecks.cwellid AND NOT lFlat AND cDeck = doidecks.cdeck
		               lnTotal = lnTotal + nplugpct
		            ENDSCAN
		            lcMessage = 'Plugging Pct = ' + STR(lnTotal, 11, 7)
		
		
		      ENDCASE
		
		      THISFORM.PAGEFRAME.page2.lblInterestTotal.CAPTION = lcMessage
		      THISFORM.PAGEFRAME.page2.lblInterestTotal.REFRESH()
		      RETURN .T.
		
		   CASE tlDialog
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevoil
		      ENDSCAN
		      lnOil   = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND NOT lFlat AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevgas
		      ENDSCAN
		      lnGas   = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevoth
		      ENDSCAN
		      lnother = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtrp
		      ENDSCAN
		      lntrp   = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cTypeInv = 'W' AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nworkint
		      ENDSCAN
		      lnOper  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevmisc1
		      ENDSCAN
		      lnmisc1 = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevmisc2
		      ENDSCAN
		      lnMisc2 = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nintclass1
		      ENDSCAN
		      lnClass1 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nintclass2
		      ENDSCAN
		      lnClass2 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nintclass3
		      ENDSCAN
		      lnClass3 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nintclass4
		      ENDSCAN
		      lnClass4 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nintclass5
		      ENDSCAN
		      lnClass5 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nbcpint
		      ENDSCAN
		      lnbcp   = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nacpint
		      ENDSCAN
		      lnacp   = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + napoint
		      ENDSCAN
		      lnapo   = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nplugpct
		      ENDSCAN
		      lnPlug = lnTotal
		      lnTotal   = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax1
		      ENDSCAN
		      lnOil1  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax2
		      ENDSCAN
		      lnGas1  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax3
		      ENDSCAN
		      lnOther1 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax4
		      ENDSCAN
		      lnOil2  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax5
		      ENDSCAN
		      lnGas2  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax6
		      ENDSCAN
		      lnOther2 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax7
		      ENDSCAN
		      lnOil3  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax8
		      ENDSCAN
		      lnGas3  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax9
		      ENDSCAN
		      lnOther3 = lnTotal
		      lnTotal  = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'O', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax10
		      ENDSCAN
		      lnOil4  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND INLIST(cTypeInt, 'G', 'B') AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax11
		      ENDSCAN
		      lnGas4  = lnTotal
		      lnTotal = 0
		
		      SELECT doifile
		      SCAN FOR cWellID = doidecks.cwellid AND cDeck = doidecks.cdeck
		         lnTotal = lnTotal + nrevtax12
		      ENDSCAN
		      lnOther4 = lnTotal
		      lnTotal  = 0
		
		      IF NOT tlValidate
		         DO FORM ..\commonsource\dmdoicheck
		         RETURN .T.
		      ELSE
		         llValidate = .T.
		         lcMessage  = 'The following interests are greater than 100%:' + CHR(13)
		         IF lnOil > 100
		            lcMessage  = lcMessage + 'Oil Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnGas > 100
		            lcMessage  = lcMessage + 'Gas Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnother > 100
		            lcMessage  = lcMessage + 'Other Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnmisc1 > 100
		            lcMessage  = lcMessage + 'Misc 1 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnMisc2 > 100
		            lcMessage  = lcMessage + 'Misc 2 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOil1 > 100
		            lcMessage  = lcMessage + 'Oil Tax 1 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOil2 > 100
		            lcMessage  = lcMessage + 'Oil Tax 2 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOil3 > 100
		            lcMessage  = lcMessage + 'Oil Tax 3 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOil4 > 100
		            lcMessage  = lcMessage + 'Oil Tax 4 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnGas1 > 100
		            lcMessage  = lcMessage + 'Gas Tax 1 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnGas2 > 100
		            lcMessage  = lcMessage + 'Gas Tax 2 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnGas3 > 100
		            lcMessage  = lcMessage + 'Gas Tax 3 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnGas4 > 100
		            lcMessage  = lcMessage + 'Gas Tax 4 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOther1 > 100
		            lcMessage  = lcMessage + 'Other Tax 1 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOther2 > 100
		            lcMessage  = lcMessage + 'Other Tax 2 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOther3 > 100
		            lcMessage  = lcMessage + 'Other Tax 3 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOther4 > 100
		            lcMessage  = lcMessage + 'Other Tax 4 Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lntrp > 100
		            lcMessage  = lcMessage + 'Trans Revenue' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnOper > 100
		            lcMessage  = lcMessage + 'Working Interest' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnClass1 > 100
		            lcMessage  = lcMessage + 'Class 1 Expense' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnClass2 > 100
		            lcMessage  = lcMessage + 'Class 2 Expense' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnClass3 > 100
		            lcMessage  = lcMessage + 'Class 3 Expense' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnClass4 > 100
		            lcMessage  = lcMessage + 'Class 4 Expense' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnClass5 > 100
		            lcMessage  = lcMessage + 'Class 5 Expense' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnbcp > 100
		            lcMessage  = lcMessage + 'BCP Expense' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnacp > 100
		            lcMessage  = lcMessage + 'ACP Expense' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         IF lnPlug > 100
		            lcMessage  = lcMessage + 'Plugging Pct' + CHR(13)
		            llValidate = .F.
		         ENDIF
		         lcMessage = lcMessage + 'The interests for this well need corrected.'
		         IF NOT llValidate
		            MESSAGEBOX(lcMessage, 16, 'DOI Problem')
		         ENDIF
		         RETURN (llValidate)
		      ENDIF
		ENDCASE
		
		
		
		
		 
	ENDPROC

	PROCEDURE createnewdeck
		****************************************************************************************
		*  Created: 5/12/21
		*  Author:   Phil Sherwood
		*
		* Purpose: Creates a new DOI deck based off the default (or blank) deck with a new name
		* 
		* Parameters:
		*
		* Changes:
		*
		****************************************************************************************
		lcWell = thisform.pageframe.page2.txtWellID2.Value 
		
		DO FORM getdeckname WITH lcWell TO lcDeckName
		
		IF NOT EMPTY(lcDeckName)
		 
		   SELECT * FROM wellinv  ;
		      WHERE cDeck = thisform.pageframe.page2.cbodeck2.value ;
		        AND cWellID = lcWell ;
		      INTO CURSOR newdoi 
		   
		   IF _tally > 0
		      SELECT newdoi
		      SCAN 
		         SCATTER MEMVAR 
		         m.cDeck = lcDeckName
		         m.cidwinv = GetNextPK('DOI')
		         INSERT INTO wellinv FROM MEMVAR 
		      ENDSCAN 
		      TABLEUPDATE(.t.,.t.,'Wellinv')
		      thisform.pageframe.page2.cbodeck2.Refresh()
		      MESSAGEBOX('Created new DOI Deck ' + lcDeckName,64,thisform.Caption)
		      swclose('newdoi')
		      thisform.RequeryDeck(lcDeckName,lcWell)
		      thisform.pageframe.page1.cbodeck1.Requery(lcDeckName)
		      thisform.requeryclass('Doidecks')
		   ENDIF    
		ENDIF 
	ENDPROC

	PROCEDURE Init
		IF DODEFAULT()  
		   IF NOT thisform.cmdatamanager.isnew('wellinv')  &&  To avoid asking you if you want to save immediately after answering Yes about adding a new record to the empty table
		      SELECT doidecks
		      SET ORDER to navorder
		      LOCATE FOR cdeck = 'ORIGINAL'
		      IF NOT FOUND()
		         GO top
		      ENDIF 
		      SELECT wells
		      LOCATE FOR cwellid = doidecks.cwellid
		      IF FOUND()
		         thisform.pageframe.page1.txtwellname.set('value',wells.cwellname)
		         thisform.pageframe.page2.txtwellname.set('value',wells.cwellname)
		      ELSE
		         thisform.pageframe.page1.txtwellname.set('value','')
		         thisform.pageframe.page2.txtwellname.set('value','')
		      ENDIF 
		      *thisform.requeryclass('Wells')
		   ENDIF 
		   IF m.goApp.lDocuments
		      thisform.AddObject('oFileDialog','sffiledialog')
		      thisform.pageFrame.PageCount = 3
		   ELSE
		      thisform.pageFrame.PageCount = 2
		   ENDIF 
		   
		   * Check to see if there are any interests in wellinv for a 
		   * deck that isn't in doidecks. Add the deck if it doesn't exist.
		   thisform.CheckDecks()
		ENDIF 
	ENDPROC

	PROCEDURE list
		LPARAMETERS cworkarea
		LOCAL lcList
		PRIV llOK
		
		DO CASE
			CASE  THISFORM.PAGEFRAME.ACTIVEPAGE = 1  && Interest Views
			    lcList = 'cdeck\Deck Name,cwellid\Well ID,cwellname\Well Name'
			    
			    SELECT doidecks.cdeck, ;
			           doidecks.cwellid, ;
			           wells.cwellname ;
			       FROM doidecks ;
			            JOIN wells ON wells.cwellid = doidecks.cwellid ;
			       INTO CURSOR decklist READWRITE ;
			       ORDER BY doidecks.cdeck, doidecks.cwellid 
			    
			    INDEX ON cwellname TAG cwellname
			    INDEX ON cwellid   TAG cwellid   
			    INDEX ON cdeck     TAG cdeck 
			    
			    llOK = .F.
			    DO form .custom\picklist WITH 'decklist', lcList, thisform.pageframe.page1.cbodeck1.Value, 3, .t., .t.
			    
			    IF llOK
			       swselect('doidecks')
			       LOCATE FOR cdeck = decklist.cdeck ;
			              AND cwellid = decklist.cwellid
			       thisform.pageframe.page1.cbodeck1.Value = doidecks.cdeck
			       thisform.pageframe.page1.cbodeck1.Refresh()
			       thisform.pageframe.page1.txtWellID1.Value = doidecks.cwellid
			       thisform.pageframe.page1.txtWellID1.refresh()
			       thisform.cmdatamanager.afternav('Wells')
		           thisform.pageFrame.page1.Activate()
			    ENDIF 
		
			CASE THISFORM.PAGEFRAME.ACTIVEPAGE = 2  && Owner Interests
		
				IF THIS.flushcontrolbuffer() AND THIS.beforenav('Wellinv')
		
					llOK = .F.
					lcList = 'cwellid\Well ID,cDeck\Deck,cwellname\Well Name, cgroup\Group, cownerid\Owner ID,cownname\Owner Name,ctypeinv\Type'
		
					SELECT wellinv.cwellid, ;
						wellinv.cownerid, ;
						wellinv.ctypeinv, ;
						wells.cwellname, ;
						wells.cgroup, ;
						wellinv.cdeck, ;
						investor.csortfield AS cownname, ;
						wellinv.cidwinv ;
						FROM wellinv, wells, investor ;
						INTO CURSOR tempdoi READWRITE ;
						WHERE wellinv.cwellid = wells.cwellid ;
						AND wellinv.cownerid = investor.cownerid ;
						ORDER BY wellinv.cwellid, wellinv.cdeck, wellinv.ctypeinv, wellinv.cownerid
		
					IF _TALLY > 0
						SELECT tempdoi
						INDEX ON cwellid+ctypeinv+cownerid TAG cwellid
						INDEX ON cownerid+cwellid+ctypeinv TAG cownerid
						INDEX ON cwellname TAG cwellname
						INDEX ON cownname  TAG cownname
						INDEX ON ctypeinv  TAG ctypeinv
						INDEX on cdeck     TAG cdeck
		
						DO FORM ..\CUSTOM\picklist WITH 'Tempdoi', lcList, wellinv.cwellid, 7, .T., .T.
		
		
						IF llOK
							swselect('wellinv')
							THISFORM.cmdatamanager.revertall()
							swselect('wellinv')
							SET ORDER TO cidwinv
		
							IF SEEK(tempdoi.cidwinv)
								SELECT doifile
								SET ORDER TO cidwinv
								SEEK(tempdoi.cidwinv)
								SELECT wells
								LOCATE FOR cwellid == doifile.cwellid
								THISFORM.pageframe.page2.txtwellname.SET('VALUE',tempdoi.cwellname)
								THISFORM.pageframe.page2.txtWellID2.VALUE = tempdoi.cwellid
		
								IF wellinv.ctypeinv <> 'W'  &&  Not WI, so disable the working interest text box
									THISFORM.PAGEFRAME.page2.txtInterest.SET('Enabled',.F.)
									THISFORM.PAGEFRAME.page2.txtInterest.ENABLED = .F.
									THISFORM.PAGEFRAME.page2.chkLjib.SET('enabled',.F.)
									THISFORM.PAGEFRAME.page2.chkLjib.ENABLED = .F.
								ELSE
									THISFORM.PAGEFRAME.page2.txtInterest.SET('Enabled',.T.)
									THISFORM.PAGEFRAME.page2.txtInterest.ENABLED = .T.
									THISFORM.PAGEFRAME.page2.chkLjib.SET('enabled',.T.)
									THISFORM.PAGEFRAME.page2.chkLjib.ENABLED = .T.
								ENDIF
		
								THISFORM.REFRESH()
								THISFORM.cmdatamanager.afternav('wellinv')
							ENDIF
						ENDIF
					ELSE
						THISFORM.omessage.DISPLAY('There are no division of interests defined...')
					ENDIF
		
					IF USED('tempdoi1')
						USE IN tempdoi1
					ENDIF
					IF USED('tempdoi')
						USE IN tempdoi
					ENDIF
				ENDIF
		ENDCASE
		
	ENDPROC

	PROCEDURE new
		LPARAMETERS cworkarea
		
		*
		*  Force page2 to be active.  New records can only be added
		*  using page2.
		*
		thisform.pageframe.activepage = 2
		
		RETURN (DODEFAULT('Wellinv'))
	ENDPROC

	PROCEDURE recalcrev		&& Recalculates the net revenue interests.
		*************************************************************************
		*  Calculates the working interest owners NRI based on the royalty burden 
		*  in the well.
		*************************************************************************
		LOCAL lcKey, lnNumInv, lnGasRev, lnOilRev, lnGas, lnOil, lnOver, jnGasRev, jnOilRev, jnOthRev, lnOthRev, lnOther
		LOCAL llReturn, llTaxes, llWorkIntComplain, loError
		
		llReturn = .T.
		
		TRY
		
		   IF THISFORM.flushcontrolbuffer()
		      STORE 0 TO lnGasRev, lnGas, lnOilRev, lnOil, jnGasRev, jnOilRev, lnOther, lnOthRev, jnOthRev, lnNumInv, lnOver
		
		      IF THISFORM.pageframe.page2.chkspecify.VALUE = .F.
		         llTaxes = .T.
		      ELSE
		         llTaxes = .F.
		      ENDIF
		*
		*  Not explicitly specifying gas and oil income interests, so calculate
		*
		      WAIT WIND NOWAIT 'Recalculating Revenue Interests...'
		      SELECT  cWellID,;
		              cownerid,;
		              nworkint,;
		              ctypeinv,;
		              cTypeInt, ;
		              000.00000000 AS noinc,;
		              000.00000000 AS nginc, ;
		              lflat,;
		              nflatrate,;
		              cDirect,;
		              lprogram,;
		              cprogcode,;
		              cidwinv, ;
		              nrevgas,;
		              nrevoil,;
		              lJIB,;
		              lOnHold ;
		          FROM wellinv WITH (BUFFERING = .T.) ;
		          INTO CURSOR doiwrk ;
		          WHERE cWellID = THISFORM.pageframe.page2.txtWellID2.VALUE ;
		            AND cDeck   = thisform.pageframe.page2.cbodeck2.Value ;
		            AND nworkint >= 0  ;
		          ORDER BY ctypeinv, cprogcode, cownerid
		
		      lnNumInv = _TALLY
		
		* Get the total of royalty percentages for oil and gas
		      SELECT  SUM(nrevgas) AS nGasPct,;
		              SUM(nrevoil) AS nOilPct,;
		              SUM(nrevoth) AS nOthPct ;
		          FROM wellinv WITH (BUFFERING = .T.) ;
		          INTO CURSOR revwrk ;
		          WHERE cWellID = THISFORM.pageframe.page2.txtWellID2.VALUE ;
		          	AND cDeck   = thisform.pageframe.page2.cbodeck2.Value ;
		            AND (wellinv.lflat = .F. ;
		             OR nflatrate = 0) ;
		            AND INLIST(ctypeinv, 'L', 'O')
		
		      SELECT revwrk
		      lnGasRev = nGasPct
		      lnOilRev = nOilPct
		      lnOthRev = nOthPct
		      jnGasRev = nGasPct
		      jnOilRev = nOilPct
		      jnOthRev = nOthPct
		
		      SELECT doifile
		      SET ORDER TO cidinvwell
		
		      llWorkIntComplain = .F.
		
		* Initialize lcKey in case they don't have any working interest owners entered yet.
		      lcKey = '********'
		
		      SELECT doiwrk
		      SCAN FOR NOT lprogram
		         SCATTER MEMVAR
		         IF m.ctypeinv = 'W'
		            IF m.nworkint = 0 AND NOT llWorkIntComplain
		               MESSAGEBOX('At least one working interest owner does not have a working interest specified. ' + ;
		                    'Working interest owners must have a working interest percentage in order for the ' + ;
		                    'net revenue percentages for oil, gas and other products to calculate automatically.', 48, 'Calculate Net Revenue Problem')
		               llWorkIntComplain = .T.
		            ENDIF
		            IF INLIST(m.cTypeInt, 'B', 'G')
		               lnGas = ROUND(m.nworkint * (100 - lnGasRev) / 100, 7)
		            ELSE
		               lnGas = 0
		            ENDIF
		            IF INLIST(m.cTypeInt, 'B', 'O')
		               lnOil = ROUND(m.nworkint * (100 - lnOilRev) / 100, 7)
		            ELSE
		               lnOil = 0
		            ENDIF
		            IF m.cTypeInt = 'B'
		               lnOther = ROUND(m.nworkint * (100 - lnOthRev) / 100, 7)
		            ELSE
		               lnOther = 0
		            ENDIF
		            jnGasRev = jnGasRev + lnGas
		            jnOilRev = jnOilRev + lnOil
		            jnOthRev = jnOthRev + lnOther
		            lcKey    = m.cidwinv + m.cownerid + m.cWellID
		            SELECT doifile
		            IF SEEK (lcKey)
		               REPLACE nworkint WITH m.nworkint
		               IF nrevgas <> lnGas
		                  REPLACE nrevgas WITH lnGas
		                  IF llTaxes
		                     REPL nRevTax2  WITH lnGas, ;
		                        nRevTax5  WITH lnGas, ;
		                        nRevTax8  WITH lnGas, ;
		                        nRevTax11 WITH lnGas
		                  ENDIF
		               ENDIF
		               IF nrevoil <> lnOil
		                  REPLACE nrevoil WITH lnOil
		                  IF llTaxes
		                     REPL nRevTax1  WITH lnOil, ;
		                        nRevTax4  WITH lnOil, ;
		                        nRevTax7  WITH lnOil, ;
		                        nRevTax10 WITH lnOil
		                  ENDIF
		               ENDIF
		               IF nrevoth <> lnOther
		                  REPLACE nrevoth WITH lnOther
		                  IF llTaxes
		                     REPL nRevTax3  WITH lnOther, ;
		                        nRevTax6  WITH lnOther, ;
		                        nRevTax9  WITH lnOther, ;
		                        nRevTax12 WITH lnOther
		                  ENDIF
		               ENDIF
		            ENDIF
		         ENDIF
		      ENDSCAN
		*
		*  If the gas revenue percentages total over 100%, subtract the
		*  overage from the last owner in the well.
		*
		      IF jnGasRev > 100
		         lnOver = jnGasRev - 100.0000000
		         lnGas  = lnGas - lnOver
		         SELECT doifile
		         IF SEEK(lcKey)
		            IF nrevgas <> lnGas
		               REPLACE nrevgas WITH lnGas
		               IF llTaxes
		                  REPL nRevTax2  WITH lnGas, ;
		                     nRevTax5  WITH lnGas, ;
		                     nRevTax8  WITH lnGas, ;
		                     nRevTax11 WITH lnGas
		               ENDIF
		            ENDIF
		         ENDIF
		      ENDIF
		*
		*  If the gas revenue percentages are under 100%, add the
		*  amount to the last owner in the well.  This is only if
		*  the amount the total is under 100% is less than 1%.
		*
		      IF jnGasRev < 100 AND jnGasRev > 99
		         lnOver = 100 - jnGasRev
		         lnGas  = lnGas + lnOver
		         SELECT doifile
		         IF SEEK(lcKey)
		            IF nrevgas <> lnGas
		               REPLACE nrevgas WITH lnGas
		               IF llTaxes
		                  REPL nRevTax2  WITH lnGas, ;
		                     nRevTax5  WITH lnGas, ;
		                     nRevTax8  WITH lnGas, ;
		                     nRevTax11 WITH lnGas
		               ENDIF
		            ENDIF
		         ENDIF
		      ENDIF
		*
		*  If the oil revenue percentages total over 100%, subtract the
		*  overage from the last owner in the well.
		*
		      IF jnOilRev > 100
		         lnOver = jnOilRev - 100.0000000
		         lnOil  = lnOil - lnOver
		         SELECT doifile
		         IF SEEK (lcKey)
		            IF nrevoil <> lnOil
		               REPLACE nrevoil WITH lnOil
		               IF llTaxes
		                  REPL nRevTax1  WITH lnOil, ;
		                     nRevTax4  WITH lnOil, ;
		                     nRevTax7  WITH lnOil, ;
		                     nRevTax10 WITH lnOil
		               ENDIF
		            ENDIF
		         ENDIF
		      ENDIF
		*
		*  If the oil revenue percentages are under 100%, add the
		*  amount to the last owner in the well.  This is only if
		*  the amount the total is under 100% is less than 1%.
		*
		      IF jnOilRev < 100 AND jnOilRev > 99
		         lnOver = 100 - jnOilRev
		         lnOil  = lnOil + lnOver
		         SELECT doifile
		         IF SEEK (lcKey)
		            IF nrevoil <> lnOil
		               REPLACE nrevoil WITH lnOil
		               IF llTaxes
		                  REPL nRevTax1  WITH lnOil, ;
		                     nRevTax4  WITH lnOil, ;
		                     nRevTax7  WITH lnOil, ;
		                     nRevTax10 WITH lnOil
		               ENDIF
		            ENDIF
		         ENDIF
		      ENDIF
		
		*
		*  If the other revenue percentages total over 100%, subtract the
		*  overage from the last owner in the well.
		*
		      IF jnOthRev > 100
		         lnOver  = jnOthRev - 100.0000000
		         lnOther = lnOther - lnOver
		         SELECT doifile
		         IF SEEK (lcKey)
		            IF nrevoth <> lnOther
		               REPLACE nrevoth WITH lnOther
		               IF llTaxes
		                  REPL nRevTax3  WITH lnOther, ;
		                     nRevTax6  WITH lnOther, ;
		                     nRevTax9  WITH lnOther, ;
		                     nRevTax12 WITH lnOther
		               ENDIF
		            ENDIF
		         ENDIF
		      ENDIF
		*
		*  If the other revenue percentages are under 100%, add the
		*  amount to the last owner in the well.  This is only if
		*  the amount the total is under 100% is less than 1%.
		*
		      IF jnOthRev < 100 AND jnOthRev > 99
		         lnOver  = 100 - jnOthRev
		         lnOther = lnOther + lnOver
		         SELECT doifile
		         IF SEEK (lcKey)
		            IF nrevoth <> lnOther
		               REPLACE nrevoth WITH lnOther
		               IF llTaxes
		                  REPL nRevTax3  WITH lnOther, ;
		                     nRevTax6  WITH lnOther, ;
		                     nRevTax9  WITH lnOther, ;
		                     nRevTax12 WITH lnOther
		               ENDIF
		            ENDIF
		         ENDIF
		      ENDIF
		
		*  Update landowner and override pcts in the well record
		      SELECT wells
		      IF nOilInt <> lnOilRev
		         REPL nOilInt WITH lnOilRev
		      ENDIF
		      IF nGasInt <> lnGasRev
		         REPL nGasInt WITH lnGasRev
		      ENDIF
		
		   ENDIF
		CATCH TO loError
		   llReturn = .F.
		   DO errorlog WITH 'Recalcrev', loError.LINENO, 'DOI', loError.ERRORNO, loError.MESSAGE, '', loError
		   MESSAGEBOX('Unable to process the DOI at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		        'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		ENDTRY
		
		RETURN llReturn
	ENDPROC

	PROCEDURE requeryclass
		*******************************************************************
		* Builds the Interest Views grid based on the current well and deck
		*******************************************************************
		LPARA cworkarea
		PRIV lcWellID, lcDeck
		
		
		m.cworkarea = PROPER(m.cworkarea)
		lcWellID = doidecks.cwellid
		lcDeck   = thisform.pageFrame.page1.cboDeck1.Value 
		
		swselect('wells')
		LOCATE FOR cwellid = lcWellID
		IF FOUND()
		   THISFORM.pageframe.page1.txtwellName.VALUE = wells.cwellname
		ELSE
		   THISFORM.pageframe.page1.txtwellName.VALUE = 'Unknown'
		ENDIF
		
		lcView = THISFORM.PAGEFRAME.page1.cbointerestclass.LISTITEM[thisform.pageframe.page1.cbointerestclass.listitemid,2]
		
		* Nothing to requery if the dropdown hasn't been initialized yet
		IF EMPTY(lcView)
		   lcView = 'DC'
		ENDIF 
		
		STRTOFILE('DOI: Requery Class workarea = ' + m.cworkarea + ' Well = ' + lcWellid + ' Deck = ' + lcDeck + CHR(10),'doidebug.txt',1)
		
		WITH THISFORM.PAGEFRAME.page1.grdgridcustom1
		   DO CASE
		      CASE lcView = 'DC'
		         .RECORDSOURCE = 'DOI_DC'
		         .Column1.CONTROLSOURCE             = 'DOI_DC.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_DC.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_DC.lonhold'
		         .Column4.CONTROLSOURCE             = 'DOI_DC.ljib'
		         .Column5.CONTROLSOURCE             = 'DOI_DC.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_DC.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_DC.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_DC.lflat'
		         .Column10.CONTROLSOURCE            = 'DOI_DC.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_DC.interest'
		         .cworkarea = 'DOI_DC'
		         =REQUERY('DOI_DC')
		
		      CASE lcView = 'OR'
		         .RECORDSOURCE = 'DOI_OR'
		         .Column1.CONTROLSOURCE             = 'DOI_OR.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_OR'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_OR.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_OR.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_OR.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_OR'
		         .Column3.chkOnHold.cValueSource    = 'DOI_OR.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_OR.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_OR'
		         .Column4.chkJIB.cValueSource       = 'DOI_OR.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_OR.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_OR'
		         .Column5.txtOwnerType.cValueSource = 'DOI_OR.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_OR.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_OR'
		         .Column6.txtIntType.cValueSource   = 'DOI_OR.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_OR.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_OR'
		         .Column7.txtDirectPay.cValueSource = 'DOI_OR.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_OR.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_OR'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_OR.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_OR.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_OR'
		         .Column10.txtProgCode.cValueSource = 'DOI_OR.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_OR.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_OR'
		         .Column11.txtInterest.cValueSource = 'DOI_OR.interest'
		         .cworkarea = 'DOI_OR'
		         =REQUERY('DOI_OR')
		
		      CASE lcView = 'GR'
		         .RECORDSOURCE = 'DOI_GR'
		         .Column1.CONTROLSOURCE             = 'DOI_GR.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_GR'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_GR.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_GR.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_GR.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_GR'
		         .Column3.chkOnHold.cValueSource    = 'DOI_GR.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_GR.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_GR'
		         .Column4.chkJIB.cValueSource       = 'DOI_GR.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_GR.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_GR'
		         .Column5.txtOwnerType.cValueSource = 'DOI_GR.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_GR.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_GR'
		         .Column6.txtIntType.cValueSource   = 'DOI_GR.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_GR.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_GR'
		         .Column7.txtDirectPay.cValueSource = 'DOI_GR.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_GR.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_GR'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_GR.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_GR.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_GR'
		         .Column10.txtProgCode.cValueSource = 'DOI_GR.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_GR.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_GR'
		         .Column11.txtInterest.cValueSource = 'DOI_GR.interest'
		         .cworkarea = 'DOI_GR'
		         =REQUERY('DOI_GR')
		
		      CASE lcView = 'TR'
		         .RECORDSOURCE = 'DOI_TR'
		         .Column1.CONTROLSOURCE             = 'DOI_TR.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_TR'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_TR.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_TR.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_TR.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_TR'
		         .Column3.chkOnHold.cValueSource    = 'DOI_TR.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_TR.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_TR'
		         .Column4.chkJIB.cValueSource       = 'DOI_TR.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_TR.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_TR'
		         .Column5.txtOwnerType.cValueSource = 'DOI_TR.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_TR.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_TR'
		         .Column6.txtIntType.cValueSource   = 'DOI_TR.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_TR.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_TR'
		         .Column7.txtDirectPay.cValueSource = 'DOI_TR.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_TR.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_TR'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_TR.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_TR.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_TR'
		         .Column10.txtProgCode.cValueSource = 'DOI_TR.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_TR.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_TR'
		         .Column11.txtInterest.cValueSource = 'DOI_TR.interest'
		         .cworkarea = 'DOI_TR'
		         =REQUERY('DOI_TR')
		
		      CASE lcView = 'OP'
		         .RECORDSOURCE = 'DOI_OP'
		         .Column1.CONTROLSOURCE             = 'DOI_OP.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_OP'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_OP.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_OP.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_OP.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_OP'
		         .Column3.chkOnHold.cValueSource    = 'DOI_OP.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_OP.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_OP'
		         .Column4.chkJIB.cValueSource       = 'DOI_OP.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_OP.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_OP'
		         .Column5.txtOwnerType.cValueSource = 'DOI_OP.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_OP.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_OP'
		         .Column6.txtIntType.cValueSource   = 'DOI_OP.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_OP.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_OP'
		         .Column7.txtDirectPay.cValueSource = 'DOI_OP.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_OP.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_OP'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_OP.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_OP.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_OP'
		         .Column10.txtProgCode.cValueSource = 'DOI_OP.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_OP.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_OP'
		         .Column11.txtInterest.cValueSource = 'DOI_OP.interest'
		         .cworkarea = 'DOI_OP'
		         =REQUERY('DOI_OP')
		
		      CASE lcView = 'M1'
		         .RECORDSOURCE = 'DOI_M1'
		         .Column1.CONTROLSOURCE             = 'DOI_M1.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_M1'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_M1.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_M1.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_M1.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_M1'
		         .Column3.chkOnHold.cValueSource    = 'DOI_M1.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_M1.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_M1'
		         .Column4.chkJIB.cValueSource       = 'DOI_M1.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_M1.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_M1'
		         .Column5.txtOwnerType.cValueSource = 'DOI_M1.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_M1.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_M1'
		         .Column6.txtIntType.cValueSource   = 'DOI_M1.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_M1.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_M1'
		         .Column7.txtDirectPay.cValueSource = 'DOI_M1.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_M1.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_M1'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_M1.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_M1.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_M1'
		         .Column10.txtProgCode.cValueSource = 'DOI_M1.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_M1.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_M1'
		         .Column11.txtInterest.cValueSource = 'DOI_M1.interest'
		         .cworkarea = 'DOI_M1'
		         =REQUERY('DOI_M1')
		
		      CASE lcView = 'M2'
		         .RECORDSOURCE = 'DOI_M2'
		         .Column1.CONTROLSOURCE             = 'DOI_M2.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_M2'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_M2.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_M2.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_M2.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_M2'
		         .Column3.chkOnHold.cValueSource    = 'DOI_M2.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_M2.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_M2'
		         .Column4.chkJIB.cValueSource       = 'DOI_M2.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_M2.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_M2'
		         .Column5.txtOwnerType.cValueSource = 'DOI_M2.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_M2.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_M2'
		         .Column6.txtIntType.cValueSource   = 'DOI_M2.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_M2.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_M2'
		         .Column7.txtDirectPay.cValueSource = 'DOI_M2.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_M2.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_M2'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_M2.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_M2.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_M2'
		         .Column10.txtProgCode.cValueSource = 'DOI_M2.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_M2.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_M2'
		         .Column11.txtInterest.cValueSource = 'DOI_M2.interest'
		         .cworkarea = 'DOI_M2'
		         =REQUERY('DOI_M2')
		
		      CASE lcView = 'BC'
		         .RECORDSOURCE = 'DOI_BC'
		         .Column1.CONTROLSOURCE             = 'DOI_BC.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_BC'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_BC.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_BC.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_BC.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_BC'
		         .Column3.chkOnHold.cValueSource    = 'DOI_BC.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_BC.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_BC'
		         .Column4.chkJIB.cValueSource       = 'DOI_BC.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_BC.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_BC'
		         .Column5.txtOwnerType.cValueSource = 'DOI_BC.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_BC.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_BC'
		         .Column6.txtIntType.cValueSource   = 'DOI_BC.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_BC.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_BC'
		         .Column7.txtDirectPay.cValueSource = 'DOI_BC.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_BC.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_BC'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_BC.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_BC.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_BC'
		         .Column10.txtProgCode.cValueSource = 'DOI_BC.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_BC.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_BC'
		         .Column11.txtInterest.cValueSource = 'DOI_BC.interest'
		         .cworkarea = 'DOI_BC'
		         =REQUERY('DOI_BC')
		
		      CASE lcView = 'AC'
		         .RECORDSOURCE = 'DOI_AC'
		         .Column1.CONTROLSOURCE             = 'DOI_AC.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_AC'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_AC.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_AC.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_AC.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_AC'
		         .Column3.chkOnHold.cValueSource    = 'DOI_AC.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_AC.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_AC'
		         .Column4.chkJIB.cValueSource       = 'DOI_AC.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_AC.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_AC'
		         .Column5.txtOwnerType.cValueSource = 'DOI_AC.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_AC.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_AC'
		         .Column6.txtIntType.cValueSource   = 'DOI_AC.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_AC.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_AC'
		         .Column7.txtDirectPay.cValueSource = 'DOI_AC.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_AC.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_AC'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_AC.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_AC.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_AC'
		         .Column10.txtProgCode.cValueSource = 'DOI_AC.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_AC.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_AC'
		         .Column11.txtInterest.cValueSource = 'DOI_AC.interest'
		         .cworkarea = 'DOI_AC'
		         =REQUERY('DOI_AC')
		
		      CASE lcView = 'AP'
		         .RECORDSOURCE = 'DOI_AP'
		         .Column1.CONTROLSOURCE             = 'DOI_AP.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_AP'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_AP.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_AP.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_AP.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_AP'
		         .Column3.chkOnHold.cValueSource    = 'DOI_AP.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_AP.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_AP'
		         .Column4.chkJIB.cValueSource       = 'DOI_AP.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_AP.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_AP'
		         .Column5.txtOwnerType.cValueSource = 'DOI_AP.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_AP.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_AP'
		         .Column6.txtIntType.cValueSource   = 'DOI_AP.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_AP.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_AP'
		         .Column7.txtDirectPay.cValueSource = 'DOI_AP.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_AP.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_AP'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_AP.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_AP.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_AP'
		         .Column10.txtProgCode.cValueSource = 'DOI_AP.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_AP.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_AP'
		         .Column11.txtInterest.cValueSource = 'DOI_AP.interest'
		         .cworkarea = 'DOI_AP'
		         =REQUERY('DOI_AP')
		
		      CASE lcView = 'E1'
		         .RECORDSOURCE = 'DOI_E1'
		         .Column1.CONTROLSOURCE             = 'DOI_E1.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_E1'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_E1.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_E1.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_E1.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_E1'
		         .Column3.chkOnHold.cValueSource    = 'DOI_E1.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_E1.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_E1'
		         .Column4.chkJIB.cValueSource       = 'DOI_E1.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_E1.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_E1'
		         .Column5.txtOwnerType.cValueSource = 'DOI_E1.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_E1.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_E1'
		         .Column6.txtIntType.cValueSource   = 'DOI_E1.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_E1.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_E1'
		         .Column7.txtDirectPay.cValueSource = 'DOI_E1.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_E1.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_E1'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_E1.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_E1.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_E1'
		         .Column10.txtProgCode.cValueSource = 'DOI_E1.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_E1.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_E1'
		         .Column11.txtInterest.cValueSource = 'DOI_E1.interest'
		         .cworkarea = 'DOI_E1'
		         =REQUERY('DOI_E1')
		
		      CASE lcView = 'E2'
		         .RECORDSOURCE = 'DOI_E2'
		         .Column1.CONTROLSOURCE             = 'DOI_E2.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_E2'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_E2.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_E2.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_E2.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_E2'
		         .Column3.chkOnHold.cValueSource    = 'DOI_E2.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_E2.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_E2'
		         .Column4.chkJIB.cValueSource       = 'DOI_E2.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_E2.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_E2'
		         .Column5.txtOwnerType.cValueSource = 'DOI_E2.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_E2.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_E2'
		         .Column6.txtIntType.cValueSource   = 'DOI_E2.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_E2.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_E2'
		         .Column7.txtDirectPay.cValueSource = 'DOI_E2.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_E2.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_E2'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_E2.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_E2.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_E2'
		         .Column10.txtProgCode.cValueSource = 'DOI_E2.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_E2.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_E2'
		         .Column11.txtInterest.cValueSource = 'DOI_E2.interest'
		         .cworkarea = 'DOI_E2'
		         =REQUERY('DOI_E2')
		
		      CASE lcView = 'E3'
		         .RECORDSOURCE = 'DOI_E3'
		         .Column1.CONTROLSOURCE             = 'DOI_E3.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_E3'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_E3.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_E3.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_E3.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_E3'
		         .Column3.chkOnHold.cValueSource    = 'DOI_E3.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_E3.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_E3'
		         .Column4.chkJIB.cValueSource       = 'DOI_E3.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_E3.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_E3'
		         .Column5.txtOwnerType.cValueSource = 'DOI_E3.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_E3.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_E3'
		         .Column6.txtIntType.cValueSource   = 'DOI_E3.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_E3.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_E3'
		         .Column7.txtDirectPay.cValueSource = 'DOI_E3.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_E3.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_E3'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_E3.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_E3.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_E3'
		         .Column10.txtProgCode.cValueSource = 'DOI_E3.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_E3.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_E3'
		         .Column11.txtInterest.cValueSource = 'DOI_E3.interest'
		         .cworkarea = 'DOI_E3'
		         =REQUERY('DOI_E3')
		
		      CASE lcView = 'E4'
		         .RECORDSOURCE = 'DOI_E4'
		         .Column1.CONTROLSOURCE             = 'DOI_E4.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_E4'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_E4.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_E4.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_E4.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_E4'
		         .Column3.chkOnHold.cValueSource    = 'DOI_E4.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_E4.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_E4'
		         .Column4.chkJIB.cValueSource       = 'DOI_E4.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_E4.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_E4'
		         .Column5.txtOwnerType.cValueSource = 'DOI_E4.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_E4.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_E4'
		         .Column6.txtIntType.cValueSource   = 'DOI_E4.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_E4.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_E4'
		         .Column7.txtDirectPay.cValueSource = 'DOI_E4.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_E4.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_E4'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_E4.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_E4.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_E4'
		         .Column10.txtProgCode.cValueSource = 'DOI_E4.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_E4.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_E4'
		         .Column11.txtInterest.cValueSource = 'DOI_E4.interest'
		         .cworkarea = 'DOI_E4'
		         =REQUERY('DOI_E4')
		
		      CASE lcView = 'E5'
		         .RECORDSOURCE = 'DOI_E5'
		         .Column1.CONTROLSOURCE             = 'DOI_E5.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_E5'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_E5.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_E5.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_E5.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_E5'
		         .Column3.chkOnHold.cValueSource    = 'DOI_E5.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_E5.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_E5'
		         .Column4.chkJIB.cValueSource       = 'DOI_E5.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_E5.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_E5'
		         .Column5.txtOwnerType.cValueSource = 'DOI_E5.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_E5.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_E5'
		         .Column6.txtIntType.cValueSource   = 'DOI_E5.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_E5.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_E5'
		         .Column7.txtDirectPay.cValueSource = 'DOI_E5.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_E5.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_E5'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_E5.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_E5.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_E5'
		         .Column10.txtProgCode.cValueSource = 'DOI_E5.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_E5.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_E5'
		         .Column11.txtInterest.cValueSource = 'DOI_E5.interest'
		         .cworkarea = 'DOI_E5'
		         =REQUERY('DOI_E5')
		
		      CASE lcView = 'OT1'
		         .RECORDSOURCE = 'DOI_OT1'
		         .Column1.CONTROLSOURCE             = 'DOI_OT1.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_OT1'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_OT1.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_OT1.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_OT1.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_OT1'
		         .Column3.chkOnHold.cValueSource    = 'DOI_OT1.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_OT1.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_OT1'
		         .Column4.chkJIB.cValueSource       = 'DOI_OT1.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_OT1.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_OT1'
		         .Column5.txtOwnerType.cValueSource = 'DOI_OT1.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_OT1.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_OT1'
		         .Column6.txtIntType.cValueSource   = 'DOI_OT1.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_OT1.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_OT1'
		         .Column7.txtDirectPay.cValueSource = 'DOI_OT1.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_OT1.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_OT1'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_OT1.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_OT1.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_OT1'
		         .Column10.txtProgCode.cValueSource = 'DOI_OT1.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_OT1.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_OT1'
		         .Column11.txtInterest.cValueSource = 'DOI_OT1.interest'
		         .cworkarea = 'DOI_OT1'
		         =REQUERY('DOI_OT1')
		
		      CASE lcView = 'GT1'
		         .RECORDSOURCE = 'DOI_GT1'
		         .Column1.CONTROLSOURCE             = 'DOI_GT1.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_GT1'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_GT1.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_GT1.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_GT1.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_GT1'
		         .Column3.chkOnHold.cValueSource    = 'DOI_GT1.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_GT1.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_GT1'
		         .Column4.chkJIB.cValueSource       = 'DOI_GT1.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_GT1.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_GT1'
		         .Column5.txtOwnerType.cValueSource = 'DOI_GT1.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_GT1.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_GT1'
		         .Column6.txtIntType.cValueSource   = 'DOI_GT1.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_GT1.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_GT1'
		         .Column7.txtDirectPay.cValueSource = 'DOI_GT1.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_GT1.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_GT1'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_GT1.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_GT1.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_GT1'
		         .Column10.txtProgCode.cValueSource = 'DOI_GT1.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_GT1.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_GT1'
		         .Column11.txtInterest.cValueSource = 'DOI_GT1.interest'
		         .cworkarea = 'DOI_GT1'
		         =REQUERY('DOI_GT1')
		
		      CASE lcView = 'PT1'
		         .RECORDSOURCE = 'DOI_PT1'
		         .Column1.CONTROLSOURCE             = 'DOI_PT1.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_PT1'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_PT1.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_PT1.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_PT1.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_PT1'
		         .Column3.chkOnHold.cValueSource    = 'DOI_PT1.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_PT1.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_PT1'
		         .Column4.chkJIB.cValueSource       = 'DOI_PT1.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_PT1.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_PT1'
		         .Column5.txtOwnerType.cValueSource = 'DOI_PT1.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_PT1.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_PT1'
		         .Column6.txtIntType.cValueSource   = 'DOI_PT1.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_PT1.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_PT1'
		         .Column7.txtDirectPay.cValueSource = 'DOI_PT1.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_PT1.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_PT1'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_PT1.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_PT1.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_PT1'
		         .Column10.txtProgCode.cValueSource = 'DOI_PT1.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_PT1.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_PT1'
		         .Column11.txtInterest.cValueSource = 'DOI_PT1.interest'
		         .cworkarea = 'DOI_PT1'
		         =REQUERY('DOI_PT1')
		
		      CASE lcView = 'OT2'
		         .RECORDSOURCE = 'DOI_OT2'
		         .Column1.CONTROLSOURCE             = 'DOI_OT2.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_OT2'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_OT2.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_OT2.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_OT2.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_OT2'
		         .Column3.chkOnHold.cValueSource    = 'DOI_OT2.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_OT2.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_OT2'
		         .Column4.chkJIB.cValueSource       = 'DOI_OT2.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_OT2.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_OT2'
		         .Column5.txtOwnerType.cValueSource = 'DOI_OT2.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_OT2.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_OT2'
		         .Column6.txtIntType.cValueSource   = 'DOI_OT2.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_OT2.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_OT2'
		         .Column7.txtDirectPay.cValueSource = 'DOI_OT2.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_OT2.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_OT2'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_OT2.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_OT2.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_OT2'
		         .Column10.txtProgCode.cValueSource = 'DOI_OT2.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_OT2.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_OT2'
		         .Column11.txtInterest.cValueSource = 'DOI_OT2.interest'
		         .cworkarea = 'DOI_OT2'
		         =REQUERY('DOI_OT2')
		
		      CASE lcView = 'GT2'
		         .RECORDSOURCE = 'DOI_GT2'
		         .Column1.CONTROLSOURCE             = 'DOI_GT2.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_GT2'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_GT2.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_GT2.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_GT2.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_GT2'
		         .Column3.chkOnHold.cValueSource    = 'DOI_GT2.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_GT2.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_GT2'
		         .Column4.chkJIB.cValueSource       = 'DOI_GT2.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_GT2.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_GT2'
		         .Column5.txtOwnerType.cValueSource = 'DOI_GT2.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_GT2.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_GT2'
		         .Column6.txtIntType.cValueSource   = 'DOI_GT2.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_GT2.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_GT2'
		         .Column7.txtDirectPay.cValueSource = 'DOI_GT2.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_GT2.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_GT2'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_GT2.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_GT2.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_GT2'
		         .Column10.txtProgCode.cValueSource = 'DOI_GT2.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_GT2.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_GT2'
		         .Column11.txtInterest.cValueSource = 'DOI_GT2.interest'
		         .cworkarea = 'DOI_GT2'
		         =REQUERY('DOI_GT2')
		
		      CASE lcView = 'PT2'
		         .RECORDSOURCE = 'DOI_PT2'
		         .Column1.CONTROLSOURCE             = 'DOI_PT2.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_PT2'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_PT2.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_PT2.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_PT2.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_PT2'
		         .Column3.chkOnHold.cValueSource    = 'DOI_PT2.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_PT2.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_PT2'
		         .Column4.chkJIB.cValueSource       = 'DOI_PT2.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_PT2.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_PT2'
		         .Column5.txtOwnerType.cValueSource = 'DOI_PT2.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_PT2.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_PT2'
		         .Column6.txtIntType.cValueSource   = 'DOI_PT2.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_PT2.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_PT2'
		         .Column7.txtDirectPay.cValueSource = 'DOI_PT2.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_PT2.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_PT2'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_PT2.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_PT2.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_PT2'
		         .Column10.txtProgCode.cValueSource = 'DOI_PT2.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_PT2.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_PT2'
		         .Column11.txtInterest.cValueSource = 'DOI_PT2.interest'
		         .cworkarea = 'DOI_PT2'
		         =REQUERY('DOI_PT2')
		
		      CASE lcView = 'OT3'
		         .RECORDSOURCE = 'DOI_OT3'
		         .Column1.CONTROLSOURCE             = 'DOI_OT3.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_OT3'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_OT3.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_OT3.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_OT3.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_OT3'
		         .Column3.chkOnHold.cValueSource    = 'DOI_OT3.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_OT3.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_OT3'
		         .Column4.chkJIB.cValueSource       = 'DOI_OT3.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_OT3.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_OT3'
		         .Column5.txtOwnerType.cValueSource = 'DOI_OT3.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_OT3.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_OT3'
		         .Column6.txtIntType.cValueSource   = 'DOI_OT3.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_OT3.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_OT3'
		         .Column7.txtDirectPay.cValueSource = 'DOI_OT3.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_OT3.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_OT3'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_OT3.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_OT3.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_OT3'
		         .Column10.txtProgCode.cValueSource = 'DOI_OT3.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_OT3.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_OT3'
		         .Column11.txtInterest.cValueSource = 'DOI_OT3.interest'
		         .cworkarea = 'DOI_OT3'
		         =REQUERY('DOI_OT3')
		
		      CASE lcView = 'GT3'
		         .RECORDSOURCE = 'DOI_GT3'
		         .Column1.CONTROLSOURCE             = 'DOI_GT3.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_GT3'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_GT3.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_GT3.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_GT3.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_GT3'
		         .Column3.chkOnHold.cValueSource    = 'DOI_GT3.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_GT3.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_GT3'
		         .Column4.chkJIB.cValueSource       = 'DOI_GT3.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_GT3.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_GT3'
		         .Column5.txtOwnerType.cValueSource = 'DOI_GT3.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_GT3.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_GT3'
		         .Column6.txtIntType.cValueSource   = 'DOI_GT3.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_GT3.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_GT3'
		         .Column7.txtDirectPay.cValueSource = 'DOI_GT3.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_GT3.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_GT3'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_GT3.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_GT3.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_GT3'
		         .Column10.txtProgCode.cValueSource = 'DOI_GT3.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_GT3.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_GT3'
		         .Column11.txtInterest.cValueSource = 'DOI_GT3.interest'
		         .cworkarea = 'DOI_GT3'
		         =REQUERY('DOI_GT3')
		
		      CASE lcView = 'PT3'
		         .RECORDSOURCE = 'DOI_PT3'
		         .Column1.CONTROLSOURCE             = 'DOI_PT3.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_PT3'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_PT3.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_PT3.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_PT3.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_PT3'
		         .Column3.chkOnHold.cValueSource    = 'DOI_PT3.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_PT3.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_PT3'
		         .Column4.chkJIB.cValueSource       = 'DOI_PT3.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_PT3.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_PT3'
		         .Column5.txtOwnerType.cValueSource = 'DOI_PT3.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_PT3.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_PT3'
		         .Column6.txtIntType.cValueSource   = 'DOI_PT3.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_PT3.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_PT3'
		         .Column7.txtDirectPay.cValueSource = 'DOI_PT3.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_PT3.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_PT3'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_PT3.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_PT3.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_PT3'
		         .Column10.txtProgCode.cValueSource = 'DOI_PT3.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_PT3.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_PT3'
		         .Column11.txtInterest.cValueSource = 'DOI_PT3.interest'
		         .cworkarea = 'DOI_PT3'
		         =REQUERY('DOI_PT3')
		
		      CASE lcView = 'OT4'
		         .RECORDSOURCE = 'DOI_OT4'
		         .Column1.CONTROLSOURCE             = 'DOI_OT4.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_OT4'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_OT4.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_OT4.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_OT4.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_OT4'
		         .Column3.chkOnHold.cValueSource    = 'DOI_OT4.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_OT4.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_OT4'
		         .Column4.chkJIB.cValueSource       = 'DOI_OT4.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_OT4.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_OT4'
		         .Column5.txtOwnerType.cValueSource = 'DOI_OT4.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_OT4.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_OT4'
		         .Column6.txtIntType.cValueSource   = 'DOI_OT4.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_OT4.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_OT4'
		         .Column7.txtDirectPay.cValueSource = 'DOI_OT4.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_OT4.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_OT4'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_OT4.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_OT4.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_OT4'
		         .Column10.txtProgCode.cValueSource = 'DOI_OT4.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_OT4.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_OT4'
		         .Column11.txtInterest.cValueSource = 'DOI_OT4.interest'
		         .cworkarea = 'DOI_OT4'
		         =REQUERY('DOI_OT4')
		
		      CASE lcView = 'GT4'
		         .RECORDSOURCE = 'DOI_GT4'
		         .Column1.CONTROLSOURCE             = 'DOI_GT4.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_GT4'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_GT4.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_GT4.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_GT4.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_GT4'
		         .Column3.chkOnHold.cValueSource    = 'DOI_GT4.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_GT4.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_GT4'
		         .Column4.chkJIB.cValueSource       = 'DOI_GT4.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_GT4.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_GT4'
		         .Column5.txtOwnerType.cValueSource = 'DOI_GT4.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_GT4.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_GT4'
		         .Column6.txtIntType.cValueSource   = 'DOI_GT4.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_GT4.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_GT4'
		         .Column7.txtDirectPay.cValueSource = 'DOI_GT4.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_GT4.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_GT4'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_GT4.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_GT4.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_GT4'
		         .Column10.txtProgCode.cValueSource = 'DOI_GT4.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_GT4.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_GT4'
		         .Column11.txtInterest.cValueSource = 'DOI_GT4.interest'
		         .cworkarea = 'DOI_GT4'
		         =REQUERY('DOI_GT4')
		
		      CASE lcView = 'PT4'
		         .RECORDSOURCE = 'DOI_PT4'
		         .Column1.CONTROLSOURCE             = 'DOI_PT4.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_PT4'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_PT4.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_PT4.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_PT4.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_PT4'
		         .Column3.chkOnHold.cValueSource    = 'DOI_PT4.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_PT4.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_PT4'
		         .Column4.chkJIB.cValueSource       = 'DOI_PT4.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_PT4.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_PT4'
		         .Column5.txtOwnerType.cValueSource = 'DOI_PT4.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_PT4.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_PT4'
		         .Column6.txtIntType.cValueSource   = 'DOI_PT4.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_PT4.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_PT4'
		         .Column7.txtDirectPay.cValueSource = 'DOI_PT4.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_PT4.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_PT4'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_PT4.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_PT4.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_PT4'
		         .Column10.txtProgCode.cValueSource = 'DOI_PT4.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_PT4.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_PT4'
		         .Column11.txtInterest.cValueSource = 'DOI_PT4.interest'
		         .cworkarea = 'DOI_PT4'
		         =REQUERY('DOI_PT4')
		
		      CASE lcView = 'PL'
		         .RECORDSOURCE = 'DOI_PLG'
		         .Column1.CONTROLSOURCE             = 'DOI_PLG.cOwnerID'
		         .Column1.txtOwnerID.cworkarea      = 'DOI_PLG'
		         .Column1.txtOwnerID.cValueSource   = 'DOI_PLG.cOwnerID'
		         .Column2.CONTROLSOURCE             = 'DOI_PLG.cOwnName'
		         .Column3.CONTROLSOURCE             = 'DOI_PLG.lonhold'
		         .Column3.chkOnHold.cworkarea       = 'DOI_PLG'
		         .Column3.chkOnHold.cValueSource    = 'DOI_PLG.lOnHold'
		         .Column4.CONTROLSOURCE             = 'DOI_PLG.ljib'
		         .Column4.chkJIB.cworkarea          = 'DOI_PLG'
		         .Column4.chkJIB.cValueSource       = 'DOI_PLG.lJIB'
		         .Column5.CONTROLSOURCE             = 'DOI_PLG.cTypeInv'
		         .Column5.txtOwnerType.cworkarea    = 'DOI_PLG'
		         .Column5.txtOwnerType.cValueSource = 'DOI_PLG.cTypeInv'
		         .Column6.CONTROLSOURCE             = 'DOI_PLG.cTypeInt'
		         .Column6.txtIntType.cworkarea      = 'DOI_PLG'
		         .Column6.txtIntType.cValueSource   = 'DOI_PLG.cTypeInt'
		         .Column7.CONTROLSOURCE             = 'DOI_PLG.cDirect'
		         .Column7.txtDirectPay.cworkarea    = 'DOI_PLG'
		         .Column7.txtDirectPay.cValueSource = 'DOI_PLG.cDirect'
		         .Column8.CONTROLSOURCE             = 'DOI_PLG.lflat'
		         .Column8.chkFlatRate.cworkarea     = 'DOI_PLG'
		         .Column8.chkFlatRate.cValueSource  = 'DOI_PLG.lFlat'
		         .Column10.CONTROLSOURCE            = 'DOI_PLG.cProgCode'
		         .Column10.txtProgCode.cworkarea    = 'DOI_PLG'
		         .Column10.txtProgCode.cValueSource = 'DOI_PLG.cProgCode'
		         .Column11.CONTROLSOURCE            = 'DOI_PLG.interest'
		         .Column11.txtInterest.cworkarea    = 'DOI_PLG'
		         .Column11.txtInterest.cValueSource = 'DOI_PLG.interest'
		         .cworkarea = 'DOI_PLG'
		         =REQUERY('DOI_PLG')
		   ENDCASE
		
		   .REFRESH()
		
		ENDWITH
		
		IF TYPE('m.cworkarea') <> 'C'
		   m.cworkarea = ''
		ENDIF
		
		THISFORM.PAGEFRAME.page1.grdgridcustom1.REFRESH()
		
		THISFORM.calcints()
		
		
		
		
	ENDPROC

	PROCEDURE requerydeck
		LPARAMETERS lcDeck, lcWellID
		
		IF THISFORM.PAGEFRAME.ACTIVEPAGE = 2  && Owner Interests
			SELECT wellinv
			LOCATE FOR cdeck = lcDeck ;
				AND cwellid = lcWellID 
			IF FOUND()
				THISFORM.cmdatamanager.afternav('wellinv')
			ENDIF
		ELSE
		    * Interest Views
			THISFORM.requeryclass('Doidecks')
			thisform.pageFrame.page1.Activate()
		ENDIF
		
	ENDPROC

	PROCEDURE selectrec		&& Selects the current record from the view displayed in the grid and displays it on the owner interests page.
		LPARAMETERS lcView
		*  This method is called by the doubleclick event from 
		*  each textbox in the grid on the Interest Views page.
		*  It selects the given record and displays it on the
		*  Owner Interests Page
		*
		LOCAL lcRecKey, lcView
		
		SELECT (lcView)
		lcRecKey = cidwinv
		
		swselect('wellinv')
		SET ORDER TO cidwinv
		IF SEEK(lcRecKey)
		   SELECT doidecks
		   LOCATE FOR cdeck = wellinv.cdeck AND cwellid = wellinv.cwellid
		   thisform.pageFrame.ActivePage = 2
		   thisform.refresh()
		ENDIF   
		
	ENDPROC

	PROCEDURE setflat
		**************************************************************************
		*  Either enables or disables the flat rate amount fields and interest
		*  fields based on whether the owner is a flat rate or not.
		*  Flat rate owners won't have an interest percentage in the same record
		*  so those are disabled when the owner is a flat rate owner.
		*  Non-flat rate owners won't see the flat rate fields.
		**************************************************************************
		LPARAMETERS tlFlatAmount
		
		* tlFlatAmount = .t. - disable all but oil rev, gas rev and tax pcts
		* tlFlatAmount = .f. - disable all
		
		
		      IF wellinv.lFlat = .T.  &&  Flat rate, so disable the rest of the interests on the screen
		         THISFORM.PAGEFRAME.page2.txtFlatRate.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtFlatMCF.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtFlatBBL.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtcFlatStart.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.opgFlatFreq.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTrp.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevMisc1.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevMisc2.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevOth.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtInterest.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtIntClass1.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtIntClass2.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtIntClass3.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtIntClass4.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtIntClass5.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtAPOInt.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtNBCPint.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtnACPInt.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevOil.SET('enabled',.f.)
		         THISFORM.PAGEFRAME.page2.txtRevGas.SET('enabled',.f.)
		         THISFORM.PAGEFRAME.page2.txtRevTax1.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax2.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax3.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax4.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax5.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax6.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax7.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax8.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax9.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax10.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax11.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevTax12.SET('enabled',.F.)
		      ELSE
		         THISFORM.PAGEFRAME.page2.txtFlatRate.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtFlatMCF.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtFlatBBL.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtcFlatStart.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.opgFlatFreq.SET('enabled',.F.)
		         THISFORM.PAGEFRAME.page2.txtRevOil.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevGas.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTrp.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevMisc1.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevMisc2.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevOth.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtInterest.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtIntClass1.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtIntClass2.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtIntClass3.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtIntClass4.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtIntClass5.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtAPOInt.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtNBCPint.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtnACPInt.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax1.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax2.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax3.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax4.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax5.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax6.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax7.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax8.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax9.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax10.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax11.SET('enabled',.T.)
		         THISFORM.PAGEFRAME.page2.txtRevTax12.SET('enabled',.T.)
		      ENDIF
		
	ENDPROC

	PROCEDURE setstate
		**************************************************************************
		* Let's the toolbar know that something changed on the form so the
		* save button is enabled.
		**************************************************************************
		this.lChanged = .T.
	ENDPROC

	PROCEDURE showflatfields
		LPARAMETERS tlShow
		
		thisform.pageFrame.page2.lblFlatBBL.Visible = tlShow
		thisform.pageFrame.page2.lblFlatFreq.Visible = tlShow
		thisform.pageFrame.page2.lblFlatMCF.Visible  = tlShow
		thisform.pageframe.page2.lblFlatrate.Visible = tlShow
		thisform.pageFrame.page2.lblFlatStarts.Visible = tlShow
		thisform.pageframe.page2.txtcFlatStart.Visible = tlShow
		thisform.pageframe.page2.txtFlatBBL.Visible = tlShow
		thisform.pageframe.page2.txtFlatMCF.Visible = tlShow
		thisform.pageFrame.page2.txtFlatrate.Visible = tlShow
		thisform.pageFrame.page2.opgFlatFreq.Visible = tlShow
		
	ENDPROC

	PROCEDURE temp
	ENDPROC

	PROCEDURE viewdocument
		LOCAL lnReturn, llReturn, lcOutputFile
		LOCAL liKey, lcPath, llDebug
		
		llDebug = FILE('datafiles\debug.txt')
		
		liKey = INT(VAL(thisform.pageFrame.page3.lstDocuments.Value))
		
		swselect('documents')
		SET ORDER TO iDocPK
		IF SEEK(liKey)
		   lcOutputFile = ALLTRIM(cPath)
		
		   llReturn = .T.
		
		   IF NOT FILE(lcOutputFile)
		      llReturn = .F.
		      IF llDebug
		         MESSAGEBOX('Attempting to view: ' + CHR(10) + ;
		                    lcOutputfile,64,'View Document')
		      ENDIF               
		   ENDIF
		
		   TRY
		      IF llReturn
		         DECLARE INTEGER ShellExecute IN "Shell32.dll" ;
		            INTEGER HWND, ;
		            STRING lpVerb, ;
		            STRING lpFile, ;
		            STRING lpParameters, ;
		            STRING lpDirectory, ;
		            LONG nShowCmd
		
		         lnReturn = ShellExecute(0, "Open", lcOutputFile, "", "", 1)
		         
		      ENDIF
		
		*      THIS.nReturnValue = lnReturn
		
		      IF lnReturn > 32
		         llReturn = .T.
		      ELSE
		         llReturn = .F.
		         IF lldebug
		            MESSAGEBOX('Return from ShellExecute: ' + TRANSFORM(lnReturn),64,'View Document')
		         ENDIF    
		      ENDIF
		   CATCH TO loError
		      IF llDebug
		         MESSAGEBOX('Error Occured: ' + CHR(10) + ;
		                     loError.Message,64,'View Document')
		      ENDIF                
		   ENDTRY
		
		   RETURN (llReturn)
		
		ENDIF
	ENDPROC

	PROCEDURE zerointerests
		**************************************************************************
		*  Zeroes out the interest fields when the owner is marked as a 
		*  flat-rate owner
		**************************************************************************
		IF THISFORM.PAGEFRAME.page2.txtrevoil.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevgas.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtrp.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevmisc1.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevmisc2.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax1.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax2.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax3.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax4.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax5.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax6.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax7.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax8.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax9.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax10.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax11.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtrevtax12.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtintclass1.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtintclass2.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtintclass3.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtintclass4.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtintclass5.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtinterest.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtnbcpint.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtnacpint.VALUE+  ;
		      THISFORM.PAGEFRAME.page2.txtapoint.VALUE = 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF
		
	ENDPROC

	PROCEDURE cmdatamanager.afterdelete
		LPARAMETERS cworkarea
		
		SELE wellinv
		=TABLEUPDATE(.T.,.T.)
		
		IF NOT thisform.pageframe.page2.chkSpecify.value
		   thisform.recalcrev()
		   thisform.save()
		ENDIF   
		
		DODEFAULT(cworkarea)
		
	ENDPROC

	PROCEDURE cmdatamanager.afternav
		LPARAMETERS cworkarea
		
		STRTOFILE('Afternav: ' + m.cworkarea + CHR(10),'DOIdebug.txt',1)
		
		DO CASE
			CASE THISFORM.PAGEFRAME.ACTIVEPAGE = 1   && Interest Views
			    IF LOWER(m.cworkarea) = 'doidecks'
			        thisform.pageFrame.page1.cbodeck1.Requery(doidecks.cdeck)
		  			THISFORM.requeryclass('Wells')
		   		ENDIF 
				IF THISFORM.lIntWarning
					WAIT WIND NOWAIT 'This interest class is over 100%. Please correct it.'
				ENDIF
				
				swselect('wells')
				LOCATE FOR cWellID = doidecks.cWellID
				IF FOUND()
				   thisform.pageframe.page1.txtwellname.Value = wells.cwellname
				   thisform.pageframe.page2.txtwellname.Value = wells.cwellname
				ELSE
				   thisform.pageframe.page1.txtwellname.Value = 'Unknown'
				   thisform.pageframe.page2.txtwellname.Value = 'Unknown'
				ENDIF 
				
				SELECT wellinv
				LOCATE FOR cwellid = doidecks.cwellid AND cdeck = doidecks.cdeck
				thisform.pageframe.page2.Refresh()
				
			CASE THISFORM.PAGEFRAME.ACTIVEPAGE = 2  && Owner Interests
				IF m.goapp.lPluggingModule
					THISFORM.PAGEFRAME.page2.lblplugMod.VISIBLE  = .T.
					THISFORM.PAGEFRAME.page2.txtnplugPct.VISIBLE = .T.
					THISFORM.PAGEFRAME.page2.shpplug.VISIBLE = .T.
				ELSE
					THISFORM.PAGEFRAME.page2.lblplugMod.VISIBLE  = .F.
					THISFORM.PAGEFRAME.page2.txtnplugPct.VISIBLE = .F.
					THISFORM.PAGEFRAME.page2.shpplug.VISIBLE = .F.
				ENDIF
				
				* Enable the suspense reason field if the owner is on hold
				IF wellinv.lonhold
				   thisform.pageFrame.page2.cboSuspReason.lenabled = .t.
				ELSE 
				   thisform.pageFrame.page2.cboSuspReason.lenabled = .f.
				ENDIF    
		
				swselect('wells')
				LOCATE FOR cWellID = wellinv.cWellID
				IF FOUND()
				   thisform.pageframe.page2.txtwellname.Value = wells.cwellname
				ELSE
				   thisform.pageframe.page2.txtwellname.Value = 'Unknown'
				ENDIF 
				
				swselect('wellinv')
				THISFORM.PAGEFRAME.page2.txtcOwnerID.REFRESH()
		
		        swselect('doidecks')
		        LOCATE FOR cdeck = wellinv.cdeck AND cwellid = wellinv.cwellid
		        
				THISFORM.pageframe.page2.cbodeck2.VALUE = wellinv.cdeck
				THISFORM.pageframe.page2.cbodeck2.REFRESH()
		
				swselect('investor', .T.)
				SET ORDER TO cOwnerID
				IF SEEK(THISFORM.PAGEFRAME.page2.txtcOwnerID.VALUE)
					THISFORM.PAGEFRAME.page2.txtcOwnerName.VALUE = cownname
					THISFORM.PAGEFRAME.page2.txtcOwnerName.REFRESH()
					IF lDummy  &&  If a dummy owner, set the lDummyAfterNav flag, so we know it was set as a dummy when the record was moved onto - BH 01/31/08
						THISFORM.lDummyafternav = .T.
					ELSE
						THISFORM.lDummyafternav = .F.
					ENDIF
				ELSE
					THISFORM.PAGEFRAME.page2.txtcOwnerName.VALUE = 'Unknown'
					THISFORM.PAGEFRAME.page2.txtcOwnerName.REFRESH()
				ENDIF
				THISFORM.ShowFlatFields(wellinv.lflat)
				THISFORM.lcoldwellid   = wellinv.cWellID
				THISFORM.lcoldprogcode = wellinv.cProgCode
		
				IF UPPER(m.cworkarea) = 'WELLINV'
					THISFORM.oldinttype = wellinv.ljib
					THISFORM.setflat()
		
					IF wellinv.cTypeInv <> 'W'  &&  Not WI, so disable the working interest text box
						THISFORM.PAGEFRAME.page2.txtInterest.SET('Enabled', .F.)
						THISFORM.PAGEFRAME.page2.txtInterest.ENABLED = .F.
						THISFORM.PAGEFRAME.page2.chkLjib.SET('enabled', .F.)
						THISFORM.PAGEFRAME.page2.chkLjib.ENABLED = .F.
					ELSE
						THISFORM.PAGEFRAME.page2.txtInterest.SET('Enabled', .T.)
						THISFORM.PAGEFRAME.page2.txtInterest.ENABLED = .T.
						THISFORM.PAGEFRAME.page2.chkLjib.SET('enabled', .T.)
						THISFORM.PAGEFRAME.page2.chkLjib.ENABLED = .T.
					ENDIF
		
					IF wellinv.lpayout
						THISFORM.PAGEFRAME.page2.txtapoint.BACKCOLOR = RGB(255, 0, 0)
					ELSE
						IF THISFORM.lexpliciteditmode = .T.
							THISFORM.PAGEFRAME.page2.txtapoint.BACKCOLOR = RGB(212, 208, 200)
						ELSE
							THISFORM.PAGEFRAME.page2.txtapoint.BACKCOLOR = RGB(255, 255, 255)
						ENDIF
					ENDIF
		
					THISFORM.pageframe.page2.cbodeck2.REQUERY(wellinv.cdeck)
				ENDIF
				THISFORM.PAGEFRAME.page2.REFRESH()
			CASE THISFORM.PAGEFRAME.ACTIVEPAGE = 3  && Documents
				THISFORM.PAGEFRAME.page3.lstDocuments.REQUERY()
		
		ENDCASE
		
		THISFORM.LOCKSCREEN = .F.
		DODEFAULT(cworkarea)
		
		
	ENDPROC

	PROCEDURE cmdatamanager.afternew
		LPARAMETERS cworkarea
		LOCAL lcTypeInv
		
		IF m.cWorkArea = 'Wellinv'
		   thisform.lNewrecord = .T.
		   DO CASE 
		      CASE thisform.nOwnerType = 1
		         lcTypeInv = 'L'
		      CASE thisform.nOwnerType = 2
		         lcTypeInv = 'O'   
		      CASE thisform.nOwnerType = 3
		         lcTypeInv = 'W'   
		      OTHERWISE
		         lcTypeInv = 'L'
		         thisform.nOwnerType = 1
		   ENDCASE      
		   thisform.pageFrame.page2.cboOwnType.ListItemId = thisform.nownertype
		   thisform.pageFrame.page2.cboownType.Refresh()
		   m.cidwinv = GetNextPK('DOI')
		   SET DELETED OFF
		   swselect('wellinv1')
		   SET ORDER TO cidwinv
		   DO WHILE SEEK(m.cidwinv)
		      m.cidwinv = GetNextPK('DOI')
		   ENDDO
		   SET DELETED ON
		   swselect('wellinv')
		   REPLACE cidwinv   WITH m.cidwinv, ;
		      cDeck     WITH thisform.pageframe.page2.cbodeck2.Value, ;
		      cWellID   WITH thisform.lcoldwellid, ;
		      cOwnerID  WITH '', ;
		      ctypeinv  WITH lcTypeInv, ;
		      cTypeInt  WITH 'B', ;
		      cDirect   WITH 'N', ;
		      cprogcode WITH thisform.lcoldprogcode, ;
		      lJIB      WITH .F., ;
		      lOnHold   WITH .F., ;
		      nworkint  WITH 0, ;
		      lFlat     WITH .F., ;
		      dadded    WITH DATETIME(), ;
		      cadduser  WITH m.goapp.cuser
		   THISFORM.PAGEFRAME.page2.txtcOwnerName.VALUE = ''
		   THISFORM.setnextcontrol(THISFORM.pageframe.page2.txtWellID2)
		   THISFORM.PAGEFRAME.page2.cboOwnType.LISTITEMID = 1
		   THISFORM.PAGEFRAME.page2.cboIntType.LISTITEMID = 1
		   THISFORM.PAGEFRAME.page2.cboDirect.LISTITEMID = 1
		   thisform.lDummyafternav = .f.
		ENDIF
		
		DODEFAULT(cworkarea)
		
	ENDPROC

	PROCEDURE cmdatamanager.afterupdate
		LPARAMETERS cworkarealist
		
		SELE wellinv
		REPL dchanged WITH DATETIME(), ;
		     cchguser WITH m.goapp.cuser
		=TABLEUPDATE(.T.)
		
		SELE doifile
		=TABLEUPDATE(.T.)
		
		thisform.lcoldwellid = wellinv.cWellID 
		
		RETURN (DODEFAULT('Wellinv'))
	ENDPROC

	PROCEDURE cmdatamanager.beforedelete
		LPARAMETERS cworkarea
		
		IF thisform.pageframe.activepage = 1
		   thisform.omessage.warning('Interests must be deleted from the Owner Interests page.')
		   RETURN .F.
		ENDIF
		
		DODEFAULT(cworkarea)
	ENDPROC

	PROCEDURE cmdatamanager.beforenav
		LPARAMETERS cworkarea
		
		thisform.LockScreen = .T.
		
		IF thisform.pageframe.activepage = 2
		   thisform.cWorkarea = 'wellinv'
		   select wellinv
		   SET ORDER TO deckorder
		ENDIF   
		
		IF thisform.pageframe.activepage = 1
		   thisform.cWorkarea = 'doidecks'
		   swselect('doidecks')
		   SET ORDER to navorder
		ENDIF   
		
		thisform.lchanged = .f.
		
		RETURN (DODEFAULT(m.cWorkArea))   
	ENDPROC

	PROCEDURE cmdatamanager.beforenew
		LPARAMETERS cworkarea
		
		THISFORM.lcOldOwnerID = THISFORM.PAGEFRAME.Page2.txtcOwnerID.VALUE
		THISFORM.lcOldWellID = THISFORM.pageframe.page2.txtWellID2.VALUE
		THISFORM.nOwnerType  = THISFORM.PAGEFRAME.Page2.cboownType.LISTITEMID
		THISFORM.lcOldProgCode = THISFORM.PAGEFRAME.Page2.txtprogcode.VALUE
		
		RETURN(DODEFAULT(cworkarea))
		
	ENDPROC

	PROCEDURE cmdatamanager.beforeupdate
		LPARAMETERS cworkarealist
		
		LOCAL llExpFound, llRevFound, llDummy
		
		STORE .F. TO llExpFound, llRevFound  &&  Variables for whether it finds any revenue or expense waiting to be processed
		
		IF thisform.pageFrame.ActivePage # 2
		   RETURN
		ENDIF 
		
		* Set focus elsewhere, so valids of textboxes aren't doing any 
		* re-calcs or replaces that keep it from saving completely - BH 03/12/2008
		THISFORM.setnextcontrol(THISFORM.PAGEFRAME.page2.txtcOwnerID)  
		
		SELECT wells
		LOCATE FOR cwellid == THISFORM.pageframe.page2.txtWellID2.value
		IF FOUND() AND wells.cwellstat = 'I'
		   THISFORM.omessage.warning('This well is inactive. No changes are allowed.')
		   RETURN .F.
		ENDIF
		
		IF wellinv.lonhold AND EMPTY(wellinv.creason)
		   MESSAGEBOX('The suspense reason must be specified when an owner is on hold!',16,thisform.Caption)
		   thisform.setnextcontrol(thisform.pageFrame.page2.cbosuspreason)
		   RETURN .f.
		ENDIF 
		
		lcWellID = wellinv.cwellid
		lcDeck   = wellinv.cdeck
		
		IF NOT FILE('petrox.dat')  
		*  Don't ask if this is Petrox, because they do hundreds of replacements at a time, 
		*  and we wrote them a utility to combine them later
		*  Check for a record for this owner in this well with this owner type, 
		*  and don't let them add a duplicate
		   swselect('wellinv1')    
		   IF wellinv.lFlat
		      LOCATE FOR cwellid = wellinv.cwellid ;
		             AND cOwnerID = wellinv.cOwnerID ;
		             AND cTypeInv = wellinv.cTypeInv ;
		             AND cProgCode = wellinv.cProgCode ;
		             AND cDeck     = wellinv.cdeck ;
		             AND cidwinv <> wellinv.cidwinv ;
		             AND lFlat
		   ELSE
		      LOCATE FOR cwellid = wellinv.cwellid ;
		             AND cOwnerID = wellinv.cOwnerID ;
		             AND cTypeInv = wellinv.cTypeInv ;
		             AND cProgCode = wellinv.cProgCode ;
		             AND cDeck     = wellinv.cdeck ;
		             AND cidwinv <> wellinv.cidwinv ;
		             AND NOT lFlat
		   ENDIF
		   IF FOUND()
		      THISFORM.omessage.warning("This owner already has an interest in this well and deck with this owner type. " + ;
		                                "An owner cannot have multiple interests in a well deck with the same owner type. " + ;
		                                "You must add this entry's percentages to the existing record, instead of creating multiple entries.")
		      THISFORM.setnextcontrol(THISFORM.PAGEFRAME.page2.txtcOwnerID)
		      RETURN .F.
		   ENDIF
		ENDIF
		
		* Recalculate the pcts if needed
		IF NOT THISFORM.pageframe.page2.chkSpecify.VALUE
		   THISFORM.recalcrev()
		ENDIF
		
		SELECT investor
		LOCATE FOR cOwnerID == THISFORM.PAGEFRAME.page2.txtcOwnerID.VALUE AND lDummy
		IF FOUND()
		   llDummy = .T.
		ELSE
		   llDummy = .F.
		ENDIF
		
		*  If it was a dummy when they opened the screen, and it's still a dummy, 
		*  check to see what interests changed, and see if they can do it
		IF THISFORM.ldummyafternav AND llDummy  
		   swselect('wellinv1')
		   LOCATE FOR cidwinv == wellinv.cidwinv  &&  Match old record
		   IF FOUND()
		      IF wellinv.nrevoil <> wellinv1.nrevoil OR ;
		         wellinv.nRevGas <> wellinv1.nRevGas OR ;
		         wellinv.nRevOth <> wellinv1.nRevOth OR ;  
		         wellinv.nRevTrp <> wellinv1.nRevTrp OR ;
		         wellinv.nRevMisc1 <> wellinv1.nRevMisc1 OR ;
		         wellinv.nRevMisc2 <> wellinv1.nRevMisc2
		         IF swactivity(wellinv.cwellid,.F.,.F.,'R')
		            llRevFound = .T.
		         ENDIF
		      ENDIF
		      IF wellinv.nWorkInt <> wellinv1.nWorkInt OR ;
		         wellinv.nIntClass1 <> wellinv1.nIntClass2 OR ;
		         wellinv.nIntClass3 <> wellinv1.nIntClass3 OR ;
		         wellinv.nIntClass4 <> wellinv1.nIntClass4 OR ;
		         wellinv.nIntClass5 <> wellinv1.nIntClass5 OR ;
		         wellinv.nBCPInt <> wellinv1.nBCPInt OR ;
		         wellinv.nACPInt <> wellinv1.nACPInt OR ;
		         wellinv.nAPOInt <> wellinv1.nAPOInt
		         IF swactivity(wellinv.cwellid,.F.,.F.,'E')
		            llExpFound = .T.
		         ENDIF
		      ENDIF
		   ENDIF
		ENDIF
		
		*  If it was a dummy when they opened the screen, and it's NOT still a dummy, ;
		*  check to see if there's any revenue/expense waiting to be processed
		IF THISFORM.ldummyafternav AND NOT llDummy  
		   swselect('wellinv1')
		   LOCATE FOR cidwinv == wellinv.cidwinv  &&  Match old record
		   IF FOUND()
		      IF swactivity(wellinv.cwellid,.F.,.F.,'R')
		         llRevFound = .T.
		      ENDIF
		      IF swactivity(wellinv.cwellid,.F.,.F.,'E')
		         llExpFound = .T.
		      ENDIF
		   ENDIF
		ENDIF
		
		*  If it wasn't a dummy when they opened the screen, but it is now, ;
		*  check to see if there's any revenue/expense waiting to be processed
		IF NOT THISFORM.ldummyafternav AND llDummy  
		   swselect('wellinv1')
		   LOCATE FOR cidwinv == wellinv.cidwinv  &&  Match old record
		   IF FOUND()
		      IF swactivity(wellinv.cwellid,.F.,.F.,'R')
		         llRevFound = .T.
		      ENDIF
		      IF swactivity(wellinv.cwellid,.F.,.F.,'E')
		         llExpFound = .T.
		      ENDIF
		   ENDIF
		   THISFORM.ldummyafternav = .T.  &&  It's now a dummy record
		ENDIF
		
		*  Display warning message, depending whether there's unprocessed revenue, expenses, or both
		DO CASE  
		   CASE llRevFound AND NOT llExpFound &&  Revenue Only
		      THISFORM.omessage.warning('The amount of dummy ownership in this well has changed, ' + ;
		                                'and there is unprocessed revenue for this well whose ' + ;
		                                'gross amount could be affected.  Re-save any receipts ' + ;
		                                'to ensure that they have been grossed up correctly.')
		   CASE NOT llRevFound AND llExpFound 
		      *  Expense Only
		      THISFORM.omessage.warning('The amount of dummy ownership in this well has changed, ' + ;
		                                'and there are unprocessed expenses for this well whose ' + ;
		                                'gross amount could be affected.  Re-save any bills to ' + ;
		                                'ensure that they have been grossed up correctly.')
		   CASE llRevFound AND llExpFound   
		      * Both revenue and expense
		      THISFORM.omessage.warning('The amount of dummy ownership in this well has changed, ' + ;
		                                'and there is unprocessed revenue and expense for this well ' + ;
		                                'whose gross amounts could be affected.  Re-save bills and ' + ;
		                                'receipts to ensure that they get grossed up correctly.')
		ENDCASE
		
		IF VARTYPE(thisform.lcOldProgCode) # 'C'
		   thisform.lcOldProgCode = ''
		ENDIF 
		
		*  If they change the program code, tell them that the suspense records will be updated to have the new program in it
		IF wellinv.cProgCode <> THISFORM.lcoldprogcode
		   SELECT suspense
		   SCAN FOR cwellid == wellinv.cwellid AND cOwnerID == wellinv.cOwnerID AND cTypeInv = wellinv.cTypeInv
		      REPLACE cProgCode WITH wellinv.cProgCode
		   ENDSCAN
		   =TABLEUPDATE(.T.,.T.)
		   THISFORM.omessage.DISPLAY('The program code has been changed, so any outstanding suspense records ' + ;
		                             'for this owner in this well have been updated with the new program code.')
		ENDIF
		
		*  Find the old record, and check to see if the DP stuff has changed, and if it has, 
		*  check to see if there's revenue waiting to be processed that would be affected
		swselect('wellinv1')  
		LOCATE FOR cidwinv == wellinv.cidwinv
		IF FOUND()
		   *  The direct pay stuff has changed, so check for unprocessed revenue
		   IF wellinv1.cDirect <> wellinv.cDirect AND swactivity(wellinv.cwellid,.F.,.F.,'R')  
		      THISFORM.omessage.warning("The amount of direct paid ownership has been changed, " + ;
		                                "and there is unprocessed revenue in the New Run whose " + ;
		                                "gross amount will be affected by this change.  " + ;
		                                "Re-save any receipts to ensure that they have been grossed up correctly.")
		   ENDIF
		ENDIF
		
		* Check to see if we're changing the owner from a net to jib or vice versa.
		IF THISFORM.oldinttype <> wellinv.ljib AND NOT THISFORM.lNewRecord
		   IF THISFORM.oldinttype
		      MESSAGEBOX('Changing this owner from a JIB owner to a NET owner will affect the following: ' + CHR(13) + ;
		         '-> Any outstanding receivables will need to be entered as suspense beginning balances in ' + ;
		         'order for the balance to be automatically deducted from future revenue run closings.',48,'Processing Affected...')
		   ELSE
		      MESSAGEBOX('Changing this owner from a NET owner to a JIB owner will affect the following: ' + CHR(13) + ;
		         '-> Any outstanding deficits will need to be entered as JIB receivable beginning balances in ' + ;
		         'order for the balance to affect future revenue JIB closings.',48,'Processing Affected...')
		   ENDIF
		ENDIF
		
		THISFORM.oldinttype = wellinv.ljib
		
		* Reset the new record flag
		THISFORM.lNewRecord = .F.
		
		*
		* Don't let an owner marked to post be set as direct paid
		*
		IF wellinv.cDirect <> 'N'
		   swselect('investor')
		   SET ORDER TO cOwnerID
		   IF SEEK(wellinv.cOwnerID)
		      IF investor.linteggl
		         IF NOT THISFORM.omessage.CONFIRM('This owner should not be marked as direct paid. ' + ;
		                                          'They are set to ' + IIF(m.goapp.lamversion,'post ' + ;
		                                          'to the G/L',IIF(m.goapp.lqbversion,'post to QB','not ' + ;
		                                          'create a check')) + ' in their owner information record, ' + ;
		                                          'which should only be used for your company record. Do you want to continue?')
		            REPLACE wellinv.cDirect WITH 'N'
		            THISFORM.PAGEFRAME.page2.cboDirect.REFRESH()
		            RETURN .F.
		         ENDIF
		      ENDIF
		   ELSE
		      RETURN .F.
		   ENDIF
		ENDIF
		
		IF THISFORM.PAGEFRAME.page2.chkLflat.VALUE AND THISFORM.PAGEFRAME.page2.cboOwnType.VALUE <> 'L'
		   THISFORM.omessage.warning('You cannot save a flat rate owner with an owner type other than Royalty.')
		   THISFORM.setnextcontrol(THISFORM.PAGEFRAME.page2.cboOwnType)
		   RETURN .F.
		ENDIF
		
		IF THISFORM.PAGEFRAME.page2.chkLflat.VALUE AND ;
		      THISFORM.PAGEFRAME.page2.txtflatBBL.VALUE = 0 AND ;
		      THISFORM.PAGEFRAME.page2.txtflatMCF.VALUE = 0 AND ;
		      THISFORM.PAGEFRAME.page2.txtflatrate.VALUE = 0
		   THISFORM.omessage.DISPLAY('An owner marked as a flat rate royalty owner must have a flat rate specified.')
		   THISFORM.setnextcontrol(THISFORM.PAGEFRAME.page2.txtflatrate)
		   RETURN .F.
		ENDIF
		
		* Set the default flag on all wellinv records for this deck
		*!*	IF thisform.chkDefaultDeck.Value
		*!*	   UPDATE doifile SET lDefault = .T. WHERE cWellID = lcWellID AND cDeck = lcDeck
		*!*	   UPDATE doifile SET lDefault = .F. WHERE cWellID = lcWellID AND cDeck # lcDeck
		*!*	ELSE
		*!*		UPDATE doifile SET lDefault = .F. WHERE cWellID = lcWellID AND cDeck = lcDeck
		*!*	ENDIF 
		
		BEGIN TRANSACTION
		SELECT doifile
		TABLEUPDATE(.T.,.T.)
		
		swselect('wellinv')
		TABLEUPDATE(.T.,.T.)
		
		SELECT wells
		TABLEUPDATE(.T.,.T.)
		
		END TRANSACTION
		
		THISFORM.chkinterest('**',.T.,.T.)
		
		RETURN(DODEFAULT(cworkarealist))
		
		
	ENDPROC

	PROCEDURE cmdatamanager.isrecordchanged
		LPARAMETERS cworkarea
		
		IF m.cWorkarea = 'Wells'
		   RETURN .F.
		ENDIF
		
		DODEFAULT(cworkarea)   
	ENDPROC

	PROCEDURE pageframe.activepage_assign
		LPARAMETERS nNewPage
		this.ActivePage = nNewPage
	ENDPROC

	PROCEDURE pageframe.Page1.Activate
		LOCAL lcWellID, lcDeck
		
		*
		*  Make sure the navigation workarea is DOIDECKS
		*  for page1.
		*
		thisform.cnavworkarea = 'Doidecks'
		
		lcWellID = doidecks.cwellid
		lcDeck   = doidecks.cdeck
		
		swselect('doidecks')
		LOCATE FOR cdeck = lcDeck AND cwellid = lcWellID
		IF NOT FOUND()
		   LOCATE FOR cDeck = lcDeck
		   lcWellID = doidecks.cwellid
		   thisform.pageframe.page1.txtWellID1.Refresh()
		ENDIF 
		 
		IF NOT EMPTY(lcWellID)
		   swselect('wells')
		   SET ORDER TO cwellid
		   IF SEEK(lcWellID)   
		      thisform.pageframe.page1.txtWellName.value = cWellName
		      thisform.pageframe.page1.txtWellName.Refresh()
		      thisform.pageframe.page1.txtWellID1.refresh()
		      thisform.pageframe.page2.chkSpecify.Refresh()   
		   ENDIF   
		ELSE
		   lcWellID = ''
		ENDIF
		
		*
		*  Make the specify revenue interest checkbox
		*  invisible.  It shouldn't be seen when page1
		*  is active.
		*
		thisform.pageframe.page2.chkSpecify.Visible       = .F.
		
		this.ForeColor = RGB(0,0,255)
		
		IF this.Parent.PageCount > 2
		   this.Parent.page3.ForeColor = RGB(0,0,0)
		ENDIF    
		
		this.Parent.page2.ForeColor = RGB(0,0,0)
		
		*
		*  Call the afternav method to do all the recalcs
		*  and to refresh the grid.
		*
		*thisform.cmdatamanager.afternav('Doidecks')
		
	ENDPROC

	PROCEDURE pageframe.Page1.cboDeck1.Click
		IF DODEFAULT()
		   lcDeck   = this.Value
		   lcWellID = thisform.pageframe.page1.txtWellID1.Value 
		   thisform.RequeryDeck(lcDeck,lcWellID)
		ENDIF 
	ENDPROC

	PROCEDURE pageframe.Page1.cboDeck1.Init
		IF DODEFAULT()
		   this.Requery()
		ENDIF    
	ENDPROC

	PROCEDURE pageframe.Page1.cboDeck1.Requery
		LPARAMETERS lcDeck
		
		IF DODEFAULT()
			THIS.CLEAR()
		
		    IF VARTYPE(lcDeck) # 'C'
		       lcDeck = this.Value
		    ENDIF 
		       
		    lcWellID = doidecks.cwellid
		    lnIndex = 1
		    
			SELECT cdeck, ldefault FROM doidecks ;
			    WHERE cwellid = lcWellID ;
				INTO CURSOR temp ;
				ORDER BY cdeck DESC  ;
				GROUP BY cdeck
		
			lnx = 1
			IF _TALLY > 0
				SELECT temp
				SCAN
					SCATTER MEMVAR
					IF EMPTY(m.cdeck)
					   m.cdeck = '(blank)'
					ENDIF 
					THIS.ADDLISTITEM(m.cdeck,lnx,1)
					THIS.ADDLISTITEM(m.cdeck,lnx,2)
					IF m.cDeck = lcDeck
					   lnIndex = lnx
					ENDIF 
					lnx = lnx + 1 
				ENDSCAN
			    this.ListItemId = lnIndex
			ELSE 		
			    this.ListItemId = 1
			ENDIF
		ENDIF
		
	ENDPROC

	PROCEDURE pageframe.Page1.cboDeck1.Valid
		
		lcWellid = doidecks.cwellid
		lcDeck   = this.Value
		
		SELECT doidecks
		LOCATE FOR cwellid = lcWellid AND cDeck = lcDeck
		
		thisform.cmdatamanager.afternav('doidecks')
		   
		RETURN .t.
	ENDPROC

	PROCEDURE pageframe.Page1.cboInterestClass.Click
		
		thisform.requeryclass('Wells')
	ENDPROC

	PROCEDURE pageframe.Page1.cboInterestClass.Init
		LOCAL lcWellID
		
		lcWellID = thisform.pageframe.page2.txtWellID2.value
		
		*
		*  Initialize the interest classes available
		*
		THIS.ADDLISTITEM('Working Interest',1,1)
		THIS.ADDLISTITEM('DC',1,2)
		
		THIS.ADDLISTITEM('Oil Revenue',2,1)
		THIS.ADDLISTITEM('OR',2,2)
		
		THIS.ADDLISTITEM('Gas Revenue',3,1)
		THIS.ADDLISTITEM('GR',3,2)
		
		THIS.ADDLISTITEM('Trans Revenue',4,1)
		THIS.ADDLISTITEM('TR',4,2)
		
		THIS.ADDLISTITEM('Other Product Rev',5,1)
		THIS.ADDLISTITEM('OP',5,2)
		
		THIS.ADDLISTITEM('Misc Revenue 1',6,1)
		THIS.ADDLISTITEM('M1',6,2)
		
		THIS.ADDLISTITEM('Misc Revenue 2',7,1)
		THIS.ADDLISTITEM('M2',7,2)
		
		THIS.ADDLISTITEM('Before Casing Point',8,1)
		THIS.ADDLISTITEM('BC',8,2)
		
		THIS.ADDLISTITEM('After Casing Point',9,1)
		THIS.ADDLISTITEM('AC',9,2)
		
		THIS.ADDLISTITEM('Expense Class 1',10,1)
		THIS.ADDLISTITEM('E1',10,2)
		
		THIS.ADDLISTITEM('Expense Class 2',11,1)
		THIS.ADDLISTITEM('E2',11,2)
		
		THIS.ADDLISTITEM('Expense Class 3',12,1)
		THIS.ADDLISTITEM('E3',12,2)
		
		THIS.ADDLISTITEM('Expense Class 4',13,1)
		THIS.ADDLISTITEM('E4',13,2)
		
		THIS.ADDLISTITEM('Expense Class 5',14,1)
		THIS.ADDLISTITEM('E5',14,2)
		
		THIS.ADDLISTITEM('Oil Taxes 1',15,1)
		THIS.ADDLISTITEM('OT1',15,2)
		
		THIS.ADDLISTITEM('Gas Taxes 1',16,1)
		THIS.ADDLISTITEM('GT1',16,2)
		
		THIS.ADDLISTITEM('Other Product Taxes 1',17,1)
		THIS.ADDLISTITEM('PT1',17,2)
		
		THIS.ADDLISTITEM('Oil Taxes 2',18,1)
		THIS.ADDLISTITEM('OT2',18,2)
		
		THIS.ADDLISTITEM('Gas Taxes 2',19,1)
		THIS.ADDLISTITEM('GT2',19,2)
		
		THIS.ADDLISTITEM('Other Product Taxes 2',20,1)
		THIS.ADDLISTITEM('PT2',20,2)
		
		THIS.ADDLISTITEM('Oil Taxes 3',21,1)
		THIS.ADDLISTITEM('OT3',21,2)
		
		THIS.ADDLISTITEM('Gas Taxes 3',22,1)
		THIS.ADDLISTITEM('GT3',22,2)
		
		THIS.ADDLISTITEM('Other Product Taxes 3',23,1)
		THIS.ADDLISTITEM('PT3',23,2)
		
		THIS.ADDLISTITEM('Oil Taxes 4',24,1)
		THIS.ADDLISTITEM('OT4',24,2)
		
		THIS.ADDLISTITEM('Gas Taxes 4',25,1)
		THIS.ADDLISTITEM('GT4',25,2)
		
		THIS.ADDLISTITEM('Other Product Taxes 4',26,1)
		THIS.ADDLISTITEM('PT4',26,2)
		
		THIS.ADDLISTITEM('After Payout',27,1)
		THIS.ADDLISTITEM('AP',27,2)
		
		THIS.ADDLISTITEM('Plugging',28,1)
		THIS.ADDLISTITEM('PL',28,2)
		
		THIS.LISTITEMID = 1
		
		THIS.CLICK()
		
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page1.cmdChkInterests.Click
		WAIT WINDOW NOWAIT 'Checking interests...'
		TRY 
		lcSelect = SELECT()
		lnRecNo = RECNO('wellinv')
		* Make sure all blank wells and owners are removed
		swCleanDOI()
		
		SELECT (lcSelect)
		swselect('wellinv')
		GOTO lnRecNo
		
		WAIT CLEAR 
		
		thisform.chkInterest('',.T.)
		CATCH TO loError
		   IF loError.ErrorNo = 5
		      MESSAGEBOX('There are no interests setup for this well.', 48,'Check Interests Problem')
		   ELSE
		      MESSAGEBOX('There was a problem checking the interests.' + CHR(10) + CHR(10) + ;
		                 'Error#: ' + TRANSFORM(loerror.errorno) + CHR(10) + ;
		                 'Msg: ' + loerror.message, 48,'Check Interests Problem')
		   ENDIF               
		ENDTRY 
	ENDPROC

	PROCEDURE pageframe.Page1.cmdLookWell1.Click
		LOCAL lcList, lcNewWell, lcNewWellName
		PRIV llOK, llNew
		
		THISFORM.lcoldwellid = wellinv.cwellid
		
		llOK   = .T.
		lcList = 'cWellid/Well ID,cwellname/Well Name,cdeck/Deck,cgroup/Group,cwellstat/Status'
		lcDeck = THISFORM.pageframe.page1.cbodeck1.VALUE
		
		SELECT  doidecks.cwellid,;
		   wells.cwellname,;
		   doidecks.cdeck, ;
		   wells.cgroup,;
		   wells.cwellstat  ;
		   FROM doidecks, wells ;
		   WHERE wells.cwellid = doidecks.cwellid ;
		   INTO CURSOR well_list READWRITE  ;
		   ORDER BY doidecks.cwellid
		
		IF _TALLY > 0
		   INDEX ON cwellid TAG cwellid
		   INDEX ON cwellname TAG cwellname
		   INDEX ON cdeck TAG cdeck
		   INDEX ON cgroup TAG cgroup
		   INDEX ON cwellstat TAG cwellstat
		ENDIF
		
		DO FORM ..\CUSTOM\picklist WITH 'Well_List', lcList, ;
		   IIF(THISFORM.PAGEFRAME.ACTIVEPAGE = 2, THISFORM.pageframe.page1.txtWellID1.VALUE, THISFORM.pageframe.page1.txtWellID1.VALUE), 5, .T.
		
		IF llOK
		   lcNewWell     = well_list.cwellid
		   lcNewWellName = well_list.cwellname
		   lcNewGroup    = well_list.cgroup
		   lcNewDeck     = well_list.cdeck
		
		
		   swselect('doidecks')
		   LOCATE FOR cdeck = lcNewDeck AND cwellid = lcNewWell
		   IF NOT FOUND()
		      LOCATE FOR cwellid = lcNewWell
		      lcDeck = doidecks.cdeck
		   ENDIF
		   THISFORM.pageframe.page1.txtWellID1.VALUE = lcNewWell
		   THISFORM.pageframe.page1.txtWellID1.REFRESH()
		   THISFORM.PAGEFRAME.page1.txtWellName.VALUE = lcNewWellName
		   THISFORM.PAGEFRAME.page1.txtWellName.REFRESH()
		   thisform.pageframe.page1.cbodeck1.Refresh()
		   THISFORM.requeryclass('Wells')
		ENDIF
		
	ENDPROC

	PROCEDURE pageframe.Page1.cmdLookWell1.When
		IF MDOWN()
		   DODEFAULT()
		ENDIF
		
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.AfterRowColChange
		LPARAMETERS ncol
		*
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.BeforeRowColChange
		LPARAMETERS nColIndex
		*
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column1.txtOwnerID.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column1.txtOwnerID.Valid
		*!*	LOCAL lcSelect
		
		*!*	lcSelect = SELECT()
		
		*!*	*
		*!*	*  Only update the owner name if the owner id has changed
		*!*	*
		*!*	IF this.lChanged
		*!*	   swselect('investor')
		*!*	   SET ORDER TO cOwnerID
		*!*	   IF SEEK(this.value)
		*!*	      thisform.pageframe.page1.grdgridcustom1.column2.txtOwnerName.value = cownname
		*!*	      thisform.pageframe.page1.grdgridcustom1.column2.txtOwnerName.Refresh()
		*!*	   ENDIF
		*!*	ENDIF
		
		*!*	SELECT (lcSelect)   
		*DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column10.txtProgCode.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column11.txtInterest.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column11.txtInterest.Valid
		thisform.setnextcontrol(this)
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column2.txtOwnerName.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column3.chkOnHold.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column4.chkJIB.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column5.txtOwnerType.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column6.txtIntType.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column7.txtDirectPay.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column8.chkFlatRate.DblClick
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		thisform.selectrec(lcView)
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Column9.Command1.Click
		* Get the view currently displayed
		lcView = thisform.pageframe.page1.grdgridcustom1.recordsource
		lnRecNo = RECNO()
		GO lnRecNo
		thisform.selectrec(lcView)
		*thisform.cmdatamanager.afternav('WELLINV')
	ENDPROC

	PROCEDURE pageframe.Page1.Grdgridcustom1.Valid
		*
	ENDPROC

	PROCEDURE pageframe.Page1.txtnTotalInt.When
		DODEFAULT()
		RETURN .f.
	ENDPROC

	PROCEDURE pageframe.Page1.txtWellid1.GotFocus
		ON KEY LABEL F2 _screen.activeform.cmdLookWell1.Click()
		DODEFAULT()
		
	ENDPROC

	PROCEDURE pageframe.Page1.txtWellid1.InteractiveChange
		IF DODEFAULT()
		   select wells
		   LOCATE FOR cwellid == this.Value
		   IF FOUND()
		      thisform.pageframe.page1.txtwellname.set('value',wells.cwellname)
		      thisform.lcoldwellid = wells.cwellid
		      thisform.pageframe.page1.cbodeck1.Requery()
		   ELSE
		      thisform.pageframe.page1.txtwellname.set('value','')
		      thisform.lcoldwellid = ''
		   ENDIF    
		ENDIF    
	ENDPROC

	PROCEDURE pageframe.Page1.txtWellid1.Valid
		LOCAL lcWellID 
		
		ON KEY LABEL F2 *
		
		* thisform.cmdatamanager.afternav('Wells')   
		
		RETURN .t.
		
		
	ENDPROC

	PROCEDURE pageframe.Page1.txtWellName.When
		RETURN .F.
	ENDPROC

	PROCEDURE pageframe.Page2.Activate
		LOCAL lcWellID
		
		thisform.cnavworkarea = 'Wellinv'
		
		lcWellID = doidecks.cwellid
		lcDeck   = doidecks.cdeck
		
		swselect('doidecks')
		LOCATE FOR cdeck = lcDeck AND cwellid = lcWellID
		IF NOT FOUND()
		   GO top
		   lcWellID = doidecks.cwellid
		   lcDeck   = doidecks.cdeck
		ENDIF 
		
		IF wellinv.cwellid # lcWellID 
		   swselect('wellinv')
		   LOCATE FOR cdeck = lcDeck AND cwellid = lcWellid 
		ENDIF 
		
		thisform.cmdatamanager.afternav('wellinv')
		
		IF NOT EMPTY(lcWellID)
		   swselect('wells')
		   SET ORDER TO cwellid
		   IF SEEK(lcWellID)   
		      thisform.pageframe.page2.txtWellName.value = cWellName
		      thisform.pageframe.page2.txtWellName.Refresh()
		      thisform.pageframe.page2.txtWellID2.refresh()
		      thisform.pageframe.page2.chkSpecify.Refresh()   
		   ENDIF   
		ELSE
		   lcWellID = ''
		ENDIF
		
		*  Make the specify revenue interest checkbox
		*  visible.  It should be seen when page2
		*  is active.
		*
		thisform.pageframe.page2.chkSpecify.Visible       = .T.
		
		
		THISFORM.LOCKSCREEN = .F.
		
		*
		*  Make sure the navigation workarea is WELLINV
		*
		THISFORM.cnavworkarea = 'wellinv'
		
		*  Fill in the owner name
		SWSELECT('investor')
		SET ORDER TO cOwnerID
		IF SEEK(wellinv.cOwnerID)
		   THISFORM.PAGEFRAME.page2.txtcOwnerName.VALUE = cownname
		   THISFORM.PAGEFRAME.page2.txtcOwnerName.REFRESH()
		ELSE
		   THISFORM.PAGEFRAME.page2.txtcOwnerName.VALUE = 'Unknown'
		   THISFORM.PAGEFRAME.page2.txtcOwnerName.REFRESH()
		ENDIF
		
		thisform.setflat()
		
		
		THIS.REFRESH()
		
		this.ForeColor = RGB(0,0,255)
		this.Parent.page1.ForeColor = RGB(0,0,0)
		IF this.Parent.PageCount > 2
		   this.Parent.page3.ForeColor = RGB(0,0,0)
		ENDIF    
		THISFORM.LOCKSCREEN = .F.
		
	ENDPROC

	PROCEDURE pageframe.Page2.cboDeck2.Click
		IF DODEFAULT()
		   lcDeck   = this.Value
		   lcWellID = thisform.pageframe.page2.txtWellID2.Value 
		   thisform.RequeryDeck(lcDeck,lcWellID)
		ENDIF 
	ENDPROC

	PROCEDURE pageframe.Page2.cboDeck2.Init
		IF DODEFAULT()
		   this.Requery()
		ENDIF    
	ENDPROC

	PROCEDURE pageframe.Page2.cboDeck2.Requery
		LPARAMETERS lcDeck
		
		IF DODEFAULT()
			THIS.CLEAR()
		
		    IF VARTYPE(lcDeck) # 'C'
		       lcDeck = this.Value
		    ENDIF 
		       
		    lcWellID = wellinv.cwellid
		    lnIndex = 1
		    
			SELECT cdeck, ldefault FROM doidecks ;
			    WHERE cwellid = lcWellID ;
				INTO CURSOR temp ;
				ORDER BY cdeck DESC  ;
				GROUP BY cdeck
		
			lnx = 1
			IF _TALLY > 0
				SELECT temp
				SCAN
					SCATTER MEMVAR
					IF EMPTY(m.cdeck)
					   m.cdeck = '(blank)'
					ENDIF 
					THIS.ADDLISTITEM(m.cdeck,lnx,1)
					THIS.ADDLISTITEM(m.cdeck,lnx,2)
					IF m.cDeck = lcDeck
					   lnIndex = lnx
					ENDIF 
					lnx = lnx + 1 
				ENDSCAN
			    this.ListItemId = lnIndex
			ELSE 		
			    this.ListItemId = 1
			ENDIF
		ENDIF
		
	ENDPROC

	PROCEDURE pageframe.Page2.cboDeck2.Valid
		lcDeck = this.Value
		
		IF NOT thisform.cmdatamanager.isnew('Wellinv')
		   thisform.cmdatamanager.afternav('wellinv')
		ELSE
		   thisform.cmdatamanager.replace('Wellinv','Cdeck',this.Value)
		ENDIF 
		   
		RETURN .t.
	ENDPROC

	PROCEDURE pageframe.Page2.cboDirect.Init
		this.addlistitem('None',1,1)
		this.addlistitem('N',1,2)
		this.addlistitem('Both',2,1)
		this.addlistitem('B',2,2)
		this.addlistitem('Oil',3,1)
		this.addlistitem('O',3,2)
		this.addlistitem('Gas',4,1)
		this.addlistitem('G',4,2)
		
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page2.cboDirect.LostFocus
		IF NOT thisform.pageframe.page2.chkspecify.value AND wellinv.ctypeinv = 'W'
		   thisform.setnextcontrol(thisform.pageframe.page2.txtInterest)
		ENDIF
		DODEFAULT()   
		   
	ENDPROC

	PROCEDURE pageframe.Page2.cboDirect.Valid
		LOCAL llDummy
		
		SELECT investor
		LOCATE FOR cOwnerID == thisform.pageFrame.page2.txtcownerID.Value AND lDummy
		IF FOUND()
		   llDummy = .t.
		ELSE
		   llDummy = .f.
		ENDIF 
		
		IF this.Value <> 'N' AND llDummy  &&  Don't let them change it to anything besides "Neither" for a Dummy owner 
		   thisform.oMessage.Warning("You cannot mark a DUMMY owner as directly paid.  Any revenue entered will be grossed up to account for the DUMMY owner's percentage, so marking them as directly paid is unnecessary.")
		   this.set('value','N')
		   thisform.setnextcontrol(this)
		ENDIF
		
		IF this.value <> 'N'
		   SWSELECT('investor')
		   SET ORDER to cownerid
		   IF SEEK(wellinv.cownerid) 
		      IF investor.linteggl
		         thisform.omessage.warning('This owner should not be marked as direct paid. ' + ;
		               'They are set to ' + IIF(m.goapp.lamversion,'post to the G/L',IIF(m.goapp.lqbversion,'post to QB','not create a check')) + ' in their owner information record, which should only be used for your company record.')
		      ENDIF
		   ELSE
		      RETURN .f.
		   ENDIF
		ENDIF 
		
		DODEFAULT()
		
		
		
	ENDPROC

	PROCEDURE pageframe.Page2.cboIntType.Init
		this.addlistitem('Both',1,1)
		this.addlistitem('B',1,2)
		this.addlistitem('Oil',2,1)
		this.addlistitem('O',2,2)
		this.addlistitem('Gas',3,1)
		this.addlistitem('G',3,2)
		
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page2.cboIntType.Valid
		dodefault()
		DO CASE
		   CASE UPPER(this.value) = 'G'
		      thisform.cmdatamanager.replace('Wellinv','nrevoil',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax1',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax4',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax7',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax10',0)
		      thisform.pageframe.page2.refresh()
		   CASE UPPER(this.value) = 'O'
		      thisform.cmdatamanager.replace('Wellinv','nrevgas',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax2',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax5',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax8',0)
		      thisform.cmdatamanager.replace('Wellinv','nrevtax11',0)   
		      thisform.pageframe.page2.refresh()
		ENDCASE
		
		
	ENDPROC

	PROCEDURE pageframe.Page2.cboOwnType.Init
		
		this.addlistitem('Royalty',1,1)
		this.addlistitem('L',1,2)
		this.addlistitem('Override',2,1)
		this.addlistitem('O',2,2)
		this.addlistitem('Working Int',3,1)
		this.addlistitem('W',3,2)
		
		DODEFAULT()
		
		
	ENDPROC

	PROCEDURE pageframe.Page2.cboOwnType.LostFocus
		*  Don't ask if this is Petrox, because they do hundreds of replacements at a time, and we wrote them a utility to combine them later
		IF NOT FILE('petrox.dat')
		   *  Check for a record for this owner in this well with this owner type and program, and don't let them add a duplicate  
		   swselect('wellinv1')  
		   IF wellinv.lFlat
		      LOCATE FOR cWellID = wellinv.cWellID ;
		             AND cOwnerID = wellinv.cOwnerID ;
		             AND cTypeInv = wellinv.cTypeInv ;
		             AND cProgcode = wellinv.cProgCode ;
		             AND cidwinv <> wellinv.cidwinv ;
		             AND lFlat
		   ELSE
		      LOCATE FOR cWellID = wellinv.cWellID ;
		             AND cOwnerID = wellinv.cOwnerID ;
		             AND cTypeInv = wellinv.cTypeInv ;
		             AND cProgCode = wellinv.cProgcode ;
		             AND cidwinv <> wellinv.cidwinv ;
		             AND NOT lFlat
		   ENDIF
		   IF FOUND()
		      THISFORM.oMessage.Warning("This owner already has an interest in this well with this owner type. " + ;
		                                "An owner cannot have multiple interests in a well with the same owner " + ;
		                                "type.  You must add this entry's percentages to the existing record, " + ;
		                                "instead of creating multiple entries.")
		      thisform.setnextcontrol(thisform.pageFrame.page2.txtcownerID)
		   ENDIF
		ENDIF
		
		dodefault()
	ENDPROC

	PROCEDURE pageframe.Page2.cboOwnType.Valid
		DODEFAULT()
		
		IF this.value <> 'W'
		   this.Parent.txtinterest.set('enabled',.f.)
		   * Zero out the interest
		   thisform.cmdatamanager.replace('Wellinv','Nworkint',0)
		   this.Parent.chkLjib.set('value',.f.)
		   this.Parent.chkljib.set('Enabled',.f.)
		ELSE
		   this.Parent.txtinterest.set('enabled',.t.)
		   this.Parent.chkljib.set('Enabled',.t.)
		ENDIF
		
		thisform.Refresh()
	ENDPROC

	PROCEDURE pageframe.Page2.cboSuspReason.Init
		this.AddListItem(' ',1,1)
		this.AddListItem(' ',1,2)
		lnx = 2
		swselect('suspreasons')
		SCAN 
		   SCATTER MEMVAR 
		   THIS.ADDLISTITEM(m.creason,lnx,1)
		   THIS.ADDLISTITEM(m.description,lnx,2)
		   lnx = lnx + 1 
		ENDSCAN 
		
		THIS.REFRESH()
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE pageframe.Page2.chkLflat.Click
		IF DODEFAULT()
		   thisform.showflatfields(this.value)
		ENDIF    
		   
	ENDPROC

	PROCEDURE pageframe.Page2.chkLflat.Valid
		LOCAL llDummy
		
		DODEFAULT()
		
		SELECT investor
		LOCATE FOR cOwnerID == thisform.pageFrame.page2.txtcownerID.Value AND lDummy
		IF FOUND()
		   llDummy = .t.
		ELSE
		   llDummy = .f.
		ENDIF 
		
		IF THIS.VALUE AND lDummy  &&  Don't let them change a Dummy owner to be a flat rate
		   THISFORM.oMessage.warning('You cannot mark a DUMMY owner as a flat rate owner.')
		   THIS.SET('value',.F.)
		   THISFORM.setnextcontrol(THIS)
		ENDIF
		
		
		
		THISFORM.setflat(.f.)
		
	ENDPROC

	PROCEDURE pageframe.Page2.chkLonhold.Click
		IF THIS.VALUE = .T.
		   SWSELECT('investor')
		   LOCATE FOR cOwnerID == wellinv.cOwnerID
		   IF investor.lIntegGL = .T. AND (m.goapp.lAMVersion OR m.goapp.lQBVersion)  &&  Don't let them put an owner who is set to post on hold - BH 10/02/2008
		      IF m.goapp.lQBVersion = .f.
		         THISFORM.oMessage.Warning('This owner is set to post to the General Ledger.  Their interest cannot be put on hold.')
		      ELSE
		         THISFORM.oMessage.Warning('This owner is set to post to the QB Income/Expense Accounts.  Their interest cannot be put on hold.')
		      ENDIF
		      THIS.SET('value',.F.)
		   ENDIF
		   IF investor.lDummy
		      thisform.oMessage.Warning('This owner is marked as a Dummy owner in their Owner Information record.  They cannot be put on hold.')
		      THIS.SET('value',.F.)
		   ENDIF 
		   this.Parent.cbosuspReason.Enabled = .t.
		ELSE
		   this.Parent.cboSuspReason.Enabled = .f. 
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE pageframe.Page2.cmdLookOwner.Click
		LOCAL lcList
		PRIV llOK
		
		llOK   = .T.
		lcList = 'cownerid,csortfield'
		IF TYPE('thisform.lcoldownerid') <> 'C'
		   thisform.lcoldownerid = ' '
		ENDIF   
		
		DO FORM ..\custom\picklist WITH 'Investor', lcList, iif(empty(thisform.pageframe.page2.txtcownerid.value),thisform.lcOldOwnerID,thisform.pageframe.page2.txtcownerid.value), 2
		
		IF llOK
		   this.Parent.txtcownerID.set('value',investor.cownerid)
		   thisform.pageframe.page2.txtcOwnerID.Refresh()
		   thisform.pageframe.page2.txtcOwnerName.value = investor.cOwnName
		   thisform.pageframe.page2.txtcOwnerName.Refresh()
		   thisform.pageframe.page2.txtcOwnerID.SetFocus()
		ENDIF   
		
		SELE wellinv
	ENDPROC

	PROCEDURE pageframe.Page2.cmdLookOwner.When
		SELE wellinv1
		
		COUNT FOR NOT DELETED() TO lnCount
		IF NOT thisform.cmdatamanager.isnew('Wellinv') AND lnCount = 0 
		   RETURN .F.
		ELSE
		   IF MDOWN()
		      RETURN .T.
		   ENDIF
		ENDIF          
		
	ENDPROC

	PROCEDURE pageframe.Page2.cmdLookWell2.Click
		LOCAL lcList, lcNewWell, lcNewWellName
		PRIV llOK, llNew
		
		llNew = THISFORM.cmdatamanager.isnew('Wellinv')
		
		THISFORM.lcoldwellid = wellinv.cwellid
		
		llOK   = .T.
		lcList = 'cWellid,cwellname,cgroup,cwellstat'
		lcDeck = thisform.pageframe.page2.cbodeck2.value
		
		SELECT  wells.cwellid,;
				wells.cwellname,;
				wells.cgroup,;
				wells.cwellstat  ;
			FROM wells ;
			INTO CURSOR well_list READWRITE  ;
			ORDER BY cwellid
		
		IF _tally > 0
		   INDEX on cwellid TAG cwellid
		   INDEX on cwellname TAG cwellname
		   INDEX on cgroup TAG cgroup
		   INDEX on cwellstat TAG cwellstat
		ENDIF
		
		DO FORM ..\CUSTOM\picklist WITH 'Well_List', lcList, ;
		      IIF(THISFORM.PAGEFRAME.ACTIVEPAGE = 2, THISFORM.pageframe.page2.txtWellID2.VALUE, THISFORM.pageframe.page2.txtWellID2.VALUE), 4, .t.
		
		IF llOK
		    lcNewWell     = well_list.cwellid
		    lcNewWellName = well_list.cwellname
		    lcNewGroup    = well_list.cgroup
		
		
		    IF THISFORM.PAGEFRAME.ACTIVEPAGE = 2
		       swselect('doidecks')
		       LOCATE FOR cdeck = lcDeck AND cwellid = lcNewWell
		        IF THISFORM.cmdatamanager.isnew('WellInv')
		            THISFORM.cmdatamanager.REPLACE('Wellinv', 'cWellID', lcNewWell)
		        ELSE
		            IF lcNewWell <> THISFORM.lcoldwellid
		                THISFORM.cmdatamanager.revertall()
		                swselect('wellinv')
		                LOCATE FOR cwellid = lcNewWell AND cDeck = lcDeck
		                IF FOUND()
		                    THISFORM.cmdatamanager.afternav('Wellinv')
		                    THISFORM.pageframe.page2.txtWellID2.REFRESH()
		                ELSE
		                    IF THISFORM.omessage.CONFIRM('No owners have been added to this well. Would you like to add owners to this well?')
		                        lcSaveWell = lcNewWell
		                        THISFORM.cmdatamanager.new('Wellinv')
		                        THISFORM.cmdatamanager.REPLACE('Wellinv', 'Cwellid', lcSaveWell)
		                        THISFORM.pageframe.page2.txtWellID2.REFRESH()
		                    ELSE
		                        RETURN .F.
		                    ENDIF
		                ENDIF
		            ENDIF
		            THISFORM.lchanged = .F.
		        ENDIF
		        THISFORM.pageframe.page2.txtWellName.VALUE = lcNewWellName
		        THISFORM.pageframe.page2.txtWellName.REFRESH()
		        THISFORM.setnextcontrol(THISFORM.pageframe.page2.txtWellID2)
		        thisform.pageframe.page2.cbodeck2.Requery()
		
		        lcDeck   = thisform.pageframe.page2.cbodeck2.value
		        thisform.RequeryDeck(lcDeck, lcNewWell)
		    ELSE
		       swselect('doidecks')
		       LOCATE FOR cdeck = lcDeck AND cwellid = lcNewWell
		       IF NOT FOUND()
		          LOCATE FOR cwellid = lcNewWell
		          lcDeck = doidecks.cdeck
		       ENDIF
		        THISFORM.pageframe.page2.txtWellID2.VALUE = lcNewWell
		        THISFORM.pageframe.page2.txtWellID2.REFRESH()
		        THISFORM.pageframe.page2.txtWellName.VALUE = lcNewWellName
		        THISFORM.pageframe.page2.txtWellName.REFRESH()
		        THISFORM.requeryclass('Wells')
		    ENDIF
		ENDIF
	ENDPROC

	PROCEDURE pageframe.Page2.cmdLookWell2.When
		SELE wellinv1
		
		COUNT FOR NOT DELETED() TO lnCount
		IF NOT thisform.cmdatamanager.isnew('Wellinv') AND lnCount = 0 
		   RETURN .F.
		ELSE
		   IF MDOWN()
		      RETURN .T.
		   ENDIF
		ENDIF          
		
	ENDPROC

	PROCEDURE pageframe.Page2.cmdProgram.Click
		LOCAL lcList
		PRIV llOK
		
		llOK   = .F.
		lcList = 'cprogcode,cprogname'
		
		DO FORM ..\custom\picklist WITH 'Programs', lcList, thisform.pageframe.page2.txtprogcode.value, 2
		
		IF llOK
		   this.Parent.txtprogcode.set('value',programs.cprogcode)
		   thisform.pageframe.page2.txtprogcode.refresh()
		   thisform.pageframe.page2.txtProgcode.SetFocus()
		ENDIF   
	ENDPROC

	PROCEDURE pageframe.Page2.cmdProgram.When
		SELE wellinv
		lnRecNo = RECNO()
		
		COUNT FOR NOT DELETED() TO lnCount
		go lnrecno
		IF lnCount = 0
		   RETURN .F.
		ELSE
		   IF MDOWN()
		      RETURN .T.
		   ENDIF
		ENDIF          
	ENDPROC

	PROCEDURE pageframe.Page2.Deactivate
		*
		*  Update the wellinv table
		*
		IF thisform.lchanged
		   thisform.save()
		ENDIF   
		
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page2.opgFlatFreq.When
		RETURN wellinv.lFlat
	ENDPROC

	PROCEDURE pageframe.Page2.txtAPOInt.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('AP')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtAPOInt.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtcFlatStart.Valid
		DODEFAULT()
		
		this.value = PADL(ALLTRIM(this.value),2,'0')
		thisform.cmdatamanager.replace('Wellinv','Cflatstart',this.value)
		this.refresh()
	ENDPROC

	PROCEDURE pageframe.Page2.txtcFlatStart.When
		RETURN wellinv.lFlat
	ENDPROC

	PROCEDURE pageframe.Page2.txtcOwnerID.GotFocus
		ON KEY LABEL F2 _screen.activeform.pageframe.page2.cmdlookowner.click()
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page2.txtcOwnerID.InteractiveChange
		IF DODEFAULT()
		   SWSELECT('investor',.T.)
		   LOCATE FOR cownerid == this.Value
		   IF FOUND()
		      thisform.pageFrame.page2.txtcOwnerName.set('value',investor.cownname)
		   ELSE
		      thisform.pageFrame.page2.txtcOwnerName.set('value','')
		   ENDIF 
		ENDIF    
	ENDPROC

	PROCEDURE pageframe.Page2.txtcOwnerID.LostFocus
		ON KEY LABEL F2 *
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page2.txtcOwnerName.When
		RETURN .F.
	ENDPROC

	PROCEDURE pageframe.Page2.txtFlatBBL.Valid
		DODEFAULT()
		IF THIS.VALUE <> 0
		   IF THISFORM.oMessage.CONFIRM("Enabling the flat rate will zero out this owner's percentages in this record.  " + ;
		                                "Any other interests for this owner will NOT be affected.")
		      THISFORM.PAGEFRAME.page2.txtInterest.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtrp.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevgas.setvalue(0)
		      thisform.pageframe.page2.txtrevoil.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevmisc1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevmisc2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax3.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax4.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax5.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax6.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax7.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax8.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax9.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax10.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax11.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax12.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass3.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass4.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass5.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtinterest.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtnbcpint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtnacpint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtapoint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.cboowntype.LISTITEMID = 1
		      THISFORM.PAGEFRAME.page2.cboowntype.REFRESH()
		            IF EMPTY(thisform.pageframe.page2.txtcflatStart.Value)
		         THISFORM.PAGEFRAME.page2.txtcflatstart.SET('value','01')
		      ENDIF    
		      IF EMPTY(thisform.pageframe.page2.opgFlatFreq.Value)
		         THISFORM.PAGEFRAME.page2.opgFlatFreq.SET('value',1)
		      ENDIF    
		
		      thisform.pageframe.page2.txtflatBBL.Enabled = .f.
		      thisform.pageframe.page2.txtflatmcf.Enabled = .f.
		      thisform.pageFrame.page2.txtrevgas.set('enabled',.f.)
		      thisform.pageFrame.page2.txtrevoil.set('enabled',.f.)
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Ctypeinv','L')
		   ELSE
		      thisform.cmdatamanager.replace('wellinv','nflatrate',0)
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Lflat',.F.)
		      thisform.setnextcontrol(thisform.pageframe.page2.txtrevoil)
		      THIS.REFRESH()
		   ENDIF
		ENDIF
	ENDPROC

	PROCEDURE pageframe.Page2.txtFlatBBL.When
		RETURN wellinv.lFlat  and wellinv.nflatrate = 0
	ENDPROC

	PROCEDURE pageframe.Page2.txtFlatMCF.Valid
		DODEFAULT()
		IF THIS.VALUE <> 0
		   IF THISFORM.oMessage.CONFIRM("Enabling the flat rate will zero out this owner's percentages in this record.  " + ;
		                                "Any other interests for this owner will NOT be affected.")
		      THISFORM.PAGEFRAME.page2.txtInterest.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtrp.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevgas.setvalue(0)
		      thisform.pageframe.page2.txtrevoil.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevmisc1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevmisc2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax3.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax4.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax5.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax6.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax7.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax8.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax9.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax10.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax11.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax12.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass3.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass4.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass5.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtinterest.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtnbcpint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtnacpint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtapoint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.cboowntype.LISTITEMID = 1
		      THISFORM.PAGEFRAME.page2.cboowntype.REFRESH()
		            IF EMPTY(thisform.pageframe.page2.txtcflatStart.Value)
		         THISFORM.PAGEFRAME.page2.txtcflatstart.SET('value','01')
		      ENDIF    
		      IF EMPTY(thisform.pageframe.page2.opgFlatFreq.Value)
		         THISFORM.PAGEFRAME.page2.opgFlatFreq.SET('value',1)
		      ENDIF    
		
		      thisform.pageframe.page2.txtflatBBL.Enabled = .f.
		      thisform.pageframe.page2.txtflatmcf.Enabled = .f.
		      thisform.pageFrame.page2.txtrevgas.set('enabled',.f.)
		      thisform.pageFrame.page2.txtrevoil.set('enabled',.f.)
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Ctypeinv','L')
		   ELSE
		      thisform.cmdatamanager.replace('wellinv','nflatrate',0)
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Lflat',.F.)
		      thisform.setnextcontrol(thisform.pageframe.page2.txtrevoil)
		      THIS.REFRESH()
		   ENDIF
		ENDIF
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtFlatMCF.When
		RETURN wellinv.lFlat and wellinv.nflatrate = 0
	ENDPROC

	PROCEDURE pageframe.Page2.txtFlatrate.Valid
		DODEFAULT()
		IF THIS.VALUE <> 0
		   IF THISFORM.oMessage.CONFIRM("Enabling the flat rate will zero out this owner's percentages in this record.  " + ;
		                                "Any other interests for this owner will NOT be affected.")
		      THISFORM.PAGEFRAME.page2.txtInterest.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtrp.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevgas.setvalue(0)
		      thisform.pageframe.page2.txtrevoil.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevmisc1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevmisc2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax3.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax4.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax5.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax6.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax7.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax8.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax9.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax10.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax11.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtrevtax12.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass1.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass2.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass3.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass4.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtintclass5.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtinterest.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtnbcpint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtnacpint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.txtapoint.setvalue(0)
		      THISFORM.PAGEFRAME.page2.cboowntype.LISTITEMID = 1
		      THISFORM.PAGEFRAME.page2.cboowntype.REFRESH()
		            IF EMPTY(thisform.pageframe.page2.txtcflatStart.Value)
		         THISFORM.PAGEFRAME.page2.txtcflatstart.SET('value','01')
		      ENDIF    
		      IF EMPTY(thisform.pageframe.page2.opgFlatFreq.Value)
		         THISFORM.PAGEFRAME.page2.opgFlatFreq.SET('value',1)
		      ENDIF    
		
		      thisform.pageframe.page2.txtflatBBL.Enabled = .f.
		      thisform.pageframe.page2.txtflatmcf.Enabled = .f.
		      thisform.pageFrame.page2.txtrevgas.set('enabled',.f.)
		      thisform.pageFrame.page2.txtrevoil.set('enabled',.f.)
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Ctypeinv','L')
		   ELSE
		      thisform.cmdatamanager.replace('wellinv','nflatrate',0)
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Lflat',.F.)
		      thisform.setnextcontrol(thisform.pageframe.page2.txtrevoil)
		      THIS.REFRESH()
		   ENDIF
		ENDIF
	ENDPROC

	PROCEDURE pageframe.Page2.txtFlatrate.When
		RETURN wellinv.lFlat  and wellinv.nflatmcf = 0 and wellinv.nflatbbl = 0
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass1.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('E1')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass1.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass1.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass2.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('E2')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass2.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass2.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass3.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('E3')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass3.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass3.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass4.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('E4')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass4.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass4.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass5.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('E5')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass5.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtIntclass5.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtInterest.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('DC')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtInterest.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtInterest.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtInterest.When
		RETURN (wellinv.ctypeinv='W')
	ENDPROC

	PROCEDURE pageframe.Page2.txtNacpint.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('AC')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtNacpint.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtNacpint.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtNbcpint.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('BC')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtNbcpint.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtNbcpint.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtnPlugPct.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('PLG')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtnPlugPct.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtProgcode.LostFocus
		on key label f2 *
	ENDPROC

	PROCEDURE pageframe.Page2.txtProgcode.When
		ON KEY LABEL F2 _screen.activeform.pageframe.page2.cmdProgram.click()
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevgas.GotFocus
		thisform.chkInterest('GR')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevgas.LostFocus
		*
		*  Reset the total
		*
		THISFORM.chkInterest('**')
		
		WITH THISFORM.PAGEFRAME.Page2
		   IF THISFORM.pageframe.page2.chkspecify.VALUE = .T. AND THIS.VALUE <> 0 AND (THIS.VALUE <> .txtrevtax2.VALUE OR THIS.VALUE <> .txtrevtax5.VALUE OR ;
		         THIS.VALUE <> .txtrevtax8.VALUE OR THIS.VALUE <> .txtrevtax11.VALUE)
		      IF (wellinv.lflat = .f. OR wellinv.nflatrate = 0) AND THISFORM.omessage.CONFIRM('Should this revenue interest be copied to the Gas Tax interests?')
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax2',THIS.VALUE)
		         THIS.PARENT.txtrevtax2.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax5',THIS.VALUE)
		         THIS.PARENT.txtrevtax5.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax8',THIS.VALUE)
		         THIS.PARENT.txtrevtax8.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax11',THIS.VALUE)
		         THIS.PARENT.txtrevtax11.REFRESH()
		      ENDIF
		   ELSE
		      IF wellinv.nrevtax2 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax2',THIS.VALUE)
		         THIS.PARENT.txtrevtax2.REFRESH()
		      endif   
		
		      IF wellinv.nrevtax5 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax5',THIS.VALUE)
		         THIS.PARENT.txtrevtax5.REFRESH()
		      ENDIF
		      
		      IF wellinv.nrevtax8 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax8',THIS.VALUE)
		         THIS.PARENT.txtrevtax8.REFRESH()
		      ENDIF
		      
		      IF wellinv.nrevtax11 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax11',THIS.VALUE)
		         THIS.PARENT.txtrevtax11.REFRESH()
		      endif   
		   ENDIF
		ENDWITH
		
		RETURN (DODEFAULT())
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevgas.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevmisc1.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('M1')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevmisc1.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevmisc1.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevmisc2.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('M2')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevmisc2.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevmisc2.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevoil.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('OR')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevoil.LostFocus
		*
		*  Reset the total
		*
		THISFORM.chkInterest('**')
		
		WITH THISFORM.PAGEFRAME.Page2
		   IF THISFORM.pageframe.page2.chkspecify.VALUE = .T. AND THIS.VALUE <> 0 AND (THIS.VALUE <> .txtrevtax1.VALUE OR THIS.VALUE <> .txtrevtax4.VALUE OR ;
		         THIS.VALUE <> .txtrevtax7.VALUE OR THIS.VALUE <> .txtrevtax10.VALUE)
		      IF THISFORM.omessage.CONFIRM('Should this revenue interest be copied to the Oil Tax interests?')
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax1',THIS.VALUE)
		         THIS.PARENT.txtrevtax1.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax4',THIS.VALUE)
		         THIS.PARENT.txtrevtax4.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax7',THIS.VALUE)
		         THIS.PARENT.txtrevtax7.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax10',THIS.VALUE)
		         THIS.PARENT.txtrevtax10.REFRESH()
		      ENDIF
		   ELSE
		      IF wellinv.nrevtax1 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax1',THIS.VALUE)
		         THIS.PARENT.txtrevtax1.REFRESH()
		      ENDIF    
		
		      IF wellinv.nrevtax4 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax4',THIS.VALUE)
		         THIS.PARENT.txtrevtax4.REFRESH()
		      endif   
		
		      IF wellinv.nrevtax7 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax7',THIS.VALUE)
		         THIS.PARENT.txtrevtax7.REFRESH()
		      ENDIF
		      
		      IF wellinv.nrevtax10 <> this.value AND (wellinv.lflat = .f. OR wellinv.nflatrate = 0)
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax10',THIS.VALUE)
		         THIS.PARENT.txtrevtax10.REFRESH()
		      endif   
		   ENDIF
		ENDWITH
		
		RETURN (DODEFAULT())
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevoil.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevOth.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('OP')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevOth.LostFocus
		*
		*  Reset the total
		*
		THISFORM.chkInterest('**')
		
		WITH THISFORM.PAGEFRAME.Page2
		   IF THISFORM.pageframe.page2.chkspecify.VALUE = .T. AND THIS.VALUE <> 0 AND (THIS.VALUE <> .txtrevtax3.VALUE OR THIS.VALUE <> .txtrevtax6.VALUE OR ;
		         THIS.VALUE <> .txtrevtax9.VALUE OR THIS.VALUE <> .txtrevtax12.VALUE)
		      IF THISFORM.omessage.CONFIRM('Should this revenue interest be copied to the Other Tax interests?')
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax3',THIS.VALUE)
		         THIS.PARENT.txtrevtax3.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax6',THIS.VALUE)
		         THIS.PARENT.txtrevtax6.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax9',THIS.VALUE)
		         THIS.PARENT.txtrevtax9.REFRESH()
		
		         THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax12',THIS.VALUE)
		         THIS.PARENT.txtrevtax12.REFRESH()
		      ENDIF
		   ELSE
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax3',THIS.VALUE)
		      THIS.PARENT.txtrevtax3.REFRESH()
		
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax6',THIS.VALUE)
		      THIS.PARENT.txtrevtax6.REFRESH()
		
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax9',THIS.VALUE)
		      THIS.PARENT.txtrevtax9.REFRESH()
		
		      THISFORM.cmdatamanager.REPLACE('Wellinv','Nrevtax12',THIS.VALUE)
		      THIS.PARENT.txtrevtax12.REFRESH()
		   ENDIF
		ENDWITH
		RETURN(DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevOth.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax1.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('OT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax1.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax1.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax10.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('OT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax10.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax10.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax11.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax11.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax11.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax12.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax12.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax12.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax2.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax2.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax2.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax3.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax3.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtax3.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax4.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('OT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax4.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax4.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax5.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax5.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax5.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax6.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax6.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax6.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax7.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('OT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax7.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax7.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax8.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax8.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax8.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax9.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('GT')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax9.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevTax9.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtrp.GotFocus
		*
		*  Display the total interests for this class
		*
		thisform.chkInterest('TR')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtrp.LostFocus
		*
		*  Reset the total
		*
		thisform.chkInterest('**')
		
		RETURN (DODEFAULT())
	ENDPROC

	PROCEDURE pageframe.Page2.txtRevtrp.Valid
		IF DODEFAULT()
		   IF this.Value > 100
		      thisform.omessage.severe("An interest can't be greater than 100%")
		      this.set('Value',0)
		      RETURN 0
		   ENDIF
		ENDIF       
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtWellid2.GotFocus
		ON KEY LABEL F2 _screen.activeform.pageframe.page2.cmdLookWell.Click()
		DODEFAULT()
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtWellid2.InteractiveChange
		IF DODEFAULT()
		   select wells
		   LOCATE FOR cwellid == this.Value
		   IF FOUND()
		      thisform.pageframe.page2.txtwellname.set('value',wells.cwellname)
		      thisform.lcoldwellid = wells.cwellid
		      thisform.pageframe.page2.cbodeck2.Requery()
		   ELSE
		      thisform.pageframe.page2.txtwellname.set('value','')
		      thisform.lcoldwellid = ''
		   ENDIF    
		ENDIF    
	ENDPROC

	PROCEDURE pageframe.Page2.txtWellid2.Valid
		LOCAL lcWellID 
		
		ON KEY LABEL F2 *
		
		IF thisform.cmdatamanager.isnew('wellinv')
		   thisform.cmdatamanager.replace('Wellinv','Cwellid',this.Value)
		ENDIF 
		
		RETURN .t.
		
		
	ENDPROC

	PROCEDURE pageframe.Page2.txtWellName.When
		RETURN .F.
	ENDPROC

	PROCEDURE pageframe.Page3.Activate
		IF DODEFAULT()
		   THIS.FORECOLOR              = RGB(0, 0, 255)
		   THIS.PARENT.page1.FORECOLOR = RGB(0, 0, 0)
		   THIS.PARENT.page2.FORECOLOR = RGB(0, 0, 0)
		
		   IF m.goApp.lCloudDocs
		      THIS.cmdTreeno.VISIBLE = .T.
		   ELSE
		      THIS.cmdTreeno.VISIBLE = .F.
		   ENDIF
		ENDIF
	ENDPROC

	PROCEDURE pageframe.Page3.cmdDelDoc.Click
		likey = INT(VAL(this.parent.lstDocuments.Value))
		
		swselect('documents')
		SET ORDER to iDocPK
		IF SEEK(likey)
		   DELETE NEXT 1
		   this.Parent.lstDocuments.Requery()
		   thisform.setchanged(.t.,'Documents')
		   m.gostatemanager.refreshall('Form')
		ENDIF 
	ENDPROC

	PROCEDURE pageframe.Page3.cmdLinkDoc.Click
		LOCAL lnx, llReturn
		*:Global cDesc, cDocKey, cDocLink, cfk, cpath
		llReturn = THISFORM.ofilEDIALOG.openfile()
		
		IF NOT THISFORM.ofilEDIALOG.lcancelled 
		   m.cDesc    = thisform.omessage.gettext('Enter a description for this file.','Get File Description')
		   IF ALLTRIM(UPPER(thisform.oFileDialog.cPath)) $ UPPER(thisform.oFileDialog.aFiles[1])
		      m.cPath = thisform.oFileDialog.aFiles[1]
		   ELSE 
		      m.cpath    = UPPER(ALLTRIM(thisform.oFileDialog.cPath)+THISFORM.ofilEDIALOG.aFiles[1])
		   ENDIF    
		   IF EMPTY(m.cDesc) OR ISNULL(m.cDesc)
		      m.cDesc = ALLTRIM(m.cpath)
		   ENDIF 
		   m.cfk      = wells.cwellid
		   m.cDocLink  = 'DI'
		
		   swSELECT('documents')
		   LOCATE FOR cfk == m.cfk AND ALLTRIM(cpath) == ALLTRIM(m.cpath)
		   IF NOT FOUND()
		      INSERT INTO documents FROM MEMVAR
		   ENDIF
		   THIS.PARENT.lstDocuments.REQUERY()
		   THISFORM.setchanged(.T., 'Documents')
		   m.gostatemanager.refreshall('Form')
		ENDIF
		 
	ENDPROC

	PROCEDURE pageframe.Page3.cmdShowPath.Click
		IF this.Caption = 'Show Paths'
		   this.Parent.lstDocuments.Requery('Path')
		   this.Caption = 'Show Desc'
		ELSE
		   this.Parent.lstDocuments.Requery('Desc')
		   this.Caption = 'Show Paths'
		ENDIF    
		
	ENDPROC

	PROCEDURE pageframe.Page3.cmdTreeno.Click
		LOCAL loTS
		
		loTS = m.goApp.oTreeno
		
		IF loTS.Login()
		   * Get the cabinet ID, needed for the other calls
		   lnCabinetID = loTS.GetCabinetID("DOI") && ex. "Leases", "Wells"
		
		   IF m.lnCabinetID = -1
		      MESSAGEBOX('Error Accessing Treeno:' + CHR(10) + loTS.cErrorMsg,48,'Treeno Problem')
		      RETURN
		   ENDIF
		
		   * Check to see if the folder already exists
		   * Not a great example because if you did a search for a company named "Test"
		   * a company like "Test Company" would match. The assumption is this
		   * field contains a unique value. If that ends up being a bad assumption
		   * you could iterate over the loTS.oMatches and do a more exact match.
		   *lnMatches = loTS.SearchCabinet(lnCabinetID, "company_name", "Test Company") && ex. lease_number or well_id
		   lnMatches = loTS.SearchCabinet(lnCabinetID, "well_id", wells.cwellid) && ex. lease_number or well_id
		
		   IF lnMatches = -1
		      MESSAGEBOX('Error Accessing Treeno:' + CHR(10) + loTS.cErrorMsg,48,'Treeno Problem')
		      RETURN
		   ENDIF
		
		   * If the folder doesn't exist, create it
		   IF lnMatches = 0
		      * Folder Not found
		      IF MESSAGEBOX('The folder for well: ' + wells.cwellid + ' does not exist in Treeno. Do you want to create it?',36,'Access Treeno') = 6
		         CREATE CURSOR curfolder (well_id C(10), well_name C(40), api_number C(20), county C(30), township C(20), status C(1), lease_id c(10))
		         SWSELECT('leasewell')
		         SELECT cLeaseID FROM leasewell WHERE  cwellid == wells.cwellid INTO CURSOR templease ORDER BY cleaseid
		         INSERT INTO curfolder (well_id, well_name, api_number, county, township, status, lease_id) ;
		            VALUES (wells.cwellid, wells.cwellname, wells.cpermit1, wells.ccounty, wells.ctownship, wells.cwellstat, templease.cleaseid)
		
		         llCreated = loTS.CreateFolder(thisform.DataSessionId, m.lnCabinetID, "curFolder")
		
		         IF !m.llCreated
		            MESSAGEBOX('Error Accessing Treeno:' + CHR(10) + loTS.cErrorMsg,48,'Treeno Problem')
		         ENDIF
		      ELSE
		         RETURN
		      ENDIF
		   ENDIF
		
		   swselect('options')
		   GO TOP 
		   lcUser = ALLTRIM(cTreenoUser)
		   lcPassword = ALLTRIM(cmEncrypt(options.cTreenoPwd,'5h3rWar3A1Z2'))
		   * Now open the website up to this folder
		   loTS.LaunchWebsite(lcUser, lcPassword, "Wells", "well_id", wells.cwellid)
		ELSE
		   MESSAGEBOX('Unable to login to Treeno. Check your user name and password in the Cloud Doc Mgmt preferences and try again.',16,'Treeno Login Problem')      
		ENDIF
		
	ENDPROC

	PROCEDURE pageframe.Page3.cmdViewDoc.Click
		thisform.viewdocument()
	ENDPROC

	PROCEDURE pageframe.Page3.lstDocuments.Click
		LOCAL liDocPK
		*:Global cpath
		
		IF DODEFAULT()
		liDocPK = INT(VAL(this.ListItem[this.ListItemId,2]))
		
		swselect('documents')
		SET ORDER to idocpk
		IF SEEK(liDocPK)
		   m.cpath = cpath
		   this.ToolTipText = m.cpath
		ENDIF 
		ENDIF 
		 
	ENDPROC

	PROCEDURE pageframe.Page3.lstDocuments.DblClick
		thisform.viewdocument()
	ENDPROC

	PROCEDURE pageframe.Page3.lstDocuments.Requery
		LPARAMETERS tcType
		
		IF VARTYPE(tcType) # 'C'
		   tcType = 'Desc'
		ENDIF
		
		swselect('options')
		llDocShare = options.lDocShare
		
		THIS.CLEAR()
		lnx = 1
		swselect('documents')
		
		IF llDocShare
		   IF tcType = 'Desc'
		      SCAN FOR cDocLink = 'DI' AND cFK == wells.cwellid
		         SCATTER MEMVAR
		         THIS.ADDLISTITEM(documents.cdesc, lnx, 1)
		         THIS.ADDLISTITEM(TRANSFORM(documents.idocpk), lnx, 2)
		         lnx = lnx + 1
		      ENDSCAN
		   ELSE
		      SCAN FOR cDocLink = 'DI' AND cFK == wells.cwellid
		         SCATTER MEMVAR
		         THIS.ADDLISTITEM(documents.cpath, lnx, 1)
		         THIS.ADDLISTITEM(TRANSFORM(documents.idocpk), lnx, 2)
		         lnx = lnx + 1
		      ENDSCAN
		   ENDIF
		* Add all the documents for attached leases also
		   lcWellID = wells.cwellid
		   SWSELECT('leasewell')
		   SCAN FOR cwellid == lcWellID
		      m.cLeaseID = cLeaseID
		      swselect('documents')
		      IF tcType = 'Desc'
		         SCAN FOR cDocLink='LI' AND cFK = m.cLeaseID
		            SCATTER MEMVAR
		            THIS.ADDLISTITEM(documents.cdesc, lnx, 1)
		            THIS.ADDLISTITEM(TRANSFORM(documents.idocpk), lnx, 2)
		            lnx = lnx + 1
		         ENDSCAN
		      ELSE
		         SCAN FOR cDocLink='LI' AND cFK = m.cLeaseID
		            SCATTER MEMVAR
		            THIS.ADDLISTITEM(documents.cpath, lnx, 1)
		            THIS.ADDLISTITEM(TRANSFORM(documents.idocpk), lnx, 2)
		            lnx = lnx + 1
		         ENDSCAN
		      ENDIF    
		   ENDSCAN    
		ELSE
		   IF tcType = 'Desc'
		      SCAN FOR cDocLink = 'DI' AND cFK == wells.cwellid
		         SCATTER MEMVAR
		         THIS.ADDLISTITEM(documents.cdesc, lnx, 1)
		         THIS.ADDLISTITEM(TRANSFORM(documents.idocpk), lnx, 2)
		         lnx = lnx + 1
		      ENDSCAN
		   ELSE
		      SCAN FOR cDocLink = 'DI' AND cFK == wells.cwellid
		         SCATTER MEMVAR
		         THIS.ADDLISTITEM(documents.cpath, lnx, 1)
		         THIS.ADDLISTITEM(TRANSFORM(documents.idocpk), lnx, 2)
		         lnx = lnx + 1
		      ENDSCAN
		   ENDIF
		ENDIF
		
		DODEFAULT()
	ENDPROC

	PROCEDURE pageframe.setpage
		LPARAMETERS nPageIx, nDelta, nFlags
		RETURN .t.
	ENDPROC

ENDDEFINE
