*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmexportstmt.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\..\..\3rdparty\vfp2c32\vfp2c32\vfp2c.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor20" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor22" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 761
	Left = -1
	Name = "Dataenvironment"
	Top = -2
	Width = 1016

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "groups", ;
		CursorSource = "groups", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 11, ;
		Name = "Cursor1", ;
		Top = 7, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "sevtax", ;
		CursorSource = "sevtax", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor10", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "susaudit", ;
		CursorSource = "susaudit", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor11", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "sysctl", ;
		CursorSource = "sysctl", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor12", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor13' AS cursor WITH ;
		Alias = "vendor", ;
		CursorSource = "vendor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor13", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor14' AS cursor WITH ;
		Alias = "wellhist", ;
		CursorSource = "wellhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor14", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor15' AS cursor WITH ;
		Alias = "wellinv", ;
		CursorSource = "wellinv", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor15", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor16' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Filter = "lcompressor = .f.", ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor16", ;
		Top = 620, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor17' AS cursor WITH ;
		Alias = "taxcodes", ;
		CursorSource = "taxcodes", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 424, ;
		Name = "Cursor17", ;
		Top = 128, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor18' AS cursor WITH ;
		Alias = "glopt", ;
		CursorSource = "glopt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 428, ;
		Name = "Cursor18", ;
		Top = 505, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor19' AS cursor WITH ;
		Alias = "appurchd", ;
		CursorSource = "appurchd", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor19", ;
		Top = 138, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 149, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor20' AS cursor WITH ;
		Alias = "roundtmp", ;
		CursorSource = "roundtmp", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 427, ;
		Name = "Cursor20", ;
		Top = 253, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor21' AS cursor WITH ;
		Alias = "revcat", ;
		CursorSource = "revcat", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor21", ;
		Top = 622, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor22' AS cursor WITH ;
		Alias = "ownpcts", ;
		CursorSource = "ownpcts", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 414, ;
		Name = "Cursor22", ;
		Top = 9, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "disbhist", ;
		CursorSource = "disbhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 21, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "expense", ;
		CursorSource = "expense", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "expcat", ;
		CursorSource = "expcat", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "options", ;
		BufferModeOverride = 3, ;
		CursorSource = "options", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 429, ;
		Name = "Cursor6", ;
		Top = 379, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "income", ;
		CursorSource = "income", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "programs", ;
		CursorSource = "programs", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor8", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "revsrc", ;
		CursorSource = "revsrc", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 291, ;
		Name = "Cursor9", ;
		Top = 259, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formexportstmts AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="shpRectangle" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChkPrintMin" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ChkPrintDef" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkNoSuspDet" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkChecksOnly" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcommandbuttoncustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cmdcommandbuttoncustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cntgetfile1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkOwners" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Runcombo1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: backtaxwith		&& Process backup and tax withholding
		*m: buildstmt
		*m: calccompress		&& Process Compression/Gathering Charges
		*m: calcexpense		&& Does expense calculations
		*m: calcincome		&& Does income calculations
		*m: calctaxes		&& Does tax calculations
		*m: createpdf		&& Create the PDF file for the report
		*m: deficits_own		&& Process deficits when netting all wells together for an owner.
		*m: deficits_well		&& Process well deficits when not netting wells together.
		*m: flatowner		&& Processes revenue for flat owners.
		*m: getformats
		*m: getprevmins		&& Get previous minimums
		*m: getrange		&& Gets the oil and gas period ranges.
		*m: intonhold		&& Process released interest on holds.
		*m: netbalance		&& Print net balance this period.
		*m: netwelltotalnosplit		&& Prints the well net total line if production periods are not split into their own sections.
		*m: netwelltotalsplit		&& Processes the net well total
		*m: ownerstmt
		*m: prevmins		&& Brings in Previous Minimums
		*m: pulltype		&& Remove owner types not being reported.
		*m: rounding		&& Reports rounding
		*m: stmtnotes		&& Brings in any statement notes.
		*p: cdmbatch		&& DM Batch Code
		*p: cgroup
		*p: cowner1
		*p: cowner2
		*p: cownerid		&& Current Owner we're working with
		*p: cperiod
		*p: cprogcode
		*p: creportnamep
		*p: crunyear
		*p: ctypeint
		*p: ctypeinv
		*p: cwell1
		*p: cwell2
		*p: cwellid
		*p: cyear
		*p: dacctdate
		*p: gastax1
		*p: gastax2
		*p: gastax3
		*p: gastax4
		*p: lallminsreleased
		*p: lbelowminimum
		*p: lcanceled
		*p: lclosed
		*p: lcloserun
		*p: lemailonly		&& Only send statements to owners marked to have email statements.
		*p: lexemptroyalty
		*p: lnetwells		&& .T. = net wells together in this group
		*p: loldversion
		*p: lowneronhold
		*p: lownertaxexempt		&& Owner is tax exempt
		*p: lroyaltyowner		&& Owner is a royalty owner
		*p: lsplitperiods
		*p: nbackupwith		&& Backup Withholding
		*p: nbalance
		*p: ncompress
		*p: ngasamount
		*p: ngasrevenue
		*p: ngastax1
		*p: ngastax2
		*p: ngastax3
		*p: ngastax4
		*p: ngather
		*p: noilamount
		*p: noilrevenue
		*p: noiltax1
		*p: noiltax2
		*p: noiltax3
		*p: noiltax4
		*p: notheramount
		*p: nothtax1
		*p: nothtax2
		*p: nothtax3
		*p: nothtax4
		*p: nownertotal
		*p: nrunno
		*p: ntaxwith		&& Tax Withholding
		*p: ntotalbbl
		*p: ntotalmcf
		*p: ntotalother
		*p: ntotinc		&& Total Income Variable
		*p: ntotnet
		*p: nwellnet
		*p: nwelltot
		*p: nworkint
		*p: odist		&& DistProc object
		*p: oiltax1
		*p: oiltax2
		*p: oiltax3
		*p: oiltax4
		*p: oinvtmp		&& Invtmp object
		*p: ooptions
		*p: othtax1
		*p: othtax2
		*p: othtax3
		*p: othtax4
		*p: owellwork		&& Wellwork object
		*p: ownergroup
		*p: oxfrx
	*</DefinedPropArrayMethod>

	Caption = "Export Owner Statement"
	cowner2 = 
	cownerid = 		&& Current Owner we're working with
	cperiod = 
	creportname = 
	creportnamep = .F.
	cselectcriteria = 
	csortorder = 
	ctitle2 = 
	ctypeint = 
	ctypeinv = 
	cwell1 = 
	cwell2 = 
	cwellid = 
	cyear = 
	dacctdate = {}
	DataSession = 2
	DoCreate = .T.
	Height = 436
	HelpContextID = 217
	loldversion = .F.
	Name = "FormExportStmts"
	oxfrx = .NULL.
	Width = 534
	_memberdata = <VFPData>
		<memberdata name="lquiet" display="lQuiet"/>
		</VFPData>
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 119
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 25
	Swrptcriteriabuttons1.Top = 363
	Swrptcriteriabuttons1.Visible = .F.
	Swrptcriteriabuttons1.ZOrderSet = 2

	ADD OBJECT 'chkChecksOnly' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Include Owners With Checks", ;
		Height = 16, ;
		Left = 55, ;
		lenabled = .T., ;
		Name = "chkChecksOnly", ;
		TabIndex = 12, ;
		Top = 208, ;
		Value = .T., ;
		Width = 158, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkNoSuspDet' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Don't show suspense ", ;
		ControlSource = "", ;
		Height = 16, ;
		Left = 273, ;
		Name = "chkNoSuspDet", ;
		TabIndex = 18, ;
		Top = 209, ;
		Value = .F., ;
		Width = 127, ;
		ZOrderSet = 24
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkOwners' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Choose Selected Owners", ;
		Left = 195, ;
		Name = "chkOwners", ;
		Top = 59, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'ChkPrintDef' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Include Owners in Deficit", ;
		ControlSource = "", ;
		Height = 16, ;
		Left = 272, ;
		Name = "ChkPrintDef", ;
		TabIndex = 15, ;
		Top = 230, ;
		Value = .F., ;
		Width = 139, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'ChkPrintMin' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Include Owners in Legal Suspense", ;
		ControlSource = "", ;
		Height = 16, ;
		Left = 55, ;
		Name = "ChkPrintMin", ;
		TabIndex = 14, ;
		Top = 230, ;
		Value = .F., ;
		Width = 187, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Cmdcommandbuttoncustom1' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Export", ;
		Height = 60, ;
		Left = 144, ;
		Name = "Cmdcommandbuttoncustom1", ;
		Top = 360, ;
		Width = 96
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cmdcommandbuttoncustom2' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Close", ;
		Height = 60, ;
		Left = 264, ;
		Name = "Cmdcommandbuttoncustom2", ;
		Top = 360, ;
		Width = 96
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cntgetfile1' AS cntgetfile WITH ;
		cdefaultextension = , ;
		cextensionlist = , ;
		Height = 24, ;
		Left = 27, ;
		lfullpath = .T., ;
		lmustexist = .T., ;
		lpathonly = .T., ;
		Name = "Cntgetfile1", ;
		TabIndex = 7, ;
		Top = 300, ;
		Width = 479, ;
		cmdPath.Height = 22, ;
		cmdPath.Left = 450, ;
		cmdPath.Name = "cmdPath", ;
		cmdPath.Top = 0, ;
		cmdPath.Width = 23, ;
		edtPath.Height = 23, ;
		edtPath.Left = 0, ;
		edtPath.Name = "edtPath", ;
		edtPath.SelectOnEntry = .T., ;
		edtPath.Top = 0, ;
		edtPath.Width = 443
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="container" />

	ADD OBJECT 'Label1' AS label WITH ;
		AutoSize = .T., ;
		Caption = "What To Include", ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 50, ;
		Name = "Label1", ;
		TabIndex = 26, ;
		Top = 187, ;
		Width = 90, ;
		ZOrderSet = 23
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'LblBegID' AS lbllabelcustom WITH ;
		Caption = "First Owner:", ;
		Height = 16, ;
		Left = 107, ;
		Name = "LblBegID", ;
		TabIndex = 8, ;
		Top = 90, ;
		Width = 63, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblEndID' AS lbllabelcustom WITH ;
		Caption = "Last Owner:", ;
		Height = 16, ;
		Left = 107, ;
		Name = "LblEndID", ;
		TabIndex = 9, ;
		Top = 141, ;
		Width = 63, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Run No", ;
		Left = 107, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 2, ;
		Top = 28, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "Export Location", ;
		FontBold = .T., ;
		Left = 28, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 6, ;
		Top = 285
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Caption = "All Owners Selected", ;
		ForeColor = 0,0,255, ;
		Left = 216, ;
		Name = "lblSelected", ;
		Top = 125, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Runcombo1' AS runcombo WITH ;
		cshowwhat = R, ;
		Height = 20, ;
		Left = 154, ;
		lshownew = .F., ;
		Name = "Runcombo1", ;
		TabIndex = 1, ;
		Top = 26, ;
		Width = 257, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'shpRectangle' AS shape WITH ;
		Height = 70, ;
		Left = 45, ;
		Name = "shpRectangle", ;
		Top = 194, ;
		Width = 445, ;
		ZOrderSet = 1
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 195, ;
		Name = "Swrptlook1", ;
		TabIndex = 7, ;
		Top = 87, ;
		ZOrderSet = 4, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = investor.cownerid, ;
		txtBegID.clistworkarea = investor, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = investor.cownerid, ;
		txtEndID.clistworkarea = investor, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />
	
	PROCEDURE backtaxwith		&& Process backup and tax withholding
	ENDPROC

	PROCEDURE builddata
		return (this.ownerstmt())
	ENDPROC

	PROCEDURE buildstmt
	ENDPROC

	PROCEDURE calccompress		&& Process Compression/Gathering Charges
	ENDPROC

	PROCEDURE calcexpense		&& Does expense calculations
	ENDPROC

	PROCEDURE calcincome		&& Does income calculations
	ENDPROC

	PROCEDURE calctaxes		&& Does tax calculations
	ENDPROC

	PROCEDURE createpdf		&& Create the PDF file for the report
		LPARAMETERS lcOutputFile
		PRIV lcTitle1, lcTitle2, lcSortOrder, lcSelect
		LOCAL lcQuery, lcPath, lcOutputFile, lcOutputType, llResult, oXFRX, llSilent
		LOCAL lcSelect, lcSortOrder, lcTitle1, lcTitle2, llShowFile, loError
		*:Global cGrpName, cProcessor, cProducer, glGrpName, pState, pZip, paddr1, paddr2, paddr3, pcity
		*:Global pcontact, pphone, ptax
		
		TRY
		   lcTitle1     = THISFORM.cTitle1
		   lcTitle2     = THISFORM.cTitle2
		   lcSortOrder  = THISFORM.cSortOrder
		   lcSelect     = ''
		   llShowFile   = .F.
		   lcOutputType = UPPER(JUSTEXT(lcOutputFile))
		   llResult     = .T.
		   llSilent     = .T.
		
		   IF NOT EMPTY(lcOutputFile)
		
		* Check on the existence of the application object
		* if it doesn't exist, we're running in development
		* mode and need to initialize the company address info.
		      IF TYPE('m.goApp') = 'O'
		         m.cProducer = m.goApp.ccompanyname
		         m.paddr1    = m.goApp.cAddress1
		         m.paddr2    = m.goApp.cAddress2
		         m.paddr3    = m.goApp.cAddress3
		         m.pcontact  = m.goApp.cContact
		         m.pphone    = m.goApp.cPhoneNo
		      ELSE
		         m.cProducer = 'SherWare, Inc.'
		         m.paddr1    = 'PO Box 223'
		         m.paddr2    = 'Wooster, OH  44691'
		         m.paddr3    = ''
		         m.ptax      = '99-9999999'
		         m.pcontact  = 'Phil Sherwood'
		         m.pphone    = '3302623115'
		         m.pcity     = 'Wooster'
		         m.pState    = 'OH'
		         m.pZip      = '44691'
		      ENDIF
		
		      IF TYPE('m.goApp') = 'O'
		         m.cProducer = m.goApp.ccompanyname
		         IF m.goApp.lDemo
		            m.cProducer = 'Demo Version of Software'
		            m.cGrpName  = m.cProducer
		         ENDIF
		      ELSE
		         m.cProducer = 'Development Company, Inc.'
		      ENDIF
		
		      IF TYPE('m.cProcessor') <> 'C'
		         m.cProcessor = ''
		      ENDIF
		
		      glGrpName = .F.
		
		      oXFRX = THISFORM.oXFRX
		
		      IF oXFRX.SetupXFRX()
		
		* Select the passed cursor before running the report
		         TRY
		            SELECT statemnt
		         CATCH
		         ENDTRY
		
		
		         oXFRX.cOutputFile = lcOutputFile
		         oXFRX.cOutputType = lcOutputType
		         oXFRX.cTitle1     = THIS.cTitle1
		         oXFRX.cTitle2     = THIS.cTitle2
		         oXFRX.cReportName = THIS.cReportName
		
		         llResult = oXFRX.CallXFRX(llSilent)
		
		      ELSE
		         llResult = .F.
		      ENDIF
		   ELSE
		      llResult = .F.
		   ENDIF
		
		CATCH TO loError
		   llResult = .F.
		   DO errorlog WITH 'CreatePDF', loError.LINENO, 'Owner Statement', loError.ERRORNO, loError.MESSAGE
		   MESSAGEBOX('Unable to process the report at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		        'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		*   THISFORM.lQuiet = .T.
		ENDTRY
		
		RETURN (llResult)
		
		
		 
	ENDPROC

	PROCEDURE deficits_own		&& Process deficits when netting all wells together for an owner.
	ENDPROC

	PROCEDURE deficits_well		&& Process well deficits when not netting wells together.
	ENDPROC

	PROCEDURE Destroy
		thisform.oXFRX = .NULL.
		DODEFAULT()
		
	ENDPROC

	PROCEDURE flatowner		&& Processes revenue for flat owners.
	ENDPROC

	PROCEDURE getformats
	ENDPROC

	PROCEDURE getprevmins		&& Get previous minimums
	ENDPROC

	PROCEDURE getrange		&& Gets the oil and gas period ranges.
	ENDPROC

	PROCEDURE Init
		SET SAFETY OFF
		
		DODEFAULT()
		LOCAL llFound
		
		SET CENTURY OFF
		SET MULTILOCKS ON
		
		SELECT investor
		SET ORDER TO cOwnerID
		GO TOP
		
		THISFORM.swrptlook1.txtBegName.VALUE = cSortField
		THISFORM.swrptlook1.txtBegID.VALUE   = cOwnerID
		GO BOTTOM
		
		THISFORM.swrptlook1.txtEndName.VALUE = cSortField
		THISFORM.swrptlook1.txtEndID.VALUE   = cOwnerID
		
		THISFORM.cntgetfile1.edtpath.VALUE = specialfolders('CommonDocuments')
		
		IF FILE('nosplit.cfg')
		   THIS.lsplitperiods = .F.
		ELSE
		   THIS.lsplitperiods = .T.
		ENDIF
		
		IF FILE('datafiles\PrintMin.cfg')
		   THISFORM.chkPrintMin.VALUE = .T.
		ENDIF
		IF FILE('datafiles\PrintDef.cfg')
		   THISFORM.chkprintDef.VALUE = .T.
		ENDIF
		
		THISFORM.oXFRX = CREATEOBJECT('swXFRX')
		
		SET ESCAPE ON 
	ENDPROC

	PROCEDURE intonhold		&& Process released interest on holds.
	ENDPROC

	PROCEDURE netbalance		&& Print net balance this period.
	ENDPROC

	PROCEDURE netwelltotalnosplit		&& Prints the well net total line if production periods are not split into their own sections.
	ENDPROC

	PROCEDURE netwelltotalsplit		&& Processes the net well total
	ENDPROC

	PROCEDURE ownerstmt
		LOCAL tcOwner1, tcOwner2, tcYear, tcPeriod, tcWellID1, tcWellID2, ownstmt, lcVersion
		LOCAL llReturn, loError
		LOCAL tcDMBatch, tcGroup, tcOwnerType, tdAcctDate, tlDetail, tlFlatRate, tlIncludeChecks
		LOCAL tlNoProd, tlNoSuspDet, tlPrintDef, tlPrintMin, tlZipCode, tnRunNo
		
		PUBLIC llUser_Canceled
		
		TRY
		
		   llUser_Canceled = .F.
		   tcOwner1        = THISFORM.swrptlook1.txtBegID.VALUE
		   tcOwner2        = THISFORM.swrptlook1.txtEndID.VALUE
		   tcYear          = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 2]
		   tnRunNo         = INT(VAL(THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 3]))
		   tcGroup         = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 4]
		   tdAcctDate      = CTOD(THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 7])
		   tcDMBatch       = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 5]
		   tlSelected      = thisform.chkOwners.value
		   tlFlatRate      = .T.
		   tlIncludeChecks = .T.
		   tlZipCode       = .F.
		   tlDetail        = .F.
		   tlNoSuspDet     = THISFORM.chknoSuspDet.VALUE
		   tlIncSummary    = .F.
		   THISFORM.cgroup = tcGroup
		   lcVersion       = ' '
		
		   IF tnRunNo = 0
		      tdAcctDate = THISFORM.txtAcctDate.VALUE
		      tcGroup    = LEFT(THISFORM.swgroup1.VALUE, 2)
		      tcYear     = ALLT(STR(YEAR(tdAcctDate)))
		   ELSE
		* Check to see what version the run was closed under
		      swselect('sysctl')
		      LOCATE FOR nrunno == tnRunNo AND cRunYear == tcYear AND ctypeclose = 'R'
		      IF FOUND()
		         lcVersion = cVersion
		      ENDIF
		   ENDIF
		
		   swselect('options')
		   GO TOP
		   SCATTER NAME THIS.oOptions
		
		   tlNoProd    = .F.
		   tlPrintMin  = THISFORM.chkprintmin.VALUE
		   tlPrintDef  = THISFORM.chkprintdef.VALUE
		   tcOwnerType = 'ALL'
		
		* If the version is empty we assume it was
		* closed under the old version before we
		* started storing the version #. If so,
		* use the old ownerstmt class.
		   IF EMPTY(lcVersion)  AND tnRunNo <> 0
		      SET CLASSLIB TO CUSTOM\swoldstuff.vcx ADDITIVE
		      ownstmt              = CREATEOBJECT('oldswownerstmt')
		      THISFORM.lOldversion = .T.
		   ELSE
		      SET PROCEDURE TO CUSTOM\swowner.prg ADDITIVE
		      ownstmt                = CREATEOBJECT('swownerstmt')
		      THISFORM.lOldversion   = .F.
		      ownstmt.lIncludeChecks = tlIncludeChecks
		      ownstmt.lEmailOnly     = .F.
		      ownstmt.lDirDeposit    = .T.
		      ownstmt.lNoSuspDet     = tlNoSuspDet
		   ENDIF
		
		* Fill in properties needed by the statement process
		   ownstmt.cOwner1    = tcOwner1
		   ownstmt.cOwner2    = tcOwner2
		   ownstmt.cgroup     = tcGroup
		   ownstmt.dAcctDate  = tdAcctDate
		   ownstmt.cDMBatch   = tcDMBatch
		   ownstmt.cRunYear   = tcYear
		   ownstmt.nrunno     = tnRunNo
		   ownstmt.cOwnerType = tcOwnerType
		   ownstmt.lFlatRate  = tlFlatRate
		   ownstmt.lNoProd    = tlNoProd
		   ownstmt.lPrintMin  = tlPrintMin
		   ownstmt.lPrintDef  = tlPrintDef
		   ownstmt.lZipOrder  = tlZipCode
		   ownstmt.lDetail    = tlDetail
		   IF NOT THISFORM.lOldversion
		      ownstmt.lIncSummary = tlIncSummary
		   ENDIF
		
		   IF ownstmt.MAIN(tlSelected)
		*
		*  Send data through report
		*
		      SELECT statemnt
		      SET ORDER TO invprog
		      IF RECC() = 0
		         llReturn = .F.
		      ELSE
		         llReturn = .T.
		      ENDIF
		   ELSE
		      llReturn = .F.
		   ENDIF
		
		CATCH TO loError
		   llReturn = .F.
		   DO errorlog WITH 'Ownerstmt', loError.LINENO, 'Owner Statements', loError.ERRORNO, loError.MESSAGE
		   MESSAGEBOX('Unable to process the report at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		      'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		ENDTRY
		
		* Reset global cancel flag
		m.goApp.lCanceled = .F.
		
		
		SELECT statemnt
		DELETE FOR EMPTY(ctype) OR INLIST(ctype,'NOT','TOT','NET','PRG','PRS','PPD','RND','BAL','FLT')
		DELETE FOR ninvamt = 0
		REPLACE ninvamt WITH ninvamt *-1 FOR ctype='EXP'
		REPLACE nrevint WITH nworkint FOR ctype='EXP'
		REPLACE ctype WITH ccatcode FOR ctype = 'EXP'
		
		
		CREATE CURSOR temp ;
		   (acctdate   d, ;
		   prodyear   c(4), ;
		   prodprd    c(2), ;
		   well_id    c(10), ;
		   well_name  c(40), ;
		   TYPE       c(5), ;
		   VOLUME     N(12,2), ;
		   price      N(12,4), ;
		   gross      N(12,2), ;
		   deductcode c(4), ;
		   category   c(30), ;
		   int_type   c(1), ;
		   net_amount  N(12,2), ;
		   interest   N(11,7))
		
		SELECT cownerid FROM statemnt INTO CURSOR owners ORDER BY cownerid GROUP BY cownerid
		lncount = 0
		lnowners = 0
		SELECT owners
		SCAN
		   m.cownerid = cownerid
		   SELECT statemnt
		   SCAN FOR cownerid == m.cownerid
		      SCATTER MEMVAR
		
		      m.acctdate = m.dAcctDate
		      m.prodyear = m.cyear
		      m.prodprd = PADL(ALLTRIM(m.cperiod),2,'0')
		      m.well_id = m.cwellid
		      m.well_name = m.cwellname
		      m.type = m.ctype
		      IF m.nunits # 0
		         m.volume = ROUND(m.nunits * (m.nrevint/100),2)
		      ENDIF
		      m.price = m.nprice
		      IF m.ntotal # 0
		         m.gross = ROUND(m.ntotal * (m.nrevint/100),2)
		      ENDIF
		      m.deductcode = m.ccatcode
		      IF NOT EMPTY(m.deductcode)
		         m.volume = 0
		         m.price  = 0
		         m.gross  = 0
		      ENDIF
		      m.category  = m.ccategory
		      m.int_type = m.ctypeinv
		      m.net_amount = m.ninvamt
		      m.interest = m.nrevint
		      INSERT INTO temp FROM MEMVAR
		      lncount = lncount + 1
		   ENDSCAN
		
		   lnowners = lnowners + 1
		
		   SELECT temp
		   lcFilename = 'ostmt_' + ALLTRIM(m.cownerid) + '_' + STRTRAN(DTOC(m.acctdate),'/','-')+'.csv'
		   lcpath = ALLTRIM(THISFORM.cntgetfile1.edtPath.VALUE)
		   COPY TO (lcpath+lcFilename) TYPE CSV
		ENDSCAN
		
		MESSAGEBOX('Exported ' + TRANSFORM(lncount) + ' owner statement records for ' + TRANSFORM(lnowners) + ' owners.',48,'Statement Export')
		RETURN llReturn
		
		
		
		
	ENDPROC

	PROCEDURE prevmins		&& Brings in Previous Minimums
	ENDPROC

	PROCEDURE pulltype		&& Remove owner types not being reported.
	ENDPROC

	PROCEDURE report
		LPARAMETERS cbutton
		LOCAL lcAlias, oPDF, lcTemp, lcYear, lnRunNo, oProgress, lcErrorMsg, llDuplex, llFoundFormat
		LOCAL lcAcctDate, lcBadEmail, lcEmail, lcFile, lcOutputFile, lcSelect, lcSortOrder, lcTitle1
		LOCAL lcTitle2, llPageCnt, llPrintError, llReturn, llStmComp, lnTally, loError, llGetFormats
		*:Global cGrpName, cProcessor, cProducer, glAcctDesc, glChgPrice, glExpSum, glHideComp, glRefID
		*:Global glShowRoy, gnCompress, gnGather, gnMinCheck, oSendMail, tcYear, tnRunNo
		
		PRIVATE pcOwnerID
		
		TRY
		   IF VARTYPE(glgrpname) # 'U'
		      RELEASE glgrpname
		   ENDIF
		   IF VARTYPE(glstminv) # 'U'
		      RELEASE glstminv
		   ENDIF
		   IF VARTYPE(gldirinv) # 'U'
		      RELEASE gldirinv
		   ENDIF
		
		   PUBLIC glgrpname, glstminv, gldirinv
		
		   llDuplex  = THISFORM.chkprintjob.VALUE
		   llSummary = THISFORM.chkIncSummary.VALUE
		
		   IF THISFORM.chkemail.VALUE
		      IF MESSAGEBOX('Do you want to send statements only to owners marked as "Email Statements Only" in their Owner Information?', 36, 'Email Statements') = 6
		         THISFORM.lEmailOnly = .T.
		      ELSE
		         THISFORM.lEmailOnly = .F.
		      ENDIF
		   ENDIF
		
		* Check to see if we have the most current statement formats
		   llGetFormats  = .F.
		   llFoundFormat = .F.
		   lnFiles       = ADIR(laRpts, m.goapp.crptsfolder + 'dmrostmt2as.frx')
		   IF lnFiles = 0
		      llGetFormats = .T.
		   ELSE
		      llFoundFormat = .T.
		   ENDIF
		
		   IF llGetFormats OR NOT llFoundFormat
		      WAIT WINDOW NOWAIT 'Copying in new report formats...'
		      llFormatError = .F.
		      TRY
		         GetOwnerStmts()
		      CATCH
		         llFormatError = .T.
		      ENDTRY
		   ENDIF
		
		* Turn off duplex print job if we're just doing a preview
		   IF m.cbutton = 'S' AND ;
		         THISFORM.swrptcriteriabuttons1.cmdPreview.CAPTION # 'Export'
		      llDuplex = .F.
		   ENDIF
		
		   STORE ' ' TO lcErrorMsg
		
		* Set the temp location for the PDF files
		   lcTemp = ADDBS(FULLPATH(ALLTRIM(m.goapp.cCommonFolder))) + 'TEMP\'
		   IF NOT DIRECTORY(lcTemp)
		      TRY
		         MD (lcTemp)
		      CATCH
		      ENDTRY
		   ENDIF
		
		   lcAlias = ALIAS()
		
		   ON KEY LABEL esc
		
		   IF THIS.lcanceled
		*        RETURN
		   ENDIF
		
		   tcYear  = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 2]
		   tnRunNo = INT(VAL(THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 3]))
		
		   SELECT options
		   GO TOP
		   glgrpname  = lGrpName
		   glstminv   = lStmInv
		   gnMinCheck = nMinCheck
		   glHideComp = lHideComp
		   glShowRoy  = lShowRoy
		   glAcctDesc = lAcctDesc
		   glRefID    = lRefID
		   glExpSum   = lExpSum
		   glChgPrice = lChgPrice
		   gnGather   = nGather
		   gnCompress = nCompress
		   gldirinv   = lDirInv
		   llStmComp  = THISFORM.chkcompressed.VALUE
		
		*  Get the suspense processing flag from group definition
		   SELECT groups
		   SET ORDER TO cGroup
		   IF SEEK(THISFORM.cGroup)
		      THIS.lNetWells = lNetDef
		   ELSE
		      THIS.lNetWells = .T.
		   ENDIF
		
		   SELECT statemnt
		   COUNT FOR lWellPage TO llPageCnt
		
		   IF THISFORM.lOldversion
		      IF NOT llStmComp
		         THISFORM.cReportName  = m.goapp.crptsfolder + 'dmrownstmt1.frx'
		         THISFORM.cReportNameP = m.goapp.crptsfolder + 'dmrownstmt1.frx'
		      ELSE
		         THISFORM.cReportName  = m.goapp.crptsfolder + 'dmrownstmt3.frx'
		         THISFORM.cReportNameP = m.goapp.crptsfolder + 'dmrownstmt3.frx'
		      ENDIF
		   ELSE
		      IF NOT llStmComp
		* Not compressed statements
		         IF NOT THISFORM.chksubtotal.VALUE
		* Not subtotaled by taxcode
		            IF NOT llDuplex
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt1as.frx', 'dmrostmt1a.frx')
		            ELSE
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt1ads.frx', 'dmrostmt1ad.frx')
		            ENDIF
		         ELSE
		* Subtotaled by taxcode
		            IF NOT llDuplex
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt1bs.frx', 'dmrostmt1b.frx')
		            ELSE
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt1bds.frx', 'dmrostmt1bd.frx')
		            ENDIF
		         ENDIF
		      ELSE
		* Compressed Statements
		         IF NOT THISFORM.chksubtotal.VALUE
		* Not subtotaled by taxcode
		            IF NOT llDuplex
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt2as.frx', 'dmrostmt2a.frx')
		            ELSE
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt2ads.frx', 'dmrostmt2ad.frx')
		            ENDIF
		         ELSE
		* Subtotaled by taxcode
		            IF NOT llDuplex
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt2bs.frx', 'dmrostmt2b.frx')
		            ELSE
		               THISFORM.cReportName  = m.goapp.crptsfolder + IIF(llSummary, 'dmrostmt2bds.frx', 'dmrostmt2bd.frx')
		            ENDIF
		         ENDIF
		      ENDIF
		   ENDIF
		
		   THISFORM.cReportNameP = THISFORM.cReportName
		
		
		   IF NOT FILE(THISFORM.cReportName)
		      MESSAGEBOX('The report format for this report is missing from the \Rpts folder.' + CHR(10) + ;
		           'Looking for file: ' + ALLTRIM(THISFORM.cReportName), 16, 'Missing Report Format')
		
		   ELSE
		
		      SWSELECT('options')
		      GO TOP
		      glgrpname = lGrpName
		      IF glgrpname
		         SWSELECT('groups')
		         SET ORDER TO cGroup
		         IF NOT 'NEW RUN' $ UPPER(THISFORM.runcombo1.VALUE)
		            IF SEEK(THISFORM.runcombo1.LISTITEM(THISFORM.runcombo1.LISTITEMID, 4))
		               m.cGrpName = cDesc
		            ELSE
		               m.cGrpName = ''
		            ENDIF
		         ELSE
		            IF SEEK(LEFT(THISFORM.swgroup1.VALUE, 2))
		               m.cGrpName = cDesc
		            ELSE
		               IF LEFT(THISFORM.swgroup1.VALUE, 2) = '**'
		                  m.cGrpName = 'All Companies'
		               ELSE
		                  m.cGrpName = ''
		               ENDIF
		            ENDIF
		         ENDIF
		      ELSE
		         m.cGrpName = ''
		      ENDIF
		
		      SELECT (lcAlias)
		
		      LOCAL lnResult, lcAlias
		      PRIV lcTitle1, lcTitle2, lcSortOrder, lcSelect, glgrpname, m.cGrpName
		
		      glgrpname = THIS.oOptions.lGrpName
		
		*
		*  Check to see if the requirements for calling this method are met.
		*
		      ASSERT TYPE('this.cReportName') = 'C' MESSAGE 'You must set the cReportName property to use this class'
		      ASSERT INLIST(m.cbutton, 'F', 'P', 'S')  MESSAGE 'The parm to the report method must be either "F" or "P"'
		
		      IF TYPE('this.ctitle1') # 'C'
		         THIS.ctitle1 = ''
		      ENDIF
		      IF TYPE('this.ctitle2') # 'C'
		         THIS.ctitle2 = ''
		      ENDIF
		
		      lcAlias = ALIAS()
		
		*
		*  Make the cProducer variable a default value for development purposes
		*
		      IF TYPE('m.goApp') = 'O'
		         m.cProducer  = m.goapp.cCompanyName
		         m.cProcessor = m.goapp.cAgentName
		      ELSE
		         m.cProducer  = 'Development Company, Inc.'
		         m.cProcessor = ''
		      ENDIF
		
		      IF TYPE('m.cProcessor') # 'C'
		         m.cProcessor = ''
		      ENDIF
		
		      lcTitle1    = THISFORM.ctitle1
		      lcTitle2    = THISFORM.ctitle2
		      lcSortOrder = THISFORM.cSortOrder
		      lcSelect    = THISFORM.cSelectCriteria
		
		*
		*  Set defaults for titles and criteria if not in correct format
		*
		      IF TYPE('lcTitle1') # 'C'
		         lcTitle1 = ''
		      ENDIF
		      IF TYPE('lcTitle2') # 'C'
		         lcTitle2 = ''
		      ENDIF
		      IF TYPE('lcSortOrder') # 'C'
		         lcSortOrder = ''
		      ENDIF
		      IF TYPE('lcSelect') # 'C'
		         lcSelect = ''
		      ENDIF
		
		      SELECT (lcAlias)
		
		      lcYear     = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 2]
		      lnRunNo    = INT(VAL(THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 3]))
		      lcAcctDate = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid, 7]
		
		
		*
		*  Process the report format removing tag and tag1 fields
		*
		      TRY
		         USE (THIS.cReportName) IN 0 ALIAS rptfmt
		         SELECT rptfmt
		         LOCATE FOR objtype = 1
		         IF FOUND()
		            REPLACE TAG WITH '', tag2 WITH ''
		         ENDIF
		         USE
		      CATCH
		      ENDTRY
		
		      SELECT (lcAlias)
		
		      llPrintError = .F.
		
		*
		*  Send the report to the proper location based upon the button pressed.
		*
		      DO CASE
		         CASE m.cbutton = 'P'
		            SET REPORTBEHAVIOR 90
		* Not doing it as separate print jobs
		            TRY
		               REPORT FORM (THIS.cReportName) TO PRINTER PROMPT NOCONSOLE NOEJECT
		            CATCH TO loError
		               llPrintError = .T.
		            ENDTRY
		
		            IF llPrintError
		               IF loError.ERRORNO = 1958
		                  MESSAGEBOX('There was an error loading the printer driver. Make sure you have a valid printer selected or setup as your default printer.', 16, 'Windows Printer Driver Error')
		               ELSE
		                  MESSAGEBOX('Error sending the report to the printer.' + CHR(10) + ;
		                       'Error: ' + loError.MESSAGE, 16, 'Report Print Problem')
		               ENDIF
		            ENDIF
		
		         CASE m.cbutton = 'S'
		            IF 'Export' $ THISFORM.swrptcriteriabuttons1.cmdPreview.CAPTION
		               DO FORM exportcsv WITH THISFORM.CAPTION, THISFORM.cReportName, lcAlias, lcTitle1, lcTitle2, lcSortOrder, lcSelect
		            ELSE
		               IF THISFORM.chkemail.VALUE
		                  oProgress = THIS.omessage.progressbarex('Emailing Owner Statements...')
		                  SET REPORTBEHAVIOR 80
		                  lcBadEmail = ''
		                  IF THISFORM.lEmailOnly
		                     SELE statemnt.cownerid, investor.cemail, investor.cownname ;
		                        FROM statemnt ;
		                        JOIN investor ON statemnt.cownerid = investor.cownerid ;
		                        WHERE NOT EMPTY(investor.cemail) ;
		                        AND investor.nStmtType = 3 ;
		                        INTO CURSOR temp ;
		                        ORDER BY statemnt.cownerid GROUP BY statemnt.cownerid
		                  ELSE
		                     SELE statemnt.cownerid, investor.cemail, investor.cownname ;
		                        FROM statemnt ;
		                        JOIN investor ON statemnt.cownerid = investor.cownerid ;
		                        WHERE NOT EMPTY(investor.cemail) ;
		                        INTO CURSOR temp ;
		                        ORDER BY statemnt.cownerid GROUP BY statemnt.cownerid
		                  ENDIF
		                  IF _TALLY > 0
		
		                     IF THISFORM.omessage.CONFIRM('Are you sure you want to email the distribution statements to ' + TRANSFORM(_TALLY) + ' owners?')
		
		                        lnMax = _TALLY
		                        oProgress.setprogressrange(0, lnMax)
		                        lnTally = 1
		
		                        IF THISFORM.omessage.CONFIRM('Do you want to add a personal message to the email(s)?', 'Email Statements')
		                           lcBody = THISFORM.omessage.gettext('Enter the text for the body of the email', 'Email Statements')
		                           IF ISNULL(lcBody)
		                              lcBody = .F.
		                           ENDIF
		                        ELSE
		                           lcBody = .F.
		                        ENDIF
		                        SELECT temp
		                        SCAN
		                           pcOwnerID = cownerid
		                           SELECT statemnt
		                           SET FILT TO cownerid = pcOwnerID
		                           lcEmail = ALLTRIM(temp.cemail)
		                           IF NOT '@' $ lcEmail OR EMPTY(lcEmail)
		                              lcBadEmail = lcBadEmail + temp.cownerid + ' - ' + temp.cownname + CHR(10)
		                              LOOP
		                           ENDIF
		                           oProgress.setprogressmessage('Owner: ' + temp.cownname)
		                           oProgress.updateprogress(lnTally)
		                           lnTally      = lnTally + 1
		                           lcFile       = 'OS' + '_' + ALLTRIM(STRTRAN(temp.cownerid, ',', '')) + '_' + lcYear + '_' + PADL(lnRunNo, 3, '0') + ".pdf"
		                           lcFile       = SWSTRTRAN(lcFile)
		                           lcOutputFile = ADDBS(ALLTRIM(m.goapp.cCommonFolder)) + 'TEMP\' + lcFile
		                           SELECT statemnt
		                           TRY
		                              llReturn = THIS.CreatePDF(lcOutputFile)
		                           CATCH TO loError
		                              MESSAGEBOX('There was an error trying to create a PDF file to email. Error info: ' + CHR(10) + ;
		                                   loError.MESSAGE, 16, 'PDF Printer Error')
		                              SELECT temp
		                              GO BOTT
		                           ENDTRY
		                           STORE .F. TO lcSender, lcMailServer, lcEmailUser, lcEmailPass, lnSMTPPort, llTLS
		                           IF llReturn
		                              llAsync = FILE('datafiles\asyncstmts.txt')
		                              oSendMail  = swEmailReport(lcEmail, ;
		                                   lcAcctDate + ' Owner Distribution Statement', ;
		                                   lcOutputFile, ;
		                                   IIF(lnMax = 1, .T., .F.), ;
		                                   lcBody, ;
		                                   lcSender, ;
		                                   lcMailServer, ;
		                                   lcEmailUser, ;
		                                   lcEmailPass, ;
		                                   lnSMTPPort, ;
		                                   llTLS, ;
		                                   llAsync)
		                              llReturn   = oSendMail.lResult
		                              lcErrorMsg = oSendMail.cErrorMsg
		                              RELEASE oSendMail
		                           ENDIF
		                        ENDSCAN
		                        oProgress.closeprogress()
		                        IF NOT EMPTY(lcBadEmail)
		                           lcBadEmail = 'The following owners had bad or missing email addresses and no email was sent:' + CHR(10) + CHR(10) + lcBadEmail
		                           MESSAGEBOX(lcBadEmail, 48, 'Bad Email Addresses')
		                        ELSE
		                           IF llReturn
		                              MESSAGEBOX('The owner statements were emailed successfully.', 64, 'Email Statements')
		                           ELSE
		                              MESSAGEBOX('There was a problem sending the reports via email. ' + CHR(10) + CHR(10) + ;
		                                   lcErrorMsg, 16, 'Problem Emailing Reports')
		                           ENDIF
		                        ENDIF
		                     ENDIF
		                  ELSE
		                     oProgress.closeprogress()
		                     MESSAGEBOX('There were no owners with valid email addresses. Statements cannot be emailed.', 16, 'Email Statements')
		                  ENDIF
		                  SET REPORTBEHAVIOR 90
		               ELSE
		                  llFile                 = THISFORM.swrptcriteriabuttons1.cmdPreview.CAPTION = 'File'
		                  lcAlias                = "statemnt"
		                  m.goapp.oReport.cAlias = lcAlias
		                  IF NOT USED('compmast')
		                     USE (m.goapp.cCommonFolder + 'compmast') IN 0
		                  ENDIF
		                  SELECT compmast
		                  LOCATE FOR cidcomp = m.goapp.cidcomp
		                  IF FOUND()
		                     m.cProcessor = cProcessor
		                  ELSE
		                     m.cProcessor = ""
		                  ENDIF
		
		                  m.goapp.oReport.cAlias             = lcAlias
		                  m.goapp.oReport.DATASESSIONID      = THISFORM.DATASESSIONID
		                  m.goapp.oReport.cReportName        = THISFORM.cReportName
		                  m.goapp.oReport.ctitle1            = THISFORM.ctitle1
		                  m.goapp.oReport.ctitle2            = THISFORM.ctitle2
		                  m.goapp.oReport.cProcessor         = m.cProcessor
		                  m.goapp.oReport.cSortOrder         = THISFORM.cSortOrder
		                  m.goapp.oReport.cSelectionCriteria = THISFORM.cSelectCriteria
		
		                  IF NOT EMPTY(THISFORM.cFriendlyName)
		                     m.goapp.oReport.cFriendlyName = THISFORM.cFriendlyName
		                  ELSE
		                     m.goapp.oReport.cFriendlyName = THISFORM.CAPTION
		                  ENDIF
		
		                  llReturn = m.goapp.oReport.SendReport(m.cbutton, .F., IIF(NOT EMPTY(m.cGrpName), m.cGrpName, .F.))
		               ENDIF
		            ENDIF
		      ENDCASE
		
		      THISFORM.lEmailOnly = .F.
		   ENDIF
		CATCH TO loError
		   llReturn = .F.
		   DO errorlog WITH 'Report', loError.LINENO, 'Owner Statement', loError.ERRORNO, loError.MESSAGE
		   MESSAGEBOX('Unable to process the report at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		        'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		*   THISFORM.lQuiet = .T.
		ENDTRY
		
		
		
		
		
		
		
		
	ENDPROC

	PROCEDURE rounding		&& Reports rounding
	ENDPROC

	PROCEDURE stmtnotes		&& Brings in any statement notes.
	ENDPROC

	PROCEDURE Unload
		SET CENTURY ON
		on key label esc
		SET ESCAPE OFF 
		DODEFAULT()
	ENDPROC

	PROCEDURE chkNoSuspDet.Click
		LOCAL lnHandle
		
		IF this.Value = .t.
		   IF NOT FILE('datafiles\PrintDD.cfg')
		      lnHandle = FCREATE('datafiles\PrintDD.cfg')
		      FCLOSE(lnHandle)
		   ENDIF
		ELSE
		   IF FILE('datafiles\PrintDD.cfg')
		      ERASE datafiles\PrintDD.cfg
		   ENDIF
		ENDIF 
		
		DODEFAULT()
	ENDPROC

	PROCEDURE chkOwners.Click
		IF this.Value
		   DO FORM commonsource\selected-ids WITH 'OWNER' LINKED 
		   lnCount = RECCOUNT('selected')
		   thisform.lblselected.Caption = TRANSFORM(lnCount) + ' Owners Selected'
		   thisform.lblselected.Visible = .T.
		   thisform.lblbegID.Visible = .F.
		   thisform.lblendID.Visible = .F.
		   thisform.swrptlook1.Visible = .F.
		ELSE
		   thisform.lblselected.Visible = .F.
		   thisform.lblbegID.Visible = .T.
		   thisform.lblendID.Visible = .T.
		   thisform.swrptlook1.Visible = .T.
		ENDIF 
	ENDPROC

	PROCEDURE ChkPrintDef.Click
		LOCAL lnHandle
		
		IF this.Value = .t.
		   IF NOT FILE('datafiles\PrintDef.cfg')
		      lnHandle = FCREATE('datafiles\PrintDef.cfg')
		      FCLOSE(lnHandle)
		   ENDIF
		ELSE
		   IF FILE('datafiles\PrintDef.cfg')
		      ERASE datafiles\PrintDef.cfg
		   ENDIF
		ENDIF 
		
		DODEFAULT()
	ENDPROC

	PROCEDURE ChkPrintMin.Click
		LOCAL lnHandle
		
		IF this.Value = .t.
		   IF NOT FILE('datafiles\PrintMin.cfg')
		      lnHandle = FCREATE('datafiles\PrintMin.cfg')
		      FCLOSE(lnHandle)
		   ENDIF
		ELSE
		   IF FILE('datafiles\PrintMin.cfg')
		      ERASE datafiles\PrintMin.cfg
		   ENDIF
		ENDIF 
		
		DODEFAULT()
	ENDPROC

	PROCEDURE Cmdcommandbuttoncustom1.Click
		thisform.ownerstmt()
	ENDPROC

	PROCEDURE Cmdcommandbuttoncustom2.Click
		thisform.Release()
	ENDPROC

	PROCEDURE Cntgetfile1.cmdPath.Click
		LOCAL cPath
		LOCAL llReturn, loError, llError
		#INCLUDE vfp2c.h
		llReturn = .T.
		
		TRY
		   IF THIS.PARENT.lPathOnly
		      llError = .F.
		      
		      m.cPath = GETDIR(specialfolders('CommonDocuments'),'Select where to store the backup','Backup Location',112)
		
		      IF EMPTY(m.cpath)
		         m.cpath = specialfolders('CommonDocuments')
		      ENDIF   
		   ELSE
		      m.cPath = GETFILE(THIS.PARENT.cExtensionList)
		   ENDIF
		   IF NOT EMPTY(m.cPath)
		      THIS.PARENT.SetValue(m.cPath)
		   ENDIF
		
		   THISFORM.cntgetfile1.edtpath.VALUE = ADDBS(ALLTRIM(THISFORM.cntgetfile1.edtpath.VALUE))
		
		   IF LEN(THISFORM.cntgetfile1.edtpath.VALUE) > 120  &&  Greater than the max, so don't let them choose it.
		      THISFORM.oMessage.Warning('The chosen path contains more than the maximum of 120 characters.  Please choose a different path, or use a relative path to shorten the length.')
		      THISFORM.cntgetfile1.edtpath.SET('value', '')
		   ENDIF
		CATCH TO loError
		   llReturn = .F.
		   DO errorlog WITH 'cmdPath.click', loError.LINENO, 'FileBackup', loError.ERRORNO, loError.MESSAGE, '', loError
		   MESSAGEBOX('Unable to process the backup at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		        'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		ENDTRY
		
		RETURN llReturn
		
		
	ENDPROC

	PROCEDURE Runcombo1.Init
		IF DODEFAULT()
		   this.listitemid = 1
		ENDIF   
	ENDPROC

	PROCEDURE Swrptcriteriabuttons1.cmdPreview.Click
		IF THISFORM.chkPrintJob.VALUE = .T.  &&  If option about creating separate print jobs is marked, tell them it won't affect Previews - BH 10/04/06
		   THISFORM.oMessage.DISPLAY('This option will only affect statements printed using the Print Button instead of Preview, and will send the statements to the default printer.')
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,csortfield'
		
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtbegid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cOwnerID
		   thisform.swrptlook1.txtBegName.value = cSortField
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,csortfield'
		
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtendid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cOwnerID
		   thisform.swrptlook1.txtEndName.value = cSortField
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

ENDDEFINE
