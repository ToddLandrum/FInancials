*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="imdeplpct.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	Left = 2
	Name = "Dataenvironment"
	Top = 323
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "deplset", ;
		CursorSource = "deplset", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "deplset1", ;
		CursorSource = "deplset", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formdeplset AS frmdatamanagerformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="txtCyear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblCyear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNmargpct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblNmargpct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNnonpct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblNnonpct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNnetinclim" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblNnetinclim" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="edtCnotes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblCnotes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkLlimit" UniqueID="" Timestamp="" />

	Caption = "Depletion Percentages"
	clistexpression = deplset.cyear
	cworkarea = deplset
	DoCreate = .T.
	Height = 172
	HelpContextID = 90
	Name = "FormDeplset"
	Width = 408
	cmdatamanager.Name = "cmdatamanager"
	cmdatamanager.TabIndex = 1
	cmlookupmanager.Name = "cmlookupmanager"

	ADD OBJECT 'chkLlimit' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "No Income Limitation", ;
		ControlSource = "deplset.llimit", ;
		Height = 16, ;
		Left = 58, ;
		Name = "chkLlimit", ;
		TabIndex = 3, ;
		Top = 43, ;
		Value = .F., ;
		Width = 115
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'edtCnotes' AS edteditboxcustom WITH ;
		ControlSource = "deplset.cnotes", ;
		Height = 50, ;
		Left = 100, ;
		Name = "edtCnotes", ;
		TabIndex = 12, ;
		Top = 108, ;
		Width = 250
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'lblCnotes' AS lblfieldlabelcustom WITH ;
		Caption = "Notes", ;
		Height = 16, ;
		Left = 54, ;
		Name = "lblCnotes", ;
		TabIndex = 11, ;
		Top = 108, ;
		Width = 30
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblCyear' AS lblfieldlabelcustom WITH ;
		Caption = "Year", ;
		Height = 16, ;
		Left = 58, ;
		Name = "lblCyear", ;
		TabIndex = 6, ;
		Top = 11, ;
		Width = 26
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblNmargpct' AS lblfieldlabelcustom WITH ;
		Caption = "Marginal Pct", ;
		Height = 16, ;
		Left = 24, ;
		Name = "lblNmargpct", ;
		TabIndex = 9, ;
		Top = 78, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblNnetinclim' AS lblfieldlabelcustom WITH ;
		Caption = "Net Income Limit %", ;
		Height = 16, ;
		Left = 187, ;
		Name = "lblNnetinclim", ;
		TabIndex = 5, ;
		Top = 43, ;
		Width = 92
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblNnonpct' AS lblfieldlabelcustom WITH ;
		Caption = "Non-Marginal %", ;
		Height = 16, ;
		Left = 187, ;
		Name = "lblNnonpct", ;
		TabIndex = 10, ;
		Top = 78, ;
		Width = 78
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'txtCyear' AS txttextboxcustom WITH ;
		ControlSource = "deplset.cyear", ;
		Height = 20, ;
		InputMask = "9999", ;
		Left = 100, ;
		MaxLength = 4, ;
		Name = "txtCyear", ;
		TabIndex = 2, ;
		Top = 9, ;
		Width = 39
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNmargpct' AS txttextboxcustom WITH ;
		ControlSource = "deplset.nmargpct", ;
		Height = 20, ;
		InputMask = "99.99", ;
		Left = 100, ;
		Name = "txtNmargpct", ;
		TabIndex = 7, ;
		Top = 76, ;
		Width = 57
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNnetinclim' AS txttextboxcustom WITH ;
		ControlSource = "deplset.nnetinclim", ;
		Height = 20, ;
		InputMask = "999.99", ;
		Left = 293, ;
		Name = "txtNnetinclim", ;
		TabIndex = 4, ;
		Top = 41, ;
		Width = 57
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNnonpct' AS txttextboxcustom WITH ;
		ControlSource = "deplset.nnonpct", ;
		Height = 20, ;
		InputMask = "99.99", ;
		Left = 293, ;
		Name = "txtNnonpct", ;
		TabIndex = 8, ;
		Top = 76, ;
		Width = 57
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE list
		LPARAMETERS cworkarea
		LOCAL lcList, lnRecNo, lnX
		PRIV llOK
		
		llOK = .F.
		
		SELECT Deplset
		lnRecNo = RECNO()
		COUNT FOR NOT DELETED() TO lnX
		IF lnX = 0
		   RETURN
		ELSE
		   GOTO lnRecNo
		ENDIF
		
		IF USED('depltemp')
		   USE IN depltemp
		ENDIF
		IF USED('depltemp1')
		   USE IN depltemp1
		ENDIF
		
		CREATE CURSOR depltemp  ;
		   (cYear     c(4),  ;
		   nNonPct    n(5,2),  ;
		   nMargPct   n(5,2))
		INDEX on cYear TAG cYear
		INDEX on nNonPct TAG nNonPct
		INDEX on nMargPct TAG nMargPct
		
		SELECT cYear, nmargpct, nnonpct, .f. as junk  ;
		   FROM deplset INTO CURSOR depltemp1
		   
		SELECT depltemp
		APPEND FROM DBF('depltemp1')
		
		lcList = 'cyear\Year,nmargpct\Marg %,nnonpct\Non-Marg %'
		
		IF this.flushcontrolbuffer() AND this.beforenav('Deplset')
		   DO FORM ..\custom\picklist WITH 'depltemp', lcList, deplset.cYear, 3, .t., .t.
		ENDIF
		
		IF llOK
		   SELECT deplset
		   LOCATE FOR cYear = depltemp.cYear
		ENDIF
		
		thisform.refresh()
		   
	ENDPROC

	PROCEDURE chkLlimit.Click
		DODEFAULT()
		
		IF THIS.VALUE = .T.
		   THISFORM.txtnNetIncLim.SET('enabled',.F.)
		ELSE
		   THISFORM.txtnNetIncLim.SET('enabled',.T.)
		ENDIF
		
	ENDPROC

	PROCEDURE cmdatamanager.afternav
		LPARAMETERS cworkarea
		
		IF deplset.llimit = .T.
		   THISFORM.txtnNetIncLim.SET('enabled',.F.)
		ELSE
		   THISFORM.txtnNetIncLim.SET('enabled',.T.)
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE cmdatamanager.afternew
		LPARAMETERS cworkarea
		
		thisform.setnextcontrol(thisform.txtcYear)
		
		DODEFAULT(m.cworkarea)
	ENDPROC

	PROCEDURE cmdatamanager.beforeupdate
		LPARAMETERS cworkarealist
		
		SELECT deplset1
		LOCATE FOR cyear = deplset.cyear AND RECNO('deplset1') <> RECNO('deplset')
		IF FOUND()
		   THISFORM.oMessage.Warning('A record for this year already exists.  You cannot save multiple records for the same year.')
		   thisform.txtcYear.set('value','')
		   RETURN .F.
		ENDIF
		
		DODEFAULT(cworkarealist)
		
	ENDPROC

	PROCEDURE txtNmargpct.Valid
		IF THIS.VALUE > 100
		   THISFORM.oMessage.Warning('You cannot enter a percentage greater than 100.00%')
		   RETURN .F.
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE txtNnonpct.Valid
		IF THIS.VALUE > 100
		   THISFORM.oMessage.Warning('You cannot enter a percentage greater than 100.00%')
		   RETURN .F.
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

ENDDEFINE
