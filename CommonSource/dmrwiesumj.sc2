*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrwiesumj.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor10" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 367
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 743

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "groups", ;
		CursorSource = "groups", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 9, ;
		Name = "Cursor1", ;
		Order = "cgroup", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "ownpcts", ;
		CursorSource = "ownpcts", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 547, ;
		Name = "Cursor10", ;
		Top = 167, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Order = "cwellid", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "glopt", ;
		CursorSource = "glopt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "disbhist", ;
		CursorSource = "disbhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 430, ;
		Name = "Cursor4", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "wellhist", ;
		CursorSource = "wellhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 89, ;
		Left = 570, ;
		Name = "Cursor5", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "sysctl", ;
		CursorSource = "sysctl", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor6", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "options", ;
		CursorSource = "options", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor7", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "expcat", ;
		CursorSource = "expcat", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor8", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "aropt", ;
		CursorSource = "aropt", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 430, ;
		Name = "Cursor9", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formdmrwiesumj AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="chklNet" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swyear1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swperiod1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblProdYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swgroup1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblAcctDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblGroup" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Runcombo1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblRunNo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgReportBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblDateRange" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="swdate1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="swdate2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtAcctDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: ctype
		*p: lcustrpt
		*p: odist		&& Distproc object pointer
	*</DefinedPropArrayMethod>

	Caption = "Well JIB Expense Summary"
	DataSession = 2
	DoCreate = .T.
	Height = 515
	HelpContextID = 201
	Name = "FormDmrwiesumJ"
	Width = 523
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 144
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 19
	Swrptcriteriabuttons1.Top = 432

	ADD OBJECT 'chklNet' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Don't Include Directly Paid or Dummy Amounts", ;
		Left = 150, ;
		Name = "chklNet", ;
		TabIndex = 17, ;
		Top = 382, ;
		Value = .T.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'chkSelected' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Choose Selected Wells", ;
		Left = 179, ;
		Name = "chkSelected", ;
		TabIndex = 12, ;
		Top = 248, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'lblAcctDate' AS lbllabelcustom WITH ;
		Caption = "Accounting Date:", ;
		Left = 90, ;
		Name = "lblAcctDate", ;
		TabIndex = 20, ;
		Top = 203, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblBegID' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "First Well:", ;
		Height = 16, ;
		Left = 90, ;
		Name = "lblBegID", ;
		TabIndex = 11, ;
		Top = 277, ;
		Width = 49, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblDateRange' AS lbllabelcustom WITH ;
		Caption = "Date Range:", ;
		Left = 90, ;
		Name = "lblDateRange", ;
		TabIndex = 22, ;
		Top = 122, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndID' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Last Well:", ;
		Height = 16, ;
		Left = 90, ;
		Name = "lblEndID", ;
		TabIndex = 14, ;
		Top = 327, ;
		Width = 49, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblGroup' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Group:", ;
		Height = 16, ;
		Left = 90, ;
		Name = "LblGroup", ;
		TabIndex = 15, ;
		Top = 161, ;
		Visible = .T., ;
		Width = 35, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Report By:", ;
		Left = 90, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 2, ;
		Top = 33
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "-", ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 282, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 5, ;
		Top = 122, ;
		Visible = .F., ;
		Width = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblProdYear' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Period Range:", ;
		Height = 16, ;
		Left = 90, ;
		Name = "LblProdYear", ;
		TabIndex = 16, ;
		Top = 122, ;
		Visible = .F., ;
		Width = 69, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblRunNo' AS lbllabelcustom WITH ;
		Caption = "Run No", ;
		Left = 90, ;
		Name = "lblRunNo", ;
		TabIndex = 18, ;
		Top = 122
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Caption = "All IDs Selected", ;
		ForeColor = 0,0,255, ;
		Left = 178, ;
		Name = "lblSelected", ;
		TabIndex = 21, ;
		Top = 313, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgReportBy' AS opgoptiongroupcustom WITH ;
		BorderStyle = 0, ;
		ButtonCount = 3, ;
		Height = 75, ;
		Left = 180, ;
		Name = "opgReportBy", ;
		TabIndex = 1, ;
		Top = 29, ;
		Width = 237, ;
		Option1.Caption = "Run No", ;
		Option1.FontSize = 8, ;
		Option1.Height = 17, ;
		Option1.Left = 1, ;
		Option1.Name = "Option1", ;
		Option1.Top = 3, ;
		Option1.Width = 61, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Production Period ", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 1, ;
		Option2.Name = "Option2", ;
		Option2.Top = 27, ;
		Option2.Width = 105, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "Accounting Date Range", ;
		Option3.FontSize = 8, ;
		Option3.Height = 16, ;
		Option3.Left = 1, ;
		Option3.Name = "Option3", ;
		Option3.Top = 51, ;
		Option3.Width = 132
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Runcombo1' AS runcombo WITH ;
		cshowwhat = J, ;
		Height = 20, ;
		Left = 180, ;
		Name = "Runcombo1", ;
		TabIndex = 3, ;
		Top = 120, ;
		Width = 257
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'swdate1' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 180, ;
		Name = "swdate1", ;
		TabIndex = 7, ;
		Top = 120, ;
		Visible = .F., ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'swdate2' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 297, ;
		Name = "swdate2", ;
		TabIndex = 8, ;
		Top = 120, ;
		Visible = .F., ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swgroup1' AS swgroup WITH ;
		Left = 180, ;
		lexcludeall = .T., ;
		Name = "Swgroup1", ;
		TabIndex = 9, ;
		Top = 159, ;
		Visible = .T., ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Swperiod1' AS swperiod WITH ;
		Left = 231, ;
		Name = "Swperiod1", ;
		TabIndex = 6, ;
		Top = 120, ;
		Visible = .F., ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 180, ;
		Name = "Swrptlook1", ;
		TabIndex = 13, ;
		Top = 274, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = wells.cwellid, ;
		txtBegID.clistworkarea = wells, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = wells.cwellid, ;
		txtEndID.clistworkarea = wells, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'Swyear1' AS swyear WITH ;
		Left = 180, ;
		Name = "Swyear1", ;
		TabIndex = 4, ;
		Top = 120, ;
		Visible = .F., ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtAcctDate' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 180, ;
		Name = "txtAcctDate", ;
		TabIndex = 10, ;
		Top = 202, ;
		Visible = .T., ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL m.ntotale, m.ntotali
		LOCAL m.ntotals, m.ntotaln, m.ntotalf, llDirRoy, llDirWork, llNetRpt
		
		WAIT WIND NOWAIT 'Processing Report Request...Please Wait'
		
		tcWellID1  = THISFORM.swrptlook1.txtBegID.VALUE
		tcWellID2  = THISFORM.swrptlook1.txtEndID.VALUE
		llSelected = thisform.chkselected.Value 
		
		IF NOT llSelected
		   SELECT cwellid as cid FROM wells WHERE BETWEEN(cwellid,tcWellID1,tcWellID2) INTO CURSOR selected ORDER BY cid
		ELSE
		   SELECT selected
		   GO top
		   tcWellID1 = cid
		   GO bott
		   tcWellID2 = cid 
		ENDIF 
		
		DO CASE
		   CASE THISFORM.opgreportby.VALUE = 2
		      tcyear       = THISFORM.swyear1.VALUE
		      tcperiod     = THISFORM.swperiod1.VALUE
		      tcgroup      = LEFT(THISFORM.swgroup1.VALUE,2)
		      tnrunno      = 0
		      THISFORM.cTitle2  = 'For Period: ' + tcperiod + '/'+ tcyear + ' Group: ' + tcgroup
		      tdDate1      = {01/01/1960}
		      tddate2      = {12/31/2999}
		
		   CASE THISFORM.opgreportby.VALUE = 3
		      tcyear       = '1980'
		      tcperiod     = '01'
		      tcgroup      = LEFT(THISFORM.swgroup1.VALUE,2)
		      tnrunno      = 0
		      tdDate1      = THISFORM.swdate1.VALUE
		      tddate2      = THISFORM.swdate2.VALUE
		      THISFORM.cTitle2  = 'For Date Range: ' + DTOC(tdDate1) + '-' + DTOC(tddate2) + ' Group: ' + tcgroup
		
		   OTHERWISE
		      tcyear       = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid,2]
		      tnrunno      = INT(VAL(THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid,3]))
		      tcgroup      = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid,4]
		      tcdmbatch    = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid,5]
		      tcperiod1    = '01'
		      tcyear1      = tcyear
		      tdDate1      = {01/01/1960}
		      tddate2      = {12/31/2999}
		      IF tnrunno = 0
		         tcgroup = LEFT(THISFORM.swgroup1.VALUE,2)
		      ENDIF
		      THISFORM.cTitle2  = 'For Run: ' + PADL(ALLT(STR(tnRunNo)),3,'0') + '/'+ tcyear + ' Group: ' + tcgroup
		ENDCASE
		
		IF tnrunno  = 0
		   tcgroup  = LEFT(THISFORM.swgroup1.VALUE,2)
		   tdAcctDate = THISFORM.txtacctdate.VALUE
		ELSE
		   tcgroup     = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid,4]
		   tdAcctDate  = CTOD(THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid,7])
		ENDIF
		IF EMPTY(tcyear)
		   tcyear = STR(YEAR(DATE()),4)
		ENDIF
		
		tcdmbatch   = THISFORM.runcombo1.LISTITEM[thisform.runcombo1.listitemid,5]
		llNetRpt   = THISFORM.chklNet.VALUE
		
		IF THISFORM.cType = 'R'
		   THISFORM.cTitle1  = 'Well Revenue/Expense Summary'
		ELSE
		   THISFORM.cTitle1  = 'Well JIB Expense Summary'
		ENDIF
		
		THISFORM.cSelectCriteria = 'Wells: ' + ALLTRIM(tcWellID1) + ' - ' + ALLTRIM(tcWellID2)
		THISFORM.cSortOrder = 'Well ID'
		
		IF llNetRpt
		   THISFORM.cSelectCriteria = ALLT(THISFORM.cSelectCriteria) + ' (No Directly Paid or "Dummy" Amts)'
		ENDIF
		
		*
		*  Call distproc to create the (invtmp) and (wellwork) cursors
		*
		IF THISFORM.cType = 'R'
		   THISFORM.oDist = CREATEOBJECT('distproc',tcWellID1, tcWellID2, ;
		      '01', tcyear, tcgroup, 'W', tdAcctDate, .T.,tnrunno)
		ELSE
		   THISFORM.oDist = CREATEOBJECT('jibproc',tcWellID1, tcWellID2, ;
		      '01', tcyear, tcgroup, 'W', tdAcctDate, .T.,tnrunno)
		ENDIF
		
		CREATE CURSOR wellsum ;
		   (cwellid     C(10), ;
		   cwellname   C(30), ;
		   cType       C(1), ;
		   hdate       d, ;
		   ngrossoil   N(12,2), ;
		   ngrossgas   N(12,2), ;
		   nothinc     N(12,2), ;
		   ntotinc     N(12,2), ;
		   ntotale     N(12,2), ;
		   nexpcl1     N(12,2), ;
		   nexpcl2     N(12,2), ;
		   nexpcl3     N(12,2), ;
		   nexpcl4     N(12,2), ;
		   nexpcl5     N(12,2), ;
		   nexpcla     N(12,2), ;
		   nexpclb     N(12,2), ;
		   ntotexp     N(12,2), ;
		   ntotmcf     N(12,5), ;
		   ntotbbl     N(12,5), ;
		   ntotprod    N(12,5), ;
		   ntotsev     N(12,2), ;
		   ntotbbltx   N(12,2), ;
		   ntotmcftx   N(12,2), ;
		   ntotothtx   N(12,2), ;
		   ntotcomp    N(12,2), ;
		   ntotGath    N(12,2), ;
		   ldiroilpurch l, ;
		   ldirgaspurch l, ;
		   nnet        N(12,2))
		
		DO CASE
		   CASE THISFORM.opgreportby.VALUE = 1
		      IF THISFORM.oDist.MAIN()         
		         IF THISFORM.cType = 'J'
		            IF USED('wellwork')
		               USE IN wellwork
		            ENDIF
		            IF USED('invtmp')
		               USE IN invtmp
		            ENDIF
		            IF USED('jibwell')
		               USE DBF('jibwell') AGAIN IN 0 ALIAS wellwork
		            ELSE
		               RETURN .f.  &&  No jibwell means no records, so bail out
		            ENDIF
		            IF USED('jibowner')
		               USE DBF('jibowner') AGAIN IN 0 ALIAS invtmp
		            ELSE
		               RETURN .f.  &&  No jibowner means no records, so bail out
		            ENDIF
		         ENDIF
		         **-
		         **-  Check the options to see whether to net out
		         **-  direct paid owner's taxes
		         SELECT options
		         GO TOP
		         llDirRoy   = ldirroy
		         llDirWork  = ldirwork
		
		
		         **-
		         **-  Get the totals for the wells being requested.
		         **-
		
		         SELECT wellwork.cwellid, wells.cwellname, SUM(ngrossgas+ngrossoil+ntrpinc+nmiscinc1+nmiscinc2+nothinc) AS ntotinc,   ;
		            wells.ldiroilpurch, wells.ldirgaspurch, 'R' AS cType, ;
		            SUM(ngrossoil) AS ngrossoil, SUM(ngrossgas) AS ngrossgas, SUM(nothinc) AS nothinc,;
		            SUM(ntotale) AS ntotale, ;
		            SUM(nexpcl1) AS nexpcl1, ;
		            SUM(nexpcl2) AS nexpcl2, ;
		            SUM(nexpcl3) AS nexpcl3, ;
		            SUM(nexpcl4) AS nexpcl4, ;
		            SUM(nexpcl5) AS nexpcl5, ;
		            SUM(nexpcla) AS nexpcla, ;
		            SUM(nexpclb) AS nexpclb, ;
		            SUM(ntotmcf) AS ntotmcf, ;
		            SUM(ntotbbl) AS ntotbbl, ;
		            SUM(ntotprod) AS ntotprod, ;
		            SUM(wellwork.ngather) AS ntotGath, ;
		            SUM(wellwork.ncompress) AS ntotcomp, ;
		            SUM(ntotbbltx1+ntotbbltx2+ntotbbltx3+ntotbbltx4+ntotbbltxr+ntotbbltxw) AS ntotbbltx,   ;
		            SUM(ntotmcftx1+ntotmcftx2+ntotmcftx3+ntotmcftx4+ntotmcftxr+ntotmcftxw) AS ntotmcftx,   ;
		            SUM(ntotothtx1+ntotothtx2+ntotothtx3+ntotothtx4) AS ntotothtx   ;
		            FROM wellwork, wells ;
		            WHERE wellwork.cwellid in (select cid from selected) ;
		            AND wellwork.cwellid = wells.cwellid  ;
		            AND INLIST(wells.cwellstat,'A','V','F') ;
		            INTO CURSOR welltmp ;
		            GROUP BY wellwork.cwellid ;
		            ORDER BY wellwork.cwellid
		
		         SELECT wellsum
		         APPEND FROM DBF('welltmp')
		         SELECT welltmp
		         USE
		
		         SELECT wellsum
		         GO TOP
		         SCAN
		            SCATTER MEMVAR
		            m.nadjust   = 0
		            IF llNetRpt
		               *  Report only net amounts.
		               m.ntotinc = m.ntotinc - m.ngrossgas - m.ngrossoil
		                  STORE 0 TO lnNetGas, lnNetOil, lnNetOTax, lnNetGTax, lnNetPTax, m.ntotbbl, m.ntotmcf   
		              
		               m.ntotexp  = swnetexp(m.ntotale, m.cwellid, .T., '0', 'B')
		               m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl1, m.cwellid, .T., '2', 'B')
		               m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl2, m.cwellid, .T., '2', 'B')
		               m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl3, m.cwellid, .T., '3', 'B')
		               m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl4, m.cwellid, .T., '4', 'B')
		               m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl5, m.cwellid, .T., '5', 'B')
		               m.ntotexp  = m.ntotexp + swnetexp(m.nexpcla, m.cwellid, .T., 'A', 'B')
		               m.ntotexp  = m.ntotexp + swnetexp(m.nexpclb, m.cwellid, .T., 'B', 'B')
		
		               IF THISFORM.lCustRpt
		                  m.nnet = m.ntotinc - m.ntotexp - m.ntotGath - m.ntotcomp - m.ntotsev
		               ELSE
		                  m.nnet = m.ntotinc - m.ntotexp - m.ntotGath - m.ntotcomp - m.ntotsev
		               ENDIF
		
		               SELECT wellsum
		               REPL ntotinc WITH m.ntotinc, ;
		                  ngrossgas WITH lnNetGas, ;
		                  ngrossoil WITH lnNetOil, ;
		                  ntotbbltx WITH lnNetOTax, ;
		                  ntotmcftx WITH lnNetGTax, ;
		                  ntotothtx WITH lnNetPTax, ;
		                  ntotbbl   WITH m.ntotbbl, ;
		                  ntotmcf   WITH m.ntotmcf, ;
		                  ntotexp   WITH m.ntotexp, ;
		                  nnet      WITH m.nnet
		            ELSE
		               *  If directly paid owners are exempt from taxes, remove them
		               IF llDirWork OR llDirRoy
		                  m.ntotbbltx = 0
		                  m.ntotmcftx = 0
		               ENDIF
		               m.ntotsev = m.ntotbbltx + m.ntotmcftx + m.ntotothtx
		               m.ntotexp = m.ntotale+m.nexpcl1+m.nexpcl2+m.nexpcl3+m.nexpcl4+m.nexpcl5+m.nexpcla+m.nexpclb
		               SELECT wellsum
		               REPLACE ntotsev WITH m.ntotsev, ;
		                  ntotexp WITH m.ntotexp
		               m.nnet = ntotinc - ntotexp - ntotGath - ntotcomp - ntotsev
		               REPLACE nnet WITH m.nnet
		            ENDIF
		         ENDSCAN
		
		         WAIT CLEAR
		
		         SELECT wellsum
		         IF RECC() > 0
		            RETURN .T.
		         ELSE
		            RETURN .F.
		         ENDIF
		      ELSE
		         WAIT CLEAR
		         RETURN .F.
		      ENDIF
		
		   CASE THISFORM.opgreportby.VALUE = 2
		
		      **-
		      **-  Check the options to see whether to net out
		      **-  direct paid owner's taxes
		      SELECT options
		      GO TOP
		      llDirRoy   = ldirroy
		      llDirWork  = ldirwork
		
		
		      **-
		      **-  Get the totals for the wells being requested.
		      **-
		
		      *
		      *  Fix to show expenses when past periods have an amount
		      *  of zero for the nnetexp.  This field wasn't there when they were
		      *  closed.  12/08/98 pws
		      *
		      SELECT wellhist
		      SCAN FOR hyear = tcyear AND hperiod = tcperiod AND nnetexp = 0
		         m.ntotale = ntotale
		         m.cwellid = cwellid
		         m.nnetexp = swnetexp(m.ntotale, m.cwellid, .T.,'0','N')
		         SELECT wellhist
		         REPLACE nnetexp WITH m.nnetexp
		      ENDSCAN
		
		      SELECT wellhist.cwellid, wells.cwellname, SUM(ngrossgas+ngrossoil+ntrpinc+nmiscinc1+nmiscinc2+nothinc) AS ntotinc,   ;
		         wells.ldiroilpurch, wells.ldirgaspurch, 'R' AS cType, ;
		         SUM(ngrossoil) AS ngrossoil, SUM(ngrossgas) AS ngrossgas, SUM(nothinc) AS nothinc,;
		         SUM(ntotale) AS ntotale, ;
		         SUM(nexpcl1) AS nexpcl1, ;
		         SUM(nexpcl2) AS nexpcl2, ;
		         SUM(nexpcl3) AS nexpcl3, ;
		         SUM(nexpcl4) AS nexpcl4, ;
		         SUM(nexpcl5) AS nexpcl5, ;
		         SUM(nexpcla) AS nexpcla, ;
		         SUM(nexpclb) AS nexpclb, ;
		         SUM(ntotmcf) AS ntotmcf, ;
		         SUM(ntotbbl) AS ntotbbl, ;
		         SUM(ntotprod) AS ntotprod, ;
		         SUM(wellhist.ngather) AS ntotGath, ;
		         SUM(wellhist.ncompress) AS ntotcomp, ;
		         SUM(ntotbbltx1+ntotbbltx2+ntotbbltx3+ntotbbltx4+ntotbbltxr+ntotbbltxw) AS ntotbbltx,   ;
		         SUM(ntotmcftx1+ntotmcftx2+ntotmcftx3+ntotmcftx4+ntotmcftxr+ntotmcftxw) AS ntotmcftx,   ;
		         SUM(ntotothtx1+ntotothtx2+ntotothtx3+ntotothtx4) AS ntotothtx   ;
		         FROM wellhist, wells ;
		         WHERE hyear = tcyear AND hperiod = tcperiod ;
		         AND wellhist.cwellid in (select cid from selected) ;
		         AND wellhist.cwellid = wells.cwellid  ;
		         AND wellhist.cgroup  = tcGroup ;
		         AND INLIST(wells.cwellstat,'A','V','F') ;
		         INTO CURSOR welltmp ;
		         GROUP BY wellhist.cwellid ;
		         ORDER BY wellhist.cwellid
		
		      SELECT wellsum
		      APPEND FROM DBF('welltmp')
		      SELECT welltmp
		      USE
		
		      SELECT wellsum
		      GO TOP
		      SCAN
		         SCATTER MEMVAR
		         m.nadjust   = 0
		         IF llNetRpt
		            *  Report only net amounts.
		            m.ntotinc = m.ntotinc - m.ngrossgas - m.ngrossoil
		            lnNetGas  = 0
		            lnNetOil  = 0
		            m.ntotinc = m.ntotinc + lnNetGas + lnNetOil
		            m.ngrossgas = lnNetGas
		            m.ngrossoil = lnNetOil
		            m.ntotbbl = 0
		            m.ntotmcf = 0
		            *
		            *  If the purchaser withholds the direct paid oil tax, exclude it,
		            *  otherwise show it.
		            *
		            IF m.ldiroilpurch
		               lnNetOTax  = 0
		            ELSE
		               lnNetOTax  = 0
		            ENDIF
		            IF m.ldirgaspurch
		               lnNetGTax  = 0
		            ELSE
		               lnNetGTax  = 0
		            ENDIF
		
		            lnNetPTax  = 0
		            m.ntotsev = lnNetOTax + lnNetGTax + lnNetPTax
		            SELE wellsum
		            REPLACE ntotsev WITH m.ntotsev
		
		            m.ntotexp  = swnetexp(m.ntotale, m.cwellid, .T., '0', 'B')
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl1, m.cwellid, .T., '2', 'B')
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl2, m.cwellid, .T., '2', 'B')
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl3, m.cwellid, .T., '3', 'B')
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl4, m.cwellid, .T., '4', 'B')
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl5, m.cwellid, .T., '5', 'B')
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcla, m.cwellid, .T., 'A', 'B')
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpclb, m.cwellid, .T., 'B', 'B')
		
		            IF THISFORM.lCustRpt
		               m.nnet = m.ntotinc - m.ntotexp - m.ntotGath - m.ntotcomp - m.ntotsev
		            ELSE
		               m.nnet = m.ntotinc - m.ntotexp - m.ntotGath - m.ntotcomp - m.ntotsev
		            ENDIF
		
		            SELECT wellsum
		            REPL ntotinc WITH m.ntotinc, ;
		               ngrossgas WITH lnNetGas, ;
		               ngrossoil WITH lnNetOil, ;
		               ntotbbltx WITH lnNetOTax, ;
		               ntotmcftx WITH lnNetGTax, ;
		               ntotothtx WITH lnNetPTax, ;
		               ntotbbl   WITH m.ntotbbl, ;
		               ntotmcf   WITH m.ntotmcf, ;
		               ntotexp   WITH m.ntotexp, ;
		               nnet      WITH m.nnet
		         ELSE
		            *  If directly paid owners are exempt from taxes, remove them
		            IF llDirWork OR llDirRoy
		               m.ntotbbltx = 0
		               m.ntotmcftx = 0
		            ENDIF
		            m.ntotsev = m.ntotbbltx + m.ntotmcftx + m.ntotothtx
		            m.ntotexp = m.ntotale+m.nexpcl1+m.nexpcl2+m.nexpcl3+m.nexpcl4+m.nexpcl5+m.nexpcla+m.nexpclb
		            SELECT wellsum
		            REPLACE ntotsev WITH m.ntotsev, ;
		               ntotexp WITH m.ntotexp
		            m.nnet = ntotinc - ntotexp - ntotGath - ntotcomp - ntotsev
		            REPLACE nnet WITH m.nnet
		         ENDIF
		      ENDSCAN
		
		      WAIT CLEAR
		
		      SELECT wellsum
		      IF RECC() > 0
		         RETURN .T.
		      ELSE
		         RETURN .F.
		      ENDIF
		
		   CASE THISFORM.opgreportby.VALUE = 3
		
		      **-
		      **-  Check the options to see whether to net out
		      **-  direct paid owner's taxes
		      SELECT options
		      GO TOP
		      llDirRoy   = ldirroy
		      llDirWork  = ldirwork
		
		
		      **-
		      **-  Get the totals for the wells being requested.
		      **-
		
		      *
		      *  Fix to show expenses when past periods have an amount
		      *  of zero for the nnetexp.  This field wasn't there when they were
		      *  closed.  12/08/98 pws
		      *
		      SELECT wellhist
		      SCAN FOR BETWEEN(hdate,tdDate1,tddate2) AND nnetexp = 0
		         m.ntotale = ntotale
		         m.cwellid = cwellid
		         m.nnetexp = swnetexp(m.ntotale, m.cwellid, .T.,'0','N')
		         SELECT wellhist
		         REPLACE nnetexp WITH m.nnetexp
		      ENDSCAN
		
		      SELECT wellhist.cwellid, wells.cwellname, SUM(ngrossgas+ngrossoil+ntrpinc+nmiscinc1+nmiscinc2+nothinc) AS ntotinc,   ;
		         wells.ldiroilpurch, wells.ldirgaspurch, 'R' AS cType, hdate, ;
		         SUM(ngrossoil) AS ngrossoil, SUM(ngrossgas) AS ngrossgas, SUM(nothinc) AS nothinc,;
		         SUM(ntotale) AS ntotale, ;
		         SUM(nexpcl1) AS nexpcl1, ;
		         SUM(nexpcl2) AS nexpcl2, ;
		         SUM(nexpcl3) AS nexpcl3, ;
		         SUM(nexpcl4) AS nexpcl4, ;
		         SUM(nexpcl5) AS nexpcl5, ;
		         SUM(nexpcla) AS nexpcla, ;
		         SUM(nexpclb) AS nexpclb, ;
		         SUM(ntotmcf) AS ntotmcf, ;
		         SUM(ntotbbl) AS ntotbbl, ;
		         SUM(ntotprod) AS ntotprod, ;
		         SUM(wellhist.ngather) AS ntotGath, ;
		         SUM(wellhist.ncompress) AS ntotcomp, ;
		         SUM(ntotbbltx1+ntotbbltx2+ntotbbltx3+ntotbbltx4+ntotbbltxr+ntotbbltxw) AS ntotbbltx,   ;
		         SUM(ntotmcftx1+ntotmcftx2+ntotmcftx3+ntotmcftx4+ntotmcftxr+ntotmcftxw) AS ntotmcftx,   ;
		         SUM(ntotothtx1+ntotothtx2+ntotothtx3+ntotothtx4) AS ntotothtx   ;
		         FROM wellhist, wells ;
		         WHERE BETWEEN(wellhist.hdate,tdDate1,tddate2) ;
		         AND wellhist.cwellid in (select cid from selected) ;
		         AND wellhist.cwellid = wells.cwellid  ;
		         AND INLIST(wells.cwellstat,'A','V','F') ;
		         INTO CURSOR welltmp ;
		         GROUP BY wellhist.cwellid ;
		         ORDER BY wellhist.cwellid
		
		      SELECT wellsum
		      APPEND FROM DBF('welltmp')
		      SELECT welltmp
		      USE
		
		      SELECT wellsum
		      GO TOP
		      SCAN
		         SCATTER MEMVAR
		         m.nadjust   = 0
		         IF llNetRpt
		            *  Report only net amounts.
		            m.ntotinc = m.ntotinc - m.ngrossgas - m.ngrossoil - m.nothinc
		            lnNetGas  = 0
		            lnNetOil  = 0
		            lnNetOth  = 0
		            m.ntotinc = m.ntotinc + lnNetGas + lnNetOil + lnNetOth
		            m.ngrossgas = lnNetGas
		            m.ngrossoil = lnNetOil
		            m.ntotbbl = 0
		            m.ntotmcf = 0
		            *
		            *  If the purchaser withholds the direct paid oil tax, exclude it,
		            *  otherwise show it.
		            *
		            IF m.ldiroilpurch
		               lnNetOTax  = 0
		            ELSE
		               lnNetOTax  = 0
		            ENDIF
		            IF m.ldirgaspurch
		               lnNetGTax  = 0
		            ELSE
		               lnNetGTax  = 0
		            ENDIF
		
		            lnNetPTax  = 0
		            m.ntotsev = lnNetOTax + lnNetGTax + lnNetPTax
		            SELE wellsum
		            REPLACE ntotsev WITH m.ntotsev
		
		            m.ntotexp  = swnetexp(m.ntotale, m.cwellid, .T., '0', 'B',.T.)
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl1, m.cwellid, .T., '2', 'B',.T.)
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl2, m.cwellid, .T., '2', 'B',.T.)
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl3, m.cwellid, .T., '3', 'B',.T.)
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl4, m.cwellid, .T., '4', 'B',.T.)
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcl5, m.cwellid, .T., '5', 'B',.T.)
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpcla, m.cwellid, .T., 'A', 'B',.T.)
		            m.ntotexp  = m.ntotexp + swnetexp(m.nexpclb, m.cwellid, .T., 'B', 'B',.T.)
		
		            IF THISFORM.lCustRpt
		               m.nnet = m.ntotinc - m.ntotexp - m.ntotGath - m.ntotcomp - m.ntotsev
		            ELSE
		               m.nnet = m.ntotinc - m.ntotexp - m.ntotGath - m.ntotcomp - m.ntotsev
		            ENDIF
		
		            SELECT wellsum
		            REPL ntotinc WITH m.ntotinc, ;
		               ngrossgas WITH lnNetGas, ;
		               ngrossoil WITH lnNetOil, ;
		               nothinc   WITH lnNetOth, ;
		               ntotbbltx WITH lnNetOTax, ;
		               ntotmcftx WITH lnNetGTax, ;
		               ntotothtx WITH lnNetPTax, ;
		               ntotbbl   WITH m.ntotbbl, ;
		               ntotmcf   WITH m.ntotmcf, ;
		               ntotexp   WITH m.ntotexp, ;
		               nnet      WITH m.nnet
		         ELSE
		            *  If directly paid owners are exempt from taxes, remove them
		            IF llDirWork OR llDirRoy
		               m.ntotbbltx = 0
		               m.ntotmcftx = 0
		            ENDIF
		            m.ntotsev = m.ntotbbltx + m.ntotmcftx + m.ntotothtx
		            m.ntotexp = m.ntotale+m.nexpcl1+m.nexpcl2+m.nexpcl3+m.nexpcl4+m.nexpcl5+m.nexpcla+m.nexpclb
		            SELECT wellsum
		            REPLACE ntotsev WITH m.ntotsev, ;
		               ntotexp WITH m.ntotexp
		            m.nnet = ntotinc - ntotexp - ntotGath - ntotcomp - ntotsev
		            REPLACE nnet WITH m.nnet
		         ENDIF
		      ENDSCAN
		
		      WAIT CLEAR
		
		      SELECT wellsum
		      IF RECC() > 0
		         RETURN .T.
		      ELSE
		         RETURN .F.
		      ENDIF
		
		ENDCASE
		
	ENDPROC

	PROCEDURE Init
		LPARA tcType
		
		IF DODEFAULT()
		
		   tcType = 'J'   
		   
		   thisform.cType = tcType
		         
		   SELECT wells
		   SET ORDER TO cwellid
		   GO TOP
		   THISFORM.swrptlook1.txtbegname.VALUE = cwellname
		   THISFORM.swrptlook1.txtbegid.VALUE = cwellid
		   GO BOTTOM
		   THISFORM.swrptlook1.txtendname.VALUE = cwellname
		   THISFORM.swrptlook1.txtendid.VALUE = cwellid
		
		   SELECT wells
		   SET FILTER TO
		
		   IF tcType = 'R'
		      IF FILE(m.goapp.cRptsFolder+'dmrwiecust.frx')
		         thisform.creportname = m.goapp.cRptsFolder+'dmrwiecust.frx'
		         thisform.lCustRpt = .T.
		      else   
		         THISFORM.creportname = 'dmrwiesum'
		      endif
		   ELSE
		      IF FILE(m.goapp.cRptsFolder+'dmrwiecustj.frx')
		         thisform.creportname = m.goapp.cRptsFolder+'dmrwiecustj.frx'
		         thisform.lCustRpt = .T.
		      else   
		         THISFORM.creportname = 'dmrwiesumj'
		      endif
		   ENDIF   
		
		   lddate1 = ctod(allt(str(month(date())))+'/01/'+allt(str(year(date()))))
		   lddate2 = gomonth(lddate1,1) - 1
		   thisform.swdate1.value = lddate1
		   thisform.swdate2.value = lddate2
		   
		   SELECT sysctl
		   SET ORDER TO yrprdkey
		   GO TOP
		   SCAN FOR ldisbman AND ctypeclose = 'R'
		      THISFORM.swyear1.VALUE = cyear
		      THISFORM.swperiod1.VALUE = cperiod
		      IF THISFORM.swgroup1.lexcludeall
		         lnlistcount = THISFORM.swgroup1.LISTCOUNT
		      ELSE
		         lnlistcount = THISFORM.swgroup1.LISTCOUNT + 1
		      ENDIF
		
		      FOR lnx = 1 TO lnlistcount
		         IF LEFT(THISFORM.swgroup1.LISTITEM[lnX],2) = cgroup
		            THISFORM.swgroup1.LISTITEMID = lnx
		            EXIT
		         ENDIF
		      ENDFOR
		      EXIT
		   ENDSCAN
		ENDIF
		
	ENDPROC

	PROCEDURE chkSelected.Click
		IF this.Value
		   DO FORM commonsource\selected-ids WITH 'WELL' LINKED 
		   lnCount = RECCOUNT('selected')
		   thisform.lblselected.Caption = TRANSFORM(lnCount) + ' Wells Selected'
		   thisform.lblselected.Visible = .T.
		   thisform.lblbegID.Visible = .F.
		   thisform.lblendID.Visible = .F.
		   thisform.swrptlook1.Visible = .F.
		ELSE
		   thisform.lblselected.Visible = .F.
		   thisform.lblbegID.Visible = .T.
		   thisform.lblendID.Visible = .T.
		   thisform.swrptlook1.Visible = .T.
		ENDIF 
	ENDPROC

	PROCEDURE opgReportBy.Init
		if dodefault()
		   this.value = 1
		endif   
	ENDPROC

	PROCEDURE opgReportBy.Valid
		DO CASE
		   CASE this.value = 1
		      thisform.lblProdYear.visible  = .f.
		      thisform.swperiod1.visible    = .f.
		      thisform.swyear1.visible      = .f.
		      thisform.lblRunNo.visible     = .t.
		      thisform.runcombo1.visible    = .t.
		      thisform.swdate1.visible      = .f.
		      thisform.swdate2.visible      = .f.
		      thisform.lblDateRange.Visible = .f.
		      thisform.lblacctdate.visible  = .t.
		      thisform.txtacctdate.visible  = .t.
		   CASE this.value = 2
		      thisform.lblProdYear.visible  = .t.
		      thisform.swperiod1.visible    = .t.
		      thisform.swyear1.visible      = .t.
		      thisform.lblRunNo.visible     = .f.
		      thisform.runcombo1.visible    = .f.
		      thisform.swdate1.visible      = .f.
		      thisform.swdate2.visible      = .f.
		      thisform.lblDateRange.Visible = .f.
		      thisform.lblacctdate.visible  = .f.
		      thisform.txtacctdate.visible  = .f.
		   CASE this.value = 3
		      thisform.lblProdYear.visible  = .f.
		      thisform.swperiod1.visible    = .f.
		      thisform.swyear1.visible      = .f.
		      thisform.lblRunNo.visible     = .f.
		      thisform.runcombo1.visible    = .f.
		      thisform.swdate1.visible      = .t.
		      thisform.swdate2.visible      = .t.
		      thisform.lblDateRange.Visible = .t.
		      thisform.lblacctdate.visible  = .f.
		      thisform.txtacctdate.visible  = .f.
		   OTHERWISE   
		      this.value = 1
		      thisform.lblProdYear.visible  = .f.
		      thisform.swperiod1.visible    = .f.
		      thisform.swyear1.visible      = .f.
		      thisform.lblRunNo.visible     = .t.
		      thisform.runcombo1.visible    = .t.
		      thisform.swdate1.visible      = .f.
		      thisform.swdate2.visible      = .f.
		      thisform.lblDateRange.Visible = .f.
		      thisform.lblacctdate.visible  = .t.
		      thisform.txtacctdate.visible  = .t.
		ENDCASE      
		   
	ENDPROC

	PROCEDURE Runcombo1.Init
		IF DODEFAULT()
		   this.listitemid = 1
		ENDIF   
	ENDPROC

	PROCEDURE Runcombo1.Valid
		IF 'New' $ this.value
		   thisform.swgroup1.visible = .t.
		   thisform.lblgroup.visible = .t.
		   thisform.lblacctdate.visible = .t.
		   thisform.txtacctdate.visible = .t.
		ELSE   
		   thisform.swgroup1.visible = .f.
		   thisform.lblgroup.visible = .f.
		   thisform.lblacctdate.visible = .f.
		   thisform.txtacctdate.visible = .f.
		ENDIF   
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtbegid.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cwellid
		   thisform.swrptlook1.txtBegName.value = cwellname
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtendid.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cwellid
		   thisform.swrptlook1.txtEndName.value = cwellname
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

ENDDEFINE
