*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="cschecklist.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 520

ENDDEFINE

DEFINE CLASS formchecklist AS frmmodaldialogcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cntmoverlistpair" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblAvailable" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCancel" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: process
		*p: ccursorname
		*p: ctype
		*p: nselected
	*</DefinedPropArrayMethod>

	Caption = "Select Checks to Re-print"
	ccursorname = 
	ctype = 
	DoCreate = .T.
	Height = 377
	HelpContextID = 254
	Name = "FormCheckList"
	nselected = 0
	Width = 1036
	WindowType = 1
	MWRESIZE1.lblHighLight.Name = "lblHighLight"
	MWRESIZE1.lblShading.Name = "lblShading"
	MWRESIZE1.Name = "MWRESIZE1"

	ADD OBJECT 'cmdCancel' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Cancel", ;
		Height = 36, ;
		Left = 531, ;
		Name = "cmdCancel", ;
		Top = 323, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdOK' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<OK", ;
		Height = 36, ;
		Left = 435, ;
		Name = "cmdOK", ;
		Top = 323, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Cntmoverlistpair' AS cntmoverlistpair WITH ;
		Height = 288, ;
		Left = 12, ;
		Name = "Cntmoverlistpair", ;
		Top = 24, ;
		Width = 1020, ;
		cmdDeselect.Left = 471, ;
		cmdDeselect.Name = "cmdDeselect", ;
		cmdDeselect.Top = 120, ;
		cmdDeselectAll.Left = 471, ;
		cmdDeselectAll.Name = "cmdDeselectAll", ;
		cmdDeselectAll.Top = 147, ;
		cmdSelect.Left = 471, ;
		cmdSelect.Name = "cmdSelect", ;
		cmdSelect.Top = 65, ;
		cmdSelectAll.Left = 471, ;
		cmdSelectAll.Name = "cmdSelectAll", ;
		cmdSelectAll.Top = 93, ;
		lstSelected.FontName = "Courier New", ;
		lstSelected.Height = 288, ;
		lstSelected.Left = 570, ;
		lstSelected.Name = "lstSelected", ;
		lstSelected.Top = 0, ;
		lstSelected.Width = 444, ;
		lstSource.FontName = "Courier New", ;
		lstSource.Height = 288, ;
		lstSource.Left = 0, ;
		lstSource.Name = "lstSource", ;
		lstSource.Top = 0, ;
		lstSource.Width = 444
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="container" />

	ADD OBJECT 'lblAvailable' AS lbllabelcustom WITH ;
		Caption = "lblAvailable", ;
		Left = 12, ;
		Name = "lblAvailable", ;
		Top = 308
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Available", ;
		FontBold = .T., ;
		Left = 12, ;
		Name = "Lbllabelcustom1", ;
		Top = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "Selected", ;
		FontBold = .T., ;
		Left = 588, ;
		Name = "Lbllabelcustom2", ;
		Top = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Alignment = 1, ;
		Caption = "lblSelected", ;
		Left = 948, ;
		Name = "lblSelected", ;
		Top = 308
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />
	
	PROCEDURE Init
		LOCAL ARRAY laAvail[1], laSelected[1]
		
		THIS.cCursorName = 'selected'
		tcCursorName = 'selected'
		
		IF DODEFAULT()
		
		   STORE ' ' TO laAvail, laSelected
		
		   CREATE CURSOR (tcCursorName) ;
		      (cID   C(10), ;
		      dcheckdate d, ;
		      namount    N(12,2), ;
		      cidchec    c(8))
		   INDEX ON cID TAG cID
		
		   WAIT WINDOW NOWAIT 'Building List of Checks....Please Wait'
		
		   SELECT  cID + ' - ' + LEFT(cpayee,20) + ' ' + DTOC(dcheckdate) + ' ' +  TRANSFORM(namount,'999,999,999.99') + '  ' + cidchec  ;
		      FROM checktmp ;
		      INTO ARRAY laAvail ;
		      ORDER BY cID
		
		   THISFORM.lblAvailable.CAPTION    = ALLTRIM(STR(_TALLY)) + ' Checks'
		   THISFORM.lblSelected.CAPTION = '0 Checks Selected'
		   THISFORM.CAPTION = 'Select Checks'
		   THISFORM.cType = 'Checks'
		
		
		   WAIT CLEAR
		
		   THISFORM.cntmoverlistpair.setvalue(@laAvail, @laSelected)
		
		ENDIF
		
		
		
		
		
		
	ENDPROC

	PROCEDURE process
		LOCAL ARRAY laSelected[1]
		LOCAL lnCount, lnX, lcCursorName
		
		laSelected = ' '
		lcCursorName = thisform.cCursorName
		
		thisform.cntmoverlistpair.getvalue(@laSelected)
		
		lnCount = ALEN(laSelected,1)
		
		FOR lnX = 1 TO lnCount  
		    m.cid = LEFT(laSelected[lnx],10)
		    m.cpayee = SUBSTR(laSelected[lnx],14,20)
		    m.dcheckdate = CTOD(SUBSTR(laSelected[lnx],35,10))
		    m.namount  = VAL(STRTRAN(SUBSTR(laselected[lnx],46,14),',',''))
		    m.cidchec = SUBSTR(laSelected[lnX],62,8)
		      
		  IF NOT EMPTY(m.cid)
		     INSERT INTO (lcCursorName) FROM MEMVAR
		  ENDIF   
		ENDFOR
		
		thisform.release()  
		 
	ENDPROC

	PROCEDURE cmdCancel.Click
		thisform.release()
	ENDPROC

	PROCEDURE cmdOK.Click
		thisform.Process()
	ENDPROC

	PROCEDURE Cntmoverlistpair.deselectitem
		LPARAMETERS nindex
		LOCAL lcType
		DODEFAULT(nindex)
		
		thisform.nSelected = thisform.nSelected - 1
		
		IF thisform.nSelected < 0
		   thisform.nSelected = 0
		ENDIF   
		
		lcType = 'Checks'
		thisform.lblSelected.Caption = ALLTRIM(STR(thisform.nSelected)) + ' ' + lcType + ' Selected'
		
	ENDPROC

	PROCEDURE Cntmoverlistpair.selectitem
		LPARAMETERS nindex
		LOCAL lcType
		DODEFAULT(nindex)
		
		thisform.nSelected = thisform.nSelected + 1
		lcType = 'Checks'
		thisform.lblSelected.Caption = ALLTRIM(STR(thisform.nSelected)) + ' ' + lcType + ' Selected'
		
		
	ENDPROC

ENDDEFINE
