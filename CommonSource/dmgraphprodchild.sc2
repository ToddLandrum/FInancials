*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmgraphprodchild.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	Left = 42
	Name = "Dataenvironment"
	Top = 483
	Width = 520

ENDDEFINE

DEFINE CLASS formdmprodgraphchild AS frmformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="graph1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboGraphType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdPrint" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: builddata
		*m: graphit
		*p: cgroup
		*p: ctype
		*p: cwell1
		*p: cwell2
		*p: cyear1
		*p: cyear2
		*p: nsort
		*p: numsets
	*</DefinedPropArrayMethod>

	Caption = "Production Graph"
	cgroup = .F.
	ctype = .F.
	cwell1 = .F.
	cwell2 = .F.
	cyear1 = .F.
	cyear2 = .F.
	DoCreate = .T.
	Height = 509
	HelpContextID = 490
	Name = "FormDmprodgraphchild"
	nsort = .F.
	numsets = .F.
	Width = 840
	WindowType = 1

	ADD OBJECT 'cboGraphType' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 22, ;
		Left = 77, ;
		Name = "cboGraphType", ;
		TabIndex = 2, ;
		Top = 480, ;
		Width = 216
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'cmdOK' AS cmdcommandbuttoncustom WITH ;
		Cancel = .T., ;
		Caption = "\<Close", ;
		Left = 732, ;
		Name = "cmdOK", ;
		TabIndex = 5, ;
		Top = 480
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdPrint' AS cmdcommandbuttoncustom WITH ;
		Caption = "\<Print", ;
		Left = 636, ;
		Name = "cmdPrint", ;
		TabIndex = 4, ;
		Top = 480
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'graph1' AS olecontrol WITH ;
		Height = 468, ;
		Left = 0, ;
		Name = "graph1", ;
		TabIndex = 1, ;
		Top = 0, ;
		Width = 840
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\syswow64\graphdtc.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMA98UEYSsoBAwAAAMACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7gEAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAFcAAAAAAAAAAwAAAP7///8KAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAA/v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8RTzCXqY3REYxIAIDIPsAPAAAFANFWAABfMAAAYAAAAAEAAQEAAAAAEzd+LTF+LTF+LTF+LTF+LTF+LTENMH4wOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAAAAAAAAAEAAIALAAAAR3JhcGhTdHlsZQAJAAAASQoAAAAAAAAACgAAAEdyYXBoVHlwZQAJAAAASQoAAAAGAAAACwAAAFB+MH4wfjB+MH4wAP//AAAAAP//AAIAMgAAAAAAAAIAAQAAAAMwfjADMH4wAzB+MAAAAAAAF0FyaWFsfkFyaWFsfkFyaWFsfkFyaWFsDzIwMH4xNTB+MTAwfjEwMAcwfjB+MH4wLDE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2fjE2AAAAAAAGAAAAAAAMR1JBUEhQUFIuSExQAAAAAAABAAEAAAAAAAAAAABkAAAAAAAAAAAFAAEAAAAAAAAAAAAAAAAAAQAAAAAAADIAAwANR3JhcGggQ29udHJvbAAAAQAAAAAeAAAAAAABDwAAAAgAAGQAAQABAAEAAAAnMH4wfjB+MH4wfjB+MH4wfjB+MH4wfjB+MH4wfjF+MH4wfjB+MH4wAQBkABQAFAAAAAAAAAAAAAAAAAAAAAEAAAMwfjADMH4wAzB+MAMwfjADMH4wAzF+MQAAAAAAAAAAAAAAAQAAAAAAAAAACgAAAAAAAX4AAQAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAYAxUAGAMVAAAAAAAAAAAAcmludFN0eWxlAAkAAABJCgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMA/MAKAAMAAAAAAC4AhUAuAIVAEwC8wAMAAAAOyAlaQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADs2hkAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABALzABcAKQAAAAAAMAIVADACFQAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADcAfMAEAAMAIcAEAD4ARUA+AEVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsA/MABAAMABgAGACYARUAQHgbAAAAAAAAAAAA" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Graph Type", ;
		Left = 12, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 3, ;
		Top = 484
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />
	
	PROCEDURE builddata
		
		tcWell1  = thisform.cwell1
		tcWell2  = thisform.cwell2
		tcGroup  = thisform.cGroup
		tnSort   = thisform.nsort
		tcYear1  = thisform.cyear1
		tcYear2  = thisform.cyear2
		tcType   = thisform.cType
		
		lcSeekG = "m.cwellid + m.cyear+'G'"
		lcSeekO = "m.cwellid + m.cyear+'O'"
		
		WAIT WIND NOWAIT 'Processing Request...Please Wait'
		
		CREATE CURSOR mcftmp ;
		   (cwellid     C(10), ;
		   cwellname   C(30), ;
		   permit1    C(20), ;
		   county     C(25), ;
		   state      C(2), ;
		   cyear      C(4), ;
		   ctype      C(1), ;
		   cgroup     C(2),  ;
		   ntotmcf1   N(12,4), ;
		   ntotmcf2   N(12,4), ;
		   ntotmcf3   N(12,4), ;
		   ntotmcf4   N(12,4), ;
		   ntotmcf5   N(12,4), ;
		   ntotmcf6   N(12,4), ;
		   ntotmcf7   N(12,4), ;
		   ntotmcf8   N(12,4), ;
		   ntotmcf9   N(12,4), ;
		   ntotmcf10  N(12,4), ;
		   ntotmcf11  N(12,4), ;
		   ntotmcf12  N(12,4))
		
		INDEX ON cwellid+cyear+ctype TAG wellyr
		INDEX ON cyear+cwellid+ctype TAG yrwell
		
		IF tnsort = 1      && Production Year
		   SELECT wellhist.cwellid, hyear AS cyear, hperiod, SUM(ntotmcf) AS totmcf, SUM(ntotbbl) AS totbbl, cwellname, wells.cgroup ;
		      FROM wellhist, wells ;
		      WHERE BETWEEN(hyear, tcyear1, tcyear2) ;
		      AND BETWEEN(ALLTRIM(wellhist.cwellid), tcwell1, tcwell2) ;
		      AND IIF(tcgroup='**',.T.,wellhist.cgroup=tcgroup) ;
		      AND wellhist.cwellid == wells.cwellid ;
		      INTO CURSOR temp ;
		      ORDER BY wellhist.cwellid, hyear, hperiod ;
		      GROUP BY wellhist.cwellid, hyear, hperiod
		ELSE  &&  Accounting Year
		   SELECT wellhist.cwellid, YEAR(hdate) AS nYear, MONTH(hdate) AS nPeriod, SUM(ntotmcf) AS totmcf, SUM(ntotbbl) AS totbbl, cwellname, wells.cgroup ;
		      FROM wellhist, wells ;
		      WHERE BETWEEN(YEAR(hdate), VAL(tcyear1), VAL(tcyear2)) ;
		      AND BETWEEN(ALLTRIM(wellhist.cwellid), tcwell1, tcwell2) ;
		      AND IIF(tcgroup='**',.T.,wellhist.cgroup=tcgroup) ;
		      AND wellhist.cwellid == wells.cwellid ;
		      INTO CURSOR temp ;
		      ORDER BY wellhist.cwellid, nYear, nPeriod ;
		      GROUP BY wellhist.cwellid, nYear, nPeriod
		ENDIF
		
		IF _TALLY > 0
		
		   SELECT temp
		   SCAN
		      SCATTER MEMVAR
		      IF tnsort = 2  &&  Accounting Year
		         m.hperiod = PADL(ALLTRIM(STR(m.nPeriod,2)),2,'0')
		         m.cyear   = STR(m.nYear,4)
		      ENDIF
		      IF tcType = 'G'
		         STORE 0 TO m.ntotmcf1, m.ntotmcf2, m.ntotmcf3, m.ntotmcf4, m.ntotmcf5, ;
		            m.ntotmcf6, m.ntotmcf7, m.ntotmcf8, m.ntotmcf9, m.ntotmcf10, ;
		            m.ntotmcf11, m.ntotmcf12
		         DO CASE
		         CASE m.hperiod = '01'
		            m.ntotmcf1  = m.totmcf
		         CASE m.hperiod = '02'
		            m.ntotmcf2  = m.totmcf
		         CASE m.hperiod = '03'
		            m.ntotmcf3  = m.totmcf
		         CASE m.hperiod = '04'
		            m.ntotmcf4  = m.totmcf
		         CASE m.hperiod = '05'
		            m.ntotmcf5  = m.totmcf
		         CASE m.hperiod = '06'
		            m.ntotmcf6  = m.totmcf
		         CASE m.hperiod = '07'
		            m.ntotmcf7  = m.totmcf
		         CASE m.hperiod = '08'
		            m.ntotmcf8  = m.totmcf
		         CASE m.hperiod = '09'
		            m.ntotmcf9  = m.totmcf
		         CASE m.hperiod = '10'
		            m.ntotmcf10 = m.totmcf
		         CASE m.hperiod = '11'
		            m.ntotmcf11 = m.totmcf
		         CASE m.hperiod = '12'
		            m.ntotmcf12  = m.totmcf
		         ENDCASE
		
		         SELECT mcftmp
		         SET ORDER TO wellyr
		         IF NOT SEEK(&lcSeekG)
		            m.ctype = 'G'
		            INSERT INTO mcftmp FROM MEMVAR
		         ELSE
		            DO CASE
		            CASE m.hperiod = '01'
		               REPLACE ntotmcf1  WITH m.totmcf
		            CASE m.hperiod = '02'
		               REPLACE ntotmcf2  WITH m.totmcf
		            CASE m.hperiod = '03'
		               REPLACE ntotmcf3  WITH m.totmcf
		            CASE m.hperiod = '04'
		               REPLACE ntotmcf4  WITH m.totmcf
		            CASE m.hperiod = '05'
		               REPLACE ntotmcf5  WITH m.totmcf
		            CASE m.hperiod = '06'
		               REPLACE ntotmcf6  WITH m.totmcf
		            CASE m.hperiod = '07'
		               REPLACE ntotmcf7  WITH m.totmcf
		            CASE m.hperiod = '08'
		               REPLACE ntotmcf8  WITH m.totmcf
		            CASE m.hperiod = '09'
		               REPLACE ntotmcf9  WITH m.totmcf
		            CASE m.hperiod = '10'
		               REPLACE ntotmcf10 WITH m.totmcf
		            CASE m.hperiod = '11'
		               REPLACE ntotmcf11 WITH m.totmcf
		            CASE m.hperiod = '12'
		               REPLACE ntotmcf12  WITH m.totmcf
		            ENDCASE
		         ENDIF
		      ENDIF
		
		      IF tcType = 'O'
		         STORE 0 TO m.ntotmcf1, m.ntotmcf2, m.ntotmcf3, m.ntotmcf4, m.ntotmcf5, ;
		            m.ntotmcf6, m.ntotmcf7, m.ntotmcf8, m.ntotmcf9, m.ntotmcf10, ;
		            m.ntotmcf11, m.ntotmcf12
		         DO CASE
		         CASE m.hperiod = '01'
		            m.ntotmcf1  = m.totbbl
		         CASE m.hperiod = '02'
		            m.ntotmcf2  = m.totbbl
		         CASE m.hperiod = '03'
		            m.ntotmcf3  = m.totbbl
		         CASE m.hperiod = '04'
		            m.ntotmcf4  = m.totbbl
		         CASE m.hperiod = '05'
		            m.ntotmcf5  = m.totbbl
		         CASE m.hperiod = '06'
		            m.ntotmcf6  = m.totbbl
		         CASE m.hperiod = '07'
		            m.ntotmcf7  = m.totbbl
		         CASE m.hperiod = '08'
		            m.ntotmcf8  = m.totbbl
		         CASE m.hperiod = '09'
		            m.ntotmcf9  = m.totbbl
		         CASE m.hperiod = '10'
		            m.ntotmcf10 = m.totbbl
		         CASE m.hperiod = '11'
		            m.ntotmcf11 = m.totbbl
		         CASE m.hperiod = '12'
		            m.ntotmcf12  = m.totbbl
		         ENDCASE
		
		         SELECT mcftmp
		         SET ORDER TO wellyr
		         IF NOT SEEK(&lcSeekO)
		            m.ctype = 'O'
		            INSERT INTO mcftmp FROM MEMVAR
		         ELSE
		            DO CASE
		            CASE m.hperiod = '01'
		               REPLACE ntotmcf1  WITH m.totbbl
		            CASE m.hperiod = '02'
		               REPLACE ntotmcf2  WITH m.totbbl
		            CASE m.hperiod = '03'
		               REPLACE ntotmcf3  WITH m.totbbl
		            CASE m.hperiod = '04'
		               REPLACE ntotmcf4  WITH m.totbbl
		            CASE m.hperiod = '05'
		               REPLACE ntotmcf5  WITH m.totbbl
		            CASE m.hperiod = '06'
		               REPLACE ntotmcf6  WITH m.totbbl
		            CASE m.hperiod = '07'
		               REPLACE ntotmcf7  WITH m.totbbl
		            CASE m.hperiod = '08'
		               REPLACE ntotmcf8  WITH m.totbbl
		            CASE m.hperiod = '09'
		               REPLACE ntotmcf9  WITH m.totbbl
		            CASE m.hperiod = '10'
		               REPLACE ntotmcf10 WITH m.totbbl
		            CASE m.hperiod = '11'
		               REPLACE ntotmcf11 WITH m.totbbl
		            CASE m.hperiod = '12'
		               REPLACE ntotmcf12  WITH m.totbbl
		            ENDCASE
		         ENDIF
		      ENDIF
		   ENDSCAN
		ENDIF
		
		SELECT mcftmp
		SCAN
		   m.cwellid = cwellid
		   SELECT wells
		   SET ORDER TO cwellid
		   IF SEEK(m.cwellid)
		      m.county = ccounty
		      m.permit1 = cpermit1
		      m.state   = cstate
		   ELSE
		      STORE ' ' TO m.county, m.permit1, m.state
		   ENDIF
		   SELECT mcftmp
		   REPLACE county  WITH m.county, ;
		      state   WITH m.state, ;
		      permit1 WITH m.permit1
		ENDSCAN
		
		SELECT mcftmp
		COUNT FOR NOT DELETED() TO lncount
		IF lncount = 0
		   THISFORM.omessage.warning('There were no records found to graph for this criteria.')
		   RETURN .F.
		ENDIF
		
	ENDPROC

	PROCEDURE Destroy
		ON KEY LABEL ESC
		DODEFAULT()
	ENDPROC

	PROCEDURE graphit
		
		tcType = thisform.cType
		
		LOCAL lnCount, lcVar
		
		SELECT cyear FROM mcftmp INTO CURSOR tempyear ORDER BY cyear GROUP BY cyear
		lnYears = _tally
		
		SELECT cwellid, cwellname FROM mcftmp INTO CURSOR tempwell ORDER BY cwellid GROUP BY cwellid
		lnWells = _tally
		
		IF lnwells > 14
		   MESSAGEBOX('There are too many wells chosen to graph. The limit is 14 wells.',0,'Too many wells to Graph')
		   RETURN .f.
		ENDIF
		   
		thisform.graph1.graphType = INT(VAL(thisform.cboGraphType.Value))
		
		THISFORM.graph1.graphTitle = ALLTRIM(m.goapp.cCompanyName)
		SELECT mcftmp
		   IF tcType = 'G'
		      thisform.graph1.lefttitle  = 'Gas Production (MCF)'
		   ELSE
		      thisform.graph1.lefttitle  = 'Oil Production (BBL)'
		   ENDIF
		
		IF thisform.nsort = 1
		   thisform.graph1.bottomTitle = 'Production Month'
		ELSE
		   thisform.graph1.bottomTitle = 'Accounting Month'
		ENDIF    
		
		THISFORM.graph1.NumSets   = lnWells
		THISFORM.graph1.NumPoints = lnYears * 12
		thisform.graph1.labelEvery = int((lnYears * 12)/6) 
		THISFORM.graph1.AUTOINC    = 1
		thisform.graph1.background = 15
		thisform.Graph1.lineStats  = 0
		
		IF lnwells > 4
		   thisform.graph1.thickLines = 0
		ELSE
		   thisform.graph1.thickLines = 1
		ENDIF 
		   
		thisform.graph1.tickEvery  = 1
		
		lnx = 1
		SELECT tempwell
		SCAN
		   m.cwellid = cwellid
		   THISFORM.graph1.legend(lnx) = ALLTRIM(cwellname)
		   thisform.Graph1.symbolData  = lnx
		   lny = 1
		   SELECT tempyear
		   SCAN
		      m.cyear = cyear
		      SELECT mcftmp
		      SCAN FOR cwellid == m.cwellid AND cyear == m.cyear
		         FOR lnz = 1 TO 12
		            THISFORM.graph1.ThisSet = lnx
		            lcVar = 'ntotmcf' + TRANSFORM(lnz)
		            THISFORM.graph1.DATA(lny) = &lcVar
		            thisform.graph1.label(lny) = cyear+'/'+PADL(TRANSFORM(lnz),2,'0')
		            lny = lny + 1
		         ENDFOR    
		      ENDSCAN   
		   ENDSCAN   
		   lnx = lnx + 1
		ENDSCAN
		
		RETURN .t.
		
	ENDPROC

	PROCEDURE Init
		LPARAMETERS tcwell1,tcwell2,tcgroup,tnsort,tcyear1,tcyear2,tcType
		
		ON KEY LABEL ESC _screen.ActiveForm.release()
		
		thisform.cwell1 = tcwell1
		thisform.cwell2 = tcwell2
		thisform.cgroup = tcgroup
		thisform.nsort  = tnsort
		thisform.cyear1 = tcyear1
		thisform.cyear2 = tcyear2
		thisform.ctype  = tctype
		
		IF thisform.builddata()
		   IF NOT thisform.graphit()
		      thisform.Release()
		      RETURN .f.
		   ENDIF 
		ELSE
		   thisform.Release()
		   RETURN .f.
		ENDIF    
	ENDPROC

	PROCEDURE cboGraphType.Init
		this.AddListItem('Line Graph',1,1)
		this.AddListItem('6',1,2)
		this.AddListItem('Area 2D',2,1)
		this.AddListItem('8',2,2)
		this.AddListItem('Area 3D',3,1)
		this.AddListItem('14',3,2)
		this.AddListItem('Bar 2D',4,1)
		this.AddListItem('3',4,2)
		this.AddListItem('Bar 3D',5,1)
		this.AddListItem('4',5,2)
		this.ListItemId = 1
		DODEFAULT()
	ENDPROC

	PROCEDURE cboGraphType.InteractiveChange
		IF dodefault()
		   thisform.graphit()
		   thisform.graph1.drawmode = 2
		ENDIF    
	ENDPROC

	PROCEDURE cmdOK.Click
		thisform.Release()
	ENDPROC

	PROCEDURE cmdPrint.Click
		thisform.graph1.PrintInfo(11) = 1
		thisform.graph1.PrintInfo(12) = 1
		thisform.graph1.drawMode = 5
	ENDPROC

ENDDEFINE
