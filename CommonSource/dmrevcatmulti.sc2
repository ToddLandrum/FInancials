*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrevcatmulti.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	InitialSelectedAlias = "revcat"
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "coa", ;
		CursorSource = "coa", ;
		Database = x:\convert\wolfepak\loneoak\sahara\datafiles\saharadata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "revcat", ;
		CursorSource = "revcat", ;
		Database = x:\convert\wolfepak\loneoak\sahara\datafiles\saharadata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "revcat1", ;
		CursorSource = "revcat", ;
		Database = x:\convert\wolfepak\loneoak\sahara\datafiles\saharadata\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS dmrevcatmulti AS frmdatamanagerformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Lbltextcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtRevDesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCAcctw" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCreditw" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCAcctDescw" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcRevType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCacctl" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCreditl" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCAcctDescl" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCAccto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCredito" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCAcctDesco" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboDOIClass" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblDOIClass" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: refacctno
	*</DefinedPropArrayMethod>

	Caption = "Revenue Categories"
	clistexpression = revcat.crevtype
	cnavworkarea = revcat
	cworkarea = revcat
	DoCreate = .T.
	Height = 249
	HelpContextID = 363
	Name = "DMRevcatMulti"
	Width = 500
	cmdatamanager.Name = "cmdatamanager"
	cmdatamanager.TabIndex = 2
	cmlookupmanager.Name = "cmlookupmanager"
	Mwresize1.lblHighLight.Name = "lblHighLight"
	Mwresize1.lblShading.Name = "lblShading"
	Mwresize1.Left = 480
	Mwresize1.Name = "Mwresize1"
	Mwresize1.TabIndex = 1
	Mwresize1.Top = 228

	ADD OBJECT 'cboDOIClass' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "revcat.crevclass", ;
		Height = 22, ;
		Left = 312, ;
		Name = "cboDOIClass", ;
		TabIndex = 4, ;
		Top = 11, ;
		Width = 156
		*< END OBJECT: ClassLib="..\..\..\codeminenew\ampro_rv\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'cmdCreditl' AS swlookupbutton WITH ;
		Left = 212, ;
		Name = "cmdCreditl", ;
		TabIndex = 13, ;
		Top = 148
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdCredito' AS swlookupbutton WITH ;
		Left = 212, ;
		Name = "cmdCredito", ;
		TabIndex = 17, ;
		Top = 184
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdCreditw' AS swlookupbutton WITH ;
		Left = 212, ;
		Name = "cmdCreditw", ;
		TabIndex = 9, ;
		Top = 110
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'lblDOIClass' AS lbllabelcustom WITH ;
		Caption = "DOI Class", ;
		Left = 252, ;
		Name = "lblDOIClass", ;
		TabIndex = 20, ;
		Top = 14
		*< END OBJECT: ClassLib="..\..\..\codeminenew\ampro_rv\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom1' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Revenue Type", ;
		FontBold = .T., ;
		Left = 21, ;
		Name = "Lbltextcustom1", ;
		TabIndex = 5, ;
		Top = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom2' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Revenue Description", ;
		FontBold = .T., ;
		Left = 21, ;
		Name = "Lbltextcustom2", ;
		TabIndex = 7, ;
		Top = 48
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom4' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Working Revenue", ;
		FontBold = .T., ;
		Left = 21, ;
		Name = "Lbltextcustom4", ;
		TabIndex = 11, ;
		Top = 112
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom5' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Royalty Revenue", ;
		FontBold = .T., ;
		Left = 21, ;
		Name = "Lbltextcustom5", ;
		TabIndex = 15, ;
		Top = 150
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom6' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Override Revenue", ;
		FontBold = .T., ;
		Left = 21, ;
		Name = "Lbltextcustom6", ;
		TabIndex = 19, ;
		Top = 186
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'txtCAcctDescl' AS txttextboxcustom WITH ;
		BackColor = 212,208,200, ;
		Enabled = .T., ;
		Height = 20, ;
		Left = 236, ;
		lenabled = .T., ;
		lreadonly = .T., ;
		Name = "txtCAcctDescl", ;
		ReadOnly = .T., ;
		TabIndex = 14, ;
		TabStop = .F., ;
		Top = 148, ;
		Width = 231
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCAcctDesco' AS txttextboxcustom WITH ;
		BackColor = 212,208,200, ;
		Enabled = .T., ;
		Height = 20, ;
		Left = 236, ;
		lenabled = .T., ;
		lreadonly = .T., ;
		Name = "txtCAcctDesco", ;
		ReadOnly = .T., ;
		TabIndex = 18, ;
		TabStop = .F., ;
		Top = 184, ;
		Width = 231
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCAcctDescw' AS txttextboxcustom WITH ;
		BackColor = 212,208,200, ;
		Enabled = .T., ;
		Height = 20, ;
		Left = 236, ;
		lenabled = .T., ;
		lreadonly = .T., ;
		Name = "txtCAcctDescw", ;
		ReadOnly = .T., ;
		TabIndex = 10, ;
		TabStop = .F., ;
		Top = 110, ;
		Width = 231
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCacctl' AS txtquickfill WITH ;
		clistexpression = coa.cacctno, ;
		clistworkarea = coa, ;
		ControlSource = "revcat.ccracctnol", ;
		Height = 20, ;
		InputMask = "999999", ;
		Left = 147, ;
		MaxLength = 6, ;
		Name = "txtCacctl", ;
		TabIndex = 12, ;
		Top = 148, ;
		Width = 57
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCAccto' AS txtquickfill WITH ;
		clistexpression = coa.cacctno, ;
		clistworkarea = coa, ;
		ControlSource = "revcat.ccracctnoo", ;
		Height = 20, ;
		InputMask = "999999", ;
		Left = 147, ;
		MaxLength = 6, ;
		Name = "txtCAccto", ;
		TabIndex = 16, ;
		Top = 184, ;
		Width = 57
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCAcctw' AS txtquickfill WITH ;
		clistexpression = coa.cacctno, ;
		clistworkarea = coa, ;
		ControlSource = "revcat.ccracctnow", ;
		Height = 20, ;
		InputMask = "999999", ;
		Left = 147, ;
		MaxLength = 6, ;
		Name = "txtCAcctw", ;
		TabIndex = 8, ;
		Top = 110, ;
		Width = 57
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtcRevType' AS txttextboxcustom WITH ;
		ControlSource = "revcat.crevtype", ;
		Format = "K!", ;
		Height = 20, ;
		InputMask = "XXXXX", ;
		Left = 147, ;
		lrequired = .T., ;
		MaxLength = 5, ;
		Name = "txtcRevType", ;
		TabIndex = 3, ;
		Top = 12, ;
		Width = 45
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtRevDesc' AS txttextboxcustom WITH ;
		ControlSource = "revcat.crevdesc", ;
		Height = 20, ;
		Left = 147, ;
		lrequired = .T., ;
		MaxLength = 20, ;
		Name = "txtRevDesc", ;
		TabIndex = 6, ;
		Top = 46, ;
		Width = 321
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE Activate
		IF DODEFAULT()
		   *THISFORM.refacctno()
		ENDIF
		
	ENDPROC

	PROCEDURE delete
		LPARAMETERS cworkarea
		
		thisform.omessage.warning('Revenue categories cannot be deleted.')
		RETURN .F.
	ENDPROC

	PROCEDURE Init
		**  Scan the current revcat table, and add any missing categories **
		LOCAL lnCount, lnRecNo
		
		SELECT revcat
		SET DELETED OFF
		lnRecNo = RECNO()
		
		COUNT FOR NOT DELETED() TO lnCount
		
		IF lnCount <> 18  &&  Not the maximum that there should be, so check to see what's missing
		   LOCATE FOR cRevType = 'BBL'
		   IF NOT FOUND()
		      m.cRevType = 'BBL'
		      m.cRevDesc = 'Oil Revenue'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF 
		   ENDIF
		
		   LOCATE FOR cRevType = 'MCF'
		   IF NOT FOUND()
		      m.cRevType = 'MCF'
		      m.cRevDesc = 'Gas Revenue'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'TRANS'
		   IF NOT FOUND()
		      m.cRevType = 'TRANS'
		      m.cRevDesc = 'Transp Revenue'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'OTAX1'
		   IF NOT FOUND()
		      m.cRevType = 'OTAX1'
		      m.cRevDesc = 'Oil Tax 1'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'OTAX2'
		   IF NOT FOUND()
		      m.cRevType = 'OTAX2'
		      m.cRevDesc = 'Oil Tax 2'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'OTAX3'
		   IF NOT FOUND()
		      m.cRevType = 'OTAX3'
		      m.cRevDesc = 'Oil Tax 3'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'OTAX4'
		   IF NOT FOUND()
		      m.cRevType = 'OTAX4'
		      m.cRevDesc = 'Oil Tax 4'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'GTAX1'
		   IF NOT FOUND()
		      m.cRevType = 'GTAX1'
		      m.cRevDesc = 'Gas Tax 1'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'GTAX2'
		   IF NOT FOUND()
		      m.cRevType = 'GTAX2'
		      m.cRevDesc = 'Gas Tax 2'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'GTAX3'
		   IF NOT FOUND()
		      m.cRevType = 'GTAX3'
		      m.cRevDesc = 'Gas Tax 3'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'GTAX4'
		   IF NOT FOUND()
		      m.cRevType = 'GTAX4'
		      m.cRevDesc = 'Gas Tax 4'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'PTAX1'
		   IF NOT FOUND()
		      m.cRevType = 'PTAX1'
		      m.cRevDesc = 'Other Product Tax 1'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'PTAX2'
		   IF NOT FOUND()
		      m.cRevType = 'PTAX2'
		      m.cRevDesc = 'Other Product Tax 2'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'PTAX3'
		   IF NOT FOUND()
		      m.cRevType = 'PTAX3'
		      m.cRevDesc = 'Other Product Tax 3'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'PTAX4'
		   IF NOT FOUND()
		      m.cRevType = 'PTAX4'
		      m.cRevDesc = 'Other Product Tax 4'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'MISC1'
		   IF NOT FOUND()
		      m.cRevType = 'Misc1'
		      m.cRevDesc = 'Misc Revenue 1'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'MISC2'
		   IF NOT FOUND()
		      m.cRevType = 'MISC2'
		      m.cRevDesc = 'Misc Revenue 2'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		
		   LOCATE FOR cRevType = 'OTH'
		   IF NOT FOUND()
		      m.cRevType = 'OTH'
		      m.cRevDesc = 'Other Revenue'
		      INSERT INTO revcat FROM MEMVAR
		   ELSE
		      IF DELETED()
		         RECALL
		      ENDIF
		   ENDIF
		   
		 
		   SELECT revcat
		   =TABLEUPDATE()
		ENDIF
		
		SELECT revcat
		GOTO lnRecNo
		
		SET DELETED On	
	ENDPROC

	PROCEDURE list
		LPARAMETERS cworkarea
		LOCAL lcList, lnRecNo
		PRIV llOK
		
		SET SAFETY OFF
		
		IF USED('revtmp')
		   USE IN revtmp
		ENDIF
		IF USED('revtmp1')
		   USE IN revtmp1
		ENDIF
		
		CREATE CURSOR revtmp  ;
		   (crevtype    c(5),  ;
		   crevdesc    c(20))
		INDEX ON crevtype TAG crevtype
		INDEX ON crevdesc TAG crevdesc
		
		llOK = .F.
		lcList = 'crevtype\Type,crevdesc\Revenue Description'
		
		SELECT crevtype,crevdesc FROM revcat INTO CURSOR revtmp1
		
		SELECT revtmp
		APPEND FROM DBF('revtmp1')
		
		IF THIS.flushcontrolbuffer() AND THIS.beforenav('Revcat')
		   DO FORM ..\CUSTOM\picklist WITH 'Revtmp', lcList, THISFORM.txtcrevtype.VALUE, 2,.t.,.t.
		ENDIF
		
		IF llOK
		   SELECT revcat
		   LOCATE FOR crevtype = revtmp.crevtype
		ENDIF
		
		thisform.refacctno()
		
		THISFORM.REFRESH()
		
	ENDPROC

	PROCEDURE refacctno
		SELECT coa
		SET ORDER TO acctno
		
		thisform.refresh()
		
		IF NOT EMPTY(THISFORM.txtcAcctw.VALUE)
		   IF SEEK(THISFORM.txtcAcctw.VALUE)
		      THISFORM.txtcAcctDescw.VALUE = cAcctDesc
		      THISFORM.txtcAcctDescw.Refresh()
		   ELSE
		      THISFORM.txtcAcctDescw.VALUE = ''
		   ENDIF
		ELSE
		   THISFORM.txtcAcctDescw.VALUE = ''
		ENDIF
		
		IF NOT EMPTY(THISFORM.txtcAcctl.VALUE)
		   IF SEEK(THISFORM.txtcAcctl.VALUE)
		      THISFORM.txtcAcctDescl.VALUE = cAcctDesc
		      THISFORM.txtcAcctDescl.Refresh()
		   ELSE
		      THISFORM.txtcAcctDescl.VALUE = ''
		   ENDIF
		ELSE
		   THISFORM.txtcAcctDescl.VALUE = ''
		ENDIF
		
		IF NOT EMPTY(THISFORM.txtcAccto.VALUE)
		   IF SEEK(THISFORM.txtcAccto.VALUE)
		      THISFORM.txtcAcctDesco.VALUE = cAcctDesc
		      THISFORM.txtcAcctDesco.Refresh()
		   ELSE
		      THISFORM.txtcAcctDesco.VALUE = ''
		   ENDIF
		ELSE
		   THISFORM.txtcAcctDesco.VALUE = ''
		ENDIF
	ENDPROC

	PROCEDURE Resize
		*
	ENDPROC

	PROCEDURE cboDOIClass.Init
		this.Requery()
	ENDPROC

	PROCEDURE cboDOIClass.Requery
		IF DODEFAULT()
		   this.AddListItem('Rev Int 1', 1,1)
		   this.AddListItem('1',1,2)
		   this.AddListItem('Rev Int 2', 2,1)
		   this.AddListItem('2',2,2)
		   this.AddListItem('Rev Int 3', 3,1)
		   this.AddListItem('3',3,2)
		   this.AddListItem('Rev Int 4', 4,1)
		   this.AddListItem('4',4,2)
		   this.AddListItem('Rev Int 5', 5,1)
		   this.AddListItem('5',5,2)
		   this.AddListItem('Rev Int 6', 6,1)
		   this.AddListItem('6',6,2)
		   this.AddListItem('Rev Int 7', 7,1)
		   this.AddListItem('7',7,2)
		   this.AddListItem('OTH Int 8', 8,1)
		   this.AddListItem('8',8,2)
		   this.AddListItem('MISC 1', 9,1)
		   this.AddListItem('M1',9,2)
		   this.AddListItem('MISC 2', 10,1)
		   this.AddListItem('M2',10,2)
		   this.AddListItem('TRANS', 11,1)
		   this.AddListItem('T',11,2)
		ENDIF 
	ENDPROC

	PROCEDURE cboDOIClass.Valid
		swselect('revcat1')
		LOCATE FOR crevclass = THIS.VALUE AND crevtype # THISFORM.txtcrevType.VALUE
		IF FOUND()
		   MESSAGEBOX('This DOI Class has already been chosen for revenue type ' + revcat1.crevtype + CHR(13) + CHR(13) + ;
		      'It cannot be used again. Please choose another DOI Class.',16,THISFORM.CAPTION)
		   RETURN 0
		ELSE
		   RETURN DODEFAULT()
		ENDIF
		
	ENDPROC

	PROCEDURE cmdatamanager.afternav
		LPARAMETERS cworkarea
		
		IF INLIST(revcat.crevtype,'BBL','MCF','OTH', ;
		         'MISC1','MISC2','OTAX1','OTAX2', ;
		         'OTAX3','OTAX4','GTAX1','GTAX2','GTAX3',;
		         'GTAX4','PTAX1','PTAX2','PTAX3','PTAX4')
		   thisform.lblDOIClass.Visible = .f.
		   thisform.cboDOIClass.Visible = .f.
		ELSE
		   thisform.lblDOIClass.Visible = .t.
		   thisform.cboDOIClass.Visible = .t.
		ENDIF 
		
		thisform.refacctno()
		
		dodefault(cworkarea)
	ENDPROC

	PROCEDURE cmdCreditl.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cacctno/acctno,cacctdesc/acctdesc'
		
		DO FORM ..\custom\picklist WITH 'Coa', lcList, thisform.txtcacctl.value, 2
		
		IF llOK
		   THISFORM.txtCAcctDescl.VALUE = coa.cacctdesc
		   THISFORM.txtCAcctDescl.REFRESH()
		   thisform.cmdatamanager.replace('Revcat','Ccracctnol',coa.cacctno)
		   THISFORM.txtCAcctl.REFRESH()
		   thisform.setnextcontrol(thisform.txtcacctl)
		ENDIF
		
		
		
	ENDPROC

	PROCEDURE cmdCredito.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cacctno/acctno,cacctdesc/acctdesc'
		
		DO FORM ..\custom\picklist WITH 'Coa', lcList, thisform.txtcaccto.value, 2
		
		IF llOK
		   THISFORM.txtCAcctDesco.VALUE = coa.cacctdesc
		   THISFORM.txtCAcctDesco.REFRESH()
		   thisform.cmdatamanager.replace('Revcat','Ccracctnoo',coa.cacctno)
		   THISFORM.txtCAccto.REFRESH()
		   thisform.setnextcontrol(thisform.txtcaccto)
		ENDIF
		
		
		
	ENDPROC

	PROCEDURE cmdCreditw.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cacctno/acctno,cacctdesc/acctdesc'
		
		DO FORM ..\custom\picklist WITH 'Coa', lcList, thisform.txtcacctw.value, 2
		
		IF llOK
		   THISFORM.txtCAcctDescw.VALUE = coa.cacctdesc
		   THISFORM.txtCAcctDescw.REFRESH()
		   thisform.cmdatamanager.replace('Revcat','Ccracctnow',coa.cacctno)
		   THISFORM.txtCAcctw.REFRESH()
		   thisform.setnextcontrol(thisform.txtcacctw)
		ENDIF
		
		
		
	ENDPROC

	PROCEDURE txtCAcctDescl.When
		RETURN .F.
		
	ENDPROC

	PROCEDURE txtCAcctDesco.When
		RETURN .F.
		
	ENDPROC

	PROCEDURE txtCAcctDescw.When
		RETURN .F.
		
	ENDPROC

	PROCEDURE txtCacctl.GotFocus
		ON KEY LABEL F2 _screen.activeform.cmdCreditl.Click()
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCacctl.InteractiveChange
		IF DODEFAULT()
		   thisform.txtcacctdescl.set('value',coa.cacctdesc)
		endif
	ENDPROC

	PROCEDURE txtCacctl.LostFocus
		ON KEY LABEL F2 *
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCacctl.Valid
		SELECT coa
		SET ORDER TO acctno
		IF SEEK(THIS.VALUE)
		   IF coa.ltitle OR coa.lTotalAcct  &&  Title or total account, so don't let them use it
		      THISFORM.oMessage.Warning('You cannot select a title or totaling account for this option.')
		      THIS.SET('value','')
		      RETURN .F.
		   ENDIF
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE txtCAccto.GotFocus
		ON KEY LABEL F2 _screen.activeform.cmdCredito.Click()
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCAccto.InteractiveChange
		IF DODEFAULT()
		   thisform.txtcacctdesco.set('value',coa.cacctdesc)
		endif
	ENDPROC

	PROCEDURE txtCAccto.LostFocus
		ON KEY LABEL F2 *
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCAccto.Valid
		SELECT coa
		SET ORDER TO acctno
		IF SEEK(THIS.VALUE)
		   IF coa.ltitle OR coa.lTotalAcct  &&  Title or total account, so don't let them use it
		      THISFORM.oMessage.Warning('You cannot select a title or totaling account for this option.')
		      THIS.SET('value','')
		      RETURN .F.
		   ENDIF
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE txtCAcctw.GotFocus
		ON KEY LABEL F2 _screen.activeform.cmdCreditw.Click()
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCAcctw.InteractiveChange
		IF DODEFAULT()
		   thisform.txtcacctdescw.set('value',coa.cacctdesc)
		endif
	ENDPROC

	PROCEDURE txtCAcctw.LostFocus
		ON KEY LABEL F2 *
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCAcctw.Valid
		SELECT coa
		SET ORDER TO acctno
		IF SEEK(THIS.VALUE)
		   IF coa.ltitle OR coa.lTotalAcct  &&  Title or total account, so don't let them use it
		      THISFORM.oMessage.Warning('You cannot select a title or totaling account for this option.')
		      THIS.SET('value','')
		      RETURN .F.
		   ENDIF
		ENDIF
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE txtcRevType.Valid
		* Check for the existence of the entered revtype
		lcRevCat = THIS.VALUE
		
		IF NOT EMPTY(THIS.VALUE) AND lcRevCat <> revcat.crevtype AND THIS.lChanged
		      SET DELETED OFF
		      SELECT revcat1
		      SET ORDER TO crevtype
		      IF SEEK(lcRevCat)
		         IF NOT DELETED()
		            IF THISFORM.omessage.CONFIRM('There is already a revenue category with this revenue type.  Would you like to view the existing record?')
		               THISFORM.cmdatamanager.revertall()
		               SELECT revcat
		               SET ORDER TO crevtype
		               SEEK(lcRevCat)
		               THISFORM.REFRESH()
		               THISFORM.cmdatamanager.afternav('cworkarea')
		            ELSE
		               THIS.VALUE = ''
		               RETURN 0
		            ENDIF
		         ELSE
		            THISFORM.cmdatamanager.revertall()
		            SELECT revcat
		            SET ORDER TO crevtype
		            SEEK(lcRevCat)
		            RECALL
		            REPLACE crevdesc WITH ''
		            REPLACE cdracctno WITH ''
		            REPLACE ccracctno WITH ''
		            THISFORM.REFRESH()
		         ENDIF
		      ENDIF
		      SET DELETED ON
		      SELECT revcat
		ENDIF
		
		SELECT revcat
		
		DODEFAULT()
		
	ENDPROC

ENDDEFINE
