*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="lmlandowner.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 336
	Left = 3
	Name = "Dataenvironment"
	Top = 309
	Width = 721

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "landowner", ;
		BufferModeOverride = 5, ;
		CursorSource = "landowner", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "land", ;
		CursorSource = "land", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 190, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "landowner1", ;
		CursorSource = "landowner", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "landhist", ;
		CursorSource = "landhist", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "land1", ;
		CursorSource = "land", ;
		Database = ..\amdata\appdata.dbc, ;
		Height = 219, ;
		Left = 402, ;
		Name = "Cursor6", ;
		Top = 27, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formlmlandowner AS frmdatamanagerformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="cboStatus" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCleaseid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCownerid" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdLookLease" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcLeaseName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdLookOwner" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcOwnerName" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Shpshapecustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Shpshapecustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Shpshapecustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Shpshapecustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Shpshapecustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Lbllabelcustom3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtNacres" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblNacres" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtNrental" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblNrental" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtPmtDesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblNpmtfreq" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtNtotalpmt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblNtotalpmt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtdStartPmt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtdnextpmt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtdcontstart" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblDstartpmt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Lblfieldlabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblCcontstart" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtdcontend" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblDcontend" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtNpmttodate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtnYearPmt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblNpmttodate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtCrecpage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtcInstrument" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblCrecpage" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtCrecbook" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblCrecbook" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Lbllabelcustom4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtdrecdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.lblDrecdate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtnPmtFreq" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Lblfieldlabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtdExpDate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.txtLeaseYrs" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page1.Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page1.edtRenewal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page2.edtPooling" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page3.edtDepth" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page4.edtShutIn" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page5.edtORRI" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page6.edtFreeGas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page7.edtFreeGas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page8.edtFreeGas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page9.edtFreeGas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.pgfClauses.Page10.edtFreeGas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkContDrill" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkUnitization" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkLandowner" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkAssign" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.ChkFreeGas" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkORRI" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkShutIn" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkDeptRestrict" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkPooling" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page2.chkRenewal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pgfpageframecustom1.Page3.edtNotes" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: calchist
		*m: calcpmt		&& Calculates total payment
		*m: chkclauses
	*</DefinedPropArrayMethod>

	Caption = "Lease Obligations"
	clistexpression = landowner.cownerid
	cworkarea = Landowner
	DoCreate = .T.
	Height = 475
	HelpContextID = 80
	Name = "formlmlandowner"
	Width = 837
	_memberdata = <VFPData>
		<memberdata name="calchist" display="CalcHist"/>
		<memberdata name="chkclauses" display="chkClauses"/>
		</VFPData>
	cmdatamanager.Name = "cmdatamanager"
	cmdatamanager.TabIndex = 1
	cmdatamanager.ZOrderSet = 0
	cmlookupmanager.Name = "cmlookupmanager"
	Mwresize1.lblHighLight.Name = "lblHighLight"
	Mwresize1.lblShading.Name = "lblShading"
	Mwresize1.Name = "Mwresize1"

	ADD OBJECT 'cboStatus' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		ControlSource = "land.cleasestatus", ;
		Height = 20, ;
		Left = 472, ;
		Name = "cboStatus", ;
		TabIndex = 5, ;
		Top = 11, ;
		Width = 176
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'cmdLookLease' AS cmdcommandbuttoncustom WITH ;
		Caption = "Lease", ;
		Height = 20, ;
		Left = 12, ;
		Name = "cmdLookLease", ;
		TabIndex = 2, ;
		TabStop = .F., ;
		Top = 11, ;
		Width = 72, ;
		ZOrderSet = 25
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdLookOwner' AS cmdcommandbuttoncustom WITH ;
		Caption = "Payee", ;
		Height = 20, ;
		Left = 12, ;
		Name = "cmdLookOwner", ;
		TabIndex = 7, ;
		TabStop = .F., ;
		Top = 38, ;
		Width = 72, ;
		ZOrderSet = 27
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Status", ;
		Height = 16, ;
		Left = 435, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 6, ;
		Top = 13, ;
		Width = 33
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1' AS pgfpageframecustom WITH ;
		ErasePage = .T., ;
		Height = 384, ;
		Left = 12, ;
		Name = "Pgfpageframecustom1", ;
		PageCount = 3, ;
		TabIndex = 10, ;
		Top = 72, ;
		Width = 816, ;
		Page1.Caption = "Basic Info", ;
		Page1.Name = "Page1", ;
		Page2.Caption = "Clauses", ;
		Page2.Name = "Page2", ;
		Page3.Caption = "Notes", ;
		Page3.Name = "Page3"
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="pageframe" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblCcontstart' AS lblfieldlabelcustom WITH ;
		Caption = "Contract Start", ;
		Height = 16, ;
		Left = 426, ;
		Name = "lblCcontstart", ;
		TabIndex = 27, ;
		Top = 219, ;
		Width = 69, ;
		ZOrderSet = 20
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblCrecbook' AS lblfieldlabelcustom WITH ;
		Caption = "Book", ;
		Height = 16, ;
		Left = 356, ;
		Name = "lblCrecbook", ;
		TabIndex = 21, ;
		Top = 128, ;
		Width = 26, ;
		ZOrderSet = 40
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblCrecpage' AS lblfieldlabelcustom WITH ;
		Caption = "Page", ;
		Height = 16, ;
		Left = 452, ;
		Name = "lblCrecpage", ;
		TabIndex = 22, ;
		Top = 128, ;
		Width = 26, ;
		ZOrderSet = 44
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblDcontend' AS lblfieldlabelcustom WITH ;
		Caption = "Contract Expires", ;
		Height = 16, ;
		Left = 560, ;
		Name = "lblDcontend", ;
		TabIndex = 28, ;
		Top = 219, ;
		Width = 82, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblDrecdate' AS lblfieldlabelcustom WITH ;
		Caption = "Recording Date", ;
		Height = 16, ;
		Left = 152, ;
		Name = "lblDrecdate", ;
		TabIndex = 20, ;
		Top = 128, ;
		Width = 76, ;
		ZOrderSet = 42
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblDstartpmt' AS lblfieldlabelcustom WITH ;
		Caption = "Payment Start Date", ;
		Height = 16, ;
		Left = 144, ;
		Name = "lblDstartpmt", ;
		TabIndex = 25, ;
		Top = 219, ;
		Width = 94, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Lblfieldlabelcustom1' AS lblfieldlabelcustom WITH ;
		Caption = "Next Payment Date", ;
		Height = 16, ;
		Left = 287, ;
		Name = "Lblfieldlabelcustom1", ;
		TabIndex = 26, ;
		Top = 219, ;
		Width = 93, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Lblfieldlabelcustom2' AS lblfieldlabelcustom WITH ;
		Caption = "Expiration Date", ;
		Height = 16, ;
		Left = 511, ;
		Name = "Lblfieldlabelcustom2", ;
		TabIndex = 14, ;
		Top = 62, ;
		Width = 74, ;
		ZOrderSet = 42
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Lease Duration", ;
		Left = 511, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 2, ;
		Top = 25, ;
		Width = 75
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "Yearly Pmt Total", ;
		Left = 653, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 1, ;
		Top = 19
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Lbllabelcustom3' AS lbllabelcustom WITH ;
		Caption = "Payment Description:", ;
		Left = 166, ;
		Name = "Lbllabelcustom3", ;
		TabIndex = 34, ;
		Top = 304
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Lbllabelcustom4' AS lbllabelcustom WITH ;
		Caption = "Instrument No:", ;
		Left = 152, ;
		Name = "Lbllabelcustom4", ;
		TabIndex = 23, ;
		Top = 162
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblNacres' AS lblfieldlabelcustom WITH ;
		Caption = "Acres Owned", ;
		Height = 16, ;
		Left = 73, ;
		Name = "lblNacres", ;
		TabIndex = 11, ;
		Top = 36, ;
		Width = 71, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblNpmtfreq' AS lblfieldlabelcustom WITH ;
		Caption = "Payment Freq In Months", ;
		Height = 16, ;
		Left = 73, ;
		Name = "lblNpmtfreq", ;
		TabIndex = 15, ;
		Top = 73, ;
		Width = 117, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblNpmttodate' AS lblfieldlabelcustom WITH ;
		BackStyle = 0, ;
		Caption = "Payment Total To Date", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 628, ;
		Name = "lblNpmttodate", ;
		TabIndex = 13, ;
		Top = 57, ;
		Width = 109, ;
		ZOrderSet = 24
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblNrental' AS lblfieldlabelcustom WITH ;
		Caption = "Rental per Acre", ;
		Height = 16, ;
		Left = 282, ;
		Name = "lblNrental", ;
		TabIndex = 12, ;
		Top = 36, ;
		Width = 78, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.lblNtotalpmt' AS lblfieldlabelcustom WITH ;
		Caption = "Pmt Per Period", ;
		Height = 16, ;
		Left = 282, ;
		Name = "lblNtotalpmt", ;
		TabIndex = 16, ;
		Top = 73, ;
		Width = 71, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Shpshapecustom1' AS shpshapecustom WITH ;
		Height = 89, ;
		Left = 69, ;
		Name = "Shpshapecustom1", ;
		Top = 15, ;
		Width = 406, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Shpshapecustom2' AS shpshapecustom WITH ;
		Height = 75, ;
		Left = 128, ;
		Name = "Shpshapecustom2", ;
		Top = 202, ;
		Width = 546, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Shpshapecustom3' AS shpshapecustom WITH ;
		BackColor = 212,208,200, ;
		Height = 89, ;
		Left = 618, ;
		Name = "Shpshapecustom3", ;
		Top = 15, ;
		Width = 132, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Shpshapecustom4' AS shpshapecustom WITH ;
		Height = 75, ;
		Left = 128, ;
		Name = "Shpshapecustom4", ;
		Top = 114, ;
		Width = 546, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.Shpshapecustom5' AS shpshapecustom WITH ;
		BackColor = 240,240,240, ;
		Height = 89, ;
		Left = 481, ;
		Name = "Shpshapecustom5", ;
		Top = 15, ;
		Width = 132, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="shape" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtcInstrument' AS txttextboxcustom WITH ;
		ControlSource = "land.cinstrument", ;
		Height = 20, ;
		Left = 248, ;
		Margin = 1, ;
		MaxLength = 20, ;
		Name = "txtcInstrument", ;
		TabIndex = 24, ;
		Top = 162, ;
		Width = 192, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtCrecbook' AS txttextboxcustom WITH ;
		ControlSource = "land.crecbook", ;
		Height = 20, ;
		Left = 392, ;
		Margin = 1, ;
		MaxLength = 10, ;
		Name = "txtCrecbook", ;
		TabIndex = 18, ;
		Top = 126, ;
		Width = 49, ;
		ZOrderSet = 39
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtCrecpage' AS txttextboxcustom WITH ;
		ControlSource = "land.crecpage", ;
		Height = 20, ;
		Left = 488, ;
		Margin = 1, ;
		MaxLength = 10, ;
		Name = "txtCrecpage", ;
		TabIndex = 19, ;
		Top = 126, ;
		Width = 37, ;
		ZOrderSet = 43
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtdcontend' AS dpk WITH ;
		ControlSource = "landowner.dcontend", ;
		Height = 20, ;
		Left = 555, ;
		lnocurrentdate = .T., ;
		Name = "txtdcontend", ;
		TabIndex = 32, ;
		Top = 241, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtdcontstart' AS dpk WITH ;
		ControlSource = "landowner.dcontstart", ;
		Height = 20, ;
		Left = 423, ;
		lnocurrentdate = .T., ;
		Name = "txtdcontstart", ;
		TabIndex = 31, ;
		Top = 241, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtdExpDate' AS dpk WITH ;
		ControlSource = "landowner.dexpiredate", ;
		Height = 20, ;
		Left = 510, ;
		lnocurrentdate = .T., ;
		Name = "txtdExpDate", ;
		TabIndex = 8, ;
		Top = 77, ;
		Width = 78
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtdnextpmt' AS dpk WITH ;
		ControlSource = "landowner.dnextpmt", ;
		Height = 20, ;
		Left = 291, ;
		lnocurrentdate = .T., ;
		Name = "txtdnextpmt", ;
		TabIndex = 30, ;
		Top = 241, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtdrecdate' AS dpk WITH ;
		ControlSource = "land.drecdate", ;
		Height = 20, ;
		Left = 248, ;
		lnocurrentdate = .T., ;
		Name = "txtdrecdate", ;
		TabIndex = 17, ;
		Top = 126, ;
		Width = 78
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtdStartPmt' AS dpk WITH ;
		ControlSource = "landowner.dstartpmt", ;
		Height = 20, ;
		Left = 147, ;
		lnocurrentdate = .T., ;
		Name = "txtdStartPmt", ;
		TabIndex = 29, ;
		Top = 241, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtLeaseYrs' AS txttextboxcustom WITH ;
		ControlSource = "landowner.ileaseyrs", ;
		Height = 20, ;
		Left = 509, ;
		Name = "txtLeaseYrs", ;
		TabIndex = 7, ;
		Top = 40, ;
		Width = 78
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtNacres' AS txttextboxcustom WITH ;
		ControlSource = "landowner.nacres", ;
		Height = 20, ;
		InputMask = "9999.9999", ;
		Left = 160, ;
		Name = "txtNacres", ;
		TabIndex = 3, ;
		Top = 34, ;
		Width = 85, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtnPmtFreq' AS txtnumeric WITH ;
		ControlSource = "landowner.npmtfreq", ;
		Height = 20, ;
		Left = 197, ;
		Name = "txtnPmtFreq", ;
		TabIndex = 5, ;
		Top = 71, ;
		Value = 0, ;
		Width = 48
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtNpmttodate' AS txttextboxcustom WITH ;
		ControlSource = "", ;
		Format = "", ;
		Height = 20, ;
		InputMask = "$$$,$$$,$$$.99", ;
		Left = 628, ;
		Name = "txtNpmttodate", ;
		TabIndex = 10, ;
		Top = 71, ;
		Width = 114, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtNrental' AS txttextboxcustom WITH ;
		ControlSource = "landowner.nrental", ;
		Height = 20, ;
		InputMask = "99,999.99", ;
		Left = 368, ;
		Name = "txtNrental", ;
		TabIndex = 4, ;
		Top = 34, ;
		Width = 96, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtNtotalpmt' AS txttextboxcustom WITH ;
		ControlSource = "landowner.ntotalpmt", ;
		Height = 20, ;
		Left = 368, ;
		Name = "txtNtotalpmt", ;
		TabIndex = 6, ;
		Top = 71, ;
		Width = 96, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtnYearPmt' AS txttextboxcustom WITH ;
		ControlSource = "", ;
		Format = "", ;
		Height = 20, ;
		InputMask = "$$$,$$$,$$$.99", ;
		Left = 628, ;
		Name = "txtnYearPmt", ;
		TabIndex = 9, ;
		Top = 34, ;
		Width = 114, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page1.txtPmtDesc' AS txttextboxcustom WITH ;
		ControlSource = "landowner.cpmtdesc", ;
		Height = 20, ;
		Left = 286, ;
		Name = "txtPmtDesc", ;
		TabIndex = 33, ;
		Top = 302, ;
		Width = 336
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkAssign' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Assignment", ;
		ControlSource = "land.lassignment", ;
		Left = 10, ;
		Name = "chkAssign", ;
		TabIndex = 11, ;
		Top = 312, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkContDrill' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Continuous Drilling", ;
		ControlSource = "land.lcontinuous", ;
		Left = 10, ;
		Name = "chkContDrill", ;
		TabIndex = 8, ;
		Top = 216, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkDeptRestrict' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Depth Restriction", ;
		ControlSource = "land.ldepthrestrict", ;
		Left = 10, ;
		Name = "chkDeptRestrict", ;
		TabIndex = 4, ;
		Top = 88, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.ChkFreeGas' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Free Gas", ;
		ControlSource = "land.lfreegas", ;
		Left = 10, ;
		Name = "ChkFreeGas", ;
		TabIndex = 7, ;
		Top = 184, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkLandowner' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Landowner App", ;
		ControlSource = "land.lloapprove", ;
		Left = 10, ;
		Name = "chkLandowner", ;
		TabIndex = 10, ;
		Top = 280, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkORRI' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "ORRI", ;
		ControlSource = "land.lorri", ;
		Left = 10, ;
		Name = "chkORRI", ;
		TabIndex = 6, ;
		Top = 152, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkPooling' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Pooling", ;
		ControlSource = "land.lpooling", ;
		Left = 10, ;
		Name = "chkPooling", ;
		TabIndex = 3, ;
		Top = 56, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkRenewal' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Renewal", ;
		ControlSource = "land.lrenewal", ;
		Left = 10, ;
		Name = "chkRenewal", ;
		TabIndex = 2, ;
		Top = 24, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkShutIn' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Shut-In", ;
		ControlSource = "land.lshutin", ;
		Left = 10, ;
		Name = "chkShutIn", ;
		TabIndex = 5, ;
		Top = 120, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.chkUnitization' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Unitization", ;
		ControlSource = "land.lunitization", ;
		Left = 10, ;
		Name = "chkUnitization", ;
		TabIndex = 9, ;
		Top = 248, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses' AS pgfpageframecustom WITH ;
		ErasePage = .T., ;
		Height = 340, ;
		Left = 119, ;
		Name = "pgfClauses", ;
		PageCount = 10, ;
		TabIndex = 1, ;
		TabOrientation = 0, ;
		Top = 4, ;
		Width = 684, ;
		Page1.Caption = "Renewal", ;
		Page1.Name = "Page1", ;
		Page10.Caption = "Assignment", ;
		Page10.Name = "Page10", ;
		Page2.Caption = "Pooling", ;
		Page2.Name = "Page2", ;
		Page3.Caption = "Depth", ;
		Page3.Name = "Page3", ;
		Page4.Caption = "Shut-In", ;
		Page4.Name = "Page4", ;
		Page5.Caption = "ORRI", ;
		Page5.Name = "Page5", ;
		Page6.Caption = "Free Gas", ;
		Page6.Name = "Page6", ;
		Page7.Caption = "Cont Drilling", ;
		Page7.Name = "Page7", ;
		Page8.Caption = "Unitization", ;
		Page8.Name = "Page8", ;
		Page9.Caption = "Landowner", ;
		Page9.Name = "Page9"
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="pageframe" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page1.edtRenewal' AS edteditboxcustom WITH ;
		ControlSource = "land.mrenewal", ;
		Height = 288, ;
		Left = 9, ;
		Name = "edtRenewal", ;
		Top = 8, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page10.edtFreeGas' AS edteditboxcustom WITH ;
		ControlSource = "land.massignment", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtFreeGas", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page2.edtPooling' AS edteditboxcustom WITH ;
		ControlSource = "land.mpoolnotes", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtPooling", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page3.edtDepth' AS edteditboxcustom WITH ;
		ControlSource = "land.mdepthnotes", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtDepth", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page4.edtShutIn' AS edteditboxcustom WITH ;
		ControlSource = "land.mshutnotes", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtShutIn", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page5.edtORRI' AS edteditboxcustom WITH ;
		ControlSource = "land.morrinotes", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtORRI", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page6.edtFreeGas' AS edteditboxcustom WITH ;
		ControlSource = "land.mfreegas", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtFreeGas", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page7.edtFreeGas' AS edteditboxcustom WITH ;
		ControlSource = "land.mcontinuous", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtFreeGas", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page8.edtFreeGas' AS edteditboxcustom WITH ;
		ControlSource = "land.munitization", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtFreeGas", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page2.pgfClauses.Page9.edtFreeGas' AS edteditboxcustom WITH ;
		ControlSource = "land.mloapprove", ;
		Height = 288, ;
		Left = 8, ;
		Name = "edtFreeGas", ;
		Top = 9, ;
		Width = 662
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'Pgfpageframecustom1.Page3.edtNotes' AS edteditboxcustom WITH ;
		ControlSource = "land.mcomments", ;
		Height = 316, ;
		Left = 11, ;
		Name = "edtNotes", ;
		Top = 20, ;
		Width = 792
		*< END OBJECT: ClassLib="..\..\ampro\custom\ccontrol.vcx" BaseClass="editbox" />

	ADD OBJECT 'txtCleaseid' AS txtquickfill WITH ;
		clistexpression = land.cleaseid, ;
		clistworkarea = land, ;
		ControlSource = "landowner.cleaseid", ;
		Format = "K!", ;
		Height = 20, ;
		InputMask = "XXXXXXXXXX", ;
		Left = 89, ;
		lrequired = .T., ;
		MaxLength = 10, ;
		Name = "txtCleaseid", ;
		TabIndex = 3, ;
		Top = 11, ;
		Width = 76, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtcLeaseName' AS txtquickfill WITH ;
		clistexpression = land.cleasename, ;
		clistworkarea = land, ;
		cworkarea = , ;
		Height = 20, ;
		Left = 168, ;
		Name = "txtcLeaseName", ;
		ReadOnly = .F., ;
		TabIndex = 4, ;
		Top = 11, ;
		Width = 253, ;
		ZOrderSet = 26
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCownerid' AS txtquickfill WITH ;
		clistexpression = investor.cownerid, ;
		clistworkarea = investor, ;
		ControlSource = "landowner.cownerid", ;
		Format = "!", ;
		Height = 20, ;
		Left = 90, ;
		lrequired = .T., ;
		MaxLength = 10, ;
		Name = "txtCownerid", ;
		TabIndex = 8, ;
		Top = 38, ;
		Width = 76, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtcOwnerName' AS txtquickfill WITH ;
		clistexpression = investor.csortfield, ;
		clistworkarea = investor, ;
		Height = 20, ;
		Left = 168, ;
		Name = "txtcOwnerName", ;
		ReadOnly = .F., ;
		TabIndex = 9, ;
		Top = 38, ;
		Width = 253, ;
		ZOrderSet = 28
		*< END OBJECT: ClassLib="..\custom\cgadget.vcx" BaseClass="textbox" />
	
	PROCEDURE Activate
		IF DODEFAULT()
		   thisform.CalcHist('Landowner')
		ENDIF 
	ENDPROC

	PROCEDURE calchist
		LPARAMETERS tcTable
		LOCAL lcLeaseID, lcOwnerID
		
		IF tcTable == 'Landowner'
		   lcLeaseID = landowner.cleaseid
		   lcOwnerID = landowner.cownerid
		
		   swselect('landhist')
		   SUM(nPmtAmount) FOR cownerid == lcOwnerID AND cleaseid == lcLeaseID AND YEAR(dPmtDate) = YEAR(DATE()) TO lnYearPmt
		   SUM(nPmtAmount) FOR cownerid == lcOwnerID AND cleaseid == lcLeaseID TO lnTotPmt
		
		   THISFORM.pgfpageframecustom1.page1.txtnyearPmt.VALUE   = lnYearPmt
		   THISFORM.pgfpageframecustom1.page1.txtnPmtToDate.VALUE = lnTotPmt
		ENDIF
	ENDPROC

	PROCEDURE calcpmt		&& Calculates total payment
		LOCAL lnYearPmt, lnPrdPmt, lnMonths
		
		STORE 0 TO lnYearPmt, lnPeriodPmt, lnMonths
		
		* Make sure the payment frequency in months is an integer
		lnMonths = CAST(THISFORM.pgfpageframecustom1.Page1.txtnPmtFreq.VALUE AS INT)
		
		IF (THISFORM.pgfpageframecustom1.Page1.txtnacres.VALUE = 0 OR THISFORM.pgfpageframecustom1.Page1.txtnrental.VALUE = 0) AND ;
		    thisform.pgfpageframecustom1.page1.txtnYearPmt.Value = 0
		   lnYearPmt = 0
		ELSE
		   IF thisform.pgfpageframecustom1.page1.txtnYearPmt.Value <> 0 AND (THISFORM.pgfpageframecustom1.Page1.txtnacres.VALUE = 0 OR THISFORM.pgfpageframecustom1.Page1.txtnrental.VALUE = 0)
		      lnYearPmt = landowner.nyearpmt
		   ELSE 
		      * Calculate the yearly payment total
		      lnYearPmt = THISFORM.pgfpageframecustom1.Page1.txtnacres.VALUE * THISFORM.pgfpageframecustom1.Page1.txtnrental.VALUE
		   ENDIF    
		ENDIF
		
		* Calculate the pmt per period
		IF lnYearPmt <> 0 AND lnMonths <> 0
		   lnPeriodPmt = ROUND(lnYearPmt / (12/lnMonths),2)
		ELSE
		   lnPeriodPmt = 0
		ENDIF
		
		IF Landowner.nYearPmt <> lnYearPmt AND lnYearPmt <> 0
		   THISFORM.cmdatamanager.REPLACE('Landowner','nYearPmt',lnYearPmt)
		   THISFORM.lchanged = .T.
		   THISFORM.pgfpageframecustom1.Page1.txtnYearPmt.REFRESH()
		ENDIF
		IF Landowner.nTotalPmt <> lnPeriodPmt  &&  Only replace if different
		   THISFORM.cmdatamanager.REPLACE('Landowner','NTotalPmt',lnPeriodPmt)
		   THISFORM.lchanged = .T.
		   THISFORM.pgfpageframecustom1.Page1.txtnTotalPmt.REFRESH()
		ENDIF
		
	ENDPROC

	PROCEDURE chkclauses
		IF land.lrenewal
		   thisform.pgfpageframecustom1.page2.pgfClauses.page1.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page1.Enabled = .f.
		ENDIF    
		IF land.lpooling
		   thisform.pgfpageframecustom1.page2.pgfClauses.page2.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page2.Enabled = .f.
		ENDIF    
		IF land.ldepthrestrict
		   thisform.pgfpageframecustom1.page2.pgfClauses.page3.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page3.Enabled = .f.
		ENDIF    
		IF land.lshutin
		   thisform.pgfpageframecustom1.page2.pgfClauses.page4.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page4.Enabled = .f.
		ENDIF    
		IF land.lorri
		   thisform.pgfpageframecustom1.page2.pgfClauses.page5.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page5.Enabled = .f.
		ENDIF    
		IF land.lfreegas
		   thisform.pgfpageframecustom1.page2.pgfClauses.page6.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page6.Enabled = .f.
		ENDIF   
		IF land.lcontinuous
		   thisform.pgfpageframecustom1.page2.pgfClauses.page7.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page7.Enabled = .f.
		ENDIF 
		IF land.lunitization
		   thisform.pgfpageframecustom1.page2.pgfClauses.page8.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page8.Enabled = .f.   
		ENDIF
		if land.lloapprove
		   thisform.pgfpageframecustom1.page2.pgfClauses.page9.Enabled = .t.
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page9.Enabled = .f.   
		ENDIF
		IF land.lassignment
		   thisform.pgfpageframecustom1.page2.pgfClauses.page10.Enabled = .t.   
		ELSE
		   thisform.pgfpageframecustom1.page2.pgfClauses.page10.Enabled = .f.   
		ENDIF    
	ENDPROC

	PROCEDURE Init
		LPARAMETERS tcOwner, tcLeaseID
		
		IF VARTYPE(tcOwner) # 'C'
		   tcOwner = '**'
		   tcLeaseID = '**'
		ENDIF 
		
		IF VARTYPE(tcLeaseID) # 'C'
		   tcOwner = '**'
		   tcLeaseID = '**'
		ENDIF
		
		IF DODEFAULT()
		   * If we're in demo mode, tell the user that this is an optional module
		   IF m.goapp.ldemo
		      thisform.omessage.warning('The Land Management module is an optional module that can be purchased separately.' + ;
		                                ' It is included in the demo for evaluation purposes.')
		   ENDIF
		   IF tcOwner <> '**'
		      swselect('landowner')
		      LOCATE FOR cownerid == tcowner AND cleaseid == tcleaseid
		      IF FOUND()
		         swselect('investor')
		         SET ORDER to cownerid
		         IF SEEK(tcowner)
		            thisform.txtcOwnerName.Value = investor.cownname
		         ENDIF
		         swselect('land')
		         SET ORDER to cleaseid
		         IF SEEK(tcLeaseID)
		            thisform.txtcLeaseName.Value = land.cleasename
		         ENDIF 
		         thisform.CalcHist('Landowner')
		      ENDIF    
		   ENDIF
		ENDIF
	ENDPROC

	PROCEDURE list
		LPARAMETERS cworkarea
		PRIV llOK
		LOCAL lcKey, lcList
		
		llOK = .T.
		WAIT WINDOW NOWAIT 'Creating lookup list....please wait'
		
		IF NOT USED('tempowner')
		   SELECT landowner.cidlando, landowner.cownerid, landowner.cleaseid, ;
		      investor.cSortField, land.cleasename, land.cunique, land.ctownship, land.ccounty ;
		      FROM landowner, investor, land ;
		      WHERE landowner.cownerid = investor.cownerid ;
		      AND landowner.cleaseid = land.cleaseid ;
		      INTO CURSOR tempowner READWRITE  ;
		      ORDER BY landowner.cownerid, landowner.cleaseid
		
		   IF _TALLY > 0
		      SELECT tempowner
		      INDEX ON cownerid TAG cownerid
		      INDEX ON cleaseid TAG cleaseid
		      INDEX ON cSortField TAG cSortField
		      INDEX ON cleasename TAG cleasename
		      INDEX on cunique TAG cunique
		      INDEX on ccounty TAG ccounty
		      INDEX on ctownship TAG ctownship
		   ENDIF
		ENDIF
		
		IF USED('tempowner')
		   lcList = 'cleaseid\Lease ID,cleasename\Lease Name,cownerid\Owner ID,cSortField\Owner Name,cCounty\County,cTownShip\Township,cunique\Unique ID'
		   WAIT CLEAR
		   DO FORM ..\CUSTOM\picklist WITH 'tempowner', lcList, 'landowner.cleaseid', 7, .T., .T.
		
		   IF llOK
		      lcID = tempowner.cleaseid + tempowner.cownerid
		      thisform.txtcleaseid.Value = tempowner.cleaseid
		      thisform.txtcownerID.Value = tempowner.cownerid
		      thisform.txtcleaseid.Refresh()
		      thisform.txtcownerID.Refresh()
		      SELECT landowner
		      SET ORDER TO cidlando
		      SEEK(tempowner.cidlando)
		      THISFORM.cmdatamanager.afternav('Landowner')
		      THISFORM.REFRESH()
		   ENDIF
		   USE IN tempowner
		ENDIF
		WAIT CLEAR
		
		
	ENDPROC

	PROCEDURE cboStatus.Init
		IF DODEFAULT()
		   THIS.ADDLISTITEM('Active',1,1)
		   THIS.ADDLISTITEM('Active',1,2)
		   THIS.ADDLISTITEM('Pending',2,1)
		   THIS.ADDLISTITEM('Pending',2,2)
		   THIS.ADDLISTITEM('Dedicated',3,1)
		   THIS.ADDLISTITEM('PD',3,2)
		   THIS.ADDLISTITEM('Expired',4,1)
		   THIS.ADDLISTITEM('Expired',4,2)
		   THIS.ADDLISTITEM('HBP',5,1)
		   THIS.ADDLISTITEM('HBP',5,2)
		   THIS.ADDLISTITEM('Paid-Up',6,1)
		   THIS.ADDLISTITEM('Paid-Up',6,2)
		   THIS.ADDLISTITEM('Sold',7,1)
		   THIS.ADDLISTITEM('Sold',7,2)
		   THIS.ADDLISTITEM('Mandatory Pool',8,1)
		   THIS.ADDLISTITEM('MP',8,2)
		   THIS.ADDLISTITEM('ROW',9,1)
		   THIS.ADDLISTITEM('ROW',9,2)
		   THIS.ADDLISTITEM('Location Agree',10,1)
		   THIS.ADDLISTITEM('LA',10,2)
		   THIS.ADDLISTITEM('Plugged',11,1)
		   THIS.ADDLISTITEM('PL',11,2)
		   THIS.ADDLISTITEM('Tank Battery',12,1)
		   THIS.ADDLISTITEM('TB',12,2)
		   THIS.ADDLISTITEM('Inactive',13,1)
		   THIS.ADDLISTITEM('IN',13,2)
		   THIS.AddListItem('Temporary Access',14,1)
		   THIS.ADDLISTITEM('TA',14,2)
		   this.AddListItem('Tank Battery, Etc.',15,1)
		   this.AddListItem('TBE',15,2)
		   this.addlistitem('Meter Site',16,1)
		   this.AddListItem('MS',16,2)
		   this.AddListItem('Extended',17,1)
		   this.AddListItem('EXT',17,2)
		ENDIF
		
	ENDPROC

	PROCEDURE cmdatamanager.afternav
		LPARAMETERS cworkarea
		
		SELECT land
		SET ORDER TO cleaseid
		IF SEEK(landowner.cleaseid)
		   THISFORM.txtcLeaseName.VALUE = land.cleasename
		ELSE
		   THISFORM.txtcLeaseName.VALUE = ''
		ENDIF
		
		SELECT investor
		SET ORDER TO cOwnerID
		IF SEEK(landowner.cownerid)
		   THISFORM.txtcOwnerName.VALUE = investor.cOwnName
		ELSE
		   THISFORM.txtcOwnerName.VALUE = ''
		ENDIF
		
		SELECT landowner
		
		* Enable or disable clause pages as needed.
		thisform.chkClauses()
		
		thisform.calchist(cworkarea)
		
		
		RETURN DODEFAULT()
		
	ENDPROC

	PROCEDURE cmdatamanager.afternew
		LPARAMETERS cworkarea
		LOCAL lcidlando
		
		IF m.cworkarea = 'Landowner'
		   lcidlando = THISFORM.oRegistry.IncrementCounter('%Shared.Counters.LandOwner')
		   SELECT landowner1
		   SET DELE OFF
		   SET ORDER TO cidlando
		   DO WHILE SEEK(lcidlando)
		      lcidlando = THISFORM.oRegistry.IncrementCounter('%Shared.Counters.LandOwner')
		   ENDDO
		   SET DELE ON
		
		   SELECT landowner
		   REPL cidlando WITH lcidlando, ;
		      cStatus  WITH 'A', ;
		      npmtfreq WITH 12
		   THISFORM.pgfpageframecustom1.pAGE1.txtnPmtFreq.REFRESH()
		   THISFORM.setnextcontrol(THISFORM.txtcLeaseID)
		ENDIF
		
		
	ENDPROC

	PROCEDURE cmdatamanager.beforeupdate
		LPARAMETERS cWorkareaList, lCurrentRecordOnly
		
		IF EMPTY(landowner.dnextpmt)
		   thisform.omessage.confirm('The next payment date must be filled in. Please enter a next payment date and save again.')
		   RETURN .f.
		ENDIF 
		
		TABLEUPDATE(.t.,.t.,'Landowner')
	ENDPROC

	PROCEDURE cmdLookLease.Click
		LOCAL lcKey, lcList
		PRIV llOK
		
		llOK  = .T.
		lcKey = .NULL.
		
		lcList = 'cLeaseID\Lease ID,cLeaseName\Lease Name'
		
		DO FORM ..\CUSTOM\picklist.scx WITH 'Land', lcList, THISFORM.txtcLeaseId.VALUE, 2, .F., .T.
		
		IF llOK
			THISFORM.cmdatamanager.REPLACE('Landowner', 'cleaseid', land.cleaseid)
			THISFORM.txtcLeaseName.VALUE = land.cleasename
			THISFORM.txtcLeaseID.REFRESH()
			THISFORM.txtcLeaseName.REFRESH()
			THISFORM.lChanged = .T.
			THISFORM.txtcLeaseID.fieldvalid()
			THISFORM.cmdatamanager.REPLACE('landowner', 'drecdate', land.drecdate)
			THISFORM.cmdatamanager.REPLACE('landowner', 'crecbook', land.crecbook)
			THISFORM.cmdatamanager.REPLACE('landowner', 'crecpage', land.crecpage)
			THISFORM.cmdatamanager.REPLACE('landowner', 'cinstrument', land.cinstrument)
			THISFORM.cmdatamanager.REPLACE('landowner', 'dstartpmt', land.dpmtstart)
			THISFORM.cmdatamanager.REPLACE('landowner', 'ileaseyrs', land.nleaseyears)
			thisform.Refresh()
		ENDIF
		
		THISFORM.setnextcontrol(THISFORM.txtcleaseid)
		
		SELECT landowner
		
		
	ENDPROC

	PROCEDURE cmdLookLease.When
		RETURN mdown()
	ENDPROC

	PROCEDURE cmdLookOwner.Click
		LOCAL lcKey, lcList
		PRIV llOK
		
		llOK  = .T.
		lcKey = .NULL.
		
		lcList = 'cOwnerID,cSortField'
		
		DO FORM ..\custom\picklist.scx WITH 'Investor',lcList,thisform.txtcOwnerId.value,2
		
		IF llOK
		   lcKey = Investor.cOwnerID
		   IF lcKey <> landowner.cownerid
		      THISFORM.cmdatamanager.REPLACE('Landowner','Cownerid',lcKey)
		      THISFORM.txtcOwnerName.VALUE = investor.cOwnName
		      THISFORM.txtcOwnerID.REFRESH()
		      THISFORM.txtcOwnerName.REFRESH()
		      THISFORM.lChanged = .T.
		   ENDIF
		ENDIF
		
		thisform.setnextcontrol(thisform.txtcownerid)
		
		SELECT landowner
		
	ENDPROC

	PROCEDURE cmdLookOwner.When
		RETURN mdown()
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page1.txtNacres.Valid
		LOCAL lnTotal
		
		lnTotal = THIS.VALUE
		
		SELECT landowner1
		SCAN FOR cStatus <> 'I' AND cLeaseID = landowner.cLeaseID AND cidLando <> landowner.cidLando
		   lnTotal = lnTotal + nAcres
		ENDSCAN
		
		SELECT land
		LOCATE FOR cLeaseID = landowner.cLeaseID
		IF FOUND() AND land.nGrossAcre <> 0 AND land.nGrossAcre < lnTotal  &&  Warn if they try and pay more acres than are defined in the land rec
		   THISFORM.oMessage.Warning('The amount of acres entered will take the total obligations for this lease above the number of acres defined on the Lease Information screen.  Please correct.')
		ENDIF
		
		THISFORM.calcpmt()
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page1.txtnPmtFreq.LostFocus
		IF DODEFAULT()
		   thisform.calcpmt()
		ENDIF
		
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page1.txtNpmttodate.When
		RETURN .f.
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page1.txtNrental.Valid
		IF EMPTY(landowner.npmtfreq)
		   thisform.cmdatamanager.replace('landowner','npmtfreq',1)
		ENDIF
		   
		thisform.calcpmt()
		
		DODEFAULT()
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page1.txtNtotalpmt.LostFocus
		IF DODEFAULT()
		   * Calculate the yearly payment amount by figuring what part of a year the payment
		   * frequency makes up.
		   IF CAST(thisform.pgfpageframecustom1.page1.txtnPmtFreq.Value as Int) <> 0
		      lnYearPmt = ROUND(this.Value * (12/CAST(thisform.pgfpageframecustom1.page1.txtnPmtFreq.Value as Int)),2)
		   ELSE
		      lnYearPmt = 0
		   ENDIF 
		   IF landowner.nyearpmt <> lnYearPmt
		      thisform.cmdatamanager.replace('Landowner','nYearPmt',lnYearpmt)
		      thisform.pgfpageframecustom1.page1.txtnyearPmt.Refresh()
		   ENDIF
		ENDIF 
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page1.txtnYearPmt.When
		RETURN .f.
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.Activate
		thisform.chkClauses()
		RETURN DODEFAULT()
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkAssign.Click
		IF this.Value
		   this.Parent.pgfClauses.page10.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 10
		ELSE
		   this.Parent.pgfClauses.page10.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkContDrill.Click
		IF this.Value
		   this.Parent.pgfClauses.page7.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 7
		ELSE
		   this.Parent.pgfClauses.page7.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkDeptRestrict.Click
		IF this.Value
		   this.Parent.pgfClauses.page3.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 3
		ELSE
		   this.Parent.pgfClauses.page3.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.ChkFreeGas.Click
		IF this.Value
		   this.Parent.pgfClauses.page6.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 6
		ELSE
		   this.Parent.pgfClauses.page6.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkLandowner.Click
		IF this.Value
		   this.Parent.pgfClauses.page9.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 9
		ELSE
		   this.Parent.pgfClauses.page9.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkORRI.Click
		IF this.Value
		   this.Parent.pgfClauses.page5.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 5
		ELSE
		   this.Parent.pgfClauses.page5.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkPooling.Click
		IF this.Value
		   this.Parent.pgfClauses.page2.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 2
		ELSE
		   this.Parent.pgfClauses.page2.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkRenewal.Click
		IF this.Value
		   this.Parent.pgfClauses.page1.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 1
		ELSE
		   this.Parent.pgfClauses.page1.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkShutIn.Click
		IF this.Value
		   this.Parent.pgfClauses.page4.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 4
		ELSE
		   this.Parent.pgfClauses.page4.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE Pgfpageframecustom1.Page2.chkUnitization.Click
		IF this.Value
		   this.Parent.pgfClauses.page8.Enabled = .t.
		   this.Parent.pgfClauses.ActivePage = 8
		ELSE
		   this.Parent.pgfClauses.page8.Enabled = .f.
		ENDIF    
	ENDPROC

	PROCEDURE txtCleaseid.GotFocus
		ON KEY LABEL F2 _screen.activeform.cmdLookLease.Click()
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCleaseid.InteractiveChange
		IF DODEFAULT()
		   SELECT land
		   LOCATE FOR cleaseid == this.Value
		   IF FOUND()
		      thisform.txtcLeaseName.Value = land.cleasename
		   ELSE
		      thisform.txtcLeaseName.Value = ''
		   ENDIF
		ENDIF 
	ENDPROC

	PROCEDURE txtCleaseid.LostFocus
		ON KEY LABEL F2 
		
		LOCAL lnMonths, ldContEnd
		lnMonths = 1
		
		SELECT land
		SET ORDER TO cLeaseID
		IF SEEK(THIS.VALUE)
		 
		   IF THISFORM.cmdatamanager.isnew('Landowner')      &&  Set the payment start and next payment due if a new record
		      THISFORM.cmdatamanager.REPLACE('Landowner','Dcontstart',land.dleasedate)
		      THISFORM.cmdatamanager.REPLACE('Landowner','Dnextpmt',land.dleasedate)
		      THISFORM.cmdatamanager.REPLACE('Landowner','dStartPmt',land.dleasedate)
		      thisform.cmdatamanager.replace('landowner','drecdate',land.drecdate)
		      thisform.cmdatamanager.replace('landowner','crecbook',land.crecbook)
		      thisform.cmdatamanager.replace('landowner','crecpage',land.crecpage)
		      thisform.cmdatamanager.replace('landowner','cinstrument',land.cinstrument)
		      thisform.cmdatamanager.replace('landowner','dstartpmt',land.dpmtstart)
		      thisform.cmdatamanager.replace('landowner','ileaseyrs',land.nleaseyears)
		      thisform.cmdatamanager.replace('landowner','dexpiredate',land.dexpires)
		      thisform.cmdatamanager.replace('landowner','nacres',land.nnetacres)
		      thisform.cmdatamanager.replace('landowner','lrenewal',land.lrenewal)
		      thisform.cmdatamanager.replace('landowner','mrenewal',land.mrenewal)
		      thisform.cmdatamanager.replace('landowner','lpooling',land.lpooling)
		      thisform.cmdatamanager.replace('landowner','mpoolnotes',land.mpoolnotes)
		      thisform.cmdatamanager.replace('landowner','ldepthrestrict',land.ldepthrestrict)
		      thisform.cmdatamanager.replace('landowner','mdepthnotes',land.mdepthnotes)
		      thisform.cmdatamanager.replace('landowner','lshutin',land.lshutin)
		      thisform.cmdatamanager.replace('landowner','mshutnotes',land.mshutnotes)
		      thisform.cmdatamanager.replace('landowner','lorri',land.lorri)
		      thisform.cmdatamanager.replace('landowner','morrinotes',land.morrinotes)
		      thisform.cmdatamanager.replace('landowner','lfreegas',land.lfreegas)
		      thisform.cmdatamanager.replace('landowner','mfreegas',land.mfreegas)
		      thisform.Refresh()
		
		      IF EMPTY(land.dExpires)  &&  If the expires date isn't filled in, calculate it for this owner based on the lease term in years/months
		         lnMonths = land.nleaseyears*12 + land.nleasemonths
		         ldContEnd = GOMONTH(land.dleasedate,lnMonths)
		         THISFORM.cmdatamanager.REPLACE('Landowner','Dcontend',ldContEnd)
		         THISFORM.pgfpageframecustom1.Page1.txtdcontend.REFRESH()
		      ELSE
		         THISFORM.pgfpageframecustom1.Page1.txtdcontend.SET('value',land.dExpires)
		      ENDIF
		   ENDIF
		ENDIF
		
		SELECT landowner
		
		RETURN DODEFAULT()
		
		
	ENDPROC

	PROCEDURE txtcLeaseName.fieldvalid
		thisform.cmdatamanager.replace('Landowner','cleaseid',land.cleaseid)
		RETURN .t.
	ENDPROC

	PROCEDURE txtcLeaseName.InteractiveChange
		IF DODEFAULT()
		   SELECT land
		   LOCATE FOR cleasename = ALLTRIM(this.Value)
		   IF FOUND()
		      thisform.txtcLeaseID.Value = land.cleaseid
		   ENDIF
		ENDIF 
	ENDPROC

	PROCEDURE txtCownerid.GotFocus
		ON KEY LABEL F2 _screen.activeform.cmdLookOwner.Click()
		DODEFAULT()
	ENDPROC

	PROCEDURE txtCownerid.InteractiveChange
		IF DODEFAULT()
		   SELECT investor
		   LOCATE FOR cownerid = this.Value
		   IF FOUND()
		      THISFORM.txtcOwnerName.VALUE = investor.cOwnName
		   ENDIF
		ENDIF
		      
	ENDPROC

	PROCEDURE txtCownerid.LostFocus
		ON KEY LABEL F2
		DODEFAULT()
	ENDPROC

	PROCEDURE txtcOwnerName.fieldvalid
		thisform.cmdatamanager.replace('Landowner','cownerid',investor.cownerid)
		RETURN .t.
	ENDPROC

	PROCEDURE txtcOwnerName.InteractiveChange
		IF DODEFAULT()
		   SELECT investor
		   LOCATE FOR csortfield = ALLTRIM(this.Value)
		   IF FOUND()
		      THISFORM.txtcOwnerID.VALUE = investor.cownerid
		   ENDIF
		ENDIF
		      
	ENDPROC

ENDDEFINE
