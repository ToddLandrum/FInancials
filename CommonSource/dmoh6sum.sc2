*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmoh6sum.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 334
	Left = -11
	Name = "Dataenvironment"
	Top = 240
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "Form6s", ;
		CursorSource = "Form6s", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 19, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "form6", ;
		CursorSource = "form6", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\ampro\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formdmoh6sum AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Swyear1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblLastWell" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblFirstWell" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgReportType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />

	Caption = "OH Form 6/6A Summary"
	DoCreate = .T.
	Height = 299
	HelpContextID = 613
	Name = "FormDmoh6sum"
	Width = 375
	Swrptcriteriabuttons1.chkSendFile.Alignment = 0
	Swrptcriteriabuttons1.chkSendFile.Name = "chkSendFile"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 55
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 8
	Swrptcriteriabuttons1.Top = 218

	ADD OBJECT 'LblFirstWell' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "First Well:", ;
		Height = 16, ;
		Left = 45, ;
		Name = "LblFirstWell", ;
		TabIndex = 6, ;
		Top = 100, ;
		Width = 49, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Year", ;
		Left = 68, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 3, ;
		Top = 64
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "Report Type", ;
		Left = 24, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 2, ;
		Top = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblLastWell' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Last Well:", ;
		Height = 16, ;
		Left = 45, ;
		Name = "LblLastWell", ;
		TabIndex = 7, ;
		Top = 150, ;
		Width = 49, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgReportType' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 52, ;
		Left = 92, ;
		Name = "opgReportType", ;
		TabIndex = 1, ;
		Top = 8, ;
		Width = 155, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Form 6/6A Summary", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 4, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 116, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Form 6 Royalty Owners", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 4, ;
		Option2.Name = "Option2", ;
		Option2.Top = 28, ;
		Option2.Width = 133
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 101, ;
		Name = "Swrptlook1", ;
		TabIndex = 5, ;
		Top = 97, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		TxtBegID.clistexpression = wells.cWellID, ;
		TxtBegID.clistworkarea = wells, ;
		TxtBegID.Name = "TxtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		TxtEndID.clistexpression = wells.cWellID, ;
		TxtEndID.clistworkarea = wells, ;
		TxtEndID.Name = "TxtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'Swyear1' AS swyear WITH ;
		Left = 101, ;
		Name = "Swyear1", ;
		TabIndex = 4, ;
		Top = 62
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lnRptType, lcfirstwell, lclastwell, lcYear
		
		lcfirstwell = THISFORM.swrptlook1.txtbegid.VALUE
		lclastwell  = THISFORM.swrptlook1.txtendid.VALUE
		lcYear     = THISFORM.swyear1.VALUE
		
		lnRptType = THISFORM.opgReportType.VALUE
		LOCAL lnCount
		
		SELECT * FROM form6 INTO CURSOR temp6 WHERE cYear = lcYear AND BETWEEN(cwellid,lcfirstwell,lclastwell)
		lnCount = _TALLY
		
		IF lnRptType = 2
		   THISFORM.creportname = 'dmoh6asumm.frx'  &&  Yeah, the report names are backward, but I was too lazy to fix it ** BH 3-12-02
		   thisform.cTitle1 = 'Ohio Form 6 Royalty Owner Summary Report'
		   thisform.cTitle2 = 'For Year ' + lcYear
		   SELE cRoyName,  ;
		   form6s.cWellID,  ;
		   wells.cwellname,  ;
		   form6s.nOilInt,  ;
		   form6s.nOilVal,  ; 
		   form6s.nGasInt,  ;
		   form6s.nGasVal,  ;
		   form6s.nTotalVal  ;
		   FROM form6s,wells WHERE cYear = lcYear and form6s.cwellID = wells.cWellID  ;
		      AND BETWEEN(form6s.cwellid,lcfirstwell,lclastwell) INTO CURSOR temp6s ORDER BY form6s.cwellid,croyname
		   SELECT temp6s
		ELSE
		   SELECT temp6
		   THISFORM.creportname = 'dmoh6summ.frx'
		   thisform.cTitle1 = 'Ohio Form 6/6A Summary Report'
		   thisform.cTitle2 = 'For Year ' + lcYear
		ENDIF
		
		IF lnCount > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF
		
		
	ENDPROC

	PROCEDURE Init
		IF DODEFAULT()
		
		   SELE wells
		   SET ORDER TO cwellid
		   GO TOP
		   THISFORM.swrptlook1.txtbegid.VALUE = cwellid
		   THISFORM.swrptlook1.txtbegname.VALUE = cwellname
		
		   GO BOTT
		   THISFORM.swrptlook1.txtendid.VALUE = cwellid
		   THISFORM.swrptlook1.txtendname.VALUE = cwellname
		
		   SELECT form6
		   SET ORDER TO cyear
		   GO BOTT
		   IF NOT EMPTY(form6.cyear)
		      THISFORM.swYear1.VALUE = form6.cyear
		   ENDIF
		
		ENDIF
		
	ENDPROC

	PROCEDURE opgReportType.Init
		this.value = 1
		
		dodefault()
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtbegid.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cwellid
		   thisform.swrptlook1.txtBegName.value = cwellname
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtendid.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cwellid
		   thisform.swrptlook1.txtEndName.value = cwellname
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

	PROCEDURE Swrptlook1.TxtBegID.Init
		SELECT wells
		SET ORDER TO cwellid
		GO TOP
		this.value = wells.cwellid
		this.parent.txtbegname.value = wells.cwellname
		DODEFAULT()
	ENDPROC

	PROCEDURE Swrptlook1.TxtEndID.Init
		SELECT wells
		SET ORDER TO cwellid
		GO BOTT
		this.value = wells.cwellid
		this.parent.txtendname.value = wells.cwellname
		DODEFAULT()
	ENDPROC

ENDDEFINE
