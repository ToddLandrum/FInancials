*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="invalue.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	InitialSelectedAlias = "items"
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "items", ;
		BufferModeOverride = 5, ;
		CursorSource = "items", ;
		Database = ..\ampro\amdata\appdata.dbc, ;
		Height = 90, ;
		Name = "Cursor1", ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS forminvalulist AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="opgSort" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSortBy" UniqueID="" Timestamp="" />

	Caption = "Inventory Valuation Report"
	DataSession = 2
	DoCreate = .T.
	Height = 238
	HelpContextID = 584
	Name = "FormInvalulist"
	Width = 281
	Swrptcriteriabuttons1.chkSendFile.Alignment = 0
	Swrptcriteriabuttons1.chkSendFile.Name = "chkSendFile"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 23
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 5
	Swrptcriteriabuttons1.Top = 180
	Swrptcriteriabuttons1.ZOrderSet = 0

	ADD OBJECT 'lblSortBy' AS lblfieldlabelcustom WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Sort By:", ;
		Height = 16, ;
		Left = 65, ;
		Name = "lblSortBy", ;
		TabIndex = 4, ;
		Top = 66, ;
		Width = 41, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgSort' AS opgoptiongroupcustom WITH ;
		AutoSize = .F., ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 51, ;
		Left = 108, ;
		Name = "opgSort", ;
		TabIndex = 1, ;
		Top = 60, ;
		Width = 104, ;
		ZOrderSet = 1, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Item Description", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "optItemDesc", ;
		Option1.TabIndex = 2, ;
		Option1.Top = 27, ;
		Option1.Width = 94, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Item Number", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "optItemNo", ;
		Option2.TabIndex = 1, ;
		Option2.Top = 5, ;
		Option2.Width = 77
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />
	
	PROCEDURE builddata
		thisform.cTitle1 = ''
		thisform.cTitle2 = ''
		thisform.cSelectCriteria = ''
		      
		DO CASE
		   CASE THISFORM.opgSort.VALUE = 1		&&	Item Desc
		      THISFORM.cSortOrder = 'Item Description'
		      csortby = 'items.citemdesc'
		   CASE THISFORM.opgSort.VALUE = 2		&&	ItemNum
		      THISFORM.cSortOrder = 'Item ID'
		      csortby = 'items.citemid'
		ENDCASE
		
		CREATE CURSOR itemval ;
		  (citemid    C(10), ;
		   citemdesc  C(40), ;
		   ncurcost   N(12,4), ;
		   cmeasure1  C(10), ;
		   nqtyonhand N(12,2), ;
		   ntotalval  N(12,2))
		
		
		      SELECT items.citemid, ;
		             items.citemdesc, ;
		             items.ncurcost, ;
		             items.cmeasure1, ;
		             items.nqtyonhand ;
		         FROM items ;
		         ORDER BY &csortby ;
		         INTO CURSOR temp
		      SUM nqtyonhand*ncurcost TO m.nTotalVal
		      SELECT itemval
		      APPEND FROM DBF('temp')
		      REPL nTotalVal WITH m.nTotalVal ALL
		      THISFORM.cReportName = 'invalue1.frx'
		
		
		
		SELECT itemval
		IF RECC() > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF      
		
		
	ENDPROC

	PROCEDURE Init
		
		THISFORM.opgSort.VALUE = 1
		
		DODEFAULT()
	ENDPROC

	PROCEDURE opgSort.optItemDesc.GotFocus
		THISFORM.opgSort.VALUE = 1
		
	ENDPROC

	PROCEDURE opgSort.optItemNo.GotFocus
		THISFORM.opgSort.VALUE = 2
		
	ENDPROC

ENDDEFINE
