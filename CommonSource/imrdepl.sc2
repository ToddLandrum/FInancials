*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="imrdepl.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor6" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 335
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 625

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "investor", ;
		CursorSource = "investor", ;
		Database = ..\qbdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "disbhist", ;
		CursorSource = "disbhist", ;
		Database = ..\qbdata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "deplfile", ;
		CursorSource = "deplfile", ;
		Database = ..\qbdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor3", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "deplset", ;
		CursorSource = "deplset", ;
		Database = ..\qbdata\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor4", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\qbdata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "fields", ;
		CursorSource = "fields", ;
		Database = ..\qbdata\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor6", ;
		Top = 140, ;
		Width = 101
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "wellhist", ;
		CursorSource = "wellhist", ;
		Database = ..\qbdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formimdepletion AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Swyear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblFirstOwner" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblAccYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSuspense" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblLastOwner" UniqueID="" Timestamp="" />

	Caption = "Depletion Reports"
	DataSession = 2
	DoCreate = .T.
	Height = 272
	HelpContextID = 644
	Name = "FormImdepletion"
	Width = 346
	Swrptcriteriabuttons1.chkSendFile.Alignment = 0
	Swrptcriteriabuttons1.chkSendFile.Name = "chkSendFile"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 56
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 7
	Swrptcriteriabuttons1.Top = 208
	Swrptcriteriabuttons1.ZOrderSet = 0

	ADD OBJECT 'chkSuspense' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Include Amounts Still In Suspense", ;
		Left = 101, ;
		Name = "chkSuspense", ;
		TabIndex = 6, ;
		Top = 172, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\ampro_rv\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'LblAccYear' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Year:", ;
		Height = 16, ;
		Left = 56, ;
		Name = "LblAccYear", ;
		TabIndex = 1, ;
		Top = 20, ;
		Width = 29, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblFirstOwner' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "First Owner:", ;
		Height = 16, ;
		Left = 22, ;
		Name = "LblFirstOwner", ;
		TabIndex = 4, ;
		Top = 64, ;
		Width = 63, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblLastOwner' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Last Owner:", ;
		Height = 16, ;
		Left = 22, ;
		Name = "LblLastOwner", ;
		TabIndex = 5, ;
		Top = 115, ;
		Width = 63, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 103, ;
		Name = "Swrptlook1", ;
		TabIndex = 3, ;
		Top = 62, ;
		ZOrderSet = 3, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = investor.cownerid, ;
		txtBegID.clistworkarea = investor, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = investor.cownerid, ;
		txtEndID.clistworkarea = investor, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'Swyear' AS swyear WITH ;
		Left = 103, ;
		Name = "Swyear", ;
		TabIndex = 2, ;
		Top = 22, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL tcYear, tcOwner1, tcOwner2, tcGrossNet, tnRpttype
		LOCAL m.gtotmcf, m.gtotbbl, m.gtotimcf, lnWorkCnt
		LOCAL m.gtotibbl, m.gtotinc, m.gtotexp, m.gtotsev, m.gtotdef, m.gtotnet
		
		tcYear   = thisform.swYear.value
		tcOwner1 = thisform.swrptlook1.txtBegID.value
		tcOwner2 = thisform.swrptlook1.txtEndID.value
		tlIncludeSuspense = thisform.chkSuspense.value
		
		thisform.cReportName = 'imrdepl1'
		thisform.cTitle1     = 'Well Depletion Schedule'
		thisform.cTitle2     = 'For Year ' + tcYear
		thisform.cSelectCriteria = ''
		thisform.cSortOrder      = ''
		
		DO calcdepl WITH tcYear, tcOwner1, tcOwner2, tlIncludeSuspense
		
		SELECT tempdepl
		COUNT FOR NOT DELETED() TO lnCount
		SET ORDER TO cownerid
		IF lnCount > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF      
		
		
		
		
		
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		SELECT investor
		SET ORDER TO cownerid
		GO TOP
		
		THISFORM.swrptlook1.txtBegName.VALUE = cownname
		THISFORM.swrptlook1.txtBegID.VALUE = cownerid
		GO BOTTOM
		
		THISFORM.swrptlook1.txtEndName.VALUE = cownname
		THISFORM.swrptlook1.txtEndID.VALUE = cownerid
		
		
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,cownname'
		
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtBegId.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cOwnerID
		   thisform.swrptlook1.txtBegName.value = cOwnname
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cownerid,cownname'
		
		DO FORM ..\custom\picklist WITH 'Investor', lcList, thisform.swrptlook1.txtEndId.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cOwnerID
		   thisform.swrptlook1.txtEndName.value = cOwnname
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

	PROCEDURE Swrptlook1.txtBegID.GotFocus
		ON KEY LABEL F2 _screen.activeform.swrptlook1.swlookupbutton1.Click()
	ENDPROC

	PROCEDURE Swrptlook1.txtBegID.LostFocus
		on key label F2 *
	ENDPROC

	PROCEDURE Swrptlook1.txtEndID.GotFocus
		ON KEY LABEL F2 _screen.activeform.swrptlook1.swlookupbutton2.Click()
	ENDPROC

	PROCEDURE Swrptlook1.txtEndID.LostFocus
		on key label F2 *
	ENDPROC

ENDDEFINE
