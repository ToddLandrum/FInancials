*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="micrdataupd.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />

	DataSource = .NULL.
	Height = 200
	Left = -7
	Name = "Dataenvironment"
	Top = 326
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "micrdata", ;
		CursorSource = "micrdata", ;
		Database = ..\datafiles\trilogydata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS frmmicrdataupd AS frmdatamanagerformcustom OF "..\custom\cforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="txtCbankname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblCbankname" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCmicrtransit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblCmicrtransit" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtCmicracct" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblCmicracct" UniqueID="" Timestamp="" />

	Caption = "MICR Bank Info"
	clistexpression = micrdata.cbankname
	cworkarea = micrdata
	DoCreate = .T.
	Height = 250
	Name = "frmMicrDataUpd"
	Width = 449
	cmdatamanager.Name = "cmdatamanager"
	cmdatamanager.TabIndex = 2
	cmlookupmanager.Name = "cmlookupmanager"
	MWRESIZE1.LBLHIGHLIGHT.Name = "LBLHIGHLIGHT"
	MWRESIZE1.LBLSHADING.Name = "LBLSHADING"
	MWRESIZE1.Name = "MWRESIZE1"
	MWRESIZE1.TabIndex = 1

	ADD OBJECT 'lblCbankname' AS lbllabelcustom WITH ;
		Caption = "Bank Name", ;
		Height = 16, ;
		Left = 39, ;
		Name = "lblCbankname", ;
		TabIndex = 3, ;
		Top = 43, ;
		Width = 56
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblCmicracct' AS lbllabelcustom WITH ;
		Caption = "Bank Account", ;
		Height = 16, ;
		Left = 39, ;
		Name = "lblCmicracct", ;
		TabIndex = 7, ;
		Top = 125, ;
		Width = 70
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblCmicrtransit' AS lbllabelcustom WITH ;
		Caption = "Bank Transit", ;
		Height = 16, ;
		Left = 39, ;
		Name = "lblCmicrtransit", ;
		TabIndex = 5, ;
		Top = 84, ;
		Width = 62
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'txtCbankname' AS txttextboxcustom WITH ;
		ControlSource = "micrdata.cbankname", ;
		Height = 20, ;
		Left = 126, ;
		MaxLength = 40, ;
		Name = "txtCbankname", ;
		TabIndex = 4, ;
		Top = 41, ;
		Width = 286
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCmicracct' AS txttextboxcustom WITH ;
		ControlSource = "micrdata.cmicracct", ;
		Height = 20, ;
		Left = 126, ;
		MaxLength = 15, ;
		Name = "txtCmicracct", ;
		TabIndex = 8, ;
		Top = 123, ;
		Width = 111
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtCmicrtransit' AS txttextboxcustom WITH ;
		ControlSource = "micrdata.cmicrtransit", ;
		Height = 20, ;
		Left = 126, ;
		MaxLength = 15, ;
		Name = "txtCmicrtransit", ;
		TabIndex = 6, ;
		Top = 82, ;
		Width = 111
		*< END OBJECT: ClassLib="..\..\custom\ccontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE list
		LPARAMETERS cworkarea
		LOCAL lcList, lnRecNo, loError, llReturn
		PRIV llOK
		
		llReturn = .T.
		
		TRY
		
		    llOK   = .F.
		    lcList = 'cbankname\Bank Name,cmicrtransit\Transit No, cmicracct\Bank Account'
		    SELECT micrdata
		    lnRecNo = RECNO()
		
		    IF THIS.flushcontrolbuffer() AND THIS.beforenav('micrdata')
		        DO FORM ..\CUSTOM\picklist WITH 'micrdata', lcList, thisform.txtCbankname.value, 3, .F., .T.
		    ENDIF
		
		    IF NOT llOK
		        SELECT micrdata
		        TRY 
		          GOTO lnRecNo
		        CATCH
		        ENDTRY 
		    ENDIF
		
		    THISFORM.REFRESH()
		
		CATCH TO loError
		    llReturn = .F.
		    DO errorlog WITH 'List', loError.LINENO, 'MICR Info', loError.ERRORNO, loError.MESSAGE, '', loError
		    MESSAGEBOX('Unable to process the lookup list at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		          'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		ENDTRY
		
		RETURN llReturn
		
	ENDPROC

ENDDEFINE
