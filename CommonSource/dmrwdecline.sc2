*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrwdecline.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Relation1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	Left = -11
	Name = "Dataenvironment"
	Top = 205
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "wells", ;
		CursorSource = "wells", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "wellhist", ;
		CursorSource = "wellhist", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 113, ;
		Name = "Cursor2", ;
		Top = 21, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "sysctl", ;
		CursorSource = "sysctl", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "groups", ;
		CursorSource = "groups", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Relation1' AS relation WITH ;
		ChildAlias = "wellhist", ;
		ChildOrder = "cwellid", ;
		Name = "Relation1", ;
		ParentAlias = "wells", ;
		RelationalExpr = "cwellid"
		*< END OBJECT: BaseClass="relation" />

ENDDEFINE

DEFINE CLASS formdmrwdecline AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="LblBegPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblEndPeriod" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swyear1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swyear2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swperiod1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swperiod2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblGroup" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swgroup1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblBegYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LblEndYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgSortBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboIntType" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbltextcustom7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtnPercent" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />

	Caption = "Production Decline Report"
	DataSession = 2
	DoCreate = .T.
	Height = 519
	HelpContextID = 510
	Name = "Formdmrwdecline"
	Width = 532
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 156
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 23
	Swrptcriteriabuttons1.Top = 432

	ADD OBJECT 'cboIntType' AS cbocomboboxcustom WITH ;
		BoundColumn = 2, ;
		Height = 20, ;
		Left = 192, ;
		lrequired = .F., ;
		Name = "cboIntType", ;
		TabIndex = 18, ;
		Top = 345, ;
		Width = 60
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'chkSelected' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Choose Selected Wells", ;
		Left = 194, ;
		Name = "chkSelected", ;
		TabIndex = 11, ;
		Top = 167, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'lblBegID' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "First Well:", ;
		Left = 136, ;
		Name = "lblBegID", ;
		TabIndex = 13, ;
		Top = 195
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblBegPeriod' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Period:", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 250, ;
		Name = "LblBegPeriod", ;
		TabIndex = 6, ;
		Top = 106, ;
		Width = 35, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblBegYear' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Beginning Prod Year:", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 81, ;
		Name = "LblBegYear", ;
		TabIndex = 5, ;
		Top = 106, ;
		Width = 104, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndID' AS lbltextcustom WITH ;
		BackStyle = 0, ;
		Caption = "Last Well:", ;
		Left = 136, ;
		Name = "lblEndID", ;
		TabIndex = 14, ;
		Top = 246
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblEndPeriod' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Period:", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 250, ;
		Name = "LblEndPeriod", ;
		TabIndex = 10, ;
		Top = 130, ;
		Width = 35, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblEndYear' AS lbllabelcustom WITH ;
		AutoSize = .T., ;
		Caption = "Ending Prod Year:", ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 96, ;
		Name = "LblEndYear", ;
		TabIndex = 9, ;
		Top = 130, ;
		Width = 89, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'LblGroup' AS lbllabelcustom WITH ;
		Caption = "Group:", ;
		Height = 16, ;
		Left = 150, ;
		Name = "LblGroup", ;
		TabIndex = 16, ;
		Top = 296, ;
		Width = 35, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Caption = "All IDs Selected", ;
		ForeColor = 0,0,255, ;
		Left = 193, ;
		Name = "lblSelected", ;
		TabIndex = 17, ;
		Top = 232, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom1' AS lbltextcustom WITH ;
		Caption = "Revenue to Report On:", ;
		Left = 73, ;
		Name = "Lbltextcustom1", ;
		TabIndex = 19, ;
		Top = 347
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom2' AS lbltextcustom WITH ;
		Caption = "Report When Production Drops", ;
		Left = 73, ;
		Name = "Lbltextcustom2", ;
		TabIndex = 21, ;
		Top = 378
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom6' AS lbltextcustom WITH ;
		Caption = "Sort By:", ;
		Left = 144, ;
		Name = "Lbltextcustom6", ;
		TabIndex = 2, ;
		Top = 48
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbltextcustom7' AS lbltextcustom WITH ;
		Caption = "% From Previous Month", ;
		Left = 272, ;
		Name = "Lbltextcustom7", ;
		TabIndex = 22, ;
		Top = 378
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgSortBy' AS opgoptiongroupcustom WITH ;
		AutoSize = .T., ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 45, ;
		Left = 189, ;
		Name = "opgSortBy", ;
		TabIndex = 1, ;
		Top = 42, ;
		Value = 1, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = " Well ID", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Value = 1, ;
		Option1.Width = 53, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = " Well Name", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "Option2", ;
		Option2.Top = 24, ;
		Option2.Width = 71
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Swgroup1' AS swgroup WITH ;
		Height = 20, ;
		Left = 192, ;
		Name = "Swgroup1", ;
		TabIndex = 15, ;
		Top = 294, ;
		Width = 216, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="combobox" />

	ADD OBJECT 'Swperiod1' AS swperiod WITH ;
		Left = 292, ;
		Name = "Swperiod1", ;
		TabIndex = 4, ;
		Top = 104, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swperiod2' AS swperiod WITH ;
		Left = 292, ;
		Name = "Swperiod2", ;
		TabIndex = 8, ;
		Top = 128, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 192, ;
		Name = "Swrptlook1", ;
		TabIndex = 12, ;
		Top = 192, ;
		ZOrderSet = 5, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		txtBegID.clistexpression = wells.cwellid, ;
		txtBegID.clistworkarea = wells, ;
		txtBegID.Name = "txtBegID", ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = wells.cwellid, ;
		txtEndID.clistworkarea = wells, ;
		txtEndID.Name = "txtEndID", ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'Swyear1' AS swyear WITH ;
		Left = 192, ;
		Name = "Swyear1", ;
		TabIndex = 3, ;
		Top = 104, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'Swyear2' AS swyear WITH ;
		Left = 192, ;
		Name = "Swyear2", ;
		TabIndex = 7, ;
		Top = 128, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtnPercent' AS txttextboxcustom WITH ;
		Height = 20, ;
		InputMask = "999", ;
		Left = 226, ;
		Name = "txtnPercent", ;
		TabIndex = 20, ;
		Top = 376, ;
		Width = 44
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lPct, lcGroup, lcOldID, lcPeriod1, lcPeriod2, lcReportOn, lcWell1, lcWell2, lcYear1, lcYear2
		LOCAL llReturn, lnCount, lnOldBBL, lnOldMCF, lnOrderBy, lnPct, loError
		
		llReturn = .t.
		
		TRY
		    lcYear1    = THIS.swYear1.VALUE
		    lcYear2    = THIS.swYear2.VALUE
		    lcPeriod1  = THIS.swPeriod1.VALUE
		    lcPeriod2  = THIS.swPeriod2.VALUE
		    lnOrderBy  = THIS.opgSortBy.VALUE
		    lcWell1    = THIS.Swrptlook1.txtBegID.VALUE
		    lcWell2    = THIS.Swrptlook1.txtEndID.VALUE
		    lcGroup    = LEFT(THIS.swGroup1.VALUE, 2)
		    lcReportOn = THIS.cboIntType.VALUE
		    lnPct      = THIS.txtnPercent.VALUE
		    llSelected = thisform.chkselected.Value 
		 
		    IF NOT llSelected
		       SELECT cwellid as cid FROM wells WHERE BETWEEN(cwellid,lcWell1,lcWell2) INTO CURSOR selected
		    ENDIF  
		
		    IF USED('welltemp1')
		        USE IN welltemp1
		    ENDIF
		    IF USED('welltemp')
		        USE IN welltemp
		    ENDIF
		
			SELECT  wells.cwellid, cwellname, wells.cGroup, hYear AS cYear, hPeriod AS cPeriod, ;
					SUM(nTotMCF) AS nTotMCF, SUM(nTotBBL) AS nTotBBL, lcReportOn AS cType, .F. AS lOBad, .F. AS lGBad, 000.00 AS nODecline, 000.00 AS nGDecline ;
			   FROM wellhist, wells ;
			   WHERE wellhist.cwellid in (select cid from selected) ;
				   AND wells.cwellid = wellhist.cwellid ;
				   AND IIF(lcGroup <> '**', wells.cGroup = lcGroup, .T.) ;
				   AND BETWEEN(wellhist.hYear + wellhist.hPeriod, lcYear1 + lcPeriod1, lcYear2 + lcPeriod2) ;
			   INTO CURSOR welltemp1 ;
			   GROUP BY wells.cwellid, cYear, cPeriod
		
		    USE DBF('welltemp1') AGAIN IN 0 ALIAS welltemp
		    SELECT welltemp
		    INDEX ON cwellid + cYear + cPeriod TAG cwellid
		    INDEX ON cwellname + cYear + cPeriod TAG cwellname
		    IF lnOrderBy = 1  &&  Well ID
		        SET ORDER TO cwellid
		    ELSE
		        SET ORDER TO cwellname
		    ENDIF
		
		    lcOldID  = ''
		    lnOldMCF = 0
		    lnOldBBL = 0
		
		    SCAN
		        SCATTER MEMVAR
		        IF m.cwellid == lcOldID  &&  Not the First Rec for the well, so decline needs to be calculated for this one
		            IF lcReportOn = 'O' OR lcReportOn = 'B'  &&  If reporting on oil or both, calculate decline
		                IF lnOldBBL = 0 AND nTotBBL <> 0  &&  If the previous month is zero, and there was production this month, the decline should be 100%
		                    REPLACE nODecline WITH 0
		                ELSE
		                    IF lnOldBBL <> 0
		                        lPct = 100 - ROUND(100 * (nTotBBL / lnOldBBL), 2)
		                        IF lPct > 0
		                            REPLACE nODecline WITH lPct
		                        ENDIF
		                    ENDIF
		                    IF nODecline > lnPct
		                        REPLACE lOBad WITH .T.
		                    ENDIF
		                ENDIF
		            ENDIF
		            IF lcReportOn = 'G' OR lcReportOn = 'B'  &&  If reporting on gas or both, calculate decline
		                IF lnOldMCF = 0 AND nTotMCF <> 0  &&  If the previous month is zero, and there was production this month, the decline should be 100%
		                    REPLACE nGDecline WITH 0
		                ELSE
		                    IF lnOldMCF <> 0
		                        lPct = 100 - ROUND(100 * (nTotMCF / lnOldMCF), 2)
		                        IF lPct > 0
		                            REPLACE nGDecline WITH lPct
		                        ENDIF
		                    ENDIF
		                    IF nGDecline > lnPct
		                        REPLACE lGBad WITH .T.
		                    ENDIF
		                ENDIF
		            ENDIF
		        ENDIF
		        lcOldID  = m.cwellid
		        lnOldMCF = m.nTotMCF
		        lnOldBBL = m.nTotBBL
		    ENDSCAN
		
		    SELECT wells
		    SCAN FOR BETWEEN(cwellid, lcWell1, lcWell2)
		        SELECT welltemp
		        DO CASE
		            CASE lcReportOn = 'O'
		                LOCATE FOR lOBad AND cwellid = wells.cwellid
		            CASE lcReportOn = 'G'
		                LOCATE FOR lGBad AND cwellid = wells.cwellid
		            OTHERWISE
		                LOCATE FOR (lOBad AND cwellid = wells.cwellid) OR (lGBad AND cwellid = wells.cwellid)
		        ENDCASE
		        IF NOT FOUND()
		            DELETE FOR cwellid = wells.cwellid
		        ENDIF
		    ENDSCAN
		
		    THISFORM.cReportName     = 'dmrwdecline'
		    THISFORM.cSelectCriteria = 'Wells: ' + ALLT(lcWell1) + ' - ' + ALLT(lcWell2) + ' in Group ' + THISFORM.swGroup1.VALUE
		    THISFORM.cSortOrder      = IIF(lnOrderBy = 1, 'Well ID', 'Well Name')
		    THISFORM.cTitle1         = 'Well Production Decline Report'
		    THISFORM.cTitle2         = 'For Decline Greater Than ' + ALLT(STR(lnPct)) + '%'
		
		    SELECT welltemp
		    COUNT FOR NOT DELETED() TO lnCount
		    IF lnCount > 0
		        llReturn = .T.
		    ELSE
		        llReturn = .F.
		    ENDIF
		CATCH TO loError
		    llReturn = .F.
		    DO errorlog WITH 'BuildData', loError.LINENO, 'Well Decline', loError.ERRORNO, loError.MESSAGE, '', loError
		    MESSAGEBOX('Unable to process the report at this time. Check the System Log found under Other Reports for more information.' + CHR(10) + CHR(10) + ;
		          'Contact SherWare Support for help at support@sherware.com', 16, 'Problem Encountered')
		ENDTRY
		
		RETURN llReturn
		
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		
		swselect('wells')
		SET ORDER TO cWellID
		
		GO TOP
		THISFORM.swrptlook1.txtBegName.VALUE = cwellname
		THISFORM.swrptlook1.txtBegID.VALUE   = cWellID
		
		GO BOTTOM
		THISFORM.swrptlook1.txtEndName.VALUE = cwellname
		THISFORM.swrptlook1.txtEndID.VALUE   = cWellID
		
		swselect('sysctl')
		SET ORDER TO yrprdkey
		GO TOP
		SCAN FOR lDisbman AND cTypeClose = 'R'
		    THISFORM.swYear1.VALUE   = cYear
		    THISFORM.swPeriod1.VALUE = cPeriod
		    THISFORM.swYear2.VALUE   = cYear
		    THISFORM.swPeriod2.VALUE = cPeriod
		    IF THISFORM.swGroup1.lExcludeAll
		        lnListCount = THISFORM.swGroup1.LISTCOUNT
		    ELSE
		        lnListCount = THISFORM.swGroup1.LISTCOUNT + 1
		    ENDIF
		
		    FOR lnX = 1 TO lnListCount
		        IF LEFT(THISFORM.swGroup1.LISTITEM[lnX], 2) = cGroup
		            THISFORM.swGroup1.LISTITEMID = lnX
		            EXIT
		        ENDIF
		    ENDFOR
		    EXIT
		ENDSCAN
		
		
		
		
	ENDPROC

	PROCEDURE cboIntType.Init
		this.addlistitem('Both',1,1)
		this.addlistitem('B',1,2)
		this.addlistitem('Oil',2,1)
		this.addlistitem('O',2,2)
		this.addlistitem('Gas',3,1)
		this.addlistitem('G',3,2)
		
		this.listitemid = 1
		
		DODEFAULT()
	ENDPROC

	PROCEDURE chkSelected.Click
		IF this.Value
		   DO FORM commonsource\selected-ids WITH 'WELL' LINKED 
		   lnCount = RECCOUNT('selected')
		   thisform.lblselected.Caption = TRANSFORM(lnCount) + ' Wells Selected'
		   thisform.lblselected.Visible = .T.
		   thisform.lblbegID.Visible = .F.
		   thisform.lblendID.Visible = .F.
		   thisform.swrptlook1.Visible = .F.
		ELSE
		   thisform.lblselected.Visible = .F.
		   thisform.lblbegID.Visible = .T.
		   thisform.lblendID.Visible = .T.
		   thisform.swrptlook1.Visible = .T.
		ENDIF 
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtbegid.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = cwellid
		   thisform.swrptlook1.txtBegName.value = cwellname
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'cwellid,cwellname,cgroup,cwellstat'
		DO FORM ..\custom\picklist WITH 'Wells', lcList, thisform.swrptlook1.txtendid.value, 4
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = cwellid
		   thisform.swrptlook1.txtEndName.value = cwellname
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

	PROCEDURE txtnPercent.Init
		DODEFAULT()
		
		THIS.SET('value',10)
		
	ENDPROC

ENDDEFINE
