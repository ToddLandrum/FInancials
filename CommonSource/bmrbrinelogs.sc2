*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="bmrbrinelogs.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor5" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 277
	Left = 40
	Name = "Dataenvironment"
	Top = 235
	Width = 536

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "trucks", ;
		CursorSource = "trucks", ;
		Database = ..\datafiles\duckcreekdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "brinelog", ;
		CursorSource = "brinelog", ;
		Database = ..\datafiles\duckcreekdata\appdata.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "disposal", ;
		CursorSource = "disposal", ;
		Database = ..\datafiles\duckcreekdata\appdata.dbc, ;
		Height = 191, ;
		Left = 290, ;
		Name = "Cursor3", ;
		Top = 20, ;
		Width = 95
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "leases", ;
		CursorSource = "leases", ;
		Database = ..\datafiles\duckcreekdata\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "custs", ;
		CursorSource = "custs", ;
		Database = ..\datafiles\duckcreekdata\appdata.dbc, ;
		Height = 90, ;
		Left = 149, ;
		Name = "Cursor5", ;
		Top = 143, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formbmrbrinelogs AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="opgReportBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="opgSelectBy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lbldate" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Lbllabelcustom6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcYear" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lbldash" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtddate1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtddate2" UniqueID="" Timestamp="" />

	Caption = "Brine Log Reports"
	DoCreate = .T.
	Height = 374
	HelpContextID = 649
	Name = "FormBmrbrinelogs"
	Width = 386
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.cmdPreview.Name = "cmdPreview"
	Swrptcriteriabuttons1.cmdPrint.Name = "cmdPrint"
	Swrptcriteriabuttons1.Left = 76
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 15
	Swrptcriteriabuttons1.Top = 300

	ADD OBJECT 'lbldash' AS lbllabelcustom WITH ;
		Caption = "-", ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 207, ;
		Name = "lbldash", ;
		TabIndex = 5, ;
		Top = 126, ;
		Width = 6
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lbldate' AS lbllabelcustom WITH ;
		Caption = "Date Range", ;
		Left = 37, ;
		Name = "lbldate", ;
		TabIndex = 8, ;
		Top = 126
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom1' AS lbllabelcustom WITH ;
		Caption = "Report By", ;
		Left = 50, ;
		Name = "Lbllabelcustom1", ;
		TabIndex = 2, ;
		Top = 23
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom2' AS lbllabelcustom WITH ;
		Caption = "Select By", ;
		Left = 197, ;
		Name = "Lbllabelcustom2", ;
		TabIndex = 3, ;
		Top = 23
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom5' AS lbllabelcustom WITH ;
		Caption = "Beginning Range", ;
		Left = 12, ;
		Name = "Lbllabelcustom5", ;
		TabIndex = 13, ;
		Top = 171
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Lbllabelcustom6' AS lbllabelcustom WITH ;
		Caption = "Ending Range", ;
		Left = 27, ;
		Name = "Lbllabelcustom6", ;
		TabIndex = 14, ;
		Top = 221
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblYear' AS lbllabelcustom WITH ;
		Caption = "Year", ;
		Left = 69, ;
		Name = "lblYear", ;
		TabIndex = 11, ;
		Top = 127, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'opgReportBy' AS opgoptiongroupcustom WITH ;
		BorderStyle = 0, ;
		ButtonCount = 4, ;
		Height = 84, ;
		Left = 104, ;
		Name = "opgReportBy", ;
		TabIndex = 1, ;
		Top = 21, ;
		Width = 84, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Truck", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 45, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Customer", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "Option2", ;
		Option2.Top = 24, ;
		Option2.Width = 64, ;
		Option3.AutoSize = .T., ;
		Option3.Caption = "Lease", ;
		Option3.FontSize = 8, ;
		Option3.Height = 16, ;
		Option3.Left = 5, ;
		Option3.Name = "Option3", ;
		Option3.Top = 43, ;
		Option3.Width = 48, ;
		Option4.AutoSize = .T., ;
		Option4.Caption = "County", ;
		Option4.FontSize = 8, ;
		Option4.Height = 16, ;
		Option4.Left = 5, ;
		Option4.Name = "Option4", ;
		Option4.Top = 62, ;
		Option4.Width = 52
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'opgSelectBy' AS opgoptiongroupcustom WITH ;
		BorderStyle = 0, ;
		ButtonCount = 2, ;
		Height = 48, ;
		Left = 257, ;
		Name = "opgSelectBy", ;
		TabIndex = 4, ;
		Top = 23, ;
		Width = 84, ;
		Option1.AutoSize = .T., ;
		Option1.Caption = "Date Range", ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option1.Width = 74, ;
		Option2.AutoSize = .T., ;
		Option2.Caption = "Year", ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 5, ;
		Option2.Name = "Option2", ;
		Option2.Top = 24, ;
		Option2.Width = 42
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 102, ;
		Name = "Swrptlook1", ;
		TabIndex = 12, ;
		Top = 168, ;
		Swlookupbutton1.Left = 194, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton1.Top = 0, ;
		Swlookupbutton2.Left = 194, ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		Swlookupbutton2.Top = 52, ;
		txtBegID.clistexpression = trucks.ctruck, ;
		txtBegID.clistworkarea = trucks, ;
		txtBegID.Height = 20, ;
		txtBegID.Left = 0, ;
		txtBegID.Name = "txtBegID", ;
		txtBegID.Top = 0, ;
		txtBegID.Width = 186, ;
		TxtBegName.Name = "TxtBegName", ;
		txtEndID.clistexpression = trucks.ctruck, ;
		txtEndID.clistworkarea = trucks, ;
		txtEndID.Height = 20, ;
		txtEndID.Left = 0, ;
		txtEndID.Name = "txtEndID", ;
		txtEndID.Top = 52, ;
		txtEndID.Width = 174, ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />

	ADD OBJECT 'txtcYear' AS txttextboxcustom WITH ;
		Height = 20, ;
		Left = 102, ;
		Name = "txtcYear", ;
		TabIndex = 10, ;
		Top = 124, ;
		Visible = .F., ;
		Width = 42
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtddate1' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 102, ;
		Name = "txtddate1", ;
		TabIndex = 6, ;
		Top = 124, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtddate2' AS dpk WITH ;
		ControlSource = "", ;
		Height = 20, ;
		Left = 222, ;
		Name = "txtddate2", ;
		TabIndex = 7, ;
		Top = 124, ;
		Width = 75
		*< END OBJECT: ClassLib="..\custom\swdate.vcx" BaseClass="textbox" />
	
	PROCEDURE builddata
		LOCAL lcRange1, lcRange2, m.cYear
		
		m.ddate1 = THISFORM.txtddate1.VALUE
		m.ddate2 = THISFORM.txtddate2.VALUE
		lcRange1 = THISFORM.swrptlook1.txtBegid.VALUE
		lcRange2 = THISFORM.swrptlook1.txtEndid.VALUE
		m.cYear  = THISFORM.txtcYear.VALUE
		
		CREATE CURSOR templog  ;
		 (cproducer     c(40), ;
		  clease        c(30), ;
		  ddate         d, ;
		  ccounty       c(25), ;
		  cpermit       c(60), ;
		  namount       i, ;
		  ctruck        c(5), ;
		  cdesc         c(20), ;
		  ctype         c(10), ;
		  cpermit1      c(10), ;
		  cdispsite     c(20), ;
		  cdispmeth     c(20))
		  
		DO CASE
		   CASE THISFORM.opgSelectBy.VALUE = 2         && Year
		      DO CASE
		         CASE THISFORM.opgReportBy.VALUE = 1  &&  Truck
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype, ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;
		               FROM brinelog  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN disposal ;
		                  on disposal.cdisperm == brinelog.cdisperm ;      
		               JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(trucks.ctruck,lcRange1,lcRange2) ;
		               AND YEAR(ddate) = VAL(m.cYear) ;
		               ORDER BY brinelog.ctruck, ddate, custs.ccustname, leases.clease, disposal.cdisperm ;
		               GROUP BY brinelog.ctruck, ddate, custs.ccustname, leases.clease, disposal.cdisperm ;
		               INTO CURSOR temp
		
		         CASE THISFORM.opgReportBy.VALUE = 2  &&  Customer
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype,  ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;
		               FROM brinelog  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               JOIN disposal ;
		                  on disposal.cdisperm == brinelog.cdisperm ;   
		               LEFT OUTER JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(custs.ccustid,lcRange1,lcRange2) ;
		               AND YEAR(ddate) = VAL(m.cYear) ;
		               ORDER BY custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               GROUP BY custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               INTO CURSOR temp
		
		         CASE THISFORM.opgReportBy.VALUE = 3  &&  Lease
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype,  ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;
		               FROM brinelog  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               JOIN disposal ;
		                  on disposal.cdisperm == brinelog.cdisperm ;   
		               LEFT OUTER JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(brinelog.cwellid,lcRange1,lcRange2) ;
		               AND YEAR(ddate) = VAL(m.cYear) ;
		               ORDER BY leases.clease, disposal.cdisperm, custs.ccustname, brinelog.ddate ;
		               GROUP BY leases.clease, disposal.cdisperm, custs.ccustname, brinelog.ddate ;
		               INTO CURSOR temp
		               
		         CASE THISFORM.opgReportBy.VALUE = 4  &&  County
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype, ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;
		               FROM brinelog  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN disposal ;
		                  on disposal.cdisperm == brinelog.cdisperm ;      
		               LEFT OUTER JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(leases.ccounty,lcRange1,lcRange2) ;
		               AND YEAR(ddate) = VAL(m.cYear) ;
		               ORDER BY leases.ccounty, custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               GROUP BY leases.ccounty, custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               INTO CURSOR temp
		
		      ENDCASE
		   CASE THISFORM.opgSelectBy.VALUE = 1          && Date
		      DO CASE
		         CASE THISFORM.opgReportBy.VALUE = 1  &&  Truck
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype, ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;
		               FROM brinelog  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               JOIN disposal ;
		                  ON disposal.cdisperm = brinelog.cdisperm ;
		               JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(trucks.ctruck,lcRange1,lcRange2) ;
		               AND BETWEEN(ddate,m.ddate1,m.ddate2) ;
		               ORDER BY brinelog.ctruck, ddate, custs.ccustname, leases.clease, disposal.cdisperm ;
		               GROUP BY brinelog.ctruck, ddate, custs.ccustname, leases.clease, disposal.cdisperm ;
		               INTO CURSOR temp
		
		         CASE THISFORM.opgReportBy.VALUE = 2  &&  Customer
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype, ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;               
		               FROM brinelog  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               LEFT OUTER JOIN disposal ;
		                  ON disposal.cdisperm = brinelog.cdisperm ;
		               LEFT OUTER JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(custs.ccustid,lcRange1,lcRange2) ;
		               AND BETWEEN(ddate,m.ddate1,m.ddate2) ;
		               ORDER BY custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               GROUP BY custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               INTO CURSOR temp
		
		         CASE THISFORM.opgReportBy.VALUE = 3  &&  Lease
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype, ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;               
		               FROM brinelog  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               JOIN disposal ;
		                  ON disposal.cdisperm = brinelog.cdisperm ;
		               LEFT OUTER JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(leases.cidlease,lcRange1,lcRange2) ;
		               AND BETWEEN(ddate,m.ddate1,m.ddate2) ;
		               ORDER BY leases.clease, brinelog.ddate, leases.cpermit, custs.ccustname ;
		               GROUP BY leases.clease, brinelog.ddate, leases.cpermit, custs.ccustname ;
		               INTO CURSOR temp
		
		         CASE THISFORM.opgReportBy.VALUE = 4  &&  County
		            SELECT custs.ccustname AS cproducer, leases.clease, ddate, leases.ccounty, ;
		               leases.cpermit, leases.cpermit2, leases.cpermit3, leases.cpermit4, leases.cpermit5, leases.cpermit6, ;
		               SUM(namount) AS namount, brinelog.ctruck, trucks.cdesc, brinelog.ctype, ;
		               disposal.cdisperm, disposal.cpermit1, disposal.cdispsite, disposal.cdispmeth ;
		               FROM brinelog  ;
		               JOIN custs  ;
		                  ON custs.ccustid = leases.ccustid  ;
		               JOIN leases  ;
		                  ON leases.cwellid = brinelog.cwellid  ;
		               JOIN disposal ;
		                  ON disposal.cdisperm = brinelog.cdisperm ;
		               LEFT OUTER JOIN trucks  ;
		                  ON trucks.ctruck = brinelog.ctruck  ;
		               WHERE BETWEEN(leases.ccounty,lcRange1,lcRange2) ;
		               AND BETWEEN(ddate,m.ddate1,m.ddate2) ;
		               ORDER BY leases.ccounty, custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               GROUP BY leases.ccounty, custs.ccustname, leases.clease, disposal.cdisperm, brinelog.ddate ;
		               INTO CURSOR temp
		
		      ENDCASE
		ENDCASE
		
		IF _TALLY > 0
		   SELECT temp
		   SCAN
		      SCATTER memvar
		      
		      m.cpermit = ALLTRIM(m.cpermit) + ;
		                  IIF(not EMPTY(m.cpermit2),','+ALLTRIM(m.cpermit2),'') + ;
		                  IIF(not EMPTY(m.cpermit3),','+ALLTRIM(m.cpermit3),'') + ;
		                  IIF(not EMPTY(m.cpermit4),','+ALLTRIM(m.cpermit4),'') + ;
		                  IIF(not EMPTY(m.cpermit5),','+ALLTRIM(m.cpermit5),'') + ;
		                  IIF(not EMPTY(m.cpermit6),','+ALLTRIM(m.cpermit6),'')
		      IF ISNULL(m.cpermit1)
		         m.cpermit1 = ''
		      ENDIF 
		      IF ISNULL(m.cdispsite)
		         m.cdispsite = ''
		         m.cdispmeth = ''
		      ENDIF 
		      IF RIGHT(ALLTRIM(m.cpermit),1)=','
		         m.cpermit = SUBSTR(m.cpermit,1,LEN(ALLTRIM(m.cpermit))-1)
		      ENDIF    
		      *  For mis-matched records where cDesc is .NULL.  
		      IF ISNULL(m.cDesc)
		         m.cDesc = ''
		      ENDIF 
		      INSERT INTO templog FROM memvar
		   ENDSCAN             
		   SELECT templog
		   THISFORM.cTitle1 = 'Brine Log Reports'
		   DO CASE
		      CASE THISFORM.opgReportBy.VALUE = 1
		         THISFORM.creportname = 'bmrlogtruck.FRX'
		         THISFORM.ctitle2     = 'By Truck'
		         THISFORM.cselectcriteria = 'Trucks: ' + THISFORM.swrptlook1.txtBegid.VALUE + '-' + THISFORM.swrptlook1.txtEndid.VALUE
		         THISFORM.csortorder = 'Truck, Date'
		      CASE THISFORM.opgReportBy.VALUE = 2
		         THISFORM.creportname = 'commonsource\bmrlogcust.FRX'
		         THISFORM.ctitle2     = 'By Customer'
		         THISFORM.csortorder = 'Customer, Lease'
		         THISFORM.cselectcriteria = 'Custs: ' + THISFORM.swrptlook1.txtBegid.VALUE + '-' + THISFORM.swrptlook1.txtEndid.VALUE
		      CASE THISFORM.opgReportBy.VALUE = 3
		         THISFORM.creportname = 'bmrloglease.FRX'
		         THISFORM.ctitle2     = 'By Lease'
		         THISFORM.cselectcriteria = 'Leases: ' + THISFORM.swrptlook1.txtBegid.VALUE + '-' + THISFORM.swrptlook1.txtEndid.VALUE
		         THISFORM.csortorder = 'Lease, Customer'
		      CASE THISFORM.opgReportBy.VALUE = 4
		         THISFORM.creportname = 'bmrlogcty.FRX'
		         THISFORM.ctitle2     = 'By County'
		         THISFORM.cselectcriteria = 'Counties: ' + THISFORM.swrptlook1.txtBegid.VALUE + '-' + THISFORM.swrptlook1.txtEndid.VALUE
		         THISFORM.csortorder = 'County, Lease'
		   ENDCASE
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF
		
		
		
	ENDPROC

	PROCEDURE Init
		
		IF DODEFAULT()
		   
		   SELECT trucks
		   SET ORDER TO ctruck
		   GO TOP
		   
		   thisform.swrptlook1.txtbegid.value = ctruck
		   thisform.swrptlook1.txtbegname.value = cdesc
		   
		   GO BOTT
		   thisform.swrptlook1.txtendid.value = ctruck
		   thisform.swrptlook1.txtendname.value = cdesc
		   
		   thisform.txtddate1.value = CTOD('01/01/' + STR(YEAR(DATE()),4))
		   thisform.txtddate2.value = DATE()
		   
		   thisform.txtcYear.value = STR(YEAR(DATE()),4)
		   
		   thisform.opgReportBy.value = 1
		   thisform.opgSelectBy.value = 1
		   
		   thisform.refresh()
		ENDIF   
	ENDPROC

	PROCEDURE opgReportBy.Option1.Valid
		SELECT trucks
		SET ORDER TO ctruck
		GO TOP
		thisform.swrptlook1.txtbegid.value = cTruck
		thisform.swrptlook1.txtbegname.value = cdesc
		thisform.swrptlook1.txtbegid.clistexpression = 'trucks.ctruck'
		thisform.swrptlook1.txtbegid.clistworkarea = 'trucks'
		GO BOTT
		thisform.swrptlook1.txtendid.value = cTruck
		thisform.swrptlook1.txtendname.value = cdesc
		thisform.swrptlook1.txtendid.clistexpression = 'trucks.ctruck'
		thisform.swrptlook1.txtendid.clistworkarea = 'trucks'
		
		thisform.refresh()
	ENDPROC

	PROCEDURE opgReportBy.Option2.Valid
		SELECT custs
		SET ORDER TO ccustid
		GO TOP
		THISFORM.swrptlook1.txtbegid.VALUE = ccustid
		thisform.swrptlook1.txtbegname.value = ccustname
		thisform.swrptlook1.txtbegid.clistexpression = 'custs.ccustid'
		thisform.swrptlook1.txtbegid.clistworkarea = 'custs'
		
		GO BOTT
		THISFORM.swrptlook1.txtendid.VALUE = ccustid
		thisform.swrptlook1.txtendname.value = ccustname
		thisform.swrptlook1.txtendid.clistexpression = 'custs.ccustid'
		thisform.swrptlook1.txtendid.clistworkarea = 'custs'
		
		THISFORM.REFRESH()
		
	ENDPROC

	PROCEDURE opgReportBy.Option3.Valid
		SELECT leases
		SET ORDER TO cwellid
		GO TOP
		THISFORM.swrptlook1.txtbegid.VALUE = cwellid
		thisform.swrptlook1.txtbegname.value = clease
		thisform.swrptlook1.txtbegid.clistexpression = 'leases.cwellid'
		thisform.swrptlook1.txtbegid.clistworkarea = 'leases'
		
		GO BOTT
		THISFORM.swrptlook1.txtendid.VALUE = cwellid
		thisform.swrptlook1.txtendname.value = clease
		thisform.swrptlook1.txtendid.clistexpression = 'leases.cwellid'
		thisform.swrptlook1.txtendid.clistworkarea = 'leases'
		
		THISFORM.REFRESH()
		
	ENDPROC

	PROCEDURE opgReportBy.Option4.Valid
		SELECT leases
		SET ORDER TO county
		GO TOP
		THISFORM.swrptlook1.txtbegid.VALUE = ccounty
		thisform.swrptlook1.txtbegname.value = ccounty
		thisform.swrptlook1.txtbegid.clistexpression = 'leases.ccounty'
		thisform.swrptlook1.txtbegid.clistworkarea = 'leases'
		
		GO BOTT
		THISFORM.swrptlook1.txtendid.VALUE = ccounty
		thisform.swrptlook1.txtendname.value = ccounty
		thisform.swrptlook1.txtbegid.clistexpression = 'leases.ccounty'
		thisform.swrptlook1.txtbegid.clistworkarea = 'leases'
		
		THISFORM.REFRESH()
		
	ENDPROC

	PROCEDURE opgSelectBy.Option1.When
		this.value = 1
		this.parent.option2.value = 0
		
		thisform.lblyear.visible = .f.
		thisform.txtcyear.visible = .f.
		
		thisform.lblDate.visible   = .t.
		thisform.txtddate1.visible = .t.
		thisform.txtddate2.visible = .t.
		thisform.lbldash.visible = .t.
	ENDPROC

	PROCEDURE opgSelectBy.Option2.When
		this.value = 1
		this.parent.option1.value = 0
		
		thisform.lblyear.visible = .t.
		thisform.txtcyear.visible = .t.
		
		thisform.lblDate.visible   = .f.
		thisform.txtddate1.visible = .f.
		thisform.txtddate2.visible = .f.
		thisform.lbldash.visible = .f.
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		
		DO CASE
		   CASE thisform.opgReportBy.value = 1
		      SELECT trucks
		      SET ORDER TO ctruck
		      lcList = 'cTruck,cdesc'
		      DO FORM ..\custom\picklist WITH 'Trucks', lcList, thisform.swrptlook1.txtbegid.value, 2
		      IF llOK      
		         thisform.swrptlook1.txtbegid.value = ctruck
		         thisform.swrptlook1.txtbegname.value = cdesc
		      ENDIF
		         
		   CASE thisform.opgReportBy.value = 2
		      SELECT custs
		      SET ORDER TO ccustid
		      lcList = 'ccustid,ccustname'
		      DO FORM ..\custom\picklist WITH 'Custs', lcList, thisform.swrptlook1.txtbegid.value, 2
		      IF llOK
		         thisform.swrptlook1.txtbegid.value = ccustid
		         thisform.swrptlook1.txtbegname.value = ccustname
		      ENDIF   
		   CASE thisform.opgReportBy.value = 3
		      SELECT leases
		      SET ORDER TO cwellid
		      lcList = 'cwellid, clease'
		      DO FORM ..\custom\picklist WITH 'leases', lcList, thisform.swrptlook1.txtbegid.value, 2
		      IF llOK
		         thisform.swrptlook1.txtbegid.value = cwellid
		         thisform.swrptlook1.txtbegname.value = clease
		      ENDIF   
		   CASE thisform.opgReportBy.value = 4
		      IF USED('counties')
		         USE IN counties
		      ENDIF   
		      IF USED('tmp')
		         USE IN tmp
		      ENDIF   
		      SELECT cCounty FROM leases INTO CURSOR tmp ORDER BY ccounty GROUP BY ccounty
		      IF _tally > 0
		         USE DBF('tmp') AGAIN IN 0 ALIAS counties
		         SET SAFETY OFF
		         INDEX ON ccounty TAG ccounty
		         lcList = 'ccounty\County'
		         DO FORM ..\custom\picklist WITH 'counties', lcList, thisform.swrptlook1.txtbegid.value, 1, .T., .t.
		         IF llOK
		            thisform.swrptlook1.txtbegid.value = ccounty
		            thisform.swrptlook1.txtbegname.value = ccounty
		         ENDIF
		      ENDIF   
		ENDCASE
		
		thisform.setnextcontrol(thisform.swrptlook1.txtbegid)      
		thisform.refresh()         
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		
		DO CASE
		   CASE thisform.opgReportBy.value = 1
		      SELECT trucks
		      SET ORDER TO ctruck
		      lcList = 'cTruck,cdesc'
		      DO FORM ..\custom\picklist WITH 'Trucks', lcList, thisform.swrptlook1.txtendid.value, 2
		      IF llOK      
		         thisform.swrptlook1.txtendid.value = ctruck
		         thisform.swrptlook1.txtendname.value = cdesc
		      ENDIF
		         
		   CASE thisform.opgReportBy.value = 2
		      SELECT custs
		      SET ORDER TO ccustid
		      lcList = 'ccustid,ccustname'
		      DO FORM ..\custom\picklist WITH 'Custs', lcList, thisform.swrptlook1.txtendid.value, 2
		      IF llOK
		         thisform.swrptlook1.txtendid.value = ccustid
		         thisform.swrptlook1.txtendname.value = ccustname
		      ENDIF   
		   CASE thisform.opgReportBy.value = 3
		      SELECT leases
		      SET ORDER TO cwellid
		      lcList = 'cwellid, clease'
		      DO FORM ..\custom\picklist WITH 'leases', lcList, thisform.swrptlook1.txtendid.value, 2
		      IF llOK
		         thisform.swrptlook1.txtendid.value = cwellid
		         thisform.swrptlook1.txtendname.value = clease
		      ENDIF   
		   CASE thisform.opgReportBy.value = 4
		      IF USED('counties')
		         USE IN counties
		      ENDIF   
		      IF USED('tmp')
		         USE IN tmp
		      ENDIF   
		      SELECT cCounty FROM leases INTO CURSOR tmp ORDER BY ccounty GROUP BY ccounty
		      IF _tally > 0
		         USE DBF('tmp') AGAIN IN 0 ALIAS counties
		         SET SAFETY OFF
		         INDEX ON ccounty TAG ccounty
		         lcList = 'ccounty\County'
		         DO FORM ..\custom\picklist WITH 'counties', lcList, thisform.swrptlook1.txtendid.value, 1, .T., .t.
		         IF llOK
		            thisform.swrptlook1.txtendid.value = ccounty
		            thisform.swrptlook1.txtendname.value = ccounty
		         ENDIF
		      ENDIF   
		ENDCASE
		
		thisform.setnextcontrol(thisform.swrptlook1.txtendid)      
		thisform.refresh()         
	ENDPROC

	PROCEDURE Swrptlook1.txtBegID.InteractiveChange
		IF DODEFAULT()
		   DO CASE
		      CASE THISFORM.opgReportBy.VALUE = 1  && Truck
		         THISFORM.swrptlook1.txtbegName.VALUE = trucks.cdesc
		
		      CASE THISFORM.opgReportBy.VALUE = 2  && Customer
		         THISFORM.swrptlook1.txtbegName.VALUE = custs.ccustname
		
		      CASE THISFORM.opgReportBy.VALUE = 3  && Lease
		         THISFORM.swrptlook1.txtbegName.VALUE = leases.clease
		
		      CASE THISFORM.opgReportBy.VALUE = 4  && County
		         THISFORM.swrptlook1.txtbegName.VALUE = leases.ccounty
		   ENDCASE
		ENDIF
		
	ENDPROC

	PROCEDURE Swrptlook1.txtEndID.InteractiveChange
		IF DODEFAULT()
		   DO CASE
		      CASE THISFORM.opgReportBy.VALUE = 1  && Truck
		         THISFORM.swrptlook1.txtEndName.VALUE = trucks.cdesc
		
		      CASE THISFORM.opgReportBy.VALUE = 2  && Customer
		         THISFORM.swrptlook1.txtEndName.VALUE = custs.ccustname
		
		      CASE THISFORM.opgReportBy.VALUE = 3  && Lease
		         THISFORM.swrptlook1.txtEndName.VALUE = leases.clease
		
		      CASE THISFORM.opgReportBy.VALUE = 4  && County
		         THISFORM.swrptlook1.txtEndName.VALUE = leases.ccounty
		   ENDCASE
		ENDIF
		
	ENDPROC

ENDDEFINE
