*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="dmrexplist.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />

	AutoOpenTables = .F.
	DataSource = .NULL.
	Height = 200
	Left = 34
	Name = "Dataenvironment"
	Top = 469
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "expcat", ;
		CursorSource = "expcat", ;
		Database = ..\datafiles\data\appdata.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formdmrexplist AS frmrptcriteria OF "..\source\appforms.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Swrptlook1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblEndID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblBegID" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="chkSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblSelected" UniqueID="" Timestamp="" />

	Caption = "Expense Code Listing"
	DoCreate = .T.
	Height = 302
	HelpContextID = 654
	Name = "FormDmrexpList"
	Width = 380
	Swrptcriteriabuttons1.chkExport.Alignment = 0
	Swrptcriteriabuttons1.chkExport.Name = "chkExport"
	Swrptcriteriabuttons1.cmdclose.Name = "cmdclose"
	Swrptcriteriabuttons1.CMDPREVIEW.Name = "CMDPREVIEW"
	Swrptcriteriabuttons1.CMDPRINT.Name = "CMDPRINT"
	Swrptcriteriabuttons1.Left = 72
	Swrptcriteriabuttons1.Name = "Swrptcriteriabuttons1"
	Swrptcriteriabuttons1.TabIndex = 5
	Swrptcriteriabuttons1.Top = 204
	Swrptcriteriabuttons1.ZOrderSet = 1

	ADD OBJECT 'chkSelected' AS chkcheckboxcustom WITH ;
		Alignment = 0, ;
		Caption = "Choose Selected Codes", ;
		Left = 119, ;
		Name = "chkSelected", ;
		TabIndex = 3, ;
		Top = 59, ;
		Value = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="checkbox" />

	ADD OBJECT 'lblBegID' AS lbllabelcustom WITH ;
		Caption = "First Exp Code:", ;
		Height = 16, ;
		Left = 36, ;
		Name = "lblBegID", ;
		TabIndex = 1, ;
		TabStop = .F., ;
		Top = 87, ;
		Width = 75, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblEndID' AS lbllabelcustom WITH ;
		Caption = "Last Exp Code:", ;
		Height = 16, ;
		Left = 36, ;
		Name = "lblEndID", ;
		TabIndex = 2, ;
		TabStop = .F., ;
		Top = 138, ;
		Width = 75, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'lblSelected' AS lbllabelcustom WITH ;
		Caption = "All IDs Selected", ;
		ForeColor = 0,0,255, ;
		Left = 118, ;
		Name = "lblSelected", ;
		TabIndex = 6, ;
		Top = 124, ;
		Visible = .F.
		*< END OBJECT: ClassLib="..\..\wellprofits\custom\ccontrol.vcx" BaseClass="label" />

	ADD OBJECT 'Swrptlook1' AS swrptlook WITH ;
		Left = 116, ;
		Name = "Swrptlook1", ;
		TabIndex = 4, ;
		Top = 84, ;
		ZOrderSet = 0, ;
		Swlookupbutton1.Left = 44, ;
		Swlookupbutton1.Name = "Swlookupbutton1", ;
		Swlookupbutton1.Top = 0, ;
		Swlookupbutton2.Left = 44, ;
		Swlookupbutton2.Name = "Swlookupbutton2", ;
		Swlookupbutton2.Top = 52, ;
		TxtBegID.clistexpression = expcat.ccatcode, ;
		TxtBegID.clistworkarea = expcat, ;
		TxtBegID.Height = 20, ;
		TxtBegID.InputMask = "XXXX", ;
		TxtBegID.Left = 0, ;
		TxtBegID.Name = "TxtBegID", ;
		TxtBegID.Top = 0, ;
		TxtBegID.Width = 38, ;
		TxtBegName.Name = "TxtBegName", ;
		TxtEndID.clistexpression = expcat.ccatcode, ;
		TxtEndID.clistworkarea = expcat, ;
		TxtEndID.Height = 20, ;
		TxtEndID.InputMask = "XXXX", ;
		TxtEndID.Left = 0, ;
		TxtEndID.Name = "TxtEndID", ;
		TxtEndID.Top = 51, ;
		TxtEndID.Width = 38, ;
		TxtEndName.Name = "TxtEndName"
		*< END OBJECT: ClassLib="..\custom\swcontrol.vcx" BaseClass="container" />
	
	PROCEDURE builddata
		*
		*   Builds the cursor needed by the report by using
		*   the criteria given in the form
		*
		
		IF USED('explist')
		   USE IN explist
		ENDIF
		
		lcBegID    = thisform.swrptlook1.txtbegID.Value
		lcEndID    = thisform.swrptlook1.txtendID.Value
		llSelected = thisform.chkSelected.Value
		
		IF NOT llSelected
		   SELECT ccatcode as cid FROM expcat WHERE BETWEEN(ccatcode,lcBegID,lcEndID) INTO CURSOR selected
		ENDIF 
		
		SELECT expcat.ccatcode,  ;
		       expcat.cdescrip,  ;
		       expcat.ccateg,  ;
		       expcat.lafetype,  ;
		       expcat.cexpclass,  ;
		       expcat.ctaxcode,  ;
		       expcat.cdracctv,  ;
		       expcat.ccracctv,  ;
		       expcat.cdraccto,  ;
		       expcat.ccraccto  ;
		   FROM expcat  ;
		   ORDER BY expcat.ccatcode  ;
		   WHERE expcat.ccatcode in (SELECT cid FROM selected)  ;
		   INTO CURSOR explist
		   thisform.cTitle1 = ''
		   thisform.cTitle2 = ''
		   thisform.cSelectCriteria = 'Expense Category ID: ' + ALLTRIM(thisform.swrptlook1.txtBegID.value) +  ;
		                              ' - ' + ALLTRIM(thisform.swrptlook1.txtEndID.value)
		   this.cTitle1 = 'Expense Codes'
		   this.cSortOrder = 'Expense Code'                            
		   this.cReportName = 'commonsource\dmexpcat'
		   
		SELECT explist
		IF RECC() > 0
		   RETURN .T.
		ELSE
		   RETURN .F.
		ENDIF         
	ENDPROC

	PROCEDURE Init
		SELECT expcat
		SET ORDER TO ccatcode
		GO TOP
		
		THISFORM.swrptlook1.txtBegName.VALUE = ccateg
		THISFORM.swrptlook1.txtBegID.VALUE = ccatcode
		GO BOTTOM
		
		THISFORM.swrptlook1.txtEndName.VALUE = ccateg
		THISFORM.swrptlook1.txtEndID.VALUE = ccatcode
		
		SELECT expcat
		GO TOP
		
		DODEFAULT()
		
	ENDPROC

	PROCEDURE chkSelected.Click
		IF this.Value
		   DO FORM commonsource\selected-ids WITH 'EXPCAT' LINKED 
		   lnCount = RECCOUNT('selected')
		   thisform.lblselected.Caption = TRANSFORM(lnCount) + ' Codes Selected'
		   thisform.lblselected.Visible = .T.
		   thisform.lblbegID.Visible = .F.
		   thisform.lblendID.Visible = .F.
		   thisform.swrptlook1.Visible = .F.
		ELSE
		   thisform.lblselected.Visible = .F.
		   thisform.lblbegID.Visible = .T.
		   thisform.lblendID.Visible = .T.
		   thisform.swrptlook1.Visible = .T.
		ENDIF 
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'ccatcode,ccateg'
		
		DO FORM ..\custom\picklist WITH 'Expcat', lcList, thisform.swrptlook1.txtbegid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtBegId.value = ccatcode
		   thisform.swrptlook1.txtBegName.value = ccateg
		   thisform.swrptlook1.txtBegId.refresh()
		   thisform.swrptlook1.txtBegName.refresh()
		   
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtBegId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton1.When
		RETURN MDOWN()
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.Click
		LOCAL lcList
		PRIV llOK
		
		llOK = .F.
		lcList = 'ccatcode,ccateg'
		
		DO FORM ..\custom\picklist WITH 'Expcat', lcList, thisform.swrptlook1.txtendid.value, 2
		
		IF llOK
		   thisform.swrptlook1.txtEndId.value = ccatcode
		   thisform.swrptlook1.txtEndName.value = ccateg
		   thisform.swrptlook1.txtEndId.refresh()
		   thisform.swrptlook1.txtEndName.refresh()
		ENDIF   
		
		thisform.setnextcontrol(thisform.swrptlook1.txtEndId)
		
	ENDPROC

	PROCEDURE Swrptlook1.Swlookupbutton2.When
		RETURN MDOWN()
	ENDPROC

ENDDEFINE
